var jR=Object.defineProperty;var Wg=Object.getOwnPropertySymbols;var VR=Object.prototype.hasOwnProperty,zR=Object.prototype.propertyIsEnumerable;var Hg=(m,e,t)=>e in m?jR(m,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[e]=t,Gg=(m,e)=>{for(var t in e||(e={}))VR.call(e,t)&&Hg(m,t,e[t]);if(Wg)for(var t of Wg(e))zR.call(e,t)&&Hg(m,t,e[t]);return m};var cl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function kR(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}function KR(m){if(m.__esModule)return m;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(m).forEach(function(t){var r=Object.getOwnPropertyDescriptor(m,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return m[t]}})}),e}var Od={};Object.defineProperty(Od,"__esModule",{value:!0});function YR(m,e,t){let r;return m._update=(n,i)=>{r._={name:n,value:i}},r=new Proxy(m,{set(n,i,o){if(Object.keys(t).indexOf(o.name)>-1)return t[o.name](n,o.value).then(l=>{Reflect.set(n,i,l[i])}).then(()=>(Object.keys(e).map(l=>e[l](n)),!0));throw new Error("This is not a valid reducer, (\uFF89\u2299\uFE4F\u2299)\uFF89")}}),r}var y1=Od.createStore=YR;function XR(m){return function(e,t){return m(e,t),new Promise(function(r,n){r(e)})}}var T1=Od.reducer=XR,Ld=Array.isArray||function(m){return Object.prototype.toString.call(m)=="[object Array]"},fl=Kg,QR=Nd,JR=eC,ZR=jg,qR=kg,$R=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Nd(m){for(var e=[],t=0,r=0,n="",i;(i=$R.exec(m))!=null;){var o=i[0],l=i[1],u=i.index;if(n+=m.slice(r,u),r=u+o.length,l){n+=l[1];continue}n&&(e.push(n),n="");var c=i[2],f=i[3],h=i[4],p=i[5],E=i[6],v=i[7],M=E==="+"||E==="*",y=E==="?"||E==="*",_=c||"/",g=h||p||(v?".*":"[^"+_+"]+?");e.push({name:f||t++,prefix:c||"",delimiter:_,optional:y,repeat:M,pattern:tC(g)})}return r<m.length&&(n+=m.substr(r)),n&&e.push(n),e}function eC(m){return jg(Nd(m))}function jg(m){for(var e=new Array(m.length),t=0;t<m.length;t++)typeof m[t]=="object"&&(e[t]=new RegExp("^"+m[t].pattern+"$"));return function(r){for(var n="",i=r||{},o=0;o<m.length;o++){var l=m[o];if(typeof l=="string"){n+=l;continue}var u=i[l.name],c;if(u==null){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to be defined')}if(Ld(u)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received "'+u+'"');if(u.length===0){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var f=0;f<u.length;f++){if(c=encodeURIComponent(u[f]),!e[o].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');n+=(f===0?l.prefix:l.delimiter)+c}continue}if(c=encodeURIComponent(u),!e[o].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');n+=l.prefix+c}return n}}function Vg(m){return m.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function tC(m){return m.replace(/([=!:$\/()])/g,"\\$1")}function Fd(m,e){return m.keys=e,m}function zg(m){return m.sensitive?"":"i"}function nC(m,e){var t=m.source.match(/\((?!\?)/g);if(t)for(var r=0;r<t.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return Fd(m,e)}function rC(m,e,t){for(var r=[],n=0;n<m.length;n++)r.push(Kg(m[n],e,t).source);var i=new RegExp("(?:"+r.join("|")+")",zg(t));return Fd(i,e)}function iC(m,e,t){for(var r=Nd(m),n=kg(r,t),i=0;i<r.length;i++)typeof r[i]!="string"&&e.push(r[i]);return Fd(n,e)}function kg(m,e){e=e||{};for(var t=e.strict,r=e.end!==!1,n="",i=m[m.length-1],o=typeof i=="string"&&/\/$/.test(i),l=0;l<m.length;l++){var u=m[l];if(typeof u=="string")n+=Vg(u);else{var c=Vg(u.prefix),f=u.pattern;u.repeat&&(f+="(?:"+c+f+")*"),u.optional?c?f="(?:"+c+"("+f+"))?":f="("+f+")?":f=c+"("+f+")",n+=f}}return t||(n=(o?n.slice(0,-2):n)+"(?:\\/(?=$))?"),r?n+="$":n+=t&&o?"":"(?=\\/|$)",new RegExp("^"+n,zg(e))}function Kg(m,e,t){return e=e||[],Ld(e)?t||(t={}):(t=e,e=[]),m instanceof RegExp?nC(m,e):Ld(m)?rC(m,e,t):iC(m,e,t)}fl.parse=QR;fl.compile=JR;fl.tokensToFunction=ZR;fl.tokensToRegExp=qR;var Ys=typeof document!="undefined",qr=typeof window!="undefined",Ju=typeof history!="undefined",aC=typeof process!="undefined",Bd=Ys&&document.ontouchstart?"touchstart":"click",Vi=qr&&!!(window.history.location||window.location);function zn(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}zn.prototype.configure=function(m){var e=m||{};this._window=e.window||qr&&window,this._decodeURLComponents=e.decodeURLComponents!==!1,this._popstate=e.popstate!==!1&&qr,this._click=e.click!==!1&&Ys,this._hashbang=!!e.hashbang;var t=this._window;this._popstate?t.addEventListener("popstate",this._onpopstate,!1):qr&&t.removeEventListener("popstate",this._onpopstate,!1),this._click?t.document.addEventListener(Bd,this.clickHandler,!1):Ys&&t.document.removeEventListener(Bd,this.clickHandler,!1),this._hashbang&&qr&&!Ju?t.addEventListener("hashchange",this._onpopstate,!1):qr&&t.removeEventListener("hashchange",this._onpopstate,!1)};zn.prototype.base=function(m){if(arguments.length===0)return this._base;this._base=m};zn.prototype._getBase=function(){var m=this._base;if(m)return m;var e=qr&&this._window&&this._window.location;return qr&&this._hashbang&&e&&e.protocol==="file:"&&(m=e.pathname),m};zn.prototype.strict=function(m){if(arguments.length===0)return this._strict;this._strict=m};zn.prototype.start=function(m){var e=m||{};if(this.configure(e),e.dispatch!==!1){this._running=!0;var t;if(Vi){var r=this._window,n=r.location;this._hashbang&&~n.hash.indexOf("#!")?t=n.hash.substr(2)+n.search:this._hashbang?t=n.search+n.hash:t=n.pathname+n.search+n.hash}this.replace(t,null,!0,e.dispatch)}};zn.prototype.stop=function(){if(!!this._running){this.current="",this.len=0,this._running=!1;var m=this._window;this._click&&m.document.removeEventListener(Bd,this.clickHandler,!1),qr&&m.removeEventListener("popstate",this._onpopstate,!1),qr&&m.removeEventListener("hashchange",this._onpopstate,!1)}};zn.prototype.show=function(m,e,t,r){var n=new dl(m,e,this),i=this.prevContext;return this.prevContext=n,this.current=n.path,t!==!1&&this.dispatch(n,i),n.handled!==!1&&r!==!1&&n.pushState(),n};zn.prototype.back=function(m,e){var t=this;if(this.len>0){var r=this._window;Ju&&r.history.back(),this.len--}else setTimeout(m?function(){t.show(m,e)}:function(){t.show(t._getBase(),e)})};zn.prototype.redirect=function(m,e){var t=this;typeof m=="string"&&typeof e=="string"&&Zu.call(this,m,function(r){setTimeout(function(){t.replace(e)},0)}),typeof m=="string"&&typeof e=="undefined"&&setTimeout(function(){t.replace(m)},0)};zn.prototype.replace=function(m,e,t,r){var n=new dl(m,e,this),i=this.prevContext;return this.prevContext=n,this.current=n.path,n.init=t,n.save(),r!==!1&&this.dispatch(n,i),n};zn.prototype.dispatch=function(m,e){var t=0,r=0,n=this;function i(){var l=n.exits[r++];if(!l)return o();l(e,i)}function o(){var l=n.callbacks[t++];if(m.path!==n.current){m.handled=!1;return}if(!l)return sC.call(n,m);l(m,o)}e?i():o()};zn.prototype.exit=function(m,e){if(typeof m=="function")return this.exit("*",m);for(var t=new hl(m,null,this),r=1;r<arguments.length;++r)this.exits.push(t.middleware(arguments[r]))};zn.prototype.clickHandler=function(m){if(this._which(m)===1&&!(m.metaKey||m.ctrlKey||m.shiftKey)&&!m.defaultPrevented){var e=m.target,t=m.path||(m.composedPath?m.composedPath():null);if(t){for(var r=0;r<t.length;r++)if(!!t[r].nodeName&&t[r].nodeName.toUpperCase()==="A"&&!!t[r].href){e=t[r];break}}for(;e&&e.nodeName.toUpperCase()!=="A";)e=e.parentNode;if(!(!e||e.nodeName.toUpperCase()!=="A")){var n=typeof e.href=="object"&&e.href.constructor.name==="SVGAnimatedString";if(!(e.hasAttribute("download")||e.getAttribute("rel")==="external")){var i=e.getAttribute("href");if(!(!this._hashbang&&this._samePath(e)&&(e.hash||i==="#"))&&!(i&&i.indexOf("mailto:")>-1)&&!(n?e.target.baseVal:e.target)&&!(!n&&!this.sameOrigin(e.href))){var o=n?e.href.baseVal:e.pathname+e.search+(e.hash||"");o=o[0]!=="/"?"/"+o:o,aC&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var l=o,u=this._getBase();o.indexOf(u)===0&&(o=o.substr(u.length)),this._hashbang&&(o=o.replace("#!","")),!(u&&l===o&&(!Vi||this._window.location.protocol!=="file:"))&&(m.preventDefault(),this.show(l))}}}}};zn.prototype._onpopstate=function(){var m=!1;return qr?(Ys&&document.readyState==="complete"?m=!0:window.addEventListener("load",function(){setTimeout(function(){m=!0},0)}),function(t){if(!!m){var r=this;if(t.state){var n=t.state.path;r.replace(n,t.state)}else if(Vi){var i=r._window.location;r.show(i.pathname+i.search+i.hash,void 0,void 0,!1)}}}):function(){}}();zn.prototype._which=function(m){return m=m||qr&&this._window.event,m.which==null?m.button:m.which};zn.prototype._toURL=function(m){var e=this._window;if(typeof URL=="function"&&Vi)return new URL(m,e.location.toString());if(Ys){var t=e.document.createElement("a");return t.href=m,t}};zn.prototype.sameOrigin=function(m){if(!m||!Vi)return!1;var e=this._toURL(m),t=this._window,r=t.location;return r.protocol===e.protocol&&r.hostname===e.hostname&&(r.port===e.port||r.port===""&&(e.port==80||e.port==443))};zn.prototype._samePath=function(m){if(!Vi)return!1;var e=this._window,t=e.location;return m.pathname===t.pathname&&m.search===t.search};zn.prototype._decodeURLEncodedURIComponent=function(m){return typeof m!="string"?m:this._decodeURLComponents?decodeURIComponent(m.replace(/\+/g," ")):m};function Yg(){var m=new zn;function e(){return Zu.apply(m,arguments)}return e.callbacks=m.callbacks,e.exits=m.exits,e.base=m.base.bind(m),e.strict=m.strict.bind(m),e.start=m.start.bind(m),e.stop=m.stop.bind(m),e.show=m.show.bind(m),e.back=m.back.bind(m),e.redirect=m.redirect.bind(m),e.replace=m.replace.bind(m),e.dispatch=m.dispatch.bind(m),e.exit=m.exit.bind(m),e.configure=m.configure.bind(m),e.sameOrigin=m.sameOrigin.bind(m),e.clickHandler=m.clickHandler.bind(m),e.create=Yg,Object.defineProperty(e,"len",{get:function(){return m.len},set:function(t){m.len=t}}),Object.defineProperty(e,"current",{get:function(){return m.current},set:function(t){m.current=t}}),e.Context=dl,e.Route=hl,e}function Zu(m,e){if(typeof m=="function")return Zu.call(this,"*",m);if(typeof e=="function")for(var t=new hl(m,null,this),r=1;r<arguments.length;++r)this.callbacks.push(t.middleware(arguments[r]));else typeof m=="string"?this[typeof e=="string"?"redirect":"show"](m,e):this.start(m)}function sC(m){if(!m.handled){var e,t=this,r=t._window;t._hashbang?e=Vi&&this._getBase()+r.location.hash.replace("#!",""):e=Vi&&r.location.pathname+r.location.search,e!==m.canonicalPath&&(t.stop(),m.handled=!1,Vi&&(r.location.href=m.canonicalPath))}}function oC(m){return m.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function dl(m,e,t){var r=this.page=t||Zu,n=r._window,i=r._hashbang,o=r._getBase();m[0]==="/"&&m.indexOf(o)!==0&&(m=o+(i?"#!":"")+m);var l=m.indexOf("?");this.canonicalPath=m;var u=new RegExp("^"+oC(o));if(this.path=m.replace(u,"")||"/",i&&(this.path=this.path.replace("#!","")||"/"),this.title=Ys&&n.document.title,this.state=e||{},this.state.path=m,this.querystring=~l?r._decodeURLEncodedURIComponent(m.slice(l+1)):"",this.pathname=r._decodeURLEncodedURIComponent(~l?m.slice(0,l):m),this.params={},this.hash="",!i){if(!~this.path.indexOf("#"))return;var c=this.path.split("#");this.path=this.pathname=c[0],this.hash=r._decodeURLEncodedURIComponent(c[1])||"",this.querystring=this.querystring.split("#")[0]}}dl.prototype.pushState=function(){var m=this.page,e=m._window,t=m._hashbang;m.len++,Ju&&e.history.pushState(this.state,this.title,t&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};dl.prototype.save=function(){var m=this.page;Ju&&m._window.history.replaceState(this.state,this.title,m._hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};function hl(m,e,t){var r=this.page=t||Ud,n=e||{};n.strict=n.strict||r._strict,this.path=m==="*"?"(.*)":m,this.method="GET",this.regexp=fl(this.path,this.keys=[],n)}hl.prototype.middleware=function(m){var e=this;return function(t,r){if(e.match(t.path,t.params))return t.routePath=e.path,m(t,r);r()}};hl.prototype.match=function(m,e){var t=this.keys,r=m.indexOf("?"),n=~r?m.slice(0,r):m,i=this.regexp.exec(decodeURIComponent(n));if(!i)return!1;delete e[0];for(var o=1,l=i.length;o<l;++o){var u=t[o-1],c=this.page._decodeURLEncodedURIComponent(i[o]);(c!==void 0||!hasOwnProperty.call(e,u.name))&&(e[u.name]=c)}return!0};var Ud=Yg(),lC=Ud,uC=Ud;lC.default=uC;/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Wd="134",cC={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},fC={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Xg=0,Hd=1,Qg=2,dC=3,hC=0,Gd=1,Jg=2,Xs=3,Ya=0,Hn=1,Xa=2,jd=1,pC=2,zi=0,Qs=1,Vd=2,zd=3,kd=4,Zg=5,Qa=100,qg=101,$g=102,Kd=103,Yd=104,e_=200,t_=201,n_=202,r_=203,Xd=204,Qd=205,i_=206,a_=207,s_=208,o_=209,l_=210,u_=0,c_=1,f_=2,qu=3,d_=4,h_=5,p_=6,m_=7,pl=0,g_=1,__=2,pa=0,v_=1,E_=2,y_=3,T_=4,M_=5,$u=300,Ja=301,Za=302,ml=303,gl=304,Js=306,_l=307,vl=1e3,ur=1001,El=1002,kn=1003,ec=1004,mC=1004,tc=1005,gC=1005,Jn=1006,Jd=1007,_C=1007,qa=1008,vC=1008,ki=1009,S_=1010,A_=1011,yl=1012,x_=1013,Tl=1014,yi=1015,$a=1016,R_=1017,C_=1018,b_=1019,Zs=1020,I_=1021,es=1022,cr=1023,D_=1024,P_=1025,w_=cr,ts=1026,qs=1027,O_=1028,L_=1029,N_=1030,F_=1031,B_=1032,U_=1033,Zd=33776,qd=33777,$d=33778,eh=33779,th=35840,nh=35841,rh=35842,ih=35843,W_=36196,ah=37492,sh=37496,H_=37808,G_=37809,j_=37810,V_=37811,z_=37812,k_=37813,K_=37814,Y_=37815,X_=37816,Q_=37817,J_=37818,Z_=37819,q_=37820,$_=37821,ev=36492,tv=37840,nv=37841,rv=37842,iv=37843,av=37844,sv=37845,ov=37846,lv=37847,uv=37848,cv=37849,fv=37850,dv=37851,hv=37852,pv=37853,mv=2200,gv=2201,_v=2202,Ml=2300,Sl=2301,nc=2302,ns=2400,rs=2401,Al=2402,rc=2500,oh=2501,vv=0,EC=1,yC=2,fr=3e3,ma=3001,ic=3007,ac=3002,Ev=3003,lh=3004,uh=3005,ch=3006,yv=3200,Tv=3201,is=0,Mv=1,TC=0,sc=7680,MC=7681,SC=7682,AC=7683,xC=34055,RC=34056,CC=5386,bC=512,IC=513,DC=514,PC=515,wC=516,OC=517,LC=518,Sv=519,$s=35044,eo=35048,NC=35040,FC=35045,BC=35049,UC=35041,WC=35046,HC=35050,GC=35042,jC="100",fh="300 es";class ga{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const n=r.slice(0);for(let i=0,o=n.length;i<o;i++)n[i].call(this,e);e.target=null}}}let oc=1234567;const as=Math.PI/180,xl=180/Math.PI,dr=[];for(let m=0;m<256;m++)dr[m]=(m<16?"0":"")+m.toString(16);const VC=typeof crypto!="undefined"&&"randomUUID"in crypto;function Wr(){if(VC)return crypto.randomUUID().toUpperCase();const m=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(dr[m&255]+dr[m>>8&255]+dr[m>>16&255]+dr[m>>24&255]+"-"+dr[e&255]+dr[e>>8&255]+"-"+dr[e>>16&15|64]+dr[e>>24&255]+"-"+dr[t&63|128]+dr[t>>8&255]+"-"+dr[t>>16&255]+dr[t>>24&255]+dr[r&255]+dr[r>>8&255]+dr[r>>16&255]+dr[r>>24&255]).toUpperCase()}function hr(m,e,t){return Math.max(e,Math.min(t,m))}function dh(m,e){return(m%e+e)%e}function zC(m,e,t,r,n){return r+(m-e)*(n-r)/(t-e)}function kC(m,e,t){return m!==e?(t-m)/(e-m):0}function Rl(m,e,t){return(1-t)*m+t*e}function KC(m,e,t,r){return Rl(m,e,1-Math.exp(-t*r))}function YC(m,e=1){return e-Math.abs(dh(m,e*2)-e)}function XC(m,e,t){return m<=e?0:m>=t?1:(m=(m-e)/(t-e),m*m*(3-2*m))}function QC(m,e,t){return m<=e?0:m>=t?1:(m=(m-e)/(t-e),m*m*m*(m*(m*6-15)+10))}function JC(m,e){return m+Math.floor(Math.random()*(e-m+1))}function ZC(m,e){return m+Math.random()*(e-m)}function qC(m){return m*(.5-Math.random())}function $C(m){return m!==void 0&&(oc=m%2147483647),oc=oc*16807%2147483647,(oc-1)/2147483646}function eb(m){return m*as}function tb(m){return m*xl}function hh(m){return(m&m-1)==0&&m!==0}function Av(m){return Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))}function xv(m){return Math.pow(2,Math.floor(Math.log(m)/Math.LN2))}function nb(m,e,t,r,n){const i=Math.cos,o=Math.sin,l=i(t/2),u=o(t/2),c=i((e+r)/2),f=o((e+r)/2),h=i((e-r)/2),p=o((e-r)/2),E=i((r-e)/2),v=o((r-e)/2);switch(n){case"XYX":m.set(l*f,u*h,u*p,l*c);break;case"YZY":m.set(u*p,l*f,u*h,l*c);break;case"ZXZ":m.set(u*h,u*p,l*f,l*c);break;case"XZX":m.set(l*f,u*v,u*E,l*c);break;case"YXY":m.set(u*E,l*f,u*v,l*c);break;case"ZYZ":m.set(u*v,u*E,l*f,l*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}var Rv=Object.freeze({__proto__:null,DEG2RAD:as,RAD2DEG:xl,generateUUID:Wr,clamp:hr,euclideanModulo:dh,mapLinear:zC,inverseLerp:kC,lerp:Rl,damp:KC,pingpong:YC,smoothstep:XC,smootherstep:QC,randInt:JC,randFloat:ZC,randFloatSpread:qC,seededRandom:$C,degToRad:eb,radToDeg:tb,isPowerOfTwo:hh,ceilPowerOfTwo:Av,floorPowerOfTwo:xv,setQuaternionFromProperEuler:nb});class Et{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*r-o*n+e.x,this.y=i*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Et.prototype.isVector2=!0;class Zn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,i,o,l,u,c){const f=this.elements;return f[0]=e,f[1]=n,f[2]=l,f[3]=t,f[4]=i,f[5]=u,f[6]=r,f[7]=o,f[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,o=r[0],l=r[3],u=r[6],c=r[1],f=r[4],h=r[7],p=r[2],E=r[5],v=r[8],M=n[0],y=n[3],_=n[6],g=n[1],R=n[4],S=n[7],x=n[2],w=n[5],C=n[8];return i[0]=o*M+l*g+u*x,i[3]=o*y+l*R+u*w,i[6]=o*_+l*S+u*C,i[1]=c*M+f*g+h*x,i[4]=c*y+f*R+h*w,i[7]=c*_+f*S+h*C,i[2]=p*M+E*g+v*x,i[5]=p*y+E*R+v*w,i[8]=p*_+E*S+v*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8];return t*o*f-t*l*c-r*i*f+r*l*u+n*i*c-n*o*u}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=f*o-l*c,p=l*u-f*i,E=c*i-o*u,v=t*h+r*p+n*E;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const M=1/v;return e[0]=h*M,e[1]=(n*c-f*r)*M,e[2]=(l*r-n*o)*M,e[3]=p*M,e[4]=(f*t-n*u)*M,e[5]=(n*i-l*t)*M,e[6]=E*M,e[7]=(r*u-c*t)*M,e[8]=(o*t-r*i)*M,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,o,l){const u=Math.cos(i),c=Math.sin(i);return this.set(r*u,r*c,-r*(u*o+c*l)+o+e,-n*c,n*u,-n*(-c*o+u*l)+l+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],o=n[3],l=n[6],u=n[1],c=n[4],f=n[7];return n[0]=t*i+r*u,n[3]=t*o+r*c,n[6]=t*l+r*f,n[1]=-r*i+t*u,n[4]=-r*o+t*c,n[7]=-r*l+t*f,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}Zn.prototype.isMatrix3=!0;function Cv(m){if(m.length===0)return-1/0;let e=m[0];for(let t=1,r=m.length;t<r;++t)m[t]>e&&(e=m[t]);return e}const rb={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function to(m,e){return new rb[m](e)}function lc(m){return document.createElementNS("http://www.w3.org/1999/xhtml",m)}function bv(m,e=0){let t=3735928559^e,r=1103547991^e;for(let n=0,i;n<m.length;n++)i=m.charCodeAt(n),t=Math.imul(t^i,2654435761),r=Math.imul(r^i,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}let no;class ss{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{no===void 0&&(no=lc("canvas")),no.width=e.width,no.height=e.height;const r=no.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=no}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}let ib=0;class qn extends ga{constructor(e=qn.DEFAULT_IMAGE,t=qn.DEFAULT_MAPPING,r=ur,n=ur,i=Jn,o=qa,l=cr,u=ki,c=1,f=fr){super();Object.defineProperty(this,"id",{value:ib++}),this.uuid=Wr(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=o,this.anisotropy=c,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Et(0,0),this.repeat=new Et(1,1),this.center=new Et(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const n=this.image;if(n.uuid===void 0&&(n.uuid=Wr()),!t&&e.images[n.uuid]===void 0){let i;if(Array.isArray(n)){i=[];for(let o=0,l=n.length;o<l;o++)n[o].isDataTexture?i.push(ph(n[o].image)):i.push(ph(n[o]))}else i=ph(n);e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==$u)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vl:e.x=e.x-Math.floor(e.x);break;case ur:e.x=e.x<0?0:1;break;case El:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case vl:e.y=e.y-Math.floor(e.y);break;case ur:e.y=e.y<0?0:1;break;case El:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}qn.DEFAULT_IMAGE=void 0;qn.DEFAULT_MAPPING=$u;qn.prototype.isTexture=!0;function ph(m){return typeof HTMLImageElement!="undefined"&&m instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&m instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&m instanceof ImageBitmap?ss.getDataURL(m):m.data?{data:Array.prototype.slice.call(m.data),width:m.width,height:m.height,type:m.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class Mn{constructor(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i;const o=.01,l=.1,u=e.elements,c=u[0],f=u[4],h=u[8],p=u[1],E=u[5],v=u[9],M=u[2],y=u[6],_=u[10];if(Math.abs(f-p)<o&&Math.abs(h-M)<o&&Math.abs(v-y)<o){if(Math.abs(f+p)<l&&Math.abs(h+M)<l&&Math.abs(v+y)<l&&Math.abs(c+E+_-3)<l)return this.set(1,0,0,0),this;t=Math.PI;const R=(c+1)/2,S=(E+1)/2,x=(_+1)/2,w=(f+p)/4,C=(h+M)/4,b=(v+y)/4;return R>S&&R>x?R<o?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(R),n=w/r,i=C/r):S>x?S<o?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(S),r=w/n,i=b/n):x<o?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(x),r=C/i,n=b/i),this.set(r,n,i,t),this}let g=Math.sqrt((y-v)*(y-v)+(h-M)*(h-M)+(p-f)*(p-f));return Math.abs(g)<.001&&(g=1),this.x=(y-v)/g,this.y=(h-M)/g,this.z=(p-f)/g,this.w=Math.acos((c+E+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Mn.prototype.isVector4=!0;class oi extends ga{constructor(e,t,r={}){super();this.width=e,this.height=t,this.depth=1,this.scissor=new Mn(0,0,e,t),this.scissorTest=!1,this.viewport=new Mn(0,0,e,t),this.texture=new qn(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Jn,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Gg({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}oi.prototype.isWebGLRenderTarget=!0;class Iv extends oi{constructor(e,t,r){super(e,t);const n=this.texture;this.texture=[];for(let i=0;i<r;i++)this.texture[i]=n.clone()}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,i=this.texture.length;n<i;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone();return this}}Iv.prototype.isWebGLMultipleRenderTargets=!0;class mh extends oi{constructor(e,t,r){super(e,t,r);this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}mh.prototype.isWebGLMultisampleRenderTarget=!0;class pr{constructor(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}static slerp(e,t,r,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,n)}static slerpFlat(e,t,r,n,i,o,l){let u=r[n+0],c=r[n+1],f=r[n+2],h=r[n+3];const p=i[o+0],E=i[o+1],v=i[o+2],M=i[o+3];if(l===0){e[t+0]=u,e[t+1]=c,e[t+2]=f,e[t+3]=h;return}if(l===1){e[t+0]=p,e[t+1]=E,e[t+2]=v,e[t+3]=M;return}if(h!==M||u!==p||c!==E||f!==v){let y=1-l;const _=u*p+c*E+f*v+h*M,g=_>=0?1:-1,R=1-_*_;if(R>Number.EPSILON){const x=Math.sqrt(R),w=Math.atan2(x,_*g);y=Math.sin(y*w)/x,l=Math.sin(l*w)/x}const S=l*g;if(u=u*y+p*S,c=c*y+E*S,f=f*y+v*S,h=h*y+M*S,y===1-l){const x=1/Math.sqrt(u*u+c*c+f*f+h*h);u*=x,c*=x,f*=x,h*=x}}e[t]=u,e[t+1]=c,e[t+2]=f,e[t+3]=h}static multiplyQuaternionsFlat(e,t,r,n,i,o){const l=r[n],u=r[n+1],c=r[n+2],f=r[n+3],h=i[o],p=i[o+1],E=i[o+2],v=i[o+3];return e[t]=l*v+f*h+u*E-c*p,e[t+1]=u*v+f*p+c*h-l*E,e[t+2]=c*v+f*E+l*p-u*h,e[t+3]=f*v-l*h-u*p-c*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,n=e._y,i=e._z,o=e._order,l=Math.cos,u=Math.sin,c=l(r/2),f=l(n/2),h=l(i/2),p=u(r/2),E=u(n/2),v=u(i/2);switch(o){case"XYZ":this._x=p*f*h+c*E*v,this._y=c*E*h-p*f*v,this._z=c*f*v+p*E*h,this._w=c*f*h-p*E*v;break;case"YXZ":this._x=p*f*h+c*E*v,this._y=c*E*h-p*f*v,this._z=c*f*v-p*E*h,this._w=c*f*h+p*E*v;break;case"ZXY":this._x=p*f*h-c*E*v,this._y=c*E*h+p*f*v,this._z=c*f*v+p*E*h,this._w=c*f*h-p*E*v;break;case"ZYX":this._x=p*f*h-c*E*v,this._y=c*E*h+p*f*v,this._z=c*f*v-p*E*h,this._w=c*f*h+p*E*v;break;case"YZX":this._x=p*f*h+c*E*v,this._y=c*E*h+p*f*v,this._z=c*f*v-p*E*h,this._w=c*f*h-p*E*v;break;case"XZY":this._x=p*f*h-c*E*v,this._y=c*E*h-p*f*v,this._z=c*f*v+p*E*h,this._w=c*f*h+p*E*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],i=t[8],o=t[1],l=t[5],u=t[9],c=t[2],f=t[6],h=t[10],p=r+l+h;if(p>0){const E=.5/Math.sqrt(p+1);this._w=.25/E,this._x=(f-u)*E,this._y=(i-c)*E,this._z=(o-n)*E}else if(r>l&&r>h){const E=2*Math.sqrt(1+r-l-h);this._w=(f-u)/E,this._x=.25*E,this._y=(n+o)/E,this._z=(i+c)/E}else if(l>h){const E=2*Math.sqrt(1+l-r-h);this._w=(i-c)/E,this._x=(n+o)/E,this._y=.25*E,this._z=(u+f)/E}else{const E=2*Math.sqrt(1+h-r-l);this._w=(o-n)/E,this._x=(i+c)/E,this._y=(u+f)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(hr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,i=e._z,o=e._w,l=t._x,u=t._y,c=t._z,f=t._w;return this._x=r*f+o*l+n*c-i*u,this._y=n*f+o*u+i*l-r*c,this._z=i*f+o*c+r*u-n*l,this._w=o*f-r*l-n*u-i*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,i=this._z,o=this._w;let l=o*e._w+r*e._x+n*e._y+i*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;const u=1-l*l;if(u<=Number.EPSILON){const E=1-t;return this._w=E*o+t*this._w,this._x=E*r+t*this._x,this._y=E*n+t*this._y,this._z=E*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(u),f=Math.atan2(c,l),h=Math.sin((1-t)*f)/c,p=Math.sin(t*f)/c;return this._w=o*h+this._w*p,this._x=r*h+this._x*p,this._y=n*h+this._y*p,this._z=i*h+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,r){this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(i),r*Math.cos(i),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}pr.prototype.isQuaternion=!0;class Ie{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Dv.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Dv.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,i=e.elements,o=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,l=e.z,u=e.w,c=u*t+o*n-l*r,f=u*r+l*t-i*n,h=u*n+i*r-o*t,p=-i*t-o*r-l*n;return this.x=c*u+p*-i+f*-l-h*-o,this.y=f*u+p*-o+h*-i-c*-l,this.z=h*u+p*-l+c*-o-f*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,i=e.z,o=t.x,l=t.y,u=t.z;return this.x=n*u-i*l,this.y=i*o-r*u,this.z=r*l-n*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return gh.copy(this).projectOnVector(e),this.sub(gh)}reflect(e){return this.sub(gh.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(hr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Ie.prototype.isVector3=!0;const gh=new Ie,Dv=new pr;class Hr{constructor(e=new Ie(1/0,1/0,1/0),t=new Ie(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,l=-1/0;for(let u=0,c=e.length;u<c;u+=3){const f=e[u],h=e[u+1],p=e[u+2];f<t&&(t=f),h<r&&(r=h),p<n&&(n=p),f>i&&(i=f),h>o&&(o=h),p>l&&(l=p)}return this.min.set(t,r,n),this.max.set(i,o,l),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,l=-1/0;for(let u=0,c=e.count;u<c;u++){const f=e.getX(u),h=e.getY(u),p=e.getZ(u);f<t&&(t=f),h<r&&(r=h),p<n&&(n=p),f>i&&(i=f),h>o&&(o=h),p>l&&(l=p)}return this.min.set(t,r,n),this.max.set(i,o,l),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Cl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),_h.copy(t.boundingBox),_h.applyMatrix4(e.matrixWorld),this.union(_h));const r=e.children;for(let n=0,i=r.length;n<i;n++)this.expandByObject(r[n]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Cl),Cl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(bl),uc.subVectors(this.max,bl),ro.subVectors(e.a,bl),io.subVectors(e.b,bl),ao.subVectors(e.c,bl),_a.subVectors(io,ro),va.subVectors(ao,io),os.subVectors(ro,ao);let t=[0,-_a.z,_a.y,0,-va.z,va.y,0,-os.z,os.y,_a.z,0,-_a.x,va.z,0,-va.x,os.z,0,-os.x,-_a.y,_a.x,0,-va.y,va.x,0,-os.y,os.x,0];return!vh(t,ro,io,ao,uc)||(t=[1,0,0,0,1,0,0,0,1],!vh(t,ro,io,ao,uc))?!1:(cc.crossVectors(_a,va),t=[cc.x,cc.y,cc.z],vh(t,ro,io,ao,uc))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Cl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Cl).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ki[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ki[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ki[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ki[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ki[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ki[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ki[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ki[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ki),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Hr.prototype.isBox3=!0;const Ki=[new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie],Cl=new Ie,_h=new Hr,ro=new Ie,io=new Ie,ao=new Ie,_a=new Ie,va=new Ie,os=new Ie,bl=new Ie,uc=new Ie,cc=new Ie,ls=new Ie;function vh(m,e,t,r,n){for(let i=0,o=m.length-3;i<=o;i+=3){ls.fromArray(m,i);const l=n.x*Math.abs(ls.x)+n.y*Math.abs(ls.y)+n.z*Math.abs(ls.z),u=e.dot(ls),c=t.dot(ls),f=r.dot(ls);if(Math.max(-Math.max(u,c,f),Math.min(u,c,f))>l)return!1}return!0}const ab=new Hr,Pv=new Ie,Eh=new Ie,yh=new Ie;class Ea{constructor(e=new Ie,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):ab.setFromPoints(e).getCenter(r);let n=0;for(let i=0,o=e.length;i<o;i++)n=Math.max(n,r.distanceToSquared(e[i]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){yh.subVectors(e,this.center);const t=yh.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.add(yh.multiplyScalar(n/r)),this.radius+=n}return this}union(e){return Eh.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Pv.copy(e.center).add(Eh)),this.expandByPoint(Pv.copy(e.center).sub(Eh)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Yi=new Ie,Th=new Ie,fc=new Ie,ya=new Ie,Mh=new Ie,dc=new Ie,Sh=new Ie;class Ta{constructor(e=new Ie,t=new Ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Yi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Yi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Yi.copy(this.direction).multiplyScalar(t).add(this.origin),Yi.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){Th.copy(e).add(t).multiplyScalar(.5),fc.copy(t).sub(e).normalize(),ya.copy(this.origin).sub(Th);const i=e.distanceTo(t)*.5,o=-this.direction.dot(fc),l=ya.dot(this.direction),u=-ya.dot(fc),c=ya.lengthSq(),f=Math.abs(1-o*o);let h,p,E,v;if(f>0)if(h=o*u-l,p=o*l-u,v=i*f,h>=0)if(p>=-v)if(p<=v){const M=1/f;h*=M,p*=M,E=h*(h+o*p+2*l)+p*(o*h+p+2*u)+c}else p=i,h=Math.max(0,-(o*p+l)),E=-h*h+p*(p+2*u)+c;else p=-i,h=Math.max(0,-(o*p+l)),E=-h*h+p*(p+2*u)+c;else p<=-v?(h=Math.max(0,-(-o*i+l)),p=h>0?-i:Math.min(Math.max(-i,-u),i),E=-h*h+p*(p+2*u)+c):p<=v?(h=0,p=Math.min(Math.max(-i,-u),i),E=p*(p+2*u)+c):(h=Math.max(0,-(o*i+l)),p=h>0?i:Math.min(Math.max(-i,-u),i),E=-h*h+p*(p+2*u)+c);else p=o>0?-i:i,h=Math.max(0,-(o*p+l)),E=-h*h+p*(p+2*u)+c;return r&&r.copy(this.direction).multiplyScalar(h).add(this.origin),n&&n.copy(fc).multiplyScalar(p).add(Th),E}intersectSphere(e,t){Yi.subVectors(e.center,this.origin);const r=Yi.dot(this.direction),n=Yi.dot(Yi)-r*r,i=e.radius*e.radius;if(n>i)return null;const o=Math.sqrt(i-n),l=r-o,u=r+o;return l<0&&u<0?null:l<0?this.at(u,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,i,o,l,u;const c=1/this.direction.x,f=1/this.direction.y,h=1/this.direction.z,p=this.origin;return c>=0?(r=(e.min.x-p.x)*c,n=(e.max.x-p.x)*c):(r=(e.max.x-p.x)*c,n=(e.min.x-p.x)*c),f>=0?(i=(e.min.y-p.y)*f,o=(e.max.y-p.y)*f):(i=(e.max.y-p.y)*f,o=(e.min.y-p.y)*f),r>o||i>n||((i>r||r!==r)&&(r=i),(o<n||n!==n)&&(n=o),h>=0?(l=(e.min.z-p.z)*h,u=(e.max.z-p.z)*h):(l=(e.max.z-p.z)*h,u=(e.min.z-p.z)*h),r>u||l>n)||((l>r||r!==r)&&(r=l),(u<n||n!==n)&&(n=u),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,Yi)!==null}intersectTriangle(e,t,r,n,i){Mh.subVectors(t,e),dc.subVectors(r,e),Sh.crossVectors(Mh,dc);let o=this.direction.dot(Sh),l;if(o>0){if(n)return null;l=1}else if(o<0)l=-1,o=-o;else return null;ya.subVectors(this.origin,e);const u=l*this.direction.dot(dc.crossVectors(ya,dc));if(u<0)return null;const c=l*this.direction.dot(Mh.cross(ya));if(c<0||u+c>o)return null;const f=-l*ya.dot(Sh);return f<0?null:this.at(f/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class zt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,i,o,l,u,c,f,h,p,E,v,M,y){const _=this.elements;return _[0]=e,_[4]=t,_[8]=r,_[12]=n,_[1]=i,_[5]=o,_[9]=l,_[13]=u,_[2]=c,_[6]=f,_[10]=h,_[14]=p,_[3]=E,_[7]=v,_[11]=M,_[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zt().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/so.setFromMatrixColumn(e,0).length(),i=1/so.setFromMatrixColumn(e,1).length(),o=1/so.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),l=Math.sin(r),u=Math.cos(n),c=Math.sin(n),f=Math.cos(i),h=Math.sin(i);if(e.order==="XYZ"){const p=o*f,E=o*h,v=l*f,M=l*h;t[0]=u*f,t[4]=-u*h,t[8]=c,t[1]=E+v*c,t[5]=p-M*c,t[9]=-l*u,t[2]=M-p*c,t[6]=v+E*c,t[10]=o*u}else if(e.order==="YXZ"){const p=u*f,E=u*h,v=c*f,M=c*h;t[0]=p+M*l,t[4]=v*l-E,t[8]=o*c,t[1]=o*h,t[5]=o*f,t[9]=-l,t[2]=E*l-v,t[6]=M+p*l,t[10]=o*u}else if(e.order==="ZXY"){const p=u*f,E=u*h,v=c*f,M=c*h;t[0]=p-M*l,t[4]=-o*h,t[8]=v+E*l,t[1]=E+v*l,t[5]=o*f,t[9]=M-p*l,t[2]=-o*c,t[6]=l,t[10]=o*u}else if(e.order==="ZYX"){const p=o*f,E=o*h,v=l*f,M=l*h;t[0]=u*f,t[4]=v*c-E,t[8]=p*c+M,t[1]=u*h,t[5]=M*c+p,t[9]=E*c-v,t[2]=-c,t[6]=l*u,t[10]=o*u}else if(e.order==="YZX"){const p=o*u,E=o*c,v=l*u,M=l*c;t[0]=u*f,t[4]=M-p*h,t[8]=v*h+E,t[1]=h,t[5]=o*f,t[9]=-l*f,t[2]=-c*f,t[6]=E*h+v,t[10]=p-M*h}else if(e.order==="XZY"){const p=o*u,E=o*c,v=l*u,M=l*c;t[0]=u*f,t[4]=-h,t[8]=c*f,t[1]=p*h+M,t[5]=o*f,t[9]=E*h-v,t[2]=v*h-E,t[6]=l*f,t[10]=M*h+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(sb,e,ob)}lookAt(e,t,r){const n=this.elements;return Gr.subVectors(e,t),Gr.lengthSq()===0&&(Gr.z=1),Gr.normalize(),Ma.crossVectors(r,Gr),Ma.lengthSq()===0&&(Math.abs(r.z)===1?Gr.x+=1e-4:Gr.z+=1e-4,Gr.normalize(),Ma.crossVectors(r,Gr)),Ma.normalize(),hc.crossVectors(Gr,Ma),n[0]=Ma.x,n[4]=hc.x,n[8]=Gr.x,n[1]=Ma.y,n[5]=hc.y,n[9]=Gr.y,n[2]=Ma.z,n[6]=hc.z,n[10]=Gr.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,i=this.elements,o=r[0],l=r[4],u=r[8],c=r[12],f=r[1],h=r[5],p=r[9],E=r[13],v=r[2],M=r[6],y=r[10],_=r[14],g=r[3],R=r[7],S=r[11],x=r[15],w=n[0],C=n[4],b=n[8],P=n[12],A=n[1],I=n[5],F=n[9],G=n[13],V=n[2],k=n[6],H=n[10],J=n[14],K=n[3],ae=n[7],re=n[11],le=n[15];return i[0]=o*w+l*A+u*V+c*K,i[4]=o*C+l*I+u*k+c*ae,i[8]=o*b+l*F+u*H+c*re,i[12]=o*P+l*G+u*J+c*le,i[1]=f*w+h*A+p*V+E*K,i[5]=f*C+h*I+p*k+E*ae,i[9]=f*b+h*F+p*H+E*re,i[13]=f*P+h*G+p*J+E*le,i[2]=v*w+M*A+y*V+_*K,i[6]=v*C+M*I+y*k+_*ae,i[10]=v*b+M*F+y*H+_*re,i[14]=v*P+M*G+y*J+_*le,i[3]=g*w+R*A+S*V+x*K,i[7]=g*C+R*I+S*k+x*ae,i[11]=g*b+R*F+S*H+x*re,i[15]=g*P+R*G+S*J+x*le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],l=e[5],u=e[9],c=e[13],f=e[2],h=e[6],p=e[10],E=e[14],v=e[3],M=e[7],y=e[11],_=e[15];return v*(+i*u*h-n*c*h-i*l*p+r*c*p+n*l*E-r*u*E)+M*(+t*u*E-t*c*p+i*o*p-n*o*E+n*c*f-i*u*f)+y*(+t*c*h-t*l*E-i*o*h+r*o*E+i*l*f-r*c*f)+_*(-n*l*f-t*u*h+t*l*p+n*o*h-r*o*p+r*u*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],p=e[10],E=e[11],v=e[12],M=e[13],y=e[14],_=e[15],g=h*y*c-M*p*c+M*u*E-l*y*E-h*u*_+l*p*_,R=v*p*c-f*y*c-v*u*E+o*y*E+f*u*_-o*p*_,S=f*M*c-v*h*c+v*l*E-o*M*E-f*l*_+o*h*_,x=v*h*u-f*M*u-v*l*p+o*M*p+f*l*y-o*h*y,w=t*g+r*R+n*S+i*x;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/w;return e[0]=g*C,e[1]=(M*p*i-h*y*i-M*n*E+r*y*E+h*n*_-r*p*_)*C,e[2]=(l*y*i-M*u*i+M*n*c-r*y*c-l*n*_+r*u*_)*C,e[3]=(h*u*i-l*p*i-h*n*c+r*p*c+l*n*E-r*u*E)*C,e[4]=R*C,e[5]=(f*y*i-v*p*i+v*n*E-t*y*E-f*n*_+t*p*_)*C,e[6]=(v*u*i-o*y*i-v*n*c+t*y*c+o*n*_-t*u*_)*C,e[7]=(o*p*i-f*u*i+f*n*c-t*p*c-o*n*E+t*u*E)*C,e[8]=S*C,e[9]=(v*h*i-f*M*i-v*r*E+t*M*E+f*r*_-t*h*_)*C,e[10]=(o*M*i-v*l*i+v*r*c-t*M*c-o*r*_+t*l*_)*C,e[11]=(f*l*i-o*h*i-f*r*c+t*h*c+o*r*E-t*l*E)*C,e[12]=x*C,e[13]=(f*M*n-v*h*n+v*r*p-t*M*p-f*r*y+t*h*y)*C,e[14]=(v*l*n-o*M*n-v*r*u+t*M*u+o*r*y-t*l*y)*C,e[15]=(o*h*n-f*l*n+f*r*u-t*h*u-o*r*p+t*l*p)*C,this}scale(e){const t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,l=e.y,u=e.z,c=i*o,f=i*l;return this.set(c*o+r,c*l-n*u,c*u+n*l,0,c*l+n*u,f*l+r,f*u-n*o,0,c*u-n*l,f*u+n*o,i*u*u+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,o){return this.set(1,r,i,0,e,1,o,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,i=t._x,o=t._y,l=t._z,u=t._w,c=i+i,f=o+o,h=l+l,p=i*c,E=i*f,v=i*h,M=o*f,y=o*h,_=l*h,g=u*c,R=u*f,S=u*h,x=r.x,w=r.y,C=r.z;return n[0]=(1-(M+_))*x,n[1]=(E+S)*x,n[2]=(v-R)*x,n[3]=0,n[4]=(E-S)*w,n[5]=(1-(p+_))*w,n[6]=(y+g)*w,n[7]=0,n[8]=(v+R)*C,n[9]=(y-g)*C,n[10]=(1-(p+M))*C,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let i=so.set(n[0],n[1],n[2]).length();const o=so.set(n[4],n[5],n[6]).length(),l=so.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],li.copy(this);const c=1/i,f=1/o,h=1/l;return li.elements[0]*=c,li.elements[1]*=c,li.elements[2]*=c,li.elements[4]*=f,li.elements[5]*=f,li.elements[6]*=f,li.elements[8]*=h,li.elements[9]*=h,li.elements[10]*=h,t.setFromRotationMatrix(li),r.x=i,r.y=o,r.z=l,this}makePerspective(e,t,r,n,i,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const l=this.elements,u=2*i/(t-e),c=2*i/(r-n),f=(t+e)/(t-e),h=(r+n)/(r-n),p=-(o+i)/(o-i),E=-2*o*i/(o-i);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=c,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=E,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,n,i,o){const l=this.elements,u=1/(t-e),c=1/(r-n),f=1/(o-i),h=(t+e)*u,p=(r+n)*c,E=(o+i)*f;return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=-2*f,l[14]=-E,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}zt.prototype.isMatrix4=!0;const so=new Ie,li=new zt,sb=new Ie(0,0,0),ob=new Ie(1,1,1),Ma=new Ie,hc=new Ie,Gr=new Ie,wv=new zt,Ov=new pr;class us{constructor(e=0,t=0,r=0,n=us.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,i=n[0],o=n[4],l=n[8],u=n[1],c=n[5],f=n[9],h=n[2],p=n[6],E=n[10];switch(t){case"XYZ":this._y=Math.asin(hr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,E),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-hr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,E),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,i),this._z=0);break;case"ZXY":this._x=Math.asin(hr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,E),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,i));break;case"ZYX":this._y=Math.asin(-hr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,E),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(hr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,c),this._y=Math.atan2(-h,i)):(this._x=0,this._y=Math.atan2(l,E));break;case"XZY":this._z=Math.asin(-hr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(l,i)):(this._x=Math.atan2(-f,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return wv.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wv,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ov.setFromEuler(this),this.setFromQuaternion(Ov,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new Ie(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}us.prototype.isEuler=!0;us.DefaultOrder="XYZ";us.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ah{constructor(){this.mask=1|0}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=4294967295|0}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}}let lb=0;const Lv=new Ie,oo=new pr,Xi=new zt,pc=new Ie,Il=new Ie,ub=new Ie,cb=new pr,Nv=new Ie(1,0,0),Fv=new Ie(0,1,0),Bv=new Ie(0,0,1),fb={type:"added"},Uv={type:"removed"};class un extends ga{constructor(){super();Object.defineProperty(this,"id",{value:lb++}),this.uuid=Wr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=un.DefaultUp.clone();const e=new Ie,t=new us,r=new pr,n=new Ie(1,1,1);function i(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(i),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new zt},normalMatrix:{value:new Zn}}),this.matrix=new zt,this.matrixWorld=new zt,this.matrixAutoUpdate=un.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ah,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return oo.setFromAxisAngle(e,t),this.quaternion.multiply(oo),this}rotateOnWorldAxis(e,t){return oo.setFromAxisAngle(e,t),this.quaternion.premultiply(oo),this}rotateX(e){return this.rotateOnAxis(Nv,e)}rotateY(e){return this.rotateOnAxis(Fv,e)}rotateZ(e){return this.rotateOnAxis(Bv,e)}translateOnAxis(e,t){return Lv.copy(e).applyQuaternion(this.quaternion),this.position.add(Lv.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Nv,e)}translateY(e){return this.translateOnAxis(Fv,e)}translateZ(e){return this.translateOnAxis(Bv,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Xi.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?pc.copy(e):pc.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),Il.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xi.lookAt(Il,pc,this.up):Xi.lookAt(pc,Il,this.up),this.quaternion.setFromRotationMatrix(Xi),n&&(Xi.extractRotation(n.matrixWorld),oo.setFromRotationMatrix(Xi),this.quaternion.premultiply(oo.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(fb)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Uv)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Uv)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Xi.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Xi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Il,e,ub),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Il,cb,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function i(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const u=l.shapes;if(Array.isArray(u))for(let c=0,f=u.length;c<f;c++){const h=u[c];i(e.shapes,h)}else i(e.shapes,u)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let u=0,c=this.material.length;u<c;u++)l.push(i(e.materials,this.material[u]));n.material=l}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(let l=0;l<this.children.length;l++)n.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let l=0;l<this.animations.length;l++){const u=this.animations[l];n.animations.push(i(e.animations,u))}}if(t){const l=o(e.geometries),u=o(e.materials),c=o(e.textures),f=o(e.images),h=o(e.shapes),p=o(e.skeletons),E=o(e.animations);l.length>0&&(r.geometries=l),u.length>0&&(r.materials=u),c.length>0&&(r.textures=c),f.length>0&&(r.images=f),h.length>0&&(r.shapes=h),p.length>0&&(r.skeletons=p),E.length>0&&(r.animations=E)}return r.object=n,r;function o(l){const u=[];for(const c in l){const f=l[c];delete f.metadata,u.push(f)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}un.DefaultUp=new Ie(0,1,0);un.DefaultMatrixAutoUpdate=!0;un.prototype.isObject3D=!0;const ui=new Ie,Qi=new Ie,xh=new Ie,Ji=new Ie,lo=new Ie,uo=new Ie,Wv=new Ie,Rh=new Ie,Ch=new Ie,bh=new Ie;class Gn{constructor(e=new Ie,t=new Ie,r=new Ie){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),ui.subVectors(e,t),n.cross(ui);const i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){ui.subVectors(n,t),Qi.subVectors(r,t),xh.subVectors(e,t);const o=ui.dot(ui),l=ui.dot(Qi),u=ui.dot(xh),c=Qi.dot(Qi),f=Qi.dot(xh),h=o*c-l*l;if(h===0)return i.set(-2,-1,-1);const p=1/h,E=(c*u-l*f)*p,v=(o*f-l*u)*p;return i.set(1-E-v,v,E)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,Ji),Ji.x>=0&&Ji.y>=0&&Ji.x+Ji.y<=1}static getUV(e,t,r,n,i,o,l,u){return this.getBarycoord(e,t,r,n,Ji),u.set(0,0),u.addScaledVector(i,Ji.x),u.addScaledVector(o,Ji.y),u.addScaledVector(l,Ji.z),u}static isFrontFacing(e,t,r,n){return ui.subVectors(r,t),Qi.subVectors(e,t),ui.cross(Qi).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ui.subVectors(this.c,this.b),Qi.subVectors(this.a,this.b),ui.cross(Qi).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,i){return Gn.getUV(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return Gn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,n=this.b,i=this.c;let o,l;lo.subVectors(n,r),uo.subVectors(i,r),Rh.subVectors(e,r);const u=lo.dot(Rh),c=uo.dot(Rh);if(u<=0&&c<=0)return t.copy(r);Ch.subVectors(e,n);const f=lo.dot(Ch),h=uo.dot(Ch);if(f>=0&&h<=f)return t.copy(n);const p=u*h-f*c;if(p<=0&&u>=0&&f<=0)return o=u/(u-f),t.copy(r).addScaledVector(lo,o);bh.subVectors(e,i);const E=lo.dot(bh),v=uo.dot(bh);if(v>=0&&E<=v)return t.copy(i);const M=E*c-u*v;if(M<=0&&c>=0&&v<=0)return l=c/(c-v),t.copy(r).addScaledVector(uo,l);const y=f*v-E*h;if(y<=0&&h-f>=0&&E-v>=0)return Wv.subVectors(i,n),l=(h-f)/(h-f+(E-v)),t.copy(n).addScaledVector(Wv,l);const _=1/(y+M+p);return o=M*_,l=p*_,t.copy(r).addScaledVector(lo,o).addScaledVector(uo,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let db=0;class er extends ga{constructor(){super();Object.defineProperty(this,"id",{value:db++}),this.uuid=Wr(),this.name="",this.type="Material",this.fog=!0,this.blending=Qs,this.side=Ya,this.vertexColors=!1,this.opacity=1,this.format=cr,this.transparent=!1,this.blendSrc=Xd,this.blendDst=Qd,this.blendEquation=Qa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=qu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Sv,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sc,this.stencilZFail=sc,this.stencilZPass=sc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===jd;continue}const n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Qs&&(r.blending=this.blending),this.side!==Ya&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.format!==cr&&(r.format=this.format),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(i){const o=[];for(const l in i){const u=i[l];delete u.metadata,o.push(u)}return o}if(t){const i=n(e.textures),o=n(e.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const n=t.length;r=new Array(n);for(let i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}er.prototype.isMaterial=!0;const Hv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ci={h:0,s:0,l:0},mc={h:0,s:0,l:0};function Ih(m,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?m+(e-m)*6*t:t<1/2?e:t<2/3?m+(e-m)*6*(2/3-t):m}function Dh(m){return m<.04045?m*.0773993808:Math.pow(m*.9478672986+.0521327014,2.4)}function Ph(m){return m<.0031308?m*12.92:1.055*Math.pow(m,.41666)-.055}class Ft{constructor(e,t,r){return t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,t,r){return this.r=e,this.g=t,this.b=r,this}setHSL(e,t,r){if(e=dh(e,1),t=hr(t,0,1),r=hr(r,0,1),t===0)this.r=this.g=this.b=r;else{const n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=Ih(i,n,e+1/3),this.g=Ih(i,n,e),this.b=Ih(i,n,e-1/3)}return this}setStyle(e){function t(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n;const i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const l=parseFloat(n[1])/360,u=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return t(n[4]),this.setHSL(l,u,c)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(i===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(i===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Hv[e.toLowerCase()];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){const r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Dh(e.r),this.g=Dh(e.g),this.b=Dh(e.b),this}copyLinearToSRGB(e){return this.r=Ph(e.r),this.g=Ph(e.g),this.b=Ph(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,r=this.g,n=this.b,i=Math.max(t,r,n),o=Math.min(t,r,n);let l,u;const c=(o+i)/2;if(o===i)l=0,u=0;else{const f=i-o;switch(u=c<=.5?f/(i+o):f/(2-i-o),i){case t:l=(r-n)/f+(r<n?6:0);break;case r:l=(n-t)/f+2;break;case n:l=(t-r)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,t,r){return this.getHSL(ci),ci.h+=e,ci.s+=t,ci.l+=r,this.setHSL(ci.h,ci.s,ci.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ci),e.getHSL(mc);const r=Rl(ci.h,mc.h,t),n=Rl(ci.s,mc.s,t),i=Rl(ci.l,mc.l,t);return this.setHSL(r,n,i),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Ft.NAMES=Hv;Ft.prototype.isColor=!0;Ft.prototype.r=1;Ft.prototype.g=1;Ft.prototype.b=1;class Zi extends er{constructor(e){super();this.type="MeshBasicMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Zi.prototype.isMeshBasicMaterial=!0;const Dn=new Ie,gc=new Et;class hn{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=$s,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let r=0;for(let n=0,i=e.length;n<i;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new Ft),t[r++]=o.r,t[r++]=o.g,t[r++]=o.b}return this}copyVector2sArray(e){const t=this.array;let r=0;for(let n=0,i=e.length;n<i;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new Et),t[r++]=o.x,t[r++]=o.y}return this}copyVector3sArray(e){const t=this.array;let r=0;for(let n=0,i=e.length;n<i;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Ie),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z}return this}copyVector4sArray(e){const t=this.array;let r=0;for(let n=0,i=e.length;n<i;n++){let o=e[n];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new Mn),t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=o.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)gc.fromBufferAttribute(this,t),gc.applyMatrix3(e),this.setXY(t,gc.x,gc.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Dn.fromBufferAttribute(this,t),Dn.applyMatrix3(e),this.setXYZ(t,Dn.x,Dn.y,Dn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Dn.x=this.getX(t),Dn.y=this.getY(t),Dn.z=this.getZ(t),Dn.applyMatrix4(e),this.setXYZ(t,Dn.x,Dn.y,Dn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Dn.x=this.getX(t),Dn.y=this.getY(t),Dn.z=this.getZ(t),Dn.applyNormalMatrix(e),this.setXYZ(t,Dn.x,Dn.y,Dn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Dn.x=this.getX(t),Dn.y=this.getY(t),Dn.z=this.getZ(t),Dn.transformDirection(e),this.setXYZ(t,Dn.x,Dn.y,Dn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==$s&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}hn.prototype.isBufferAttribute=!0;class Gv extends hn{constructor(e,t,r){super(new Int8Array(e),t,r)}}class jv extends hn{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class Vv extends hn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class zv extends hn{constructor(e,t,r){super(new Int16Array(e),t,r)}}class _c extends hn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class kv extends hn{constructor(e,t,r){super(new Int32Array(e),t,r)}}class vc extends hn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Kv extends hn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}Kv.prototype.isFloat16BufferAttribute=!0;class jt extends hn{constructor(e,t,r){super(new Float32Array(e),t,r)}}class Yv extends hn{constructor(e,t,r){super(new Float64Array(e),t,r)}}let hb=0;const $r=new zt,wh=new un,co=new Ie,jr=new Hr,Dl=new Hr,tr=new Ie;class Jt extends ga{constructor(){super();Object.defineProperty(this,"id",{value:hb++}),this.uuid=Wr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Cv(e)>65535?vc:_c)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const i=new Zn().getNormalMatrix(e);r.applyNormalMatrix(i),r.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return $r.makeRotationFromQuaternion(e),this.applyMatrix4($r),this}rotateX(e){return $r.makeRotationX(e),this.applyMatrix4($r),this}rotateY(e){return $r.makeRotationY(e),this.applyMatrix4($r),this}rotateZ(e){return $r.makeRotationZ(e),this.applyMatrix4($r),this}translate(e,t,r){return $r.makeTranslation(e,t,r),this.applyMatrix4($r),this}scale(e,t,r){return $r.makeScale(e,t,r),this.applyMatrix4($r),this}lookAt(e){return wh.lookAt(e),wh.updateMatrix(),this.applyMatrix4(wh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(co).negate(),this.translate(co.x,co.y,co.z),this}setFromPoints(e){const t=[];for(let r=0,n=e.length;r<n;r++){const i=e[r];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new jt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ie(-1/0,-1/0,-1/0),new Ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){const i=t[r];jr.setFromBufferAttribute(i),this.morphTargetsRelative?(tr.addVectors(this.boundingBox.min,jr.min),this.boundingBox.expandByPoint(tr),tr.addVectors(this.boundingBox.max,jr.max),this.boundingBox.expandByPoint(tr)):(this.boundingBox.expandByPoint(jr.min),this.boundingBox.expandByPoint(jr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ea);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ie,1/0);return}if(e){const r=this.boundingSphere.center;if(jr.setFromBufferAttribute(e),t)for(let i=0,o=t.length;i<o;i++){const l=t[i];Dl.setFromBufferAttribute(l),this.morphTargetsRelative?(tr.addVectors(jr.min,Dl.min),jr.expandByPoint(tr),tr.addVectors(jr.max,Dl.max),jr.expandByPoint(tr)):(jr.expandByPoint(Dl.min),jr.expandByPoint(Dl.max))}jr.getCenter(r);let n=0;for(let i=0,o=e.count;i<o;i++)tr.fromBufferAttribute(e,i),n=Math.max(n,r.distanceToSquared(tr));if(t)for(let i=0,o=t.length;i<o;i++){const l=t[i],u=this.morphTargetsRelative;for(let c=0,f=l.count;c<f;c++)tr.fromBufferAttribute(l,c),u&&(co.fromBufferAttribute(e,c),tr.add(co)),n=Math.max(n,r.distanceToSquared(tr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,n=t.position.array,i=t.normal.array,o=t.uv.array,l=n.length/3;t.tangent===void 0&&this.setAttribute("tangent",new hn(new Float32Array(4*l),4));const u=t.tangent.array,c=[],f=[];for(let A=0;A<l;A++)c[A]=new Ie,f[A]=new Ie;const h=new Ie,p=new Ie,E=new Ie,v=new Et,M=new Et,y=new Et,_=new Ie,g=new Ie;function R(A,I,F){h.fromArray(n,A*3),p.fromArray(n,I*3),E.fromArray(n,F*3),v.fromArray(o,A*2),M.fromArray(o,I*2),y.fromArray(o,F*2),p.sub(h),E.sub(h),M.sub(v),y.sub(v);const G=1/(M.x*y.y-y.x*M.y);!isFinite(G)||(_.copy(p).multiplyScalar(y.y).addScaledVector(E,-M.y).multiplyScalar(G),g.copy(E).multiplyScalar(M.x).addScaledVector(p,-y.x).multiplyScalar(G),c[A].add(_),c[I].add(_),c[F].add(_),f[A].add(g),f[I].add(g),f[F].add(g))}let S=this.groups;S.length===0&&(S=[{start:0,count:r.length}]);for(let A=0,I=S.length;A<I;++A){const F=S[A],G=F.start,V=F.count;for(let k=G,H=G+V;k<H;k+=3)R(r[k+0],r[k+1],r[k+2])}const x=new Ie,w=new Ie,C=new Ie,b=new Ie;function P(A){C.fromArray(i,A*3),b.copy(C);const I=c[A];x.copy(I),x.sub(C.multiplyScalar(C.dot(I))).normalize(),w.crossVectors(b,I);const G=w.dot(f[A])<0?-1:1;u[A*4]=x.x,u[A*4+1]=x.y,u[A*4+2]=x.z,u[A*4+3]=G}for(let A=0,I=S.length;A<I;++A){const F=S[A],G=F.start,V=F.count;for(let k=G,H=G+V;k<H;k+=3)P(r[k+0]),P(r[k+1]),P(r[k+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new hn(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let p=0,E=r.count;p<E;p++)r.setXYZ(p,0,0,0);const n=new Ie,i=new Ie,o=new Ie,l=new Ie,u=new Ie,c=new Ie,f=new Ie,h=new Ie;if(e)for(let p=0,E=e.count;p<E;p+=3){const v=e.getX(p+0),M=e.getX(p+1),y=e.getX(p+2);n.fromBufferAttribute(t,v),i.fromBufferAttribute(t,M),o.fromBufferAttribute(t,y),f.subVectors(o,i),h.subVectors(n,i),f.cross(h),l.fromBufferAttribute(r,v),u.fromBufferAttribute(r,M),c.fromBufferAttribute(r,y),l.add(f),u.add(f),c.add(f),r.setXYZ(v,l.x,l.y,l.z),r.setXYZ(M,u.x,u.y,u.z),r.setXYZ(y,c.x,c.y,c.z)}else for(let p=0,E=t.count;p<E;p+=3)n.fromBufferAttribute(t,p+0),i.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),f.subVectors(o,i),h.subVectors(n,i),f.cross(h),r.setXYZ(p+0,f.x,f.y,f.z),r.setXYZ(p+1,f.x,f.y,f.z),r.setXYZ(p+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const n in r){if(e.attributes[n]===void 0)continue;const o=r[n].array,l=e.attributes[n],u=l.array,c=l.itemSize*t,f=Math.min(u.length,o.length-c);for(let h=0,p=c;h<f;h++,p++)o[p]=u[h]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)tr.fromBufferAttribute(e,t),tr.normalize(),e.setXYZ(t,tr.x,tr.y,tr.z)}toNonIndexed(){function e(l,u){const c=l.array,f=l.itemSize,h=l.normalized,p=new c.constructor(u.length*f);let E=0,v=0;for(let M=0,y=u.length;M<y;M++){l.isInterleavedBufferAttribute?E=u[M]*l.data.stride+l.offset:E=u[M]*f;for(let _=0;_<f;_++)p[v++]=c[E++]}return new hn(p,f,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Jt,r=this.index.array,n=this.attributes;for(const l in n){const u=n[l],c=e(u,r);t.setAttribute(l,c)}const i=this.morphAttributes;for(const l in i){const u=[],c=i[l];for(let f=0,h=c.length;f<h;f++){const p=c[f],E=e(p,r);u.push(E)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,u=o.length;l<u;l++){const c=o[l];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const c in u)u[c]!==void 0&&(e[c]=u[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const u in r){const c=r[u];e.data.attributes[u]=c.toJSON(e.data)}const n={};let i=!1;for(const u in this.morphAttributes){const c=this.morphAttributes[u],f=[];for(let h=0,p=c.length;h<p;h++){const E=c[h];f.push(E.toJSON(e.data))}f.length>0&&(n[u]=f,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const n=e.attributes;for(const c in n){const f=n[c];this.setAttribute(c,f.clone(t))}const i=e.morphAttributes;for(const c in i){const f=[],h=i[c];for(let p=0,E=h.length;p<E;p++)f.push(h[p].clone(t));this.morphAttributes[c]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,f=o.length;c<f;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Jt.prototype.isBufferGeometry=!0;const Xv=new zt,fo=new Ta,Oh=new Ea,Sa=new Ie,Aa=new Ie,xa=new Ie,Lh=new Ie,Nh=new Ie,Fh=new Ie,Ec=new Ie,yc=new Ie,Tc=new Ie,Mc=new Et,Sc=new Et,Ac=new Et,Bh=new Ie,xc=new Ie;class Kn extends un{constructor(e=new Jt,t=new Zi){super();this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=n.length;i<o;i++){const l=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const r=this.geometry,n=this.material,i=this.matrixWorld;if(n===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),Oh.copy(r.boundingSphere),Oh.applyMatrix4(i),e.ray.intersectsSphere(Oh)===!1)||(Xv.copy(i).invert(),fo.copy(e.ray).applyMatrix4(Xv),r.boundingBox!==null&&fo.intersectsBox(r.boundingBox)===!1))return;let o;if(r.isBufferGeometry){const l=r.index,u=r.attributes.position,c=r.morphAttributes.position,f=r.morphTargetsRelative,h=r.attributes.uv,p=r.attributes.uv2,E=r.groups,v=r.drawRange;if(l!==null)if(Array.isArray(n))for(let M=0,y=E.length;M<y;M++){const _=E[M],g=n[_.materialIndex],R=Math.max(_.start,v.start),S=Math.min(l.count,Math.min(_.start+_.count,v.start+v.count));for(let x=R,w=S;x<w;x+=3){const C=l.getX(x),b=l.getX(x+1),P=l.getX(x+2);o=Rc(this,g,e,fo,u,c,f,h,p,C,b,P),o&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=_.materialIndex,t.push(o))}}else{const M=Math.max(0,v.start),y=Math.min(l.count,v.start+v.count);for(let _=M,g=y;_<g;_+=3){const R=l.getX(_),S=l.getX(_+1),x=l.getX(_+2);o=Rc(this,n,e,fo,u,c,f,h,p,R,S,x),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}}else if(u!==void 0)if(Array.isArray(n))for(let M=0,y=E.length;M<y;M++){const _=E[M],g=n[_.materialIndex],R=Math.max(_.start,v.start),S=Math.min(u.count,Math.min(_.start+_.count,v.start+v.count));for(let x=R,w=S;x<w;x+=3){const C=x,b=x+1,P=x+2;o=Rc(this,g,e,fo,u,c,f,h,p,C,b,P),o&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=_.materialIndex,t.push(o))}}else{const M=Math.max(0,v.start),y=Math.min(u.count,v.start+v.count);for(let _=M,g=y;_<g;_+=3){const R=_,S=_+1,x=_+2;o=Rc(this,n,e,fo,u,c,f,h,p,R,S,x),o&&(o.faceIndex=Math.floor(_/3),t.push(o))}}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}Kn.prototype.isMesh=!0;function pb(m,e,t,r,n,i,o,l){let u;if(e.side===Hn?u=r.intersectTriangle(o,i,n,!0,l):u=r.intersectTriangle(n,i,o,e.side!==Xa,l),u===null)return null;xc.copy(l),xc.applyMatrix4(m.matrixWorld);const c=t.ray.origin.distanceTo(xc);return c<t.near||c>t.far?null:{distance:c,point:xc.clone(),object:m}}function Rc(m,e,t,r,n,i,o,l,u,c,f,h){Sa.fromBufferAttribute(n,c),Aa.fromBufferAttribute(n,f),xa.fromBufferAttribute(n,h);const p=m.morphTargetInfluences;if(i&&p){Ec.set(0,0,0),yc.set(0,0,0),Tc.set(0,0,0);for(let v=0,M=i.length;v<M;v++){const y=p[v],_=i[v];y!==0&&(Lh.fromBufferAttribute(_,c),Nh.fromBufferAttribute(_,f),Fh.fromBufferAttribute(_,h),o?(Ec.addScaledVector(Lh,y),yc.addScaledVector(Nh,y),Tc.addScaledVector(Fh,y)):(Ec.addScaledVector(Lh.sub(Sa),y),yc.addScaledVector(Nh.sub(Aa),y),Tc.addScaledVector(Fh.sub(xa),y)))}Sa.add(Ec),Aa.add(yc),xa.add(Tc)}m.isSkinnedMesh&&(m.boneTransform(c,Sa),m.boneTransform(f,Aa),m.boneTransform(h,xa));const E=pb(m,e,t,r,Sa,Aa,xa,Bh);if(E){l&&(Mc.fromBufferAttribute(l,c),Sc.fromBufferAttribute(l,f),Ac.fromBufferAttribute(l,h),E.uv=Gn.getUV(Bh,Sa,Aa,xa,Mc,Sc,Ac,new Et)),u&&(Mc.fromBufferAttribute(u,c),Sc.fromBufferAttribute(u,f),Ac.fromBufferAttribute(u,h),E.uv2=Gn.getUV(Bh,Sa,Aa,xa,Mc,Sc,Ac,new Et));const v={a:c,b:f,c:h,normal:new Ie,materialIndex:0};Gn.getNormal(Sa,Aa,xa,v.normal),E.face=v}return E}class qi extends Jt{constructor(e=1,t=1,r=1,n=1,i=1,o=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};const l=this;n=Math.floor(n),i=Math.floor(i),o=Math.floor(o);const u=[],c=[],f=[],h=[];let p=0,E=0;v("z","y","x",-1,-1,r,t,e,o,i,0),v("z","y","x",1,-1,r,t,-e,o,i,1),v("x","z","y",1,1,e,r,t,n,o,2),v("x","z","y",1,-1,e,r,-t,n,o,3),v("x","y","z",1,-1,e,t,r,n,i,4),v("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(u),this.setAttribute("position",new jt(c,3)),this.setAttribute("normal",new jt(f,3)),this.setAttribute("uv",new jt(h,2));function v(M,y,_,g,R,S,x,w,C,b,P){const A=S/C,I=x/b,F=S/2,G=x/2,V=w/2,k=C+1,H=b+1;let J=0,K=0;const ae=new Ie;for(let re=0;re<H;re++){const le=re*I-G;for(let me=0;me<k;me++){const de=me*A-F;ae[M]=de*g,ae[y]=le*R,ae[_]=V,c.push(ae.x,ae.y,ae.z),ae[M]=0,ae[y]=0,ae[_]=w>0?1:-1,f.push(ae.x,ae.y,ae.z),h.push(me/C),h.push(1-re/b),J+=1}}for(let re=0;re<b;re++)for(let le=0;le<C;le++){const me=p+le+k*re,de=p+le+k*(re+1),te=p+(le+1)+k*(re+1),q=p+(le+1)+k*re;u.push(me,de,q),u.push(de,te,q),K+=6}l.addGroup(E,K,P),E+=K,p+=J}}static fromJSON(e){return new qi(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ho(m){const e={};for(const t in m){e[t]={};for(const r in m[t]){const n=m[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function Er(m){const e={};for(let t=0;t<m.length;t++){const r=ho(m[t]);for(const n in r)e[n]=r[n]}return e}const Qv={clone:ho,merge:Er};var mb=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,gb=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class $i extends er{constructor(e){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=mb,this.fragmentShader=gb,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ho(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const o=this.uniforms[n].value;o&&o.isTexture?t.uniforms[n]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[n]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[n]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[n]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[n]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[n]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[n]={type:"m4",value:o.toArray()}:t.uniforms[n]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}$i.prototype.isShaderMaterial=!0;class Pl extends un{constructor(){super();this.type="Camera",this.matrixWorldInverse=new zt,this.projectionMatrix=new zt,this.projectionMatrixInverse=new zt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Pl.prototype.isCamera=!0;class nr extends Pl{constructor(e=50,t=1,r=.1,n=2e3){super();this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=xl*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(as*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return xl*2*Math.atan(Math.tan(as*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(as*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,c=o.fullHeight;i+=o.offsetX*n/u,t-=o.offsetY*r/c,n*=o.width/u,r*=o.height/c}const l=this.filmOffset;l!==0&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}nr.prototype.isPerspectiveCamera=!0;const po=90,mo=1;class Cc extends un{constructor(e,t,r){super();if(this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;const n=new nr(po,mo,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Ie(1,0,0)),this.add(n);const i=new nr(po,mo,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Ie(-1,0,0)),this.add(i);const o=new nr(po,mo,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Ie(0,1,0)),this.add(o);const l=new nr(po,mo,e,t);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(new Ie(0,-1,0)),this.add(l);const u=new nr(po,mo,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Ie(0,0,1)),this.add(u);const c=new nr(po,mo,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Ie(0,0,-1)),this.add(c)}update(e,t){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[n,i,o,l,u,c]=this.children,f=e.xr.enabled,h=e.getRenderTarget();e.xr.enabled=!1;const p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,l),e.setRenderTarget(r,4),e.render(t,u),r.texture.generateMipmaps=p,e.setRenderTarget(r,5),e.render(t,c),e.setRenderTarget(h),e.xr.enabled=f}}class go extends qn{constructor(e,t,r,n,i,o,l,u,c,f){e=e!==void 0?e:[],t=t!==void 0?t:Ja;super(e,t,r,n,i,o,l,u,c,f);this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}go.prototype.isCubeTexture=!0;class bc extends oi{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r);super(e,e,t);t=t||{},this.texture=new go(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Jn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=cr,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new qi(5,5,5),i=new $i({name:"CubemapFromEquirect",uniforms:ho(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Hn,blending:zi});i.uniforms.tEquirect.value=t;const o=new Kn(n,i),l=t.minFilter;return t.minFilter===qa&&(t.minFilter=Jn),new Cc(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,n){const i=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,n);e.setRenderTarget(i)}}bc.prototype.isWebGLCubeRenderTarget=!0;const Uh=new Ie,_b=new Ie,vb=new Zn;class Ti{constructor(e=new Ie(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const n=Uh.subVectors(r,t).cross(_b.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(Uh),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(r).multiplyScalar(i).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||vb.getNormalMatrix(e),n=this.coplanarPoint(Uh).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}Ti.prototype.isPlane=!0;const _o=new Ea,Ic=new Ie;class wl{constructor(e=new Ti,t=new Ti,r=new Ti,n=new Ti,i=new Ti,o=new Ti){this.planes=[e,t,r,n,i,o]}set(e,t,r,n,i,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(r),l[3].copy(n),l[4].copy(i),l[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,n=r[0],i=r[1],o=r[2],l=r[3],u=r[4],c=r[5],f=r[6],h=r[7],p=r[8],E=r[9],v=r[10],M=r[11],y=r[12],_=r[13],g=r[14],R=r[15];return t[0].setComponents(l-n,h-u,M-p,R-y).normalize(),t[1].setComponents(l+n,h+u,M+p,R+y).normalize(),t[2].setComponents(l+i,h+c,M+E,R+_).normalize(),t[3].setComponents(l-i,h-c,M-E,R-_).normalize(),t[4].setComponents(l-o,h-f,M-v,R-g).normalize(),t[5].setComponents(l+o,h+f,M+v,R+g).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),_o.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_o)}intersectsSprite(e){return _o.center.set(0,0,0),_o.radius=.7071067811865476,_o.applyMatrix4(e.matrixWorld),this.intersectsSphere(_o)}intersectsSphere(e){const t=this.planes,r=e.center,n=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const n=t[r];if(Ic.x=n.normal.x>0?e.max.x:e.min.x,Ic.y=n.normal.y>0?e.max.y:e.min.y,Ic.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Ic)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Jv(){let m=null,e=!1,t=null,r=null;function n(i,o){t(i,o),r=m.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(r=m.requestAnimationFrame(n),e=!0)},stop:function(){m.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){m=i}}}function Eb(m,e){const t=e.isWebGL2,r=new WeakMap;function n(c,f){const h=c.array,p=c.usage,E=m.createBuffer();m.bindBuffer(f,E),m.bufferData(f,h,p),c.onUploadCallback();let v=5126;return h instanceof Float32Array?v=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?c.isFloat16BufferAttribute?t?v=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):v=5123:h instanceof Int16Array?v=5122:h instanceof Uint32Array?v=5125:h instanceof Int32Array?v=5124:h instanceof Int8Array?v=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(v=5121),{buffer:E,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function i(c,f,h){const p=f.array,E=f.updateRange;m.bindBuffer(h,c),E.count===-1?m.bufferSubData(h,0,p):(t?m.bufferSubData(h,E.offset*p.BYTES_PER_ELEMENT,p,E.offset,E.count):m.bufferSubData(h,E.offset*p.BYTES_PER_ELEMENT,p.subarray(E.offset,E.offset+E.count)),E.count=-1)}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function l(c){c.isInterleavedBufferAttribute&&(c=c.data);const f=r.get(c);f&&(m.deleteBuffer(f.buffer),r.delete(c))}function u(c,f){if(c.isGLBufferAttribute){const p=r.get(c);(!p||p.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=r.get(c);h===void 0?r.set(c,n(c,f)):h.version<c.version&&(i(h.buffer,c,f),h.version=c.version)}return{get:o,remove:l,update:u}}class cs extends Jt{constructor(e=1,t=1,r=1,n=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};const i=e/2,o=t/2,l=Math.floor(r),u=Math.floor(n),c=l+1,f=u+1,h=e/l,p=t/u,E=[],v=[],M=[],y=[];for(let _=0;_<f;_++){const g=_*p-o;for(let R=0;R<c;R++){const S=R*h-i;v.push(S,-g,0),M.push(0,0,1),y.push(R/l),y.push(1-_/u)}}for(let _=0;_<u;_++)for(let g=0;g<l;g++){const R=g+c*_,S=g+c*(_+1),x=g+1+c*(_+1),w=g+1+c*_;E.push(R,S,w),E.push(S,x,w)}this.setIndex(E),this.setAttribute("position",new jt(v,3)),this.setAttribute("normal",new jt(M,3)),this.setAttribute("uv",new jt(y,2))}static fromJSON(e){return new cs(e.width,e.height,e.widthSegments,e.heightSegments)}}var yb=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Tb=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Mb=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Sb=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ab=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xb=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Rb="vec3 transformed = vec3( position );",Cb=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bb=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Ib=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Db=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Pb=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wb=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Ob=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Lb=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Nb=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Fb=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Bb=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Ub=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Wb=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Hb=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Gb=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,jb=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Vb=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,zb=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,kb="gl_FragColor = linearToOutputTexel( gl_FragColor );",Kb=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,Yb=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Xb=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Qb=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Jb=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Zb=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,qb=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$b=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,eI=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,tI=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,nI=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,rI=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,iI=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,aI=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,sI=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,oI=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,lI=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,uI=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,cI=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,fI=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,dI=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,hI=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,pI=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,mI=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,gI=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,_I=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,vI=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,EI=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,yI=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,TI=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,MI=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,SI=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,AI=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,xI=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,RI=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,CI=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,bI=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,II=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,DI=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,PI=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,wI=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,OI=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,LI=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,NI=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,FI=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,BI=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,UI=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,WI=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,HI=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,GI=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,jI=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,VI=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,zI=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,kI=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,KI=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,YI=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,XI=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,QI=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,JI=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ZI=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,qI=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,$I=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,eD=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,tD=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,nD=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,rD=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,iD=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,aD=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,sD=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,oD=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,lD=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uD=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,cD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,fD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,dD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,hD=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const pD=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,mD=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,gD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_D=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vD=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ED=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,yD=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,TD=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,MD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,SD=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,AD=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xD=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,RD=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,CD=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bD=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ID=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,DD=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,PD=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wD=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,OD=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,LD=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ND=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FD=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,BD=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UD=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WD=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HD=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,GD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jD=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VD=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,zD=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,kD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,on={alphamap_fragment:yb,alphamap_pars_fragment:Tb,alphatest_fragment:Mb,alphatest_pars_fragment:Sb,aomap_fragment:Ab,aomap_pars_fragment:xb,begin_vertex:Rb,beginnormal_vertex:Cb,bsdfs:bb,bumpmap_pars_fragment:Ib,clipping_planes_fragment:Db,clipping_planes_pars_fragment:Pb,clipping_planes_pars_vertex:wb,clipping_planes_vertex:Ob,color_fragment:Lb,color_pars_fragment:Nb,color_pars_vertex:Fb,color_vertex:Bb,common:Ub,cube_uv_reflection_fragment:Wb,defaultnormal_vertex:Hb,displacementmap_pars_vertex:Gb,displacementmap_vertex:jb,emissivemap_fragment:Vb,emissivemap_pars_fragment:zb,encodings_fragment:kb,encodings_pars_fragment:Kb,envmap_fragment:Yb,envmap_common_pars_fragment:Xb,envmap_pars_fragment:Qb,envmap_pars_vertex:Jb,envmap_physical_pars_fragment:oI,envmap_vertex:Zb,fog_vertex:qb,fog_pars_vertex:$b,fog_fragment:eI,fog_pars_fragment:tI,gradientmap_pars_fragment:nI,lightmap_fragment:rI,lightmap_pars_fragment:iI,lights_lambert_vertex:aI,lights_pars_begin:sI,lights_toon_fragment:lI,lights_toon_pars_fragment:uI,lights_phong_fragment:cI,lights_phong_pars_fragment:fI,lights_physical_fragment:dI,lights_physical_pars_fragment:hI,lights_fragment_begin:pI,lights_fragment_maps:mI,lights_fragment_end:gI,logdepthbuf_fragment:_I,logdepthbuf_pars_fragment:vI,logdepthbuf_pars_vertex:EI,logdepthbuf_vertex:yI,map_fragment:TI,map_pars_fragment:MI,map_particle_fragment:SI,map_particle_pars_fragment:AI,metalnessmap_fragment:xI,metalnessmap_pars_fragment:RI,morphnormal_vertex:CI,morphtarget_pars_vertex:bI,morphtarget_vertex:II,normal_fragment_begin:DI,normal_fragment_maps:PI,normal_pars_fragment:wI,normal_pars_vertex:OI,normal_vertex:LI,normalmap_pars_fragment:NI,clearcoat_normal_fragment_begin:FI,clearcoat_normal_fragment_maps:BI,clearcoat_pars_fragment:UI,output_fragment:WI,packing:HI,premultiplied_alpha_fragment:GI,project_vertex:jI,dithering_fragment:VI,dithering_pars_fragment:zI,roughnessmap_fragment:kI,roughnessmap_pars_fragment:KI,shadowmap_pars_fragment:YI,shadowmap_pars_vertex:XI,shadowmap_vertex:QI,shadowmask_pars_fragment:JI,skinbase_vertex:ZI,skinning_pars_vertex:qI,skinning_vertex:$I,skinnormal_vertex:eD,specularmap_fragment:tD,specularmap_pars_fragment:nD,tonemapping_fragment:rD,tonemapping_pars_fragment:iD,transmission_fragment:aD,transmission_pars_fragment:sD,uv_pars_fragment:oD,uv_pars_vertex:lD,uv_vertex:uD,uv2_pars_fragment:cD,uv2_pars_vertex:fD,uv2_vertex:dD,worldpos_vertex:hD,background_vert:pD,background_frag:mD,cube_vert:gD,cube_frag:_D,depth_vert:vD,depth_frag:ED,distanceRGBA_vert:yD,distanceRGBA_frag:TD,equirect_vert:MD,equirect_frag:SD,linedashed_vert:AD,linedashed_frag:xD,meshbasic_vert:RD,meshbasic_frag:CD,meshlambert_vert:bD,meshlambert_frag:ID,meshmatcap_vert:DD,meshmatcap_frag:PD,meshnormal_vert:wD,meshnormal_frag:OD,meshphong_vert:LD,meshphong_frag:ND,meshphysical_vert:FD,meshphysical_frag:BD,meshtoon_vert:UD,meshtoon_frag:WD,points_vert:HD,points_frag:GD,shadow_vert:jD,shadow_frag:VD,sprite_vert:zD,sprite_frag:kD},Ot={common:{diffuse:{value:new Ft(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Zn},uv2Transform:{value:new Zn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Et(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zn}},sprite:{diffuse:{value:new Ft(16777215)},opacity:{value:1},center:{value:new Et(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Zn}}},fi={basic:{uniforms:Er([Ot.common,Ot.specularmap,Ot.envmap,Ot.aomap,Ot.lightmap,Ot.fog]),vertexShader:on.meshbasic_vert,fragmentShader:on.meshbasic_frag},lambert:{uniforms:Er([Ot.common,Ot.specularmap,Ot.envmap,Ot.aomap,Ot.lightmap,Ot.emissivemap,Ot.fog,Ot.lights,{emissive:{value:new Ft(0)}}]),vertexShader:on.meshlambert_vert,fragmentShader:on.meshlambert_frag},phong:{uniforms:Er([Ot.common,Ot.specularmap,Ot.envmap,Ot.aomap,Ot.lightmap,Ot.emissivemap,Ot.bumpmap,Ot.normalmap,Ot.displacementmap,Ot.fog,Ot.lights,{emissive:{value:new Ft(0)},specular:{value:new Ft(1118481)},shininess:{value:30}}]),vertexShader:on.meshphong_vert,fragmentShader:on.meshphong_frag},standard:{uniforms:Er([Ot.common,Ot.envmap,Ot.aomap,Ot.lightmap,Ot.emissivemap,Ot.bumpmap,Ot.normalmap,Ot.displacementmap,Ot.roughnessmap,Ot.metalnessmap,Ot.fog,Ot.lights,{emissive:{value:new Ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:on.meshphysical_vert,fragmentShader:on.meshphysical_frag},toon:{uniforms:Er([Ot.common,Ot.aomap,Ot.lightmap,Ot.emissivemap,Ot.bumpmap,Ot.normalmap,Ot.displacementmap,Ot.gradientmap,Ot.fog,Ot.lights,{emissive:{value:new Ft(0)}}]),vertexShader:on.meshtoon_vert,fragmentShader:on.meshtoon_frag},matcap:{uniforms:Er([Ot.common,Ot.bumpmap,Ot.normalmap,Ot.displacementmap,Ot.fog,{matcap:{value:null}}]),vertexShader:on.meshmatcap_vert,fragmentShader:on.meshmatcap_frag},points:{uniforms:Er([Ot.points,Ot.fog]),vertexShader:on.points_vert,fragmentShader:on.points_frag},dashed:{uniforms:Er([Ot.common,Ot.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:on.linedashed_vert,fragmentShader:on.linedashed_frag},depth:{uniforms:Er([Ot.common,Ot.displacementmap]),vertexShader:on.depth_vert,fragmentShader:on.depth_frag},normal:{uniforms:Er([Ot.common,Ot.bumpmap,Ot.normalmap,Ot.displacementmap,{opacity:{value:1}}]),vertexShader:on.meshnormal_vert,fragmentShader:on.meshnormal_frag},sprite:{uniforms:Er([Ot.sprite,Ot.fog]),vertexShader:on.sprite_vert,fragmentShader:on.sprite_frag},background:{uniforms:{uvTransform:{value:new Zn},t2D:{value:null}},vertexShader:on.background_vert,fragmentShader:on.background_frag},cube:{uniforms:Er([Ot.envmap,{opacity:{value:1}}]),vertexShader:on.cube_vert,fragmentShader:on.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:on.equirect_vert,fragmentShader:on.equirect_frag},distanceRGBA:{uniforms:Er([Ot.common,Ot.displacementmap,{referencePosition:{value:new Ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:on.distanceRGBA_vert,fragmentShader:on.distanceRGBA_frag},shadow:{uniforms:Er([Ot.lights,Ot.fog,{color:{value:new Ft(0)},opacity:{value:1}}]),vertexShader:on.shadow_vert,fragmentShader:on.shadow_frag}};fi.physical={uniforms:Er([fi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Et(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Ft(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Et},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ft(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new Ft(1,1,1)},specularColorMap:{value:null}}]),vertexShader:on.meshphysical_vert,fragmentShader:on.meshphysical_frag};function KD(m,e,t,r,n){const i=new Ft(0);let o=0,l,u,c=null,f=0,h=null;function p(v,M){let y=!1,_=M.isScene===!0?M.background:null;_&&_.isTexture&&(_=e.get(_));const g=m.xr,R=g.getSession&&g.getSession();R&&R.environmentBlendMode==="additive"&&(_=null),_===null?E(i,o):_&&_.isColor&&(E(_,1),y=!0),(m.autoClear||y)&&m.clear(m.autoClearColor,m.autoClearDepth,m.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Js)?(u===void 0&&(u=new Kn(new qi(1,1,1),new $i({name:"BackgroundCubeMaterial",uniforms:ho(fi.cube.uniforms),vertexShader:fi.cube.vertexShader,fragmentShader:fi.cube.fragmentShader,side:Hn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,x,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,(c!==_||f!==_.version||h!==m.toneMapping)&&(u.material.needsUpdate=!0,c=_,f=_.version,h=m.toneMapping),v.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(l===void 0&&(l=new Kn(new cs(2,2),new $i({name:"BackgroundMaterial",uniforms:ho(fi.background.uniforms),vertexShader:fi.background.vertexShader,fragmentShader:fi.background.fragmentShader,side:Ya,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=_,_.matrixAutoUpdate===!0&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),(c!==_||f!==_.version||h!==m.toneMapping)&&(l.material.needsUpdate=!0,c=_,f=_.version,h=m.toneMapping),v.unshift(l,l.geometry,l.material,0,0,null))}function E(v,M){t.buffers.color.setClear(v.r,v.g,v.b,M,n)}return{getClearColor:function(){return i},setClearColor:function(v,M=1){i.set(v),o=M,E(i,o)},getClearAlpha:function(){return o},setClearAlpha:function(v){o=v,E(i,o)},render:p}}function YD(m,e,t,r){const n=m.getParameter(34921),i=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||i!==null,l={},u=M(null);let c=u;function f(G,V,k,H,J){let K=!1;if(o){const ae=v(H,k,V);c!==ae&&(c=ae,p(c.object)),K=y(H,J),K&&_(H,J)}else{const ae=V.wireframe===!0;(c.geometry!==H.id||c.program!==k.id||c.wireframe!==ae)&&(c.geometry=H.id,c.program=k.id,c.wireframe=ae,K=!0)}G.isInstancedMesh===!0&&(K=!0),J!==null&&t.update(J,34963),K&&(C(G,V,k,H),J!==null&&m.bindBuffer(34963,t.get(J).buffer))}function h(){return r.isWebGL2?m.createVertexArray():i.createVertexArrayOES()}function p(G){return r.isWebGL2?m.bindVertexArray(G):i.bindVertexArrayOES(G)}function E(G){return r.isWebGL2?m.deleteVertexArray(G):i.deleteVertexArrayOES(G)}function v(G,V,k){const H=k.wireframe===!0;let J=l[G.id];J===void 0&&(J={},l[G.id]=J);let K=J[V.id];K===void 0&&(K={},J[V.id]=K);let ae=K[H];return ae===void 0&&(ae=M(h()),K[H]=ae),ae}function M(G){const V=[],k=[],H=[];for(let J=0;J<n;J++)V[J]=0,k[J]=0,H[J]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:k,attributeDivisors:H,object:G,attributes:{},index:null}}function y(G,V){const k=c.attributes,H=G.attributes;let J=0;for(const K in H){const ae=k[K],re=H[K];if(ae===void 0||ae.attribute!==re||ae.data!==re.data)return!0;J++}return c.attributesNum!==J||c.index!==V}function _(G,V){const k={},H=G.attributes;let J=0;for(const K in H){const ae=H[K],re={};re.attribute=ae,ae.data&&(re.data=ae.data),k[K]=re,J++}c.attributes=k,c.attributesNum=J,c.index=V}function g(){const G=c.newAttributes;for(let V=0,k=G.length;V<k;V++)G[V]=0}function R(G){S(G,0)}function S(G,V){const k=c.newAttributes,H=c.enabledAttributes,J=c.attributeDivisors;k[G]=1,H[G]===0&&(m.enableVertexAttribArray(G),H[G]=1),J[G]!==V&&((r.isWebGL2?m:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](G,V),J[G]=V)}function x(){const G=c.newAttributes,V=c.enabledAttributes;for(let k=0,H=V.length;k<H;k++)V[k]!==G[k]&&(m.disableVertexAttribArray(k),V[k]=0)}function w(G,V,k,H,J,K){r.isWebGL2===!0&&(k===5124||k===5125)?m.vertexAttribIPointer(G,V,k,J,K):m.vertexAttribPointer(G,V,k,H,J,K)}function C(G,V,k,H){if(r.isWebGL2===!1&&(G.isInstancedMesh||H.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;g();const J=H.attributes,K=k.getAttributes(),ae=V.defaultAttributeValues;for(const re in K){const le=K[re];if(le.location>=0){let me=J[re];if(me===void 0&&(re==="instanceMatrix"&&G.instanceMatrix&&(me=G.instanceMatrix),re==="instanceColor"&&G.instanceColor&&(me=G.instanceColor)),me!==void 0){const de=me.normalized,te=me.itemSize,q=t.get(me);if(q===void 0)continue;const Z=q.buffer,pe=q.type,he=q.bytesPerElement;if(me.isInterleavedBufferAttribute){const Q=me.data,Y=Q.stride,ie=me.offset;if(Q&&Q.isInstancedInterleavedBuffer){for(let ue=0;ue<le.locationSize;ue++)S(le.location+ue,Q.meshPerAttribute);G.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let ue=0;ue<le.locationSize;ue++)R(le.location+ue);m.bindBuffer(34962,Z);for(let ue=0;ue<le.locationSize;ue++)w(le.location+ue,te/le.locationSize,pe,de,Y*he,(ie+te/le.locationSize*ue)*he)}else{if(me.isInstancedBufferAttribute){for(let Q=0;Q<le.locationSize;Q++)S(le.location+Q,me.meshPerAttribute);G.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let Q=0;Q<le.locationSize;Q++)R(le.location+Q);m.bindBuffer(34962,Z);for(let Q=0;Q<le.locationSize;Q++)w(le.location+Q,te/le.locationSize,pe,de,te*he,te/le.locationSize*Q*he)}}else if(ae!==void 0){const de=ae[re];if(de!==void 0)switch(de.length){case 2:m.vertexAttrib2fv(le.location,de);break;case 3:m.vertexAttrib3fv(le.location,de);break;case 4:m.vertexAttrib4fv(le.location,de);break;default:m.vertexAttrib1fv(le.location,de)}}}}x()}function b(){I();for(const G in l){const V=l[G];for(const k in V){const H=V[k];for(const J in H)E(H[J].object),delete H[J];delete V[k]}delete l[G]}}function P(G){if(l[G.id]===void 0)return;const V=l[G.id];for(const k in V){const H=V[k];for(const J in H)E(H[J].object),delete H[J];delete V[k]}delete l[G.id]}function A(G){for(const V in l){const k=l[V];if(k[G.id]===void 0)continue;const H=k[G.id];for(const J in H)E(H[J].object),delete H[J];delete k[G.id]}}function I(){F(),c!==u&&(c=u,p(c.object))}function F(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:f,reset:I,resetDefaultState:F,dispose:b,releaseStatesOfGeometry:P,releaseStatesOfProgram:A,initAttributes:g,enableAttribute:R,disableUnusedAttributes:x}}function XD(m,e,t,r){const n=r.isWebGL2;let i;function o(c){i=c}function l(c,f){m.drawArrays(i,c,f),t.update(f,i,1)}function u(c,f,h){if(h===0)return;let p,E;if(n)p=m,E="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[E](i,c,f,h),t.update(f,i,h)}this.setMode=o,this.render=l,this.renderInstances=u}function QD(m,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");r=m.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function i(C){if(C==="highp"){if(m.getShaderPrecisionFormat(35633,36338).precision>0&&m.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return C==="mediump"&&m.getShaderPrecisionFormat(35633,36337).precision>0&&m.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&m instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&m instanceof WebGL2ComputeRenderingContext;let l=t.precision!==void 0?t.precision:"highp";const u=i(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);const c=o||e.has("WEBGL_draw_buffers"),f=t.logarithmicDepthBuffer===!0,h=m.getParameter(34930),p=m.getParameter(35660),E=m.getParameter(3379),v=m.getParameter(34076),M=m.getParameter(34921),y=m.getParameter(36347),_=m.getParameter(36348),g=m.getParameter(36349),R=p>0,S=o||e.has("OES_texture_float"),x=R&&S,w=o?m.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:i,precision:l,logarithmicDepthBuffer:f,maxTextures:h,maxVertexTextures:p,maxTextureSize:E,maxCubemapSize:v,maxAttributes:M,maxVertexUniforms:y,maxVaryings:_,maxFragmentUniforms:g,vertexTextures:R,floatFragmentTextures:S,floatVertexTextures:x,maxSamples:w}}function JD(m){const e=this;let t=null,r=0,n=!1,i=!1;const o=new Ti,l=new Zn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(h,p,E){const v=h.length!==0||p||r!==0||n;return n=p,t=f(h,E,0),r=h.length,v},this.beginShadows=function(){i=!0,f(null)},this.endShadows=function(){i=!1,c()},this.setState=function(h,p,E){const v=h.clippingPlanes,M=h.clipIntersection,y=h.clipShadows,_=m.get(h);if(!n||v===null||v.length===0||i&&!y)i?f(null):c();else{const g=i?0:r,R=g*4;let S=_.clippingState||null;u.value=S,S=f(v,p,R,E);for(let x=0;x!==R;++x)S[x]=t[x];_.clippingState=S,this.numIntersection=M?this.numPlanes:0,this.numPlanes+=g}};function c(){u.value!==t&&(u.value=t,u.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(h,p,E,v){const M=h!==null?h.length:0;let y=null;if(M!==0){if(y=u.value,v!==!0||y===null){const _=E+M*4,g=p.matrixWorldInverse;l.getNormalMatrix(g),(y===null||y.length<_)&&(y=new Float32Array(_));for(let R=0,S=E;R!==M;++R,S+=4)o.copy(h[R]).applyMatrix4(g,l),o.normal.toArray(y,S),y[S+3]=o.constant}u.value=y,u.needsUpdate=!0}return e.numPlanes=M,e.numIntersection=0,y}}function ZD(m){let e=new WeakMap;function t(o,l){return l===ml?o.mapping=Ja:l===gl&&(o.mapping=Za),o}function r(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const l=o.mapping;if(l===ml||l===gl)if(e.has(o)){const u=e.get(o).texture;return t(u,o.mapping)}else{const u=o.image;if(u&&u.height>0){const c=m.getRenderTarget(),f=new bc(u.height/2);return f.fromEquirectangularTexture(m,o),e.set(o,f),m.setRenderTarget(c),o.addEventListener("dispose",n),t(f.texture,o.mapping)}else return null}}return o}function n(o){const l=o.target;l.removeEventListener("dispose",n);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function i(){e=new WeakMap}return{get:r,dispose:i}}class Ol extends Pl{constructor(e=-1,t=1,r=1,n=-1,i=.1,o=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let i=r-e,o=r+e,l=n+t,u=n-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=c*this.view.offsetX,o=i+c*this.view.width,l-=f*this.view.offsetY,u=l-f*this.view.height}this.projectionMatrix.makeOrthographic(i,o,l,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Ol.prototype.isOrthographicCamera=!0;class vo extends $i{constructor(e){super(e);this.type="RawShaderMaterial"}}vo.prototype.isRawShaderMaterial=!0;const Eo=4,Ra=8,Mi=Math.pow(2,Ra),Zv=[.125,.215,.35,.446,.526,.582],qv=Ra-Eo+1+Zv.length,yo=20,Ca={[fr]:0,[ma]:1,[ac]:2,[lh]:3,[uh]:4,[ch]:5,[ic]:6},Wh=new Ol,{_lodPlanes:Ll,_sizeLods:$v,_sigmas:Dc}=$D(),eE=new Ft;let Hh=null;const fs=(1+Math.sqrt(5))/2,To=1/fs,tE=[new Ie(1,1,1),new Ie(-1,1,1),new Ie(1,1,-1),new Ie(-1,1,-1),new Ie(0,fs,To),new Ie(0,fs,-To),new Ie(To,0,fs),new Ie(-To,0,fs),new Ie(fs,To,0),new Ie(-fs,To,0)];class nE{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=eP(yo),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){Hh=this._renderer.getRenderTarget();const i=this._allocateTargets();return this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=aE(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=iE(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<Ll.length;e++)Ll[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Hh),e.scissorTest=!1,Pc(e,0,0,e.width,e.height)}_fromTexture(e){Hh=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:kn,minFilter:kn,generateMipmaps:!1,type:ki,format:w_,encoding:qD(e)?e.encoding:ac,depthBuffer:!1},r=rE(t);return r.depthBuffer=!e,this._pingPongRenderTarget=rE(t),r}_compileMaterial(e){const t=new Kn(Ll[0],e);this._renderer.compile(t,Wh)}_sceneToCubeUV(e,t,r,n){const i=90,o=1,l=new nr(i,o,t,r),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],f=this._renderer,h=f.autoClear,p=f.outputEncoding,E=f.toneMapping;f.getClearColor(eE),f.toneMapping=pa,f.outputEncoding=fr,f.autoClear=!1;const v=new Zi({name:"PMREM.Background",side:Hn,depthWrite:!1,depthTest:!1}),M=new Kn(new qi,v);let y=!1;const _=e.background;_?_.isColor&&(v.color.copy(_),e.background=null,y=!0):(v.color.copy(eE),y=!0);for(let g=0;g<6;g++){const R=g%3;R==0?(l.up.set(0,u[g],0),l.lookAt(c[g],0,0)):R==1?(l.up.set(0,0,u[g]),l.lookAt(0,c[g],0)):(l.up.set(0,u[g],0),l.lookAt(0,0,c[g])),Pc(n,R*Mi,g>2?Mi:0,Mi,Mi),f.setRenderTarget(n),y&&f.render(M,l),f.render(e,l)}M.geometry.dispose(),M.material.dispose(),f.toneMapping=E,f.outputEncoding=p,f.autoClear=h,e.background=_}_setEncoding(e,t){this._renderer.capabilities.isWebGL2===!0&&t.format===cr&&t.type===ki&&t.encoding===ma?e.value=Ca[fr]:e.value=Ca[t.encoding]}_textureToCubeUV(e,t){const r=this._renderer,n=e.mapping===Ja||e.mapping===Za;n?this._cubemapShader==null&&(this._cubemapShader=aE()):this._equirectShader==null&&(this._equirectShader=iE());const i=n?this._cubemapShader:this._equirectShader,o=new Kn(Ll[0],i),l=i.uniforms;l.envMap.value=e,n||l.texelSize.value.set(1/e.image.width,1/e.image.height),this._setEncoding(l.inputEncoding,e),this._setEncoding(l.outputEncoding,t.texture),Pc(t,0,0,3*Mi,2*Mi),r.setRenderTarget(t),r.render(o,Wh)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<qv;n++){const i=Math.sqrt(Dc[n]*Dc[n]-Dc[n-1]*Dc[n-1]),o=tE[(n-1)%tE.length];this._blur(e,n-1,n,i,o)}t.autoClear=r}_blur(e,t,r,n,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,n,"latitudinal",i),this._halfBlur(o,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,o,l){const u=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,h=new Kn(Ll[n],c),p=c.uniforms,E=$v[r]-1,v=isFinite(i)?Math.PI/(2*E):2*Math.PI/(2*yo-1),M=i/v,y=isFinite(i)?1+Math.floor(f*M):yo;y>yo&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${yo}`);const _=[];let g=0;for(let w=0;w<yo;++w){const C=w/M,b=Math.exp(-C*C/2);_.push(b),w==0?g+=b:w<y&&(g+=2*b)}for(let w=0;w<_.length;w++)_[w]=_[w]/g;p.envMap.value=e.texture,p.samples.value=y,p.weights.value=_,p.latitudinal.value=o==="latitudinal",l&&(p.poleAxis.value=l),p.dTheta.value=v,p.mipInt.value=Ra-r,this._setEncoding(p.inputEncoding,e.texture),this._setEncoding(p.outputEncoding,e.texture);const R=$v[n],S=3*Math.max(0,Mi-2*R),x=(n===0?0:2*Mi)+2*R*(n>Ra-Eo?n-Ra+Eo:0);Pc(t,S,x,3*R,2*R),u.setRenderTarget(t),u.render(h,Wh)}}function qD(m){return m===void 0||m.type!==ki?!1:m.encoding===fr||m.encoding===ma||m.encoding===ic}function $D(){const m=[],e=[],t=[];let r=Ra;for(let n=0;n<qv;n++){const i=Math.pow(2,r);e.push(i);let o=1/i;n>Ra-Eo?o=Zv[n-Ra+Eo-1]:n==0&&(o=0),t.push(o);const l=1/(i-1),u=-l/2,c=1+l/2,f=[u,u,c,u,c,c,u,u,c,c,u,c],h=6,p=6,E=3,v=2,M=1,y=new Float32Array(E*p*h),_=new Float32Array(v*p*h),g=new Float32Array(M*p*h);for(let S=0;S<h;S++){const x=S%3*2/3-1,w=S>2?0:-1,C=[x,w,0,x+2/3,w,0,x+2/3,w+1,0,x,w,0,x+2/3,w+1,0,x,w+1,0];y.set(C,E*p*S),_.set(f,v*p*S);const b=[S,S,S,S,S,S];g.set(b,M*p*S)}const R=new Jt;R.setAttribute("position",new hn(y,E)),R.setAttribute("uv",new hn(_,v)),R.setAttribute("faceIndex",new hn(g,M)),m.push(R),r>Eo&&r--}return{_lodPlanes:m,_sizeLods:e,_sigmas:t}}function rE(m){const e=new oi(3*Mi,3*Mi,m);return e.texture.mapping=Js,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Pc(m,e,t,r,n){m.viewport.set(e,t,r,n),m.scissor.set(e,t,r,n)}function eP(m){const e=new Float32Array(m),t=new Ie(0,1,0);return new vo({name:"SphericalGaussianBlur",defines:{n:m},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:Ca[fr]},outputEncoding:{value:Ca[fr]}},vertexShader:Gh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${jh()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:zi,depthTest:!1,depthWrite:!1})}function iE(){const m=new Et(1,1);return new vo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:m},inputEncoding:{value:Ca[fr]},outputEncoding:{value:Ca[fr]}},vertexShader:Gh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${jh()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:zi,depthTest:!1,depthWrite:!1})}function aE(){return new vo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ca[fr]},outputEncoding:{value:Ca[fr]}},vertexShader:Gh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${jh()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:zi,depthTest:!1,depthWrite:!1})}function Gh(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function jh(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function tP(m){let e=new WeakMap,t=null;function r(l){if(l&&l.isTexture&&l.isRenderTargetTexture===!1){const u=l.mapping,c=u===ml||u===gl,f=u===Ja||u===Za;if(c||f){if(e.has(l))return e.get(l).texture;{const h=l.image;if(c&&h&&h.height>0||f&&h&&n(h)){const p=m.getRenderTarget();t===null&&(t=new nE(m));const E=c?t.fromEquirectangular(l):t.fromCubemap(l);return e.set(l,E),m.setRenderTarget(p),l.addEventListener("dispose",i),E.texture}else return null}}}return l}function n(l){let u=0;const c=6;for(let f=0;f<c;f++)l[f]!==void 0&&u++;return u===c}function i(l){const u=l.target;u.removeEventListener("dispose",i);const c=e.get(u);c!==void 0&&(e.delete(u),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function nP(m){const e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=m.getExtension("WEBGL_depth_texture")||m.getExtension("MOZ_WEBGL_depth_texture")||m.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=m.getExtension("EXT_texture_filter_anisotropic")||m.getExtension("MOZ_EXT_texture_filter_anisotropic")||m.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=m.getExtension("WEBGL_compressed_texture_s3tc")||m.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=m.getExtension("WEBGL_compressed_texture_pvrtc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=m.getExtension(r)}return e[r]=n,n}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float")},get:function(r){const n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function rP(m,e,t,r){const n={},i=new WeakMap;function o(h){const p=h.target;p.index!==null&&e.remove(p.index);for(const v in p.attributes)e.remove(p.attributes[v]);p.removeEventListener("dispose",o),delete n[p.id];const E=i.get(p);E&&(e.remove(E),i.delete(p)),r.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function l(h,p){return n[p.id]===!0||(p.addEventListener("dispose",o),n[p.id]=!0,t.memory.geometries++),p}function u(h){const p=h.attributes;for(const v in p)e.update(p[v],34962);const E=h.morphAttributes;for(const v in E){const M=E[v];for(let y=0,_=M.length;y<_;y++)e.update(M[y],34962)}}function c(h){const p=[],E=h.index,v=h.attributes.position;let M=0;if(E!==null){const g=E.array;M=E.version;for(let R=0,S=g.length;R<S;R+=3){const x=g[R+0],w=g[R+1],C=g[R+2];p.push(x,w,w,C,C,x)}}else{const g=v.array;M=v.version;for(let R=0,S=g.length/3-1;R<S;R+=3){const x=R+0,w=R+1,C=R+2;p.push(x,w,w,C,C,x)}}const y=new(Cv(p)>65535?vc:_c)(p,1);y.version=M;const _=i.get(h);_&&e.remove(_),i.set(h,y)}function f(h){const p=i.get(h);if(p){const E=h.index;E!==null&&p.version<E.version&&c(h)}else c(h);return i.get(h)}return{get:l,update:u,getWireframeAttribute:f}}function iP(m,e,t,r){const n=r.isWebGL2;let i;function o(p){i=p}let l,u;function c(p){l=p.type,u=p.bytesPerElement}function f(p,E){m.drawElements(i,E,l,p*u),t.update(E,i,1)}function h(p,E,v){if(v===0)return;let M,y;if(n)M=m,y="drawElementsInstanced";else if(M=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",M===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[y](i,E,l,p*u,v),t.update(E,i,v)}this.setMode=o,this.setIndex=c,this.render=f,this.renderInstances=h}function aP(m){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(i,o,l){switch(t.calls++,o){case 4:t.triangles+=l*(i/3);break;case 1:t.lines+=l*(i/2);break;case 3:t.lines+=l*(i-1);break;case 2:t.lines+=l*i;break;case 0:t.points+=l*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}class wc extends qn{constructor(e=null,t=1,r=1,n=1){super(null);this.image={data:e,width:t,height:r,depth:n},this.magFilter=kn,this.minFilter=kn,this.wrapR=ur,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}wc.prototype.isDataTexture2DArray=!0;function sP(m,e){return m[0]-e[0]}function oP(m,e){return Math.abs(e[1])-Math.abs(m[1])}function sE(m,e){let t=1;const r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),m.divideScalar(t)}function lP(m,e,t){const r={},n=new Float32Array(8),i=new WeakMap,o=new Ie,l=[];for(let c=0;c<8;c++)l[c]=[c,0];function u(c,f,h,p){const E=c.morphTargetInfluences;if(e.isWebGL2===!0){const v=f.morphAttributes.position.length;let M=i.get(f);if(M===void 0||M.count!==v){M!==void 0&&M.texture.dispose();const g=f.morphAttributes.normal!==void 0,R=f.morphAttributes.position,S=f.morphAttributes.normal||[],x=f.attributes.position.count,w=g===!0?2:1;let C=x*w,b=1;C>e.maxTextureSize&&(b=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const P=new Float32Array(C*b*4*v),A=new wc(P,C,b,v);A.format=cr,A.type=yi;const I=w*4;for(let F=0;F<v;F++){const G=R[F],V=S[F],k=C*b*4*F;for(let H=0;H<G.count;H++){o.fromBufferAttribute(G,H),G.normalized===!0&&sE(o,G);const J=H*I;P[k+J+0]=o.x,P[k+J+1]=o.y,P[k+J+2]=o.z,P[k+J+3]=0,g===!0&&(o.fromBufferAttribute(V,H),V.normalized===!0&&sE(o,V),P[k+J+4]=o.x,P[k+J+5]=o.y,P[k+J+6]=o.z,P[k+J+7]=0)}}M={count:v,texture:A,size:new Et(C,b)},i.set(f,M)}let y=0;for(let g=0;g<E.length;g++)y+=E[g];const _=f.morphTargetsRelative?1:1-y;p.getUniforms().setValue(m,"morphTargetBaseInfluence",_),p.getUniforms().setValue(m,"morphTargetInfluences",E),p.getUniforms().setValue(m,"morphTargetsTexture",M.texture,t),p.getUniforms().setValue(m,"morphTargetsTextureSize",M.size)}else{const v=E===void 0?0:E.length;let M=r[f.id];if(M===void 0||M.length!==v){M=[];for(let S=0;S<v;S++)M[S]=[S,0];r[f.id]=M}for(let S=0;S<v;S++){const x=M[S];x[0]=S,x[1]=E[S]}M.sort(oP);for(let S=0;S<8;S++)S<v&&M[S][1]?(l[S][0]=M[S][0],l[S][1]=M[S][1]):(l[S][0]=Number.MAX_SAFE_INTEGER,l[S][1]=0);l.sort(sP);const y=f.morphAttributes.position,_=f.morphAttributes.normal;let g=0;for(let S=0;S<8;S++){const x=l[S],w=x[0],C=x[1];w!==Number.MAX_SAFE_INTEGER&&C?(y&&f.getAttribute("morphTarget"+S)!==y[w]&&f.setAttribute("morphTarget"+S,y[w]),_&&f.getAttribute("morphNormal"+S)!==_[w]&&f.setAttribute("morphNormal"+S,_[w]),n[S]=C,g+=C):(y&&f.hasAttribute("morphTarget"+S)===!0&&f.deleteAttribute("morphTarget"+S),_&&f.hasAttribute("morphNormal"+S)===!0&&f.deleteAttribute("morphNormal"+S),n[S]=0)}const R=f.morphTargetsRelative?1:1-g;p.getUniforms().setValue(m,"morphTargetBaseInfluence",R),p.getUniforms().setValue(m,"morphTargetInfluences",n)}}return{update:u}}function uP(m,e,t,r){let n=new WeakMap;function i(u){const c=r.render.frame,f=u.geometry,h=e.get(u,f);return n.get(h)!==c&&(e.update(h),n.set(h,c)),u.isInstancedMesh&&(u.hasEventListener("dispose",l)===!1&&u.addEventListener("dispose",l),t.update(u.instanceMatrix,34962),u.instanceColor!==null&&t.update(u.instanceColor,34962)),h}function o(){n=new WeakMap}function l(u){const c=u.target;c.removeEventListener("dispose",l),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:i,dispose:o}}class Vh extends qn{constructor(e=null,t=1,r=1,n=1){super(null);this.image={data:e,width:t,height:r,depth:n},this.magFilter=kn,this.minFilter=kn,this.wrapR=ur,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Vh.prototype.isDataTexture3D=!0;const oE=new qn,cP=new wc,fP=new Vh,lE=new go,uE=[],cE=[],fE=new Float32Array(16),dE=new Float32Array(9),hE=new Float32Array(4);function Mo(m,e,t){const r=m[0];if(r<=0||r>0)return m;const n=e*t;let i=uE[n];if(i===void 0&&(i=new Float32Array(n),uE[n]=i),e!==0){r.toArray(i,0);for(let o=1,l=0;o!==e;++o)l+=t,m[o].toArray(i,l)}return i}function Ar(m,e){if(m.length!==e.length)return!1;for(let t=0,r=m.length;t<r;t++)if(m[t]!==e[t])return!1;return!0}function yr(m,e){for(let t=0,r=e.length;t<r;t++)m[t]=e[t]}function pE(m,e){let t=cE[e];t===void 0&&(t=new Int32Array(e),cE[e]=t);for(let r=0;r!==e;++r)t[r]=m.allocateTextureUnit();return t}function dP(m,e){const t=this.cache;t[0]!==e&&(m.uniform1f(this.addr,e),t[0]=e)}function hP(m,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(m.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ar(t,e))return;m.uniform2fv(this.addr,e),yr(t,e)}}function pP(m,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(m.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(m.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ar(t,e))return;m.uniform3fv(this.addr,e),yr(t,e)}}function mP(m,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(m.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ar(t,e))return;m.uniform4fv(this.addr,e),yr(t,e)}}function gP(m,e){const t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;m.uniformMatrix2fv(this.addr,!1,e),yr(t,e)}else{if(Ar(t,r))return;hE.set(r),m.uniformMatrix2fv(this.addr,!1,hE),yr(t,r)}}function _P(m,e){const t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;m.uniformMatrix3fv(this.addr,!1,e),yr(t,e)}else{if(Ar(t,r))return;dE.set(r),m.uniformMatrix3fv(this.addr,!1,dE),yr(t,r)}}function vP(m,e){const t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;m.uniformMatrix4fv(this.addr,!1,e),yr(t,e)}else{if(Ar(t,r))return;fE.set(r),m.uniformMatrix4fv(this.addr,!1,fE),yr(t,r)}}function EP(m,e){const t=this.cache;t[0]!==e&&(m.uniform1i(this.addr,e),t[0]=e)}function yP(m,e){const t=this.cache;Ar(t,e)||(m.uniform2iv(this.addr,e),yr(t,e))}function TP(m,e){const t=this.cache;Ar(t,e)||(m.uniform3iv(this.addr,e),yr(t,e))}function MP(m,e){const t=this.cache;Ar(t,e)||(m.uniform4iv(this.addr,e),yr(t,e))}function SP(m,e){const t=this.cache;t[0]!==e&&(m.uniform1ui(this.addr,e),t[0]=e)}function AP(m,e){const t=this.cache;Ar(t,e)||(m.uniform2uiv(this.addr,e),yr(t,e))}function xP(m,e){const t=this.cache;Ar(t,e)||(m.uniform3uiv(this.addr,e),yr(t,e))}function RP(m,e){const t=this.cache;Ar(t,e)||(m.uniform4uiv(this.addr,e),yr(t,e))}function CP(m,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(m.uniform1i(this.addr,n),r[0]=n),t.safeSetTexture2D(e||oE,n)}function bP(m,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(m.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||fP,n)}function IP(m,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(m.uniform1i(this.addr,n),r[0]=n),t.safeSetTextureCube(e||lE,n)}function DP(m,e,t){const r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(m.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||cP,n)}function PP(m){switch(m){case 5126:return dP;case 35664:return hP;case 35665:return pP;case 35666:return mP;case 35674:return gP;case 35675:return _P;case 35676:return vP;case 5124:case 35670:return EP;case 35667:case 35671:return yP;case 35668:case 35672:return TP;case 35669:case 35673:return MP;case 5125:return SP;case 36294:return AP;case 36295:return xP;case 36296:return RP;case 35678:case 36198:case 36298:case 36306:case 35682:return CP;case 35679:case 36299:case 36307:return bP;case 35680:case 36300:case 36308:case 36293:return IP;case 36289:case 36303:case 36311:case 36292:return DP}}function wP(m,e){m.uniform1fv(this.addr,e)}function OP(m,e){const t=Mo(e,this.size,2);m.uniform2fv(this.addr,t)}function LP(m,e){const t=Mo(e,this.size,3);m.uniform3fv(this.addr,t)}function NP(m,e){const t=Mo(e,this.size,4);m.uniform4fv(this.addr,t)}function FP(m,e){const t=Mo(e,this.size,4);m.uniformMatrix2fv(this.addr,!1,t)}function BP(m,e){const t=Mo(e,this.size,9);m.uniformMatrix3fv(this.addr,!1,t)}function UP(m,e){const t=Mo(e,this.size,16);m.uniformMatrix4fv(this.addr,!1,t)}function WP(m,e){m.uniform1iv(this.addr,e)}function HP(m,e){m.uniform2iv(this.addr,e)}function GP(m,e){m.uniform3iv(this.addr,e)}function jP(m,e){m.uniform4iv(this.addr,e)}function VP(m,e){m.uniform1uiv(this.addr,e)}function zP(m,e){m.uniform2uiv(this.addr,e)}function kP(m,e){m.uniform3uiv(this.addr,e)}function KP(m,e){m.uniform4uiv(this.addr,e)}function YP(m,e,t){const r=e.length,n=pE(t,r);m.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.safeSetTexture2D(e[i]||oE,n[i])}function XP(m,e,t){const r=e.length,n=pE(t,r);m.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.safeSetTextureCube(e[i]||lE,n[i])}function QP(m){switch(m){case 5126:return wP;case 35664:return OP;case 35665:return LP;case 35666:return NP;case 35674:return FP;case 35675:return BP;case 35676:return UP;case 5124:case 35670:return WP;case 35667:case 35671:return HP;case 35668:case 35672:return GP;case 35669:case 35673:return jP;case 5125:return VP;case 36294:return zP;case 36295:return kP;case 36296:return KP;case 35678:case 36198:case 36298:case 36306:case 35682:return YP;case 35680:case 36300:case 36308:case 36293:return XP}}function JP(m,e,t){this.id=m,this.addr=t,this.cache=[],this.setValue=PP(e.type)}function mE(m,e,t){this.id=m,this.addr=t,this.cache=[],this.size=e.size,this.setValue=QP(e.type)}mE.prototype.updateCache=function(m){const e=this.cache;m instanceof Float32Array&&e.length!==m.length&&(this.cache=new Float32Array(m.length)),yr(e,m)};function gE(m){this.id=m,this.seq=[],this.map={}}gE.prototype.setValue=function(m,e,t){const r=this.seq;for(let n=0,i=r.length;n!==i;++n){const o=r[n];o.setValue(m,e[o.id],t)}};const zh=/(\w+)(\])?(\[|\.)?/g;function _E(m,e){m.seq.push(e),m.map[e.id]=e}function ZP(m,e,t){const r=m.name,n=r.length;for(zh.lastIndex=0;;){const i=zh.exec(r),o=zh.lastIndex;let l=i[1];const u=i[2]==="]",c=i[3];if(u&&(l=l|0),c===void 0||c==="["&&o+2===n){_E(t,c===void 0?new JP(l,m,e):new mE(l,m,e));break}else{let h=t.map[l];h===void 0&&(h=new gE(l),_E(t,h)),t=h}}}function ba(m,e){this.seq=[],this.map={};const t=m.getProgramParameter(e,35718);for(let r=0;r<t;++r){const n=m.getActiveUniform(e,r),i=m.getUniformLocation(e,n.name);ZP(n,i,this)}}ba.prototype.setValue=function(m,e,t,r){const n=this.map[e];n!==void 0&&n.setValue(m,t,r)};ba.prototype.setOptional=function(m,e,t){const r=e[t];r!==void 0&&this.setValue(m,t,r)};ba.upload=function(m,e,t,r){for(let n=0,i=e.length;n!==i;++n){const o=e[n],l=t[o.id];l.needsUpdate!==!1&&o.setValue(m,l.value,r)}};ba.seqWithValue=function(m,e){const t=[];for(let r=0,n=m.length;r!==n;++r){const i=m[r];i.id in e&&t.push(i)}return t};function vE(m,e,t){const r=m.createShader(e);return m.shaderSource(r,t),m.compileShader(r),r}let qP=0;function $P(m){const e=m.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function EE(m){switch(m){case fr:return["Linear","( value )"];case ma:return["sRGB","( value )"];case ac:return["RGBE","( value )"];case lh:return["RGBM","( value, 7.0 )"];case uh:return["RGBM","( value, 16.0 )"];case ch:return["RGBD","( value, 256.0 )"];case ic:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Ev:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",m),["Linear","( value )"]}}function yE(m,e,t){const r=m.getShaderParameter(e,35713),n=m.getShaderInfoLog(e).trim();return r&&n===""?"":t.toUpperCase()+`

`+n+`

`+$P(m.getShaderSource(e))}function ds(m,e){const t=EE(e);return"vec4 "+m+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function ew(m,e){const t=EE(e);return"vec4 "+m+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function tw(m,e){let t;switch(e){case v_:t="Linear";break;case E_:t="Reinhard";break;case y_:t="OptimizedCineon";break;case T_:t="ACESFilmic";break;case M_:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+m+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function nw(m){return[m.extensionDerivatives||m.envMapCubeUV||m.bumpMap||m.tangentSpaceNormalMap||m.clearcoatNormalMap||m.flatShading||m.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(m.extensionFragDepth||m.logarithmicDepthBuffer)&&m.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",m.extensionDrawBuffers&&m.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(m.extensionShaderTextureLOD||m.envMap||m.transmission)&&m.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Nl).join(`
`)}function rw(m){const e=[];for(const t in m){const r=m[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function iw(m,e){const t={},r=m.getProgramParameter(e,35721);for(let n=0;n<r;n++){const i=m.getActiveAttrib(e,n),o=i.name;let l=1;i.type===35674&&(l=2),i.type===35675&&(l=3),i.type===35676&&(l=4),t[o]={type:i.type,location:m.getAttribLocation(e,o),locationSize:l}}return t}function Nl(m){return m!==""}function TE(m,e){return m.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ME(m,e){return m.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const aw=/^[ \t]*#include +<([\w\d./]+)>/gm;function kh(m){return m.replace(aw,sw)}function sw(m,e){const t=on[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return kh(t)}const ow=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,lw=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function SE(m){return m.replace(lw,AE).replace(ow,uw)}function uw(m,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),AE(m,e,t,r)}function AE(m,e,t,r){let n="";for(let i=parseInt(e);i<parseInt(t);i++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return n}function xE(m){let e="precision "+m.precision+` float;
precision `+m.precision+" int;";return m.precision==="highp"?e+=`
#define HIGH_PRECISION`:m.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:m.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function cw(m){let e="SHADOWMAP_TYPE_BASIC";return m.shadowMapType===Gd?e="SHADOWMAP_TYPE_PCF":m.shadowMapType===Jg?e="SHADOWMAP_TYPE_PCF_SOFT":m.shadowMapType===Xs&&(e="SHADOWMAP_TYPE_VSM"),e}function fw(m){let e="ENVMAP_TYPE_CUBE";if(m.envMap)switch(m.envMapMode){case Ja:case Za:e="ENVMAP_TYPE_CUBE";break;case Js:case _l:e="ENVMAP_TYPE_CUBE_UV";break}return e}function dw(m){let e="ENVMAP_MODE_REFLECTION";if(m.envMap)switch(m.envMapMode){case Za:case _l:e="ENVMAP_MODE_REFRACTION";break}return e}function hw(m){let e="ENVMAP_BLENDING_NONE";if(m.envMap)switch(m.combine){case pl:e="ENVMAP_BLENDING_MULTIPLY";break;case g_:e="ENVMAP_BLENDING_MIX";break;case __:e="ENVMAP_BLENDING_ADD";break}return e}function pw(m,e,t,r){const n=m.getContext(),i=t.defines;let o=t.vertexShader,l=t.fragmentShader;const u=cw(t),c=fw(t),f=dw(t),h=hw(t),p=m.gammaFactor>0?m.gammaFactor:1,E=t.isWebGL2?"":nw(t),v=rw(i),M=n.createProgram();let y,_,g=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=[v].filter(Nl).join(`
`),y.length>0&&(y+=`
`),_=[E,v].filter(Nl).join(`
`),_.length>0&&(_+=`
`)):(y=[xE(t),"#define SHADER_NAME "+t.shaderName,v,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Nl).join(`
`),_=[E,xE(t),"#define SHADER_NAME "+t.shaderName,v,"#define GAMMA_FACTOR "+p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+f:"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==pa?"#define TONE_MAPPING":"",t.toneMapping!==pa?on.tonemapping_pars_fragment:"",t.toneMapping!==pa?tw("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.format===es?"#define OPAQUE":"",on.encodings_pars_fragment,t.map?ds("mapTexelToLinear",t.mapEncoding):"",t.matcap?ds("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?ds("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?ds("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.specularColorMap?ds("specularColorMapTexelToLinear",t.specularColorMapEncoding):"",t.sheenColorMap?ds("sheenColorMapTexelToLinear",t.sheenColorMapEncoding):"",t.lightMap?ds("lightMapTexelToLinear",t.lightMapEncoding):"",ew("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Nl).join(`
`)),o=kh(o),o=TE(o,t),o=ME(o,t),l=kh(l),l=TE(l,t),l=ME(l,t),o=SE(o),l=SE(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(g=`#version 300 es
`,y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,_=["#define varying in",t.glslVersion===fh?"":"out highp vec4 pc_fragColor;",t.glslVersion===fh?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const R=g+y+o,S=g+_+l,x=vE(n,35633,R),w=vE(n,35632,S);if(n.attachShader(M,x),n.attachShader(M,w),t.index0AttributeName!==void 0?n.bindAttribLocation(M,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(M,0,"position"),n.linkProgram(M),m.debug.checkShaderErrors){const P=n.getProgramInfoLog(M).trim(),A=n.getShaderInfoLog(x).trim(),I=n.getShaderInfoLog(w).trim();let F=!0,G=!0;if(n.getProgramParameter(M,35714)===!1){F=!1;const V=yE(n,x,"vertex"),k=yE(n,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(M,35715)+`

Program Info Log: `+P+`
`+V+`
`+k)}else P!==""?console.warn("THREE.WebGLProgram: Program Info Log:",P):(A===""||I==="")&&(G=!1);G&&(this.diagnostics={runnable:F,programLog:P,vertexShader:{log:A,prefix:y},fragmentShader:{log:I,prefix:_}})}n.deleteShader(x),n.deleteShader(w);let C;this.getUniforms=function(){return C===void 0&&(C=new ba(n,M)),C};let b;return this.getAttributes=function(){return b===void 0&&(b=iw(n,M)),b},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(M),this.program=void 0},this.name=t.shaderName,this.id=qP++,this.cacheKey=e,this.usedTimes=1,this.program=M,this.vertexShader=x,this.fragmentShader=w,this}function mw(m,e,t,r,n,i,o){const l=[],u=n.isWebGL2,c=n.logarithmicDepthBuffer,f=n.floatVertexTextures,h=n.maxVertexUniforms,p=n.vertexTextures;let E=n.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},M=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap",,"roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","specularIntensityMap","specularColorMap","specularColorMapEncoding","transmission","transmissionMap","thicknessMap","sheen","sheenColorMap","sheenColorMapEncoding","sheenRoughnessMap"];function y(C){const P=C.skeleton.bones;if(f)return 1024;{const I=Math.floor((h-20)/4),F=Math.min(I,P.length);return F<P.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+P.length+" bones. This GPU supports "+F+"."),0):F}}function _(C){let b;return C&&C.isTexture?b=C.encoding:C&&C.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),b=C.texture.encoding):b=fr,u&&C&&C.isTexture&&C.format===cr&&C.type===ki&&C.encoding===ma&&(b=fr),b}function g(C,b,P,A,I){const F=A.fog,G=C.isMeshStandardMaterial?A.environment:null,V=(C.isMeshStandardMaterial?t:e).get(C.envMap||G),k=v[C.type],H=I.isSkinnedMesh?y(I):0;C.precision!==null&&(E=n.getMaxPrecision(C.precision),E!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",E,"instead."));let J,K;if(k){const de=fi[k];J=de.vertexShader,K=de.fragmentShader}else J=C.vertexShader,K=C.fragmentShader;const ae=m.getRenderTarget(),re=C.alphaTest>0,le=C.clearcoat>0;return{isWebGL2:u,shaderID:k,shaderName:C.type,vertexShader:J,fragmentShader:K,defines:C.defines,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:E,instancing:I.isInstancedMesh===!0,instancingColor:I.isInstancedMesh===!0&&I.instanceColor!==null,supportsVertexTextures:p,outputEncoding:ae!==null?_(ae.texture):m.outputEncoding,map:!!C.map,mapEncoding:_(C.map),matcap:!!C.matcap,matcapEncoding:_(C.matcap),envMap:!!V,envMapMode:V&&V.mapping,envMapEncoding:_(V),envMapCubeUV:!!V&&(V.mapping===Js||V.mapping===_l),lightMap:!!C.lightMap,lightMapEncoding:_(C.lightMap),aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,emissiveMapEncoding:_(C.emissiveMap),bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===Mv,tangentSpaceNormalMap:C.normalMapType===is,clearcoat:le,clearcoatMap:le&&!!C.clearcoatMap,clearcoatRoughnessMap:le&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:le&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,specularColorMapEncoding:_(C.specularColorMap),alphaMap:!!C.alphaMap,alphaTest:re,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenColorMapEncoding:_(C.sheenColorMap),sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!I.geometry&&!!I.geometry.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!I.geometry&&!!I.geometry.attributes.color&&I.geometry.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||C.sheenRoughnessMap,uvsVertexOnly:!(!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatNormalMap||C.transmission>0||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheen>0||!!C.sheenColorMap||!!C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!F,useFog:C.fog,fogExp2:F&&F.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:c,skinning:I.isSkinnedMesh===!0&&H>0,maxBones:H,useVertexTexture:f,morphTargets:!!I.geometry&&!!I.geometry.morphAttributes.position,morphNormals:!!I.geometry&&!!I.geometry.morphAttributes.normal,morphTargetsCount:!!I.geometry&&!!I.geometry.morphAttributes.position?I.geometry.morphAttributes.position.length:0,numDirLights:b.directional.length,numPointLights:b.point.length,numSpotLights:b.spot.length,numRectAreaLights:b.rectArea.length,numHemiLights:b.hemi.length,numDirLightShadows:b.directionalShadowMap.length,numPointLightShadows:b.pointShadowMap.length,numSpotLightShadows:b.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,format:C.format,dithering:C.dithering,shadowMapEnabled:m.shadowMap.enabled&&P.length>0,shadowMapType:m.shadowMap.type,toneMapping:C.toneMapped?m.toneMapping:pa,physicallyCorrectLights:m.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Xa,flipSided:C.side===Hn,depthPacking:C.depthPacking!==void 0?C.depthPacking:!1,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function R(C){const b=[];if(C.shaderID?b.push(C.shaderID):(b.push(bv(C.fragmentShader)),b.push(bv(C.vertexShader))),C.defines!==void 0)for(const P in C.defines)b.push(P),b.push(C.defines[P]);if(C.isRawShaderMaterial===!1){for(let P=0;P<M.length;P++)b.push(C[M[P]]);b.push(m.outputEncoding),b.push(m.gammaFactor)}return b.push(C.customProgramCacheKey),b.join()}function S(C){const b=v[C.type];let P;if(b){const A=fi[b];P=Qv.clone(A.uniforms)}else P=C.uniforms;return P}function x(C,b){let P;for(let A=0,I=l.length;A<I;A++){const F=l[A];if(F.cacheKey===b){P=F,++P.usedTimes;break}}return P===void 0&&(P=new pw(m,b,C,i),l.push(P)),P}function w(C){if(--C.usedTimes==0){const b=l.indexOf(C);l[b]=l[l.length-1],l.pop(),C.destroy()}}return{getParameters:g,getProgramCacheKey:R,getUniforms:S,acquireProgram:x,releaseProgram:w,programs:l}}function gw(){let m=new WeakMap;function e(i){let o=m.get(i);return o===void 0&&(o={},m.set(i,o)),o}function t(i){m.delete(i)}function r(i,o,l){m.get(i)[o]=l}function n(){m=new WeakMap}return{get:e,remove:t,update:r,dispose:n}}function _w(m,e){return m.groupOrder!==e.groupOrder?m.groupOrder-e.groupOrder:m.renderOrder!==e.renderOrder?m.renderOrder-e.renderOrder:m.program!==e.program?m.program.id-e.program.id:m.material.id!==e.material.id?m.material.id-e.material.id:m.z!==e.z?m.z-e.z:m.id-e.id}function RE(m,e){return m.groupOrder!==e.groupOrder?m.groupOrder-e.groupOrder:m.renderOrder!==e.renderOrder?m.renderOrder-e.renderOrder:m.z!==e.z?e.z-m.z:m.id-e.id}function CE(m){const e=[];let t=0;const r=[],n=[],i=[],o={id:-1};function l(){t=0,r.length=0,n.length=0,i.length=0}function u(E,v,M,y,_,g){let R=e[t];const S=m.get(M);return R===void 0?(R={id:E.id,object:E,geometry:v,material:M,program:S.program||o,groupOrder:y,renderOrder:E.renderOrder,z:_,group:g},e[t]=R):(R.id=E.id,R.object=E,R.geometry=v,R.material=M,R.program=S.program||o,R.groupOrder=y,R.renderOrder=E.renderOrder,R.z=_,R.group=g),t++,R}function c(E,v,M,y,_,g){const R=u(E,v,M,y,_,g);M.transmission>0?n.push(R):M.transparent===!0?i.push(R):r.push(R)}function f(E,v,M,y,_,g){const R=u(E,v,M,y,_,g);M.transmission>0?n.unshift(R):M.transparent===!0?i.unshift(R):r.unshift(R)}function h(E,v){r.length>1&&r.sort(E||_w),n.length>1&&n.sort(v||RE),i.length>1&&i.sort(v||RE)}function p(){for(let E=t,v=e.length;E<v;E++){const M=e[E];if(M.id===null)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.program=null,M.group=null}}return{opaque:r,transmissive:n,transparent:i,init:l,push:c,unshift:f,finish:p,sort:h}}function vw(m){let e=new WeakMap;function t(n,i){let o;return e.has(n)===!1?(o=new CE(m),e.set(n,[o])):i>=e.get(n).length?(o=new CE(m),e.get(n).push(o)):o=e.get(n)[i],o}function r(){e=new WeakMap}return{get:t,dispose:r}}function Ew(){const m={};return{get:function(e){if(m[e.id]!==void 0)return m[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ie,color:new Ft};break;case"SpotLight":t={position:new Ie,direction:new Ie,color:new Ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ie,color:new Ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ie,skyColor:new Ft,groundColor:new Ft};break;case"RectAreaLight":t={color:new Ft,position:new Ie,halfWidth:new Ie,halfHeight:new Ie};break}return m[e.id]=t,t}}}function yw(){const m={};return{get:function(e){if(m[e.id]!==void 0)return m[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Et,shadowCameraNear:1,shadowCameraFar:1e3};break}return m[e.id]=t,t}}}let Tw=0;function Mw(m,e){return(e.castShadow?1:0)-(m.castShadow?1:0)}function Sw(m,e){const t=new Ew,r=yw(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let f=0;f<9;f++)n.probe.push(new Ie);const i=new Ie,o=new zt,l=new zt;function u(f,h){let p=0,E=0,v=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let M=0,y=0,_=0,g=0,R=0,S=0,x=0,w=0;f.sort(Mw);const C=h!==!0?Math.PI:1;for(let P=0,A=f.length;P<A;P++){const I=f[P],F=I.color,G=I.intensity,V=I.distance,k=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)p+=F.r*G*C,E+=F.g*G*C,v+=F.b*G*C;else if(I.isLightProbe)for(let H=0;H<9;H++)n.probe[H].addScaledVector(I.sh.coefficients[H],G);else if(I.isDirectionalLight){const H=t.get(I);if(H.color.copy(I.color).multiplyScalar(I.intensity*C),I.castShadow){const J=I.shadow,K=r.get(I);K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,n.directionalShadow[M]=K,n.directionalShadowMap[M]=k,n.directionalShadowMatrix[M]=I.shadow.matrix,S++}n.directional[M]=H,M++}else if(I.isSpotLight){const H=t.get(I);if(H.position.setFromMatrixPosition(I.matrixWorld),H.color.copy(F).multiplyScalar(G*C),H.distance=V,H.coneCos=Math.cos(I.angle),H.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),H.decay=I.decay,I.castShadow){const J=I.shadow,K=r.get(I);K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,n.spotShadow[_]=K,n.spotShadowMap[_]=k,n.spotShadowMatrix[_]=I.shadow.matrix,w++}n.spot[_]=H,_++}else if(I.isRectAreaLight){const H=t.get(I);H.color.copy(F).multiplyScalar(G),H.halfWidth.set(I.width*.5,0,0),H.halfHeight.set(0,I.height*.5,0),n.rectArea[g]=H,g++}else if(I.isPointLight){const H=t.get(I);if(H.color.copy(I.color).multiplyScalar(I.intensity*C),H.distance=I.distance,H.decay=I.decay,I.castShadow){const J=I.shadow,K=r.get(I);K.shadowBias=J.bias,K.shadowNormalBias=J.normalBias,K.shadowRadius=J.radius,K.shadowMapSize=J.mapSize,K.shadowCameraNear=J.camera.near,K.shadowCameraFar=J.camera.far,n.pointShadow[y]=K,n.pointShadowMap[y]=k,n.pointShadowMatrix[y]=I.shadow.matrix,x++}n.point[y]=H,y++}else if(I.isHemisphereLight){const H=t.get(I);H.skyColor.copy(I.color).multiplyScalar(G*C),H.groundColor.copy(I.groundColor).multiplyScalar(G*C),n.hemi[R]=H,R++}}g>0&&(e.isWebGL2||m.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ot.LTC_FLOAT_1,n.rectAreaLTC2=Ot.LTC_FLOAT_2):m.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Ot.LTC_HALF_1,n.rectAreaLTC2=Ot.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=p,n.ambient[1]=E,n.ambient[2]=v;const b=n.hash;(b.directionalLength!==M||b.pointLength!==y||b.spotLength!==_||b.rectAreaLength!==g||b.hemiLength!==R||b.numDirectionalShadows!==S||b.numPointShadows!==x||b.numSpotShadows!==w)&&(n.directional.length=M,n.spot.length=_,n.rectArea.length=g,n.point.length=y,n.hemi.length=R,n.directionalShadow.length=S,n.directionalShadowMap.length=S,n.pointShadow.length=x,n.pointShadowMap.length=x,n.spotShadow.length=w,n.spotShadowMap.length=w,n.directionalShadowMatrix.length=S,n.pointShadowMatrix.length=x,n.spotShadowMatrix.length=w,b.directionalLength=M,b.pointLength=y,b.spotLength=_,b.rectAreaLength=g,b.hemiLength=R,b.numDirectionalShadows=S,b.numPointShadows=x,b.numSpotShadows=w,n.version=Tw++)}function c(f,h){let p=0,E=0,v=0,M=0,y=0;const _=h.matrixWorldInverse;for(let g=0,R=f.length;g<R;g++){const S=f[g];if(S.isDirectionalLight){const x=n.directional[p];x.direction.setFromMatrixPosition(S.matrixWorld),i.setFromMatrixPosition(S.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(_),p++}else if(S.isSpotLight){const x=n.spot[v];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),x.direction.setFromMatrixPosition(S.matrixWorld),i.setFromMatrixPosition(S.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(_),v++}else if(S.isRectAreaLight){const x=n.rectArea[M];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),l.identity(),o.copy(S.matrixWorld),o.premultiply(_),l.extractRotation(o),x.halfWidth.set(S.width*.5,0,0),x.halfHeight.set(0,S.height*.5,0),x.halfWidth.applyMatrix4(l),x.halfHeight.applyMatrix4(l),M++}else if(S.isPointLight){const x=n.point[E];x.position.setFromMatrixPosition(S.matrixWorld),x.position.applyMatrix4(_),E++}else if(S.isHemisphereLight){const x=n.hemi[y];x.direction.setFromMatrixPosition(S.matrixWorld),x.direction.transformDirection(_),x.direction.normalize(),y++}}}return{setup:u,setupView:c,state:n}}function bE(m,e){const t=new Sw(m,e),r=[],n=[];function i(){r.length=0,n.length=0}function o(h){r.push(h)}function l(h){n.push(h)}function u(h){t.setup(r,h)}function c(h){t.setupView(r,h)}return{init:i,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:u,setupLightsView:c,pushLight:o,pushShadow:l}}function Aw(m,e){let t=new WeakMap;function r(i,o=0){let l;return t.has(i)===!1?(l=new bE(m,e),t.set(i,[l])):o>=t.get(i).length?(l=new bE(m,e),t.get(i).push(l)):l=t.get(i)[o],l}function n(){t=new WeakMap}return{get:r,dispose:n}}class Oc extends er{constructor(e){super();this.type="MeshDepthMaterial",this.depthPacking=yv,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Oc.prototype.isMeshDepthMaterial=!0;class Lc extends er{constructor(e){super();this.type="MeshDistanceMaterial",this.referencePosition=new Ie,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Lc.prototype.isMeshDistanceMaterial=!0;const xw=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Rw=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function IE(m,e,t){let r=new wl;const n=new Et,i=new Et,o=new Mn,l=new Oc({depthPacking:Tv}),u=new Lc,c={},f=t.maxTextureSize,h={0:Hn,1:Ya,2:Xa},p=new $i({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Et},radius:{value:4}},vertexShader:xw,fragmentShader:Rw}),E=p.clone();E.defines.HORIZONTAL_PASS=1;const v=new Jt;v.setAttribute("position",new hn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const M=new Kn(v,p),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Gd,this.render=function(S,x,w){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||S.length===0)return;const C=m.getRenderTarget(),b=m.getActiveCubeFace(),P=m.getActiveMipmapLevel(),A=m.state;A.setBlending(zi),A.buffers.color.setClear(1,1,1,1),A.buffers.depth.setTest(!0),A.setScissorTest(!1);for(let I=0,F=S.length;I<F;I++){const G=S[I],V=G.shadow;if(V===void 0){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(V.autoUpdate===!1&&V.needsUpdate===!1)continue;n.copy(V.mapSize);const k=V.getFrameExtents();if(n.multiply(k),i.copy(V.mapSize),(n.x>f||n.y>f)&&(n.x>f&&(i.x=Math.floor(f/k.x),n.x=i.x*k.x,V.mapSize.x=i.x),n.y>f&&(i.y=Math.floor(f/k.y),n.y=i.y*k.y,V.mapSize.y=i.y)),V.map===null&&!V.isPointLightShadow&&this.type===Xs){const J={minFilter:Jn,magFilter:Jn,format:cr};V.map=new oi(n.x,n.y,J),V.map.texture.name=G.name+".shadowMap",V.mapPass=new oi(n.x,n.y,J),V.camera.updateProjectionMatrix()}if(V.map===null){const J={minFilter:kn,magFilter:kn,format:cr};V.map=new oi(n.x,n.y,J),V.map.texture.name=G.name+".shadowMap",V.camera.updateProjectionMatrix()}m.setRenderTarget(V.map),m.clear();const H=V.getViewportCount();for(let J=0;J<H;J++){const K=V.getViewport(J);o.set(i.x*K.x,i.y*K.y,i.x*K.z,i.y*K.w),A.viewport(o),V.updateMatrices(G,J),r=V.getFrustum(),R(x,w,V.camera,G,this.type)}!V.isPointLightShadow&&this.type===Xs&&_(V,w),V.needsUpdate=!1}y.needsUpdate=!1,m.setRenderTarget(C,b,P)};function _(S,x){const w=e.update(M);p.defines.VSM_SAMPLES!==S.blurSamples&&(p.defines.VSM_SAMPLES=S.blurSamples,E.defines.VSM_SAMPLES=S.blurSamples,p.needsUpdate=!0,E.needsUpdate=!0),p.uniforms.shadow_pass.value=S.map.texture,p.uniforms.resolution.value=S.mapSize,p.uniforms.radius.value=S.radius,m.setRenderTarget(S.mapPass),m.clear(),m.renderBufferDirect(x,null,w,p,M,null),E.uniforms.shadow_pass.value=S.mapPass.texture,E.uniforms.resolution.value=S.mapSize,E.uniforms.radius.value=S.radius,m.setRenderTarget(S.map),m.clear(),m.renderBufferDirect(x,null,w,E,M,null)}function g(S,x,w,C,b,P,A){let I=null;const F=C.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(F!==void 0?I=F:I=C.isPointLight===!0?u:l,m.localClippingEnabled&&w.clipShadows===!0&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0){const G=I.uuid,V=w.uuid;let k=c[G];k===void 0&&(k={},c[G]=k);let H=k[V];H===void 0&&(H=I.clone(),k[V]=H),I=H}return I.visible=w.visible,I.wireframe=w.wireframe,A===Xs?I.side=w.shadowSide!==null?w.shadowSide:w.side:I.side=w.shadowSide!==null?w.shadowSide:h[w.side],I.alphaMap=w.alphaMap,I.alphaTest=w.alphaTest,I.clipShadows=w.clipShadows,I.clippingPlanes=w.clippingPlanes,I.clipIntersection=w.clipIntersection,I.displacementMap=w.displacementMap,I.displacementScale=w.displacementScale,I.displacementBias=w.displacementBias,I.wireframeLinewidth=w.wireframeLinewidth,I.linewidth=w.linewidth,C.isPointLight===!0&&I.isMeshDistanceMaterial===!0&&(I.referencePosition.setFromMatrixPosition(C.matrixWorld),I.nearDistance=b,I.farDistance=P),I}function R(S,x,w,C,b){if(S.visible===!1)return;if(S.layers.test(x.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&b===Xs)&&(!S.frustumCulled||r.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,S.matrixWorld);const I=e.update(S),F=S.material;if(Array.isArray(F)){const G=I.groups;for(let V=0,k=G.length;V<k;V++){const H=G[V],J=F[H.materialIndex];if(J&&J.visible){const K=g(S,I,J,C,w.near,w.far,b);m.renderBufferDirect(w,null,I,K,S,H)}}}else if(F.visible){const G=g(S,I,F,C,w.near,w.far,b);m.renderBufferDirect(w,null,I,G,S,null)}}const A=S.children;for(let I=0,F=A.length;I<F;I++)R(A[I],x,w,C,b)}}function Cw(m,e,t){const r=t.isWebGL2;function n(){let oe=!1;const se=new Mn;let ce=null;const Se=new Mn(0,0,0,0);return{setMask:function(Me){ce!==Me&&!oe&&(m.colorMask(Me,Me,Me,Me),ce=Me)},setLocked:function(Me){oe=Me},setClear:function(Me,ve,be,Ne,Ue){Ue===!0&&(Me*=Ne,ve*=Ne,be*=Ne),se.set(Me,ve,be,Ne),Se.equals(se)===!1&&(m.clearColor(Me,ve,be,Ne),Se.copy(se))},reset:function(){oe=!1,ce=null,Se.set(-1,0,0,0)}}}function i(){let oe=!1,se=null,ce=null,Se=null;return{setTest:function(Me){Me?te(2929):q(2929)},setMask:function(Me){se!==Me&&!oe&&(m.depthMask(Me),se=Me)},setFunc:function(Me){if(ce!==Me){if(Me)switch(Me){case u_:m.depthFunc(512);break;case c_:m.depthFunc(519);break;case f_:m.depthFunc(513);break;case qu:m.depthFunc(515);break;case d_:m.depthFunc(514);break;case h_:m.depthFunc(518);break;case p_:m.depthFunc(516);break;case m_:m.depthFunc(517);break;default:m.depthFunc(515)}else m.depthFunc(515);ce=Me}},setLocked:function(Me){oe=Me},setClear:function(Me){Se!==Me&&(m.clearDepth(Me),Se=Me)},reset:function(){oe=!1,se=null,ce=null,Se=null}}}function o(){let oe=!1,se=null,ce=null,Se=null,Me=null,ve=null,be=null,Ne=null,Ue=null;return{setTest:function(Xe){oe||(Xe?te(2960):q(2960))},setMask:function(Xe){se!==Xe&&!oe&&(m.stencilMask(Xe),se=Xe)},setFunc:function(Xe,ot,ct){(ce!==Xe||Se!==ot||Me!==ct)&&(m.stencilFunc(Xe,ot,ct),ce=Xe,Se=ot,Me=ct)},setOp:function(Xe,ot,ct){(ve!==Xe||be!==ot||Ne!==ct)&&(m.stencilOp(Xe,ot,ct),ve=Xe,be=ot,Ne=ct)},setLocked:function(Xe){oe=Xe},setClear:function(Xe){Ue!==Xe&&(m.clearStencil(Xe),Ue=Xe)},reset:function(){oe=!1,se=null,ce=null,Se=null,Me=null,ve=null,be=null,Ne=null,Ue=null}}}const l=new n,u=new i,c=new o;let f={},h=null,p={},E=null,v=!1,M=null,y=null,_=null,g=null,R=null,S=null,x=null,w=!1,C=null,b=null,P=null,A=null,I=null;const F=m.getParameter(35661);let G=!1,V=0;const k=m.getParameter(7938);k.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(k)[1]),G=V>=1):k.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),G=V>=2);let H=null,J={};const K=m.getParameter(3088),ae=m.getParameter(2978),re=new Mn().fromArray(K),le=new Mn().fromArray(ae);function me(oe,se,ce){const Se=new Uint8Array(4),Me=m.createTexture();m.bindTexture(oe,Me),m.texParameteri(oe,10241,9728),m.texParameteri(oe,10240,9728);for(let ve=0;ve<ce;ve++)m.texImage2D(se+ve,0,6408,1,1,0,6408,5121,Se);return Me}const de={};de[3553]=me(3553,3553,1),de[34067]=me(34067,34069,6),l.setClear(0,0,0,1),u.setClear(1),c.setClear(0),te(2929),u.setFunc(qu),$(!1),W(Hd),te(2884),ie(zi);function te(oe){f[oe]!==!0&&(m.enable(oe),f[oe]=!0)}function q(oe){f[oe]!==!1&&(m.disable(oe),f[oe]=!1)}function Z(oe){oe!==h&&(m.bindFramebuffer(36160,oe),h=oe)}function pe(oe,se){return se===null&&h!==null&&(se=h),p[oe]!==se?(m.bindFramebuffer(oe,se),p[oe]=se,r&&(oe===36009&&(p[36160]=se),oe===36160&&(p[36009]=se)),!0):!1}function he(oe){return E!==oe?(m.useProgram(oe),E=oe,!0):!1}const Q={[Qa]:32774,[qg]:32778,[$g]:32779};if(r)Q[Kd]=32775,Q[Yd]=32776;else{const oe=e.get("EXT_blend_minmax");oe!==null&&(Q[Kd]=oe.MIN_EXT,Q[Yd]=oe.MAX_EXT)}const Y={[e_]:0,[t_]:1,[n_]:768,[Xd]:770,[l_]:776,[s_]:774,[i_]:772,[r_]:769,[Qd]:771,[o_]:775,[a_]:773};function ie(oe,se,ce,Se,Me,ve,be,Ne){if(oe===zi){v===!0&&(q(3042),v=!1);return}if(v===!1&&(te(3042),v=!0),oe!==Zg){if(oe!==M||Ne!==w){if((y!==Qa||R!==Qa)&&(m.blendEquation(32774),y=Qa,R=Qa),Ne)switch(oe){case Qs:m.blendFuncSeparate(1,771,1,771);break;case Vd:m.blendFunc(1,1);break;case zd:m.blendFuncSeparate(0,0,769,771);break;case kd:m.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}else switch(oe){case Qs:m.blendFuncSeparate(770,771,1,771);break;case Vd:m.blendFunc(770,1);break;case zd:m.blendFunc(0,769);break;case kd:m.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",oe);break}_=null,g=null,S=null,x=null,M=oe,w=Ne}return}Me=Me||se,ve=ve||ce,be=be||Se,(se!==y||Me!==R)&&(m.blendEquationSeparate(Q[se],Q[Me]),y=se,R=Me),(ce!==_||Se!==g||ve!==S||be!==x)&&(m.blendFuncSeparate(Y[ce],Y[Se],Y[ve],Y[be]),_=ce,g=Se,S=ve,x=be),M=oe,w=null}function ue(oe,se){oe.side===Xa?q(2884):te(2884);let ce=oe.side===Hn;se&&(ce=!ce),$(ce),oe.blending===Qs&&oe.transparent===!1?ie(zi):ie(oe.blending,oe.blendEquation,oe.blendSrc,oe.blendDst,oe.blendEquationAlpha,oe.blendSrcAlpha,oe.blendDstAlpha,oe.premultipliedAlpha),u.setFunc(oe.depthFunc),u.setTest(oe.depthTest),u.setMask(oe.depthWrite),l.setMask(oe.colorWrite);const Se=oe.stencilWrite;c.setTest(Se),Se&&(c.setMask(oe.stencilWriteMask),c.setFunc(oe.stencilFunc,oe.stencilRef,oe.stencilFuncMask),c.setOp(oe.stencilFail,oe.stencilZFail,oe.stencilZPass)),L(oe.polygonOffset,oe.polygonOffsetFactor,oe.polygonOffsetUnits),oe.alphaToCoverage===!0?te(32926):q(32926)}function $(oe){C!==oe&&(oe?m.frontFace(2304):m.frontFace(2305),C=oe)}function W(oe){oe!==Xg?(te(2884),oe!==b&&(oe===Hd?m.cullFace(1029):oe===Qg?m.cullFace(1028):m.cullFace(1032))):q(2884),b=oe}function B(oe){oe!==P&&(G&&m.lineWidth(oe),P=oe)}function L(oe,se,ce){oe?(te(32823),(A!==se||I!==ce)&&(m.polygonOffset(se,ce),A=se,I=ce)):q(32823)}function D(oe){oe?te(3089):q(3089)}function O(oe){oe===void 0&&(oe=33984+F-1),H!==oe&&(m.activeTexture(oe),H=oe)}function U(oe,se){H===null&&O();let ce=J[H];ce===void 0&&(ce={type:void 0,texture:void 0},J[H]=ce),(ce.type!==oe||ce.texture!==se)&&(m.bindTexture(oe,se||de[oe]),ce.type=oe,ce.texture=se)}function fe(){const oe=J[H];oe!==void 0&&oe.type!==void 0&&(m.bindTexture(oe.type,null),oe.type=void 0,oe.texture=void 0)}function ye(){try{m.compressedTexImage2D.apply(m,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function _e(){try{m.texImage2D.apply(m,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function ee(){try{m.texImage3D.apply(m,arguments)}catch(oe){console.error("THREE.WebGLState:",oe)}}function j(oe){re.equals(oe)===!1&&(m.scissor(oe.x,oe.y,oe.z,oe.w),re.copy(oe))}function X(oe){le.equals(oe)===!1&&(m.viewport(oe.x,oe.y,oe.z,oe.w),le.copy(oe))}function z(){m.disable(3042),m.disable(2884),m.disable(2929),m.disable(32823),m.disable(3089),m.disable(2960),m.disable(32926),m.blendEquation(32774),m.blendFunc(1,0),m.blendFuncSeparate(1,0,1,0),m.colorMask(!0,!0,!0,!0),m.clearColor(0,0,0,0),m.depthMask(!0),m.depthFunc(513),m.clearDepth(1),m.stencilMask(4294967295),m.stencilFunc(519,0,4294967295),m.stencilOp(7680,7680,7680),m.clearStencil(0),m.cullFace(1029),m.frontFace(2305),m.polygonOffset(0,0),m.activeTexture(33984),m.bindFramebuffer(36160,null),r===!0&&(m.bindFramebuffer(36009,null),m.bindFramebuffer(36008,null)),m.useProgram(null),m.lineWidth(1),m.scissor(0,0,m.canvas.width,m.canvas.height),m.viewport(0,0,m.canvas.width,m.canvas.height),f={},H=null,J={},h=null,p={},E=null,v=!1,M=null,y=null,_=null,g=null,R=null,S=null,x=null,w=!1,C=null,b=null,P=null,A=null,I=null,re.set(0,0,m.canvas.width,m.canvas.height),le.set(0,0,m.canvas.width,m.canvas.height),l.reset(),u.reset(),c.reset()}return{buffers:{color:l,depth:u,stencil:c},enable:te,disable:q,bindFramebuffer:pe,bindXRFramebuffer:Z,useProgram:he,setBlending:ie,setMaterial:ue,setFlipSided:$,setCullFace:W,setLineWidth:B,setPolygonOffset:L,setScissorTest:D,activeTexture:O,bindTexture:U,unbindTexture:fe,compressedTexImage2D:ye,texImage2D:_e,texImage3D:ee,scissor:j,viewport:X,reset:z}}function bw(m,e,t,r,n,i,o){const l=n.isWebGL2,u=n.maxTextures,c=n.maxCubemapSize,f=n.maxTextureSize,h=n.maxSamples,p=new WeakMap;let E,v=!1;try{v=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(D,O){return v?new OffscreenCanvas(D,O):lc("canvas")}function y(D,O,U,fe){let ye=1;if((D.width>fe||D.height>fe)&&(ye=fe/Math.max(D.width,D.height)),ye<1||O===!0)if(typeof HTMLImageElement!="undefined"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&D instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&D instanceof ImageBitmap){const _e=O?xv:Math.floor,ee=_e(ye*D.width),j=_e(ye*D.height);E===void 0&&(E=M(ee,j));const X=U?M(ee,j):E;return X.width=ee,X.height=j,X.getContext("2d").drawImage(D,0,0,ee,j),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+ee+"x"+j+")."),X}else return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D;return D}function _(D){return hh(D.width)&&hh(D.height)}function g(D){return l?!1:D.wrapS!==ur||D.wrapT!==ur||D.minFilter!==kn&&D.minFilter!==Jn}function R(D,O){return D.generateMipmaps&&O&&D.minFilter!==kn&&D.minFilter!==Jn}function S(D,O,U,fe,ye=1){m.generateMipmap(D);const _e=r.get(O);_e.__maxMipLevel=Math.log2(Math.max(U,fe,ye))}function x(D,O,U,fe){if(l===!1)return O;if(D!==null){if(m[D]!==void 0)return m[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let ye=O;return O===6403&&(U===5126&&(ye=33326),U===5131&&(ye=33325),U===5121&&(ye=33321)),O===6407&&(U===5126&&(ye=34837),U===5131&&(ye=34843),U===5121&&(ye=32849)),O===6408&&(U===5126&&(ye=34836),U===5131&&(ye=34842),U===5121&&(ye=fe===ma?35907:32856)),(ye===33325||ye===33326||ye===34842||ye===34836)&&e.get("EXT_color_buffer_float"),ye}function w(D){return D===kn||D===ec||D===tc?9728:9729}function C(D){const O=D.target;O.removeEventListener("dispose",C),P(O),O.isVideoTexture&&p.delete(O),o.memory.textures--}function b(D){const O=D.target;O.removeEventListener("dispose",b),A(O)}function P(D){const O=r.get(D);O.__webglInit!==void 0&&(m.deleteTexture(O.__webglTexture),r.remove(D))}function A(D){const O=D.texture,U=r.get(D),fe=r.get(O);if(!!D){if(fe.__webglTexture!==void 0&&(m.deleteTexture(fe.__webglTexture),o.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++)m.deleteFramebuffer(U.__webglFramebuffer[ye]),U.__webglDepthbuffer&&m.deleteRenderbuffer(U.__webglDepthbuffer[ye]);else m.deleteFramebuffer(U.__webglFramebuffer),U.__webglDepthbuffer&&m.deleteRenderbuffer(U.__webglDepthbuffer),U.__webglMultisampledFramebuffer&&m.deleteFramebuffer(U.__webglMultisampledFramebuffer),U.__webglColorRenderbuffer&&m.deleteRenderbuffer(U.__webglColorRenderbuffer),U.__webglDepthRenderbuffer&&m.deleteRenderbuffer(U.__webglDepthRenderbuffer);if(D.isWebGLMultipleRenderTargets)for(let ye=0,_e=O.length;ye<_e;ye++){const ee=r.get(O[ye]);ee.__webglTexture&&(m.deleteTexture(ee.__webglTexture),o.memory.textures--),r.remove(O[ye])}r.remove(O),r.remove(D)}}let I=0;function F(){I=0}function G(){const D=I;return D>=u&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+u),I+=1,D}function V(D,O){const U=r.get(D);if(D.isVideoTexture&&ue(D),D.version>0&&U.__version!==D.version){const fe=D.image;if(fe===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{me(U,D,O);return}}t.activeTexture(33984+O),t.bindTexture(3553,U.__webglTexture)}function k(D,O){const U=r.get(D);if(D.version>0&&U.__version!==D.version){me(U,D,O);return}t.activeTexture(33984+O),t.bindTexture(35866,U.__webglTexture)}function H(D,O){const U=r.get(D);if(D.version>0&&U.__version!==D.version){me(U,D,O);return}t.activeTexture(33984+O),t.bindTexture(32879,U.__webglTexture)}function J(D,O){const U=r.get(D);if(D.version>0&&U.__version!==D.version){de(U,D,O);return}t.activeTexture(33984+O),t.bindTexture(34067,U.__webglTexture)}const K={[vl]:10497,[ur]:33071,[El]:33648},ae={[kn]:9728,[ec]:9984,[tc]:9986,[Jn]:9729,[Jd]:9985,[qa]:9987};function re(D,O,U){if(U?(m.texParameteri(D,10242,K[O.wrapS]),m.texParameteri(D,10243,K[O.wrapT]),(D===32879||D===35866)&&m.texParameteri(D,32882,K[O.wrapR]),m.texParameteri(D,10240,ae[O.magFilter]),m.texParameteri(D,10241,ae[O.minFilter])):(m.texParameteri(D,10242,33071),m.texParameteri(D,10243,33071),(D===32879||D===35866)&&m.texParameteri(D,32882,33071),(O.wrapS!==ur||O.wrapT!==ur)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),m.texParameteri(D,10240,w(O.magFilter)),m.texParameteri(D,10241,w(O.minFilter)),O.minFilter!==kn&&O.minFilter!==Jn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const fe=e.get("EXT_texture_filter_anisotropic");if(O.type===yi&&e.has("OES_texture_float_linear")===!1||l===!1&&O.type===$a&&e.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||r.get(O).__currentAnisotropy)&&(m.texParameterf(D,fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,n.getMaxAnisotropy())),r.get(O).__currentAnisotropy=O.anisotropy)}}function le(D,O){D.__webglInit===void 0&&(D.__webglInit=!0,O.addEventListener("dispose",C),D.__webglTexture=m.createTexture(),o.memory.textures++)}function me(D,O,U){let fe=3553;O.isDataTexture2DArray&&(fe=35866),O.isDataTexture3D&&(fe=32879),le(D,O),t.activeTexture(33984+U),t.bindTexture(fe,D.__webglTexture),m.pixelStorei(37440,O.flipY),m.pixelStorei(37441,O.premultiplyAlpha),m.pixelStorei(3317,O.unpackAlignment),m.pixelStorei(37443,0);const ye=g(O)&&_(O.image)===!1,_e=y(O.image,ye,!1,f),ee=_(_e)||l,j=i.convert(O.format);let X=i.convert(O.type),z=x(O.internalFormat,j,X,O.encoding);re(fe,O,ee);let oe;const se=O.mipmaps;if(O.isDepthTexture)z=6402,l?O.type===yi?z=36012:O.type===Tl?z=33190:O.type===Zs?z=35056:z=33189:O.type===yi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===ts&&z===6402&&O.type!==yl&&O.type!==Tl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=yl,X=i.convert(O.type)),O.format===qs&&z===6402&&(z=34041,O.type!==Zs&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=Zs,X=i.convert(O.type))),t.texImage2D(3553,0,z,_e.width,_e.height,0,j,X,null);else if(O.isDataTexture)if(se.length>0&&ee){for(let ce=0,Se=se.length;ce<Se;ce++)oe=se[ce],t.texImage2D(3553,ce,z,oe.width,oe.height,0,j,X,oe.data);O.generateMipmaps=!1,D.__maxMipLevel=se.length-1}else t.texImage2D(3553,0,z,_e.width,_e.height,0,j,X,_e.data),D.__maxMipLevel=0;else if(O.isCompressedTexture){for(let ce=0,Se=se.length;ce<Se;ce++)oe=se[ce],O.format!==cr&&O.format!==es?j!==null?t.compressedTexImage2D(3553,ce,z,oe.width,oe.height,0,oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,ce,z,oe.width,oe.height,0,j,X,oe.data);D.__maxMipLevel=se.length-1}else if(O.isDataTexture2DArray)t.texImage3D(35866,0,z,_e.width,_e.height,_e.depth,0,j,X,_e.data),D.__maxMipLevel=0;else if(O.isDataTexture3D)t.texImage3D(32879,0,z,_e.width,_e.height,_e.depth,0,j,X,_e.data),D.__maxMipLevel=0;else if(se.length>0&&ee){for(let ce=0,Se=se.length;ce<Se;ce++)oe=se[ce],t.texImage2D(3553,ce,z,j,X,oe);O.generateMipmaps=!1,D.__maxMipLevel=se.length-1}else t.texImage2D(3553,0,z,j,X,_e),D.__maxMipLevel=0;R(O,ee)&&S(fe,O,_e.width,_e.height),D.__version=O.version,O.onUpdate&&O.onUpdate(O)}function de(D,O,U){if(O.image.length!==6)return;le(D,O),t.activeTexture(33984+U),t.bindTexture(34067,D.__webglTexture),m.pixelStorei(37440,O.flipY),m.pixelStorei(37441,O.premultiplyAlpha),m.pixelStorei(3317,O.unpackAlignment),m.pixelStorei(37443,0);const fe=O&&(O.isCompressedTexture||O.image[0].isCompressedTexture),ye=O.image[0]&&O.image[0].isDataTexture,_e=[];for(let ce=0;ce<6;ce++)!fe&&!ye?_e[ce]=y(O.image[ce],!1,!0,c):_e[ce]=ye?O.image[ce].image:O.image[ce];const ee=_e[0],j=_(ee)||l,X=i.convert(O.format),z=i.convert(O.type),oe=x(O.internalFormat,X,z,O.encoding);re(34067,O,j);let se;if(fe){for(let ce=0;ce<6;ce++){se=_e[ce].mipmaps;for(let Se=0;Se<se.length;Se++){const Me=se[Se];O.format!==cr&&O.format!==es?X!==null?t.compressedTexImage2D(34069+ce,Se,oe,Me.width,Me.height,0,Me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+ce,Se,oe,Me.width,Me.height,0,X,z,Me.data)}}D.__maxMipLevel=se.length-1}else{se=O.mipmaps;for(let ce=0;ce<6;ce++)if(ye){t.texImage2D(34069+ce,0,oe,_e[ce].width,_e[ce].height,0,X,z,_e[ce].data);for(let Se=0;Se<se.length;Se++){const ve=se[Se].image[ce].image;t.texImage2D(34069+ce,Se+1,oe,ve.width,ve.height,0,X,z,ve.data)}}else{t.texImage2D(34069+ce,0,oe,X,z,_e[ce]);for(let Se=0;Se<se.length;Se++){const Me=se[Se];t.texImage2D(34069+ce,Se+1,oe,X,z,Me.image[ce])}}D.__maxMipLevel=se.length}R(O,j)&&S(34067,O,ee.width,ee.height),D.__version=O.version,O.onUpdate&&O.onUpdate(O)}function te(D,O,U,fe,ye){const _e=i.convert(U.format),ee=i.convert(U.type),j=x(U.internalFormat,_e,ee,U.encoding);ye===32879||ye===35866?t.texImage3D(ye,0,j,O.width,O.height,O.depth,0,_e,ee,null):t.texImage2D(ye,0,j,O.width,O.height,0,_e,ee,null),t.bindFramebuffer(36160,D),m.framebufferTexture2D(36160,fe,ye,r.get(U).__webglTexture,0),t.bindFramebuffer(36160,null)}function q(D,O,U){if(m.bindRenderbuffer(36161,D),O.depthBuffer&&!O.stencilBuffer){let fe=33189;if(U){const ye=O.depthTexture;ye&&ye.isDepthTexture&&(ye.type===yi?fe=36012:ye.type===Tl&&(fe=33190));const _e=ie(O);m.renderbufferStorageMultisample(36161,_e,fe,O.width,O.height)}else m.renderbufferStorage(36161,fe,O.width,O.height);m.framebufferRenderbuffer(36160,36096,36161,D)}else if(O.depthBuffer&&O.stencilBuffer){if(U){const fe=ie(O);m.renderbufferStorageMultisample(36161,fe,35056,O.width,O.height)}else m.renderbufferStorage(36161,34041,O.width,O.height);m.framebufferRenderbuffer(36160,33306,36161,D)}else{const fe=O.isWebGLMultipleRenderTargets===!0?O.texture[0]:O.texture,ye=i.convert(fe.format),_e=i.convert(fe.type),ee=x(fe.internalFormat,ye,_e,fe.encoding);if(U){const j=ie(O);m.renderbufferStorageMultisample(36161,j,ee,O.width,O.height)}else m.renderbufferStorage(36161,ee,O.width,O.height)}m.bindRenderbuffer(36161,null)}function Z(D,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,D),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),V(O.depthTexture,0);const fe=r.get(O.depthTexture).__webglTexture;if(O.depthTexture.format===ts)m.framebufferTexture2D(36160,36096,3553,fe,0);else if(O.depthTexture.format===qs)m.framebufferTexture2D(36160,33306,3553,fe,0);else throw new Error("Unknown depthTexture format")}function pe(D){const O=r.get(D),U=D.isWebGLCubeRenderTarget===!0;if(D.depthTexture){if(U)throw new Error("target.depthTexture not supported in Cube render targets");Z(O.__webglFramebuffer,D)}else if(U){O.__webglDepthbuffer=[];for(let fe=0;fe<6;fe++)t.bindFramebuffer(36160,O.__webglFramebuffer[fe]),O.__webglDepthbuffer[fe]=m.createRenderbuffer(),q(O.__webglDepthbuffer[fe],D,!1)}else t.bindFramebuffer(36160,O.__webglFramebuffer),O.__webglDepthbuffer=m.createRenderbuffer(),q(O.__webglDepthbuffer,D,!1);t.bindFramebuffer(36160,null)}function he(D){const O=D.texture,U=r.get(D),fe=r.get(O);D.addEventListener("dispose",b),D.isWebGLMultipleRenderTargets!==!0&&(fe.__webglTexture=m.createTexture(),fe.__version=O.version,o.memory.textures++);const ye=D.isWebGLCubeRenderTarget===!0,_e=D.isWebGLMultipleRenderTargets===!0,ee=D.isWebGLMultisampleRenderTarget===!0,j=O.isDataTexture3D||O.isDataTexture2DArray,X=_(D)||l;if(l&&O.format===es&&(O.type===yi||O.type===$a)&&(O.format=cr,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),ye){U.__webglFramebuffer=[];for(let z=0;z<6;z++)U.__webglFramebuffer[z]=m.createFramebuffer()}else if(U.__webglFramebuffer=m.createFramebuffer(),_e)if(n.drawBuffers){const z=D.texture;for(let oe=0,se=z.length;oe<se;oe++){const ce=r.get(z[oe]);ce.__webglTexture===void 0&&(ce.__webglTexture=m.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(ee)if(l){U.__webglMultisampledFramebuffer=m.createFramebuffer(),U.__webglColorRenderbuffer=m.createRenderbuffer(),m.bindRenderbuffer(36161,U.__webglColorRenderbuffer);const z=i.convert(O.format),oe=i.convert(O.type),se=x(O.internalFormat,z,oe,O.encoding),ce=ie(D);m.renderbufferStorageMultisample(36161,ce,se,D.width,D.height),t.bindFramebuffer(36160,U.__webglMultisampledFramebuffer),m.framebufferRenderbuffer(36160,36064,36161,U.__webglColorRenderbuffer),m.bindRenderbuffer(36161,null),D.depthBuffer&&(U.__webglDepthRenderbuffer=m.createRenderbuffer(),q(U.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ye){t.bindTexture(34067,fe.__webglTexture),re(34067,O,X);for(let z=0;z<6;z++)te(U.__webglFramebuffer[z],D,O,36064,34069+z);R(O,X)&&S(34067,O,D.width,D.height),t.unbindTexture()}else if(_e){const z=D.texture;for(let oe=0,se=z.length;oe<se;oe++){const ce=z[oe],Se=r.get(ce);t.bindTexture(3553,Se.__webglTexture),re(3553,ce,X),te(U.__webglFramebuffer,D,ce,36064+oe,3553),R(ce,X)&&S(3553,ce,D.width,D.height)}t.unbindTexture()}else{let z=3553;j&&(l?z=O.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(z,fe.__webglTexture),re(z,O,X),te(U.__webglFramebuffer,D,O,36064,z),R(O,X)&&S(z,O,D.width,D.height,D.depth),t.unbindTexture()}D.depthBuffer&&pe(D)}function Q(D){const O=_(D)||l,U=D.isWebGLMultipleRenderTargets===!0?D.texture:[D.texture];for(let fe=0,ye=U.length;fe<ye;fe++){const _e=U[fe];if(R(_e,O)){const ee=D.isWebGLCubeRenderTarget?34067:3553,j=r.get(_e).__webglTexture;t.bindTexture(ee,j),S(ee,_e,D.width,D.height),t.unbindTexture()}}}function Y(D){if(D.isWebGLMultisampleRenderTarget)if(l){const O=D.width,U=D.height;let fe=16384;D.depthBuffer&&(fe|=256),D.stencilBuffer&&(fe|=1024);const ye=r.get(D);t.bindFramebuffer(36008,ye.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ye.__webglFramebuffer),m.blitFramebuffer(0,0,O,U,0,0,O,U,fe,9728),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,ye.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ie(D){return l&&D.isWebGLMultisampleRenderTarget?Math.min(h,D.samples):0}function ue(D){const O=o.render.frame;p.get(D)!==O&&(p.set(D,O),D.update())}let $=!1,W=!1;function B(D,O){D&&D.isWebGLRenderTarget&&($===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),$=!0),D=D.texture),V(D,O)}function L(D,O){D&&D.isWebGLCubeRenderTarget&&(W===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),W=!0),D=D.texture),J(D,O)}this.allocateTextureUnit=G,this.resetTextureUnits=F,this.setTexture2D=V,this.setTexture2DArray=k,this.setTexture3D=H,this.setTextureCube=J,this.setupRenderTarget=he,this.updateRenderTargetMipmap=Q,this.updateMultisampleRenderTarget=Y,this.safeSetTexture2D=B,this.safeSetTextureCube=L}function DE(m,e,t){const r=t.isWebGL2;function n(i){let o;if(i===ki)return 5121;if(i===R_)return 32819;if(i===C_)return 32820;if(i===b_)return 33635;if(i===S_)return 5120;if(i===A_)return 5122;if(i===yl)return 5123;if(i===x_)return 5124;if(i===Tl)return 5125;if(i===yi)return 5126;if(i===$a)return r?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(i===I_)return 6406;if(i===es)return 6407;if(i===cr)return 6408;if(i===D_)return 6409;if(i===P_)return 6410;if(i===ts)return 6402;if(i===qs)return 34041;if(i===O_)return 6403;if(i===L_)return 36244;if(i===N_)return 33319;if(i===F_)return 33320;if(i===B_)return 36248;if(i===U_)return 36249;if(i===Zd||i===qd||i===$d||i===eh)if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===Zd)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===qd)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===$d)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===eh)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===th||i===nh||i===rh||i===ih)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===th)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===nh)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===rh)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===ih)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===W_)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((i===ah||i===sh)&&(o=e.get("WEBGL_compressed_texture_etc"),o!==null)){if(i===ah)return o.COMPRESSED_RGB8_ETC2;if(i===sh)return o.COMPRESSED_RGBA8_ETC2_EAC}if(i===H_||i===G_||i===j_||i===V_||i===z_||i===k_||i===K_||i===Y_||i===X_||i===Q_||i===J_||i===Z_||i===q_||i===$_||i===tv||i===nv||i===rv||i===iv||i===av||i===sv||i===ov||i===lv||i===uv||i===cv||i===fv||i===dv||i===hv||i===pv)return o=e.get("WEBGL_compressed_texture_astc"),o!==null?i:null;if(i===ev)return o=e.get("EXT_texture_compression_bptc"),o!==null?i:null;if(i===Zs)return r?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}class Kh extends nr{constructor(e=[]){super();this.cameras=e}}Kh.prototype.isArrayCamera=!0;class hs extends un{constructor(){super();this.type="Group"}}hs.prototype.isGroup=!0;const Iw={type:"move"};class Yh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new hs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new hs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new hs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,o=null;const l=this._targetRay,u=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(l!==null&&(n=t.getPose(e.targetRaySpace,r),n!==null&&(l.matrix.fromArray(n.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),n.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(n.linearVelocity)):l.hasLinearVelocity=!1,n.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(n.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Iw))),c&&e.hand){o=!0;for(const M of e.hand.values()){const y=t.getJointPose(M,r);if(c.joints[M.jointName]===void 0){const g=new hs;g.matrixAutoUpdate=!1,g.visible=!1,c.joints[M.jointName]=g,c.add(g)}const _=c.joints[M.jointName];y!==null&&(_.matrix.fromArray(y.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=y.radius),_.visible=y!==null}const f=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],p=f.position.distanceTo(h.position),E=.02,v=.005;c.inputState.pinching&&p>E+v?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=E-v&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,r),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1));return l!==null&&(l.visible=n!==null),u!==null&&(u.visible=i!==null),c!==null&&(c.visible=o!==null),this}}class Dw extends ga{constructor(e,t){super();const r=this,n=e.state;let i=null,o=1,l=null,u="local-floor",c=null,f=null,h=null,p=null,E=null,v=!1,M=null,y=null,_=null,g=null,R=null,S=null;const x=[],w=new Map,C=new nr;C.layers.enable(1),C.viewport=new Mn;const b=new nr;b.layers.enable(2),b.viewport=new Mn;const P=[C,b],A=new Kh;A.layers.enable(1),A.layers.enable(2);let I=null,F=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(de){let te=x[de];return te===void 0&&(te=new Yh,x[de]=te),te.getTargetRaySpace()},this.getControllerGrip=function(de){let te=x[de];return te===void 0&&(te=new Yh,x[de]=te),te.getGripSpace()},this.getHand=function(de){let te=x[de];return te===void 0&&(te=new Yh,x[de]=te),te.getHandSpace()};function G(de){const te=w.get(de.inputSource);te&&te.dispatchEvent({type:de.type,data:de.inputSource})}function V(){w.forEach(function(de,te){de.disconnect(te)}),w.clear(),I=null,F=null,n.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),h&&t.deleteFramebuffer(h),M&&t.deleteFramebuffer(M),y&&t.deleteRenderbuffer(y),_&&t.deleteRenderbuffer(_),h=null,M=null,y=null,_=null,E=null,p=null,f=null,i=null,me.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(de){o=de,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(de){u=de,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l},this.getBaseLayer=function(){return p!==null?p:E},this.getBinding=function(){return f},this.getFrame=function(){return g},this.getSession=function(){return i},this.setSession=async function(de){if(i=de,i!==null){i.addEventListener("select",G),i.addEventListener("selectstart",G),i.addEventListener("selectend",G),i.addEventListener("squeeze",G),i.addEventListener("squeezestart",G),i.addEventListener("squeezeend",G),i.addEventListener("end",V),i.addEventListener("inputsourceschange",k);const te=t.getContextAttributes();if(te.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0){const q={antialias:te.antialias,alpha:te.alpha,depth:te.depth,stencil:te.stencil,framebufferScaleFactor:o};E=new XRWebGLLayer(i,t,q),i.updateRenderState({baseLayer:E})}else if(t instanceof WebGLRenderingContext){const q={antialias:!0,alpha:te.alpha,depth:te.depth,stencil:te.stencil,framebufferScaleFactor:o};E=new XRWebGLLayer(i,t,q),i.updateRenderState({layers:[E]})}else{v=te.antialias;let q=null;te.depth&&(S=256,te.stencil&&(S|=1024),R=te.stencil?33306:36096,q=te.stencil?35056:33190);const Z={colorFormat:te.alpha?32856:32849,depthFormat:q,scaleFactor:o};f=new XRWebGLBinding(i,t),p=f.createProjectionLayer(Z),h=t.createFramebuffer(),i.updateRenderState({layers:[p]}),v&&(M=t.createFramebuffer(),y=t.createRenderbuffer(),t.bindRenderbuffer(36161,y),t.renderbufferStorageMultisample(36161,4,32856,p.textureWidth,p.textureHeight),n.bindFramebuffer(36160,M),t.framebufferRenderbuffer(36160,36064,36161,y),t.bindRenderbuffer(36161,null),q!==null&&(_=t.createRenderbuffer(),t.bindRenderbuffer(36161,_),t.renderbufferStorageMultisample(36161,4,q,p.textureWidth,p.textureHeight),t.framebufferRenderbuffer(36160,R,36161,_),t.bindRenderbuffer(36161,null)),n.bindFramebuffer(36160,null))}l=await i.requestReferenceSpace(u),me.setContext(i),me.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function k(de){const te=i.inputSources;for(let q=0;q<x.length;q++)w.set(te[q],x[q]);for(let q=0;q<de.removed.length;q++){const Z=de.removed[q],pe=w.get(Z);pe&&(pe.dispatchEvent({type:"disconnected",data:Z}),w.delete(Z))}for(let q=0;q<de.added.length;q++){const Z=de.added[q],pe=w.get(Z);pe&&pe.dispatchEvent({type:"connected",data:Z})}}const H=new Ie,J=new Ie;function K(de,te,q){H.setFromMatrixPosition(te.matrixWorld),J.setFromMatrixPosition(q.matrixWorld);const Z=H.distanceTo(J),pe=te.projectionMatrix.elements,he=q.projectionMatrix.elements,Q=pe[14]/(pe[10]-1),Y=pe[14]/(pe[10]+1),ie=(pe[9]+1)/pe[5],ue=(pe[9]-1)/pe[5],$=(pe[8]-1)/pe[0],W=(he[8]+1)/he[0],B=Q*$,L=Q*W,D=Z/(-$+W),O=D*-$;te.matrixWorld.decompose(de.position,de.quaternion,de.scale),de.translateX(O),de.translateZ(D),de.matrixWorld.compose(de.position,de.quaternion,de.scale),de.matrixWorldInverse.copy(de.matrixWorld).invert();const U=Q+D,fe=Y+D,ye=B-O,_e=L+(Z-O),ee=ie*Y/fe*U,j=ue*Y/fe*U;de.projectionMatrix.makePerspective(ye,_e,ee,j,U,fe)}function ae(de,te){te===null?de.matrixWorld.copy(de.matrix):de.matrixWorld.multiplyMatrices(te.matrixWorld,de.matrix),de.matrixWorldInverse.copy(de.matrixWorld).invert()}this.updateCamera=function(de){if(i===null)return;A.near=b.near=C.near=de.near,A.far=b.far=C.far=de.far,(I!==A.near||F!==A.far)&&(i.updateRenderState({depthNear:A.near,depthFar:A.far}),I=A.near,F=A.far);const te=de.parent,q=A.cameras;ae(A,te);for(let pe=0;pe<q.length;pe++)ae(q[pe],te);A.matrixWorld.decompose(A.position,A.quaternion,A.scale),de.position.copy(A.position),de.quaternion.copy(A.quaternion),de.scale.copy(A.scale),de.matrix.copy(A.matrix),de.matrixWorld.copy(A.matrixWorld);const Z=de.children;for(let pe=0,he=Z.length;pe<he;pe++)Z[pe].updateMatrixWorld(!0);q.length===2?K(A,C,b):A.projectionMatrix.copy(C.projectionMatrix)},this.getCamera=function(){return A},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(E!==null)return E.fixedFoveation},this.setFoveation=function(de){p!==null&&(p.fixedFoveation=de),E!==null&&E.fixedFoveation!==void 0&&(E.fixedFoveation=de)};let re=null;function le(de,te){if(c=te.getViewerPose(l),g=te,c!==null){const Z=c.views;E!==null&&n.bindXRFramebuffer(E.framebuffer);let pe=!1;Z.length!==A.cameras.length&&(A.cameras.length=0,pe=!0);for(let he=0;he<Z.length;he++){const Q=Z[he];let Y=null;if(E!==null)Y=E.getViewport(Q);else{const ue=f.getViewSubImage(p,Q);n.bindXRFramebuffer(h),ue.depthStencilTexture!==void 0&&t.framebufferTexture2D(36160,R,3553,ue.depthStencilTexture,0),t.framebufferTexture2D(36160,36064,3553,ue.colorTexture,0),Y=ue.viewport}const ie=P[he];ie.matrix.fromArray(Q.transform.matrix),ie.projectionMatrix.fromArray(Q.projectionMatrix),ie.viewport.set(Y.x,Y.y,Y.width,Y.height),he===0&&A.matrix.copy(ie.matrix),pe===!0&&A.cameras.push(ie)}v&&(n.bindXRFramebuffer(M),S!==null&&t.clear(S))}const q=i.inputSources;for(let Z=0;Z<x.length;Z++){const pe=x[Z],he=q[Z];pe.update(he,te,l)}if(re&&re(de,te),v){const Z=p.textureWidth,pe=p.textureHeight;n.bindFramebuffer(36008,M),n.bindFramebuffer(36009,h),t.invalidateFramebuffer(36008,[R]),t.invalidateFramebuffer(36009,[R]),t.blitFramebuffer(0,0,Z,pe,0,0,Z,pe,16384,9728),t.invalidateFramebuffer(36008,[36064]),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),n.bindFramebuffer(36160,M)}g=null}const me=new Jv;me.setAnimationLoop(le),this.setAnimationLoop=function(de){re=de},this.dispose=function(){}}}function Pw(m){function e(_,g){_.fogColor.value.copy(g.color),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)}function t(_,g,R,S,x){g.isMeshBasicMaterial?r(_,g):g.isMeshLambertMaterial?(r(_,g),u(_,g)):g.isMeshToonMaterial?(r(_,g),f(_,g)):g.isMeshPhongMaterial?(r(_,g),c(_,g)):g.isMeshStandardMaterial?(r(_,g),g.isMeshPhysicalMaterial?p(_,g,x):h(_,g)):g.isMeshMatcapMaterial?(r(_,g),E(_,g)):g.isMeshDepthMaterial?(r(_,g),v(_,g)):g.isMeshDistanceMaterial?(r(_,g),M(_,g)):g.isMeshNormalMaterial?(r(_,g),y(_,g)):g.isLineBasicMaterial?(n(_,g),g.isLineDashedMaterial&&i(_,g)):g.isPointsMaterial?o(_,g,R,S):g.isSpriteMaterial?l(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.specularMap&&(_.specularMap.value=g.specularMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);const R=m.get(g).envMap;if(R){_.envMap.value=R,_.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio;const w=m.get(R).__maxMipLevel;w!==void 0&&(_.maxMipLevel.value=w)}g.lightMap&&(_.lightMap.value=g.lightMap,_.lightMapIntensity.value=g.lightMapIntensity),g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity);let S;g.map?S=g.map:g.specularMap?S=g.specularMap:g.displacementMap?S=g.displacementMap:g.normalMap?S=g.normalMap:g.bumpMap?S=g.bumpMap:g.roughnessMap?S=g.roughnessMap:g.metalnessMap?S=g.metalnessMap:g.alphaMap?S=g.alphaMap:g.emissiveMap?S=g.emissiveMap:g.clearcoatMap?S=g.clearcoatMap:g.clearcoatNormalMap?S=g.clearcoatNormalMap:g.clearcoatRoughnessMap?S=g.clearcoatRoughnessMap:g.specularIntensityMap?S=g.specularIntensityMap:g.specularColorMap?S=g.specularColorMap:g.transmissionMap?S=g.transmissionMap:g.thicknessMap?S=g.thicknessMap:g.sheenColorMap?S=g.sheenColorMap:g.sheenRoughnessMap&&(S=g.sheenRoughnessMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),_.uvTransform.value.copy(S.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),_.uv2Transform.value.copy(x.matrix))}function n(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity}function i(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}function o(_,g,R,S){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*R,_.scale.value=S*.5,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),_.uvTransform.value.copy(x.matrix))}function l(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let R;g.map?R=g.map:g.alphaMap&&(R=g.alphaMap),R!==void 0&&(R.matrixAutoUpdate===!0&&R.updateMatrix(),_.uvTransform.value.copy(R.matrix))}function u(_,g){g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap)}function c(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Hn&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Hn&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function f(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Hn&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Hn&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function h(_,g){_.roughness.value=g.roughness,_.metalness.value=g.metalness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Hn&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Hn&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),m.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}function p(_,g,R){h(_,g),_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),_.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===Hn&&_.clearcoatNormalScale.value.negate())),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=R.texture,_.transmissionSamplerSize.value.set(R.width,R.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap)}function E(_,g){g.matcap&&(_.matcap.value=g.matcap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Hn&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Hn&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function v(_,g){g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function M(_,g){g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),_.referencePosition.value.copy(g.referencePosition),_.nearDistance.value=g.nearDistance,_.farDistance.value=g.farDistance}function y(_,g){g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Hn&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Hn&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function ww(){const m=lc("canvas");return m.style.display="block",m}function Sn(m={}){const e=m.canvas!==void 0?m.canvas:ww(),t=m.context!==void 0?m.context:null,r=m.alpha!==void 0?m.alpha:!1,n=m.depth!==void 0?m.depth:!0,i=m.stencil!==void 0?m.stencil:!0,o=m.antialias!==void 0?m.antialias:!1,l=m.premultipliedAlpha!==void 0?m.premultipliedAlpha:!0,u=m.preserveDrawingBuffer!==void 0?m.preserveDrawingBuffer:!1,c=m.powerPreference!==void 0?m.powerPreference:"default",f=m.failIfMajorPerformanceCaveat!==void 0?m.failIfMajorPerformanceCaveat:!1;let h=null,p=null;const E=[],v=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=fr,this.physicallyCorrectLights=!1,this.toneMapping=pa,this.toneMappingExposure=1;const M=this;let y=!1,_=0,g=0,R=null,S=-1,x=null;const w=new Mn,C=new Mn;let b=null,P=e.width,A=e.height,I=1,F=null,G=null;const V=new Mn(0,0,P,A),k=new Mn(0,0,P,A);let H=!1;const J=[],K=new wl;let ae=!1,re=!1,le=null;const me=new zt,de=new Ie,te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function q(){return R===null?I:1}let Z=t;function pe(Ae,Be){for(let We=0;We<Ae.length;We++){const Te=Ae[We],De=e.getContext(Te,Be);if(De!==null)return De}return null}try{const Ae={alpha:r,depth:n,stencil:i,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:f};if(e.addEventListener("webglcontextlost",be,!1),e.addEventListener("webglcontextrestored",Ne,!1),Z===null){const Be=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&Be.shift(),Z=pe(Be,Ae),Z===null)throw pe(Be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Z.getShaderPrecisionFormat===void 0&&(Z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ae){throw console.error("THREE.WebGLRenderer: "+Ae.message),Ae}let he,Q,Y,ie,ue,$,W,B,L,D,O,U,fe,ye,_e,ee,j,X,z,oe,se,ce,Se;function Me(){he=new nP(Z),Q=new QD(Z,he,m),he.init(Q),ce=new DE(Z,he,Q),Y=new Cw(Z,he,Q),J[0]=1029,ie=new aP(Z),ue=new gw,$=new bw(Z,he,Y,ue,Q,ce,ie),W=new ZD(M),B=new tP(M),L=new Eb(Z,Q),Se=new YD(Z,he,L,Q),D=new rP(Z,L,ie,Se),O=new uP(Z,D,L,ie),z=new lP(Z,Q,$),ee=new JD(ue),U=new mw(M,W,B,he,Q,Se,ee),fe=new Pw(ue),ye=new vw(ue),_e=new Aw(he,Q),X=new KD(M,W,Y,O,l),j=new IE(M,O,Q),oe=new XD(Z,he,ie,Q),se=new iP(Z,he,ie,Q),ie.programs=U.programs,M.capabilities=Q,M.extensions=he,M.properties=ue,M.renderLists=ye,M.shadowMap=j,M.state=Y,M.info=ie}Me();const ve=new Dw(M,Z);this.xr=ve,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const Ae=he.get("WEBGL_lose_context");Ae&&Ae.loseContext()},this.forceContextRestore=function(){const Ae=he.get("WEBGL_lose_context");Ae&&Ae.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(Ae){Ae!==void 0&&(I=Ae,this.setSize(P,A,!1))},this.getSize=function(Ae){return Ae.set(P,A)},this.setSize=function(Ae,Be,We){if(ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}P=Ae,A=Be,e.width=Math.floor(Ae*I),e.height=Math.floor(Be*I),We!==!1&&(e.style.width=Ae+"px",e.style.height=Be+"px"),this.setViewport(0,0,Ae,Be)},this.getDrawingBufferSize=function(Ae){return Ae.set(P*I,A*I).floor()},this.setDrawingBufferSize=function(Ae,Be,We){P=Ae,A=Be,I=We,e.width=Math.floor(Ae*We),e.height=Math.floor(Be*We),this.setViewport(0,0,Ae,Be)},this.getCurrentViewport=function(Ae){return Ae.copy(w)},this.getViewport=function(Ae){return Ae.copy(V)},this.setViewport=function(Ae,Be,We,Te){Ae.isVector4?V.set(Ae.x,Ae.y,Ae.z,Ae.w):V.set(Ae,Be,We,Te),Y.viewport(w.copy(V).multiplyScalar(I).floor())},this.getScissor=function(Ae){return Ae.copy(k)},this.setScissor=function(Ae,Be,We,Te){Ae.isVector4?k.set(Ae.x,Ae.y,Ae.z,Ae.w):k.set(Ae,Be,We,Te),Y.scissor(C.copy(k).multiplyScalar(I).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(Ae){Y.setScissorTest(H=Ae)},this.setOpaqueSort=function(Ae){F=Ae},this.setTransparentSort=function(Ae){G=Ae},this.getClearColor=function(Ae){return Ae.copy(X.getClearColor())},this.setClearColor=function(){X.setClearColor.apply(X,arguments)},this.getClearAlpha=function(){return X.getClearAlpha()},this.setClearAlpha=function(){X.setClearAlpha.apply(X,arguments)},this.clear=function(Ae,Be,We){let Te=0;(Ae===void 0||Ae)&&(Te|=16384),(Be===void 0||Be)&&(Te|=256),(We===void 0||We)&&(Te|=1024),Z.clear(Te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",be,!1),e.removeEventListener("webglcontextrestored",Ne,!1),ye.dispose(),_e.dispose(),ue.dispose(),W.dispose(),B.dispose(),O.dispose(),Se.dispose(),ve.dispose(),ve.removeEventListener("sessionstart",Bt),ve.removeEventListener("sessionend",Lt),le&&(le.dispose(),le=null),Pt.stop()};function be(Ae){Ae.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const Ae=ie.autoReset,Be=j.enabled,We=j.autoUpdate,Te=j.needsUpdate,De=j.type;Me(),ie.autoReset=Ae,j.enabled=Be,j.autoUpdate=We,j.needsUpdate=Te,j.type=De}function Ue(Ae){const Be=Ae.target;Be.removeEventListener("dispose",Ue),Xe(Be)}function Xe(Ae){ot(Ae),ue.remove(Ae)}function ot(Ae){const Be=ue.get(Ae).programs;Be!==void 0&&Be.forEach(function(We){U.releaseProgram(We)})}this.renderBufferDirect=function(Ae,Be,We,Te,De,Ze){Be===null&&(Be=te);const nt=De.isMesh&&De.matrixWorld.determinant()<0,ge=it(Ae,Be,We,Te,De);Y.setMaterial(Te,nt);let Pe=We.index;const qe=We.attributes.position;if(Pe===null){if(qe===void 0||qe.count===0)return}else if(Pe.count===0)return;let Ye=1;Te.wireframe===!0&&(Pe=D.getWireframeAttribute(We),Ye=2),Se.setup(De,Te,ge,We,Pe);let $e,ht=oe;Pe!==null&&($e=L.get(Pe),ht=se,ht.setIndex($e));const bt=Pe!==null?Pe.count:qe.count,It=We.drawRange.start*Ye,Dt=We.drawRange.count*Ye,gt=Ze!==null?Ze.start*Ye:0,Yt=Ze!==null?Ze.count*Ye:1/0,An=Math.max(It,gt),bn=Math.min(bt,It+Dt,gt+Yt)-1,tt=Math.max(0,bn-An+1);if(tt!==0){if(De.isMesh)Te.wireframe===!0?(Y.setLineWidth(Te.wireframeLinewidth*q()),ht.setMode(1)):ht.setMode(4);else if(De.isLine){let mt=Te.linewidth;mt===void 0&&(mt=1),Y.setLineWidth(mt*q()),De.isLineSegments?ht.setMode(1):De.isLineLoop?ht.setMode(2):ht.setMode(3)}else De.isPoints?ht.setMode(0):De.isSprite&&ht.setMode(4);if(De.isInstancedMesh)ht.renderInstances(An,tt,De.count);else if(We.isInstancedBufferGeometry){const mt=Math.min(We.instanceCount,We._maxInstanceCount);ht.renderInstances(An,tt,mt)}else ht.render(An,tt)}},this.compile=function(Ae,Be){p=_e.get(Ae),p.init(),v.push(p),Ae.traverseVisible(function(We){We.isLight&&We.layers.test(Be.layers)&&(p.pushLight(We),We.castShadow&&p.pushShadow(We))}),p.setupLights(M.physicallyCorrectLights),Ae.traverse(function(We){const Te=We.material;if(Te)if(Array.isArray(Te))for(let De=0;De<Te.length;De++){const Ze=Te[De];we(Ze,Ae,We)}else we(Te,Ae,We)}),v.pop(),p=null};let ct=null;function xt(Ae){ct&&ct(Ae)}function Bt(){Pt.stop()}function Lt(){Pt.start()}const Pt=new Jv;Pt.setAnimationLoop(xt),typeof window!="undefined"&&Pt.setContext(window),this.setAnimationLoop=function(Ae){ct=Ae,ve.setAnimationLoop(Ae),Ae===null?Pt.stop():Pt.start()},ve.addEventListener("sessionstart",Bt),ve.addEventListener("sessionend",Lt),this.render=function(Ae,Be){if(Be!==void 0&&Be.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;Ae.autoUpdate===!0&&Ae.updateMatrixWorld(),Be.parent===null&&Be.updateMatrixWorld(),ve.enabled===!0&&ve.isPresenting===!0&&(ve.cameraAutoUpdate===!0&&ve.updateCamera(Be),Be=ve.getCamera()),Ae.isScene===!0&&Ae.onBeforeRender(M,Ae,Be,R),p=_e.get(Ae,v.length),p.init(),v.push(p),me.multiplyMatrices(Be.projectionMatrix,Be.matrixWorldInverse),K.setFromProjectionMatrix(me),re=this.localClippingEnabled,ae=ee.init(this.clippingPlanes,re,Be),h=ye.get(Ae,E.length),h.init(),E.push(h),Ht(Ae,Be,0,M.sortObjects),h.finish(),M.sortObjects===!0&&h.sort(F,G),ae===!0&&ee.beginShadows();const We=p.state.shadowsArray;if(j.render(We,Ae,Be),ae===!0&&ee.endShadows(),this.info.autoReset===!0&&this.info.reset(),X.render(h,Ae),p.setupLights(M.physicallyCorrectLights),Be.isArrayCamera){const Te=Be.cameras;for(let De=0,Ze=Te.length;De<Ze;De++){const nt=Te[De];Oe(h,Ae,nt,nt.viewport)}}else Oe(h,Ae,Be);R!==null&&($.updateMultisampleRenderTarget(R),$.updateRenderTargetMipmap(R)),Ae.isScene===!0&&Ae.onAfterRender(M,Ae,Be),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),Se.resetDefaultState(),S=-1,x=null,v.pop(),v.length>0?p=v[v.length-1]:p=null,E.pop(),E.length>0?h=E[E.length-1]:h=null};function Ht(Ae,Be,We,Te){if(Ae.visible===!1)return;if(Ae.layers.test(Be.layers)){if(Ae.isGroup)We=Ae.renderOrder;else if(Ae.isLOD)Ae.autoUpdate===!0&&Ae.update(Be);else if(Ae.isLight)p.pushLight(Ae),Ae.castShadow&&p.pushShadow(Ae);else if(Ae.isSprite){if(!Ae.frustumCulled||K.intersectsSprite(Ae)){Te&&de.setFromMatrixPosition(Ae.matrixWorld).applyMatrix4(me);const nt=O.update(Ae),ge=Ae.material;ge.visible&&h.push(Ae,nt,ge,We,de.z,null)}}else if((Ae.isMesh||Ae.isLine||Ae.isPoints)&&(Ae.isSkinnedMesh&&Ae.skeleton.frame!==ie.render.frame&&(Ae.skeleton.update(),Ae.skeleton.frame=ie.render.frame),!Ae.frustumCulled||K.intersectsObject(Ae))){Te&&de.setFromMatrixPosition(Ae.matrixWorld).applyMatrix4(me);const nt=O.update(Ae),ge=Ae.material;if(Array.isArray(ge)){const Pe=nt.groups;for(let qe=0,Ye=Pe.length;qe<Ye;qe++){const $e=Pe[qe],ht=ge[$e.materialIndex];ht&&ht.visible&&h.push(Ae,nt,ht,We,de.z,$e)}}else ge.visible&&h.push(Ae,nt,ge,We,de.z,null)}}const Ze=Ae.children;for(let nt=0,ge=Ze.length;nt<ge;nt++)Ht(Ze[nt],Be,We,Te)}function Oe(Ae,Be,We,Te){const De=Ae.opaque,Ze=Ae.transmissive,nt=Ae.transparent;p.setupLightsView(We),Ze.length>0&&ze(De,Be,We),Te&&Y.viewport(w.copy(Te)),De.length>0&&Fe(De,Be,We),Ze.length>0&&Fe(Ze,Be,We),nt.length>0&&Fe(nt,Be,We)}function ze(Ae,Be,We){if(le===null){const nt=o===!0&&Q.isWebGL2===!0?mh:oi;le=new nt(1024,1024,{generateMipmaps:!0,type:ce.convert($a)!==null?$a:ki,minFilter:qa,magFilter:kn,wrapS:ur,wrapT:ur})}const Te=M.getRenderTarget();M.setRenderTarget(le),M.clear();const De=M.toneMapping;M.toneMapping=pa,Fe(Ae,Be,We),M.toneMapping=De,$.updateMultisampleRenderTarget(le),$.updateRenderTargetMipmap(le),M.setRenderTarget(Te)}function Fe(Ae,Be,We){const Te=Be.isScene===!0?Be.overrideMaterial:null;for(let De=0,Ze=Ae.length;De<Ze;De++){const nt=Ae[De],ge=nt.object,Pe=nt.geometry,qe=Te===null?nt.material:Te,Ye=nt.group;ge.layers.test(We.layers)&&Ce(ge,Be,We,Pe,qe,Ye)}}function Ce(Ae,Be,We,Te,De,Ze){Ae.onBeforeRender(M,Be,We,Te,De,Ze),Ae.modelViewMatrix.multiplyMatrices(We.matrixWorldInverse,Ae.matrixWorld),Ae.normalMatrix.getNormalMatrix(Ae.modelViewMatrix),De.onBeforeRender(M,Be,We,Te,Ae,Ze),De.transparent===!0&&De.side===Xa?(De.side=Hn,De.needsUpdate=!0,M.renderBufferDirect(We,Be,Te,De,Ae,Ze),De.side=Ya,De.needsUpdate=!0,M.renderBufferDirect(We,Be,Te,De,Ae,Ze),De.side=Xa):M.renderBufferDirect(We,Be,Te,De,Ae,Ze),Ae.onAfterRender(M,Be,We,Te,De,Ze)}function we(Ae,Be,We){Be.isScene!==!0&&(Be=te);const Te=ue.get(Ae),De=p.state.lights,Ze=p.state.shadowsArray,nt=De.state.version,ge=U.getParameters(Ae,De.state,Ze,Be,We),Pe=U.getProgramCacheKey(ge);let qe=Te.programs;Te.environment=Ae.isMeshStandardMaterial?Be.environment:null,Te.fog=Be.fog,Te.envMap=(Ae.isMeshStandardMaterial?B:W).get(Ae.envMap||Te.environment),qe===void 0&&(Ae.addEventListener("dispose",Ue),qe=new Map,Te.programs=qe);let Ye=qe.get(Pe);if(Ye!==void 0){if(Te.currentProgram===Ye&&Te.lightsStateVersion===nt)return Qe(Ae,ge),Ye}else ge.uniforms=U.getUniforms(Ae),Ae.onBuild(We,ge,M),Ae.onBeforeCompile(ge,M),Ye=U.acquireProgram(ge,Pe),qe.set(Pe,Ye),Te.uniforms=ge.uniforms;const $e=Te.uniforms;(!Ae.isShaderMaterial&&!Ae.isRawShaderMaterial||Ae.clipping===!0)&&($e.clippingPlanes=ee.uniform),Qe(Ae,ge),Te.needsLights=at(Ae),Te.lightsStateVersion=nt,Te.needsLights&&($e.ambientLightColor.value=De.state.ambient,$e.lightProbe.value=De.state.probe,$e.directionalLights.value=De.state.directional,$e.directionalLightShadows.value=De.state.directionalShadow,$e.spotLights.value=De.state.spot,$e.spotLightShadows.value=De.state.spotShadow,$e.rectAreaLights.value=De.state.rectArea,$e.ltc_1.value=De.state.rectAreaLTC1,$e.ltc_2.value=De.state.rectAreaLTC2,$e.pointLights.value=De.state.point,$e.pointLightShadows.value=De.state.pointShadow,$e.hemisphereLights.value=De.state.hemi,$e.directionalShadowMap.value=De.state.directionalShadowMap,$e.directionalShadowMatrix.value=De.state.directionalShadowMatrix,$e.spotShadowMap.value=De.state.spotShadowMap,$e.spotShadowMatrix.value=De.state.spotShadowMatrix,$e.pointShadowMap.value=De.state.pointShadowMap,$e.pointShadowMatrix.value=De.state.pointShadowMatrix);const ht=Ye.getUniforms(),bt=ba.seqWithValue(ht.seq,$e);return Te.currentProgram=Ye,Te.uniformsList=bt,Ye}function Qe(Ae,Be){const We=ue.get(Ae);We.outputEncoding=Be.outputEncoding,We.instancing=Be.instancing,We.skinning=Be.skinning,We.morphTargets=Be.morphTargets,We.morphNormals=Be.morphNormals,We.morphTargetsCount=Be.morphTargetsCount,We.numClippingPlanes=Be.numClippingPlanes,We.numIntersection=Be.numClipIntersection,We.vertexAlphas=Be.vertexAlphas,We.vertexTangents=Be.vertexTangents}function it(Ae,Be,We,Te,De){Be.isScene!==!0&&(Be=te),$.resetTextureUnits();const Ze=Be.fog,nt=Te.isMeshStandardMaterial?Be.environment:null,ge=R===null?M.outputEncoding:R.texture.encoding,Pe=(Te.isMeshStandardMaterial?B:W).get(Te.envMap||nt),qe=Te.vertexColors===!0&&!!We.attributes.color&&We.attributes.color.itemSize===4,Ye=!!Te.normalMap&&!!We.attributes.tangent,$e=!!We.morphAttributes.position,ht=!!We.morphAttributes.normal,bt=We.morphAttributes.position?We.morphAttributes.position.length:0,It=ue.get(Te),Dt=p.state.lights;if(ae===!0&&(re===!0||Ae!==x)){const Ve=Ae===x&&Te.id===S;ee.setState(Te,Ae,Ve)}let gt=!1;Te.version===It.__version?(It.needsLights&&It.lightsStateVersion!==Dt.state.version||It.outputEncoding!==ge||De.isInstancedMesh&&It.instancing===!1||!De.isInstancedMesh&&It.instancing===!0||De.isSkinnedMesh&&It.skinning===!1||!De.isSkinnedMesh&&It.skinning===!0||It.envMap!==Pe||Te.fog&&It.fog!==Ze||It.numClippingPlanes!==void 0&&(It.numClippingPlanes!==ee.numPlanes||It.numIntersection!==ee.numIntersection)||It.vertexAlphas!==qe||It.vertexTangents!==Ye||It.morphTargets!==$e||It.morphNormals!==ht||Q.isWebGL2===!0&&It.morphTargetsCount!==bt)&&(gt=!0):(gt=!0,It.__version=Te.version);let Yt=It.currentProgram;gt===!0&&(Yt=we(Te,Be,De));let An=!1,bn=!1,tt=!1;const mt=Yt.getUniforms(),wt=It.uniforms;if(Y.useProgram(Yt.program)&&(An=!0,bn=!0,tt=!0),Te.id!==S&&(S=Te.id,bn=!0),An||x!==Ae){if(mt.setValue(Z,"projectionMatrix",Ae.projectionMatrix),Q.logarithmicDepthBuffer&&mt.setValue(Z,"logDepthBufFC",2/(Math.log(Ae.far+1)/Math.LN2)),x!==Ae&&(x=Ae,bn=!0,tt=!0),Te.isShaderMaterial||Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshStandardMaterial||Te.envMap){const Ve=mt.map.cameraPosition;Ve!==void 0&&Ve.setValue(Z,de.setFromMatrixPosition(Ae.matrixWorld))}(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial)&&mt.setValue(Z,"isOrthographic",Ae.isOrthographicCamera===!0),(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial||Te.isShadowMaterial||De.isSkinnedMesh)&&mt.setValue(Z,"viewMatrix",Ae.matrixWorldInverse)}if(De.isSkinnedMesh){mt.setOptional(Z,De,"bindMatrix"),mt.setOptional(Z,De,"bindMatrixInverse");const Ve=De.skeleton;Ve&&(Q.floatVertexTextures?(Ve.boneTexture===null&&Ve.computeBoneTexture(),mt.setValue(Z,"boneTexture",Ve.boneTexture,$),mt.setValue(Z,"boneTextureSize",Ve.boneTextureSize)):mt.setOptional(Z,Ve,"boneMatrices"))}return!!We&&(We.morphAttributes.position!==void 0||We.morphAttributes.normal!==void 0)&&z.update(De,We,Te,Yt),(bn||It.receiveShadow!==De.receiveShadow)&&(It.receiveShadow=De.receiveShadow,mt.setValue(Z,"receiveShadow",De.receiveShadow)),bn&&(mt.setValue(Z,"toneMappingExposure",M.toneMappingExposure),It.needsLights&&st(wt,tt),Ze&&Te.fog&&fe.refreshFogUniforms(wt,Ze),fe.refreshMaterialUniforms(wt,Te,I,A,le),ba.upload(Z,It.uniformsList,wt,$)),Te.isShaderMaterial&&Te.uniformsNeedUpdate===!0&&(ba.upload(Z,It.uniformsList,wt,$),Te.uniformsNeedUpdate=!1),Te.isSpriteMaterial&&mt.setValue(Z,"center",De.center),mt.setValue(Z,"modelViewMatrix",De.modelViewMatrix),mt.setValue(Z,"normalMatrix",De.normalMatrix),mt.setValue(Z,"modelMatrix",De.matrixWorld),Yt}function st(Ae,Be){Ae.ambientLightColor.needsUpdate=Be,Ae.lightProbe.needsUpdate=Be,Ae.directionalLights.needsUpdate=Be,Ae.directionalLightShadows.needsUpdate=Be,Ae.pointLights.needsUpdate=Be,Ae.pointLightShadows.needsUpdate=Be,Ae.spotLights.needsUpdate=Be,Ae.spotLightShadows.needsUpdate=Be,Ae.rectAreaLights.needsUpdate=Be,Ae.hemisphereLights.needsUpdate=Be}function at(Ae){return Ae.isMeshLambertMaterial||Ae.isMeshToonMaterial||Ae.isMeshPhongMaterial||Ae.isMeshStandardMaterial||Ae.isShadowMaterial||Ae.isShaderMaterial&&Ae.lights===!0}this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return g},this.getRenderTarget=function(){return R},this.setRenderTarget=function(Ae,Be=0,We=0){R=Ae,_=Be,g=We,Ae&&ue.get(Ae).__webglFramebuffer===void 0&&$.setupRenderTarget(Ae);let Te=null,De=!1,Ze=!1;if(Ae){const ge=Ae.texture;(ge.isDataTexture3D||ge.isDataTexture2DArray)&&(Ze=!0);const Pe=ue.get(Ae).__webglFramebuffer;Ae.isWebGLCubeRenderTarget?(Te=Pe[Be],De=!0):Ae.isWebGLMultisampleRenderTarget?Te=ue.get(Ae).__webglMultisampledFramebuffer:Te=Pe,w.copy(Ae.viewport),C.copy(Ae.scissor),b=Ae.scissorTest}else w.copy(V).multiplyScalar(I).floor(),C.copy(k).multiplyScalar(I).floor(),b=H;if(Y.bindFramebuffer(36160,Te)&&Q.drawBuffers){let ge=!1;if(Ae)if(Ae.isWebGLMultipleRenderTargets){const Pe=Ae.texture;if(J.length!==Pe.length||J[0]!==36064){for(let qe=0,Ye=Pe.length;qe<Ye;qe++)J[qe]=36064+qe;J.length=Pe.length,ge=!0}}else(J.length!==1||J[0]!==36064)&&(J[0]=36064,J.length=1,ge=!0);else(J.length!==1||J[0]!==1029)&&(J[0]=1029,J.length=1,ge=!0);ge&&(Q.isWebGL2?Z.drawBuffers(J):he.get("WEBGL_draw_buffers").drawBuffersWEBGL(J))}if(Y.viewport(w),Y.scissor(C),Y.setScissorTest(b),De){const ge=ue.get(Ae.texture);Z.framebufferTexture2D(36160,36064,34069+Be,ge.__webglTexture,We)}else if(Ze){const ge=ue.get(Ae.texture),Pe=Be||0;Z.framebufferTextureLayer(36160,36064,ge.__webglTexture,We||0,Pe)}S=-1},this.readRenderTargetPixels=function(Ae,Be,We,Te,De,Ze,nt){if(!(Ae&&Ae.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ge=ue.get(Ae).__webglFramebuffer;if(Ae.isWebGLCubeRenderTarget&&nt!==void 0&&(ge=ge[nt]),ge){Y.bindFramebuffer(36160,ge);try{const Pe=Ae.texture,qe=Pe.format,Ye=Pe.type;if(qe!==cr&&ce.convert(qe)!==Z.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const $e=Ye===$a&&(he.has("EXT_color_buffer_half_float")||Q.isWebGL2&&he.has("EXT_color_buffer_float"));if(Ye!==ki&&ce.convert(Ye)!==Z.getParameter(35738)&&!(Ye===yi&&(Q.isWebGL2||he.has("OES_texture_float")||he.has("WEBGL_color_buffer_float")))&&!$e){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Z.checkFramebufferStatus(36160)===36053?Be>=0&&Be<=Ae.width-Te&&We>=0&&We<=Ae.height-De&&Z.readPixels(Be,We,Te,De,ce.convert(qe),ce.convert(Ye),Ze):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Pe=R!==null?ue.get(R).__webglFramebuffer:null;Y.bindFramebuffer(36160,Pe)}}},this.copyFramebufferToTexture=function(Ae,Be,We=0){const Te=Math.pow(2,-We),De=Math.floor(Be.image.width*Te),Ze=Math.floor(Be.image.height*Te);let nt=ce.convert(Be.format);Q.isWebGL2&&(nt===6407&&(nt=32849),nt===6408&&(nt=32856)),$.setTexture2D(Be,0),Z.copyTexImage2D(3553,We,nt,Ae.x,Ae.y,De,Ze,0),Y.unbindTexture()},this.copyTextureToTexture=function(Ae,Be,We,Te=0){const De=Be.image.width,Ze=Be.image.height,nt=ce.convert(We.format),ge=ce.convert(We.type);$.setTexture2D(We,0),Z.pixelStorei(37440,We.flipY),Z.pixelStorei(37441,We.premultiplyAlpha),Z.pixelStorei(3317,We.unpackAlignment),Be.isDataTexture?Z.texSubImage2D(3553,Te,Ae.x,Ae.y,De,Ze,nt,ge,Be.image.data):Be.isCompressedTexture?Z.compressedTexSubImage2D(3553,Te,Ae.x,Ae.y,Be.mipmaps[0].width,Be.mipmaps[0].height,nt,Be.mipmaps[0].data):Z.texSubImage2D(3553,Te,Ae.x,Ae.y,nt,ge,Be.image),Te===0&&We.generateMipmaps&&Z.generateMipmap(3553),Y.unbindTexture()},this.copyTextureToTexture3D=function(Ae,Be,We,Te,De=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ze=Ae.max.x-Ae.min.x+1,nt=Ae.max.y-Ae.min.y+1,ge=Ae.max.z-Ae.min.z+1,Pe=ce.convert(Te.format),qe=ce.convert(Te.type);let Ye;if(Te.isDataTexture3D)$.setTexture3D(Te,0),Ye=32879;else if(Te.isDataTexture2DArray)$.setTexture2DArray(Te,0),Ye=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Z.pixelStorei(37440,Te.flipY),Z.pixelStorei(37441,Te.premultiplyAlpha),Z.pixelStorei(3317,Te.unpackAlignment);const $e=Z.getParameter(3314),ht=Z.getParameter(32878),bt=Z.getParameter(3316),It=Z.getParameter(3315),Dt=Z.getParameter(32877),gt=We.isCompressedTexture?We.mipmaps[0]:We.image;Z.pixelStorei(3314,gt.width),Z.pixelStorei(32878,gt.height),Z.pixelStorei(3316,Ae.min.x),Z.pixelStorei(3315,Ae.min.y),Z.pixelStorei(32877,Ae.min.z),We.isDataTexture||We.isDataTexture3D?Z.texSubImage3D(Ye,De,Be.x,Be.y,Be.z,Ze,nt,ge,Pe,qe,gt.data):We.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Z.compressedTexSubImage3D(Ye,De,Be.x,Be.y,Be.z,Ze,nt,ge,Pe,gt.data)):Z.texSubImage3D(Ye,De,Be.x,Be.y,Be.z,Ze,nt,ge,Pe,qe,gt),Z.pixelStorei(3314,$e),Z.pixelStorei(32878,ht),Z.pixelStorei(3316,bt),Z.pixelStorei(3315,It),Z.pixelStorei(32877,Dt),De===0&&Te.generateMipmaps&&Z.generateMipmap(Ye),Y.unbindTexture()},this.initTexture=function(Ae){$.setTexture2D(Ae,0),Y.unbindTexture()},this.resetState=function(){_=0,g=0,R=null,Y.reset(),Se.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Sn.prototype.isWebGLRenderer=!0;class PE extends Sn{}PE.prototype.isWebGL1Renderer=!0;class Fl{constructor(e,t=25e-5){this.name="",this.color=new Ft(e),this.density=t}clone(){return new Fl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Fl.prototype.isFogExp2=!0;class Bl{constructor(e,t=1,r=1e3){this.name="",this.color=new Ft(e),this.near=t,this.far=r}clone(){return new Bl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Bl.prototype.isFog=!0;class Nc extends un{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}Nc.prototype.isScene=!0;class ps{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=$s,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Wr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ps.prototype.isInterleavedBuffer=!0;const jn=new Ie;class Ia{constructor(e,t,r,n=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)jn.x=this.getX(t),jn.y=this.getY(t),jn.z=this.getZ(t),jn.applyMatrix4(e),this.setXYZ(t,jn.x,jn.y,jn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)jn.x=this.getX(t),jn.y=this.getY(t),jn.z=this.getZ(t),jn.applyNormalMatrix(e),this.setXYZ(t,jn.x,jn.y,jn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)jn.x=this.getX(t),jn.y=this.getY(t),jn.z=this.getZ(t),jn.transformDirection(e),this.setXYZ(t,jn.x,jn.y,jn.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const n=r*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[n+i])}return new hn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ia(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const n=r*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[n+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ia.prototype.isInterleavedBufferAttribute=!0;class Fc extends er{constructor(e){super();this.type="SpriteMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}Fc.prototype.isSpriteMaterial=!0;let So;const Ul=new Ie,Ao=new Ie,xo=new Ie,Ro=new Et,Wl=new Et,wE=new zt,Bc=new Ie,Hl=new Ie,Uc=new Ie,OE=new Et,Xh=new Et,LE=new Et;class Wc extends un{constructor(e){super();if(this.type="Sprite",So===void 0){So=new Jt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new ps(t,5);So.setIndex([0,1,2,0,2,3]),So.setAttribute("position",new Ia(r,3,0,!1)),So.setAttribute("uv",new Ia(r,2,3,!1))}this.geometry=So,this.material=e!==void 0?e:new Fc,this.center=new Et(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ao.setFromMatrixScale(this.matrixWorld),wE.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),xo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ao.multiplyScalar(-xo.z);const r=this.material.rotation;let n,i;r!==0&&(i=Math.cos(r),n=Math.sin(r));const o=this.center;Hc(Bc.set(-.5,-.5,0),xo,o,Ao,n,i),Hc(Hl.set(.5,-.5,0),xo,o,Ao,n,i),Hc(Uc.set(.5,.5,0),xo,o,Ao,n,i),OE.set(0,0),Xh.set(1,0),LE.set(1,1);let l=e.ray.intersectTriangle(Bc,Hl,Uc,!1,Ul);if(l===null&&(Hc(Hl.set(-.5,.5,0),xo,o,Ao,n,i),Xh.set(0,1),l=e.ray.intersectTriangle(Bc,Uc,Hl,!1,Ul),l===null))return;const u=e.ray.origin.distanceTo(Ul);u<e.near||u>e.far||t.push({distance:u,point:Ul.clone(),uv:Gn.getUV(Ul,Bc,Hl,Uc,OE,Xh,LE,new Et),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}Wc.prototype.isSprite=!0;function Hc(m,e,t,r,n,i){Ro.subVectors(m,t).addScalar(.5).multiply(r),n!==void 0?(Wl.x=i*Ro.x-n*Ro.y,Wl.y=n*Ro.x+i*Ro.y):Wl.copy(Ro),m.copy(e),m.x+=Wl.x,m.y+=Wl.y,m.applyMatrix4(wE)}const Gc=new Ie,NE=new Ie;class FE extends un{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,n=t.length;r<n;r++){const i=t[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const r=this.levels;let n;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){Gc.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Gc);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Gc.setFromMatrixPosition(e.matrixWorld),NE.setFromMatrixPosition(this.matrixWorld);const r=Gc.distanceTo(NE)/e.zoom;t[0].object.visible=!0;let n,i;for(n=1,i=t.length;n<i&&r>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<i;n++)t[n].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let n=0,i=r.length;n<i;n++){const o=r[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}const BE=new Ie,UE=new Mn,WE=new Mn,Ow=new Ie,HE=new zt;class jc extends Kn{constructor(e,t){super(e,t);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zt,this.bindMatrixInverse=new zt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Mn,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const r=this.skeleton,n=this.geometry;UE.fromBufferAttribute(n.attributes.skinIndex,e),WE.fromBufferAttribute(n.attributes.skinWeight,e),BE.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const o=WE.getComponent(i);if(o!==0){const l=UE.getComponent(i);HE.multiplyMatrices(r.bones[l].matrixWorld,r.boneInverses[l]),t.addScaledVector(Ow.copy(BE).applyMatrix4(HE),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}jc.prototype.isSkinnedMesh=!0;class Vc extends un{constructor(){super();this.type="Bone"}}Vc.prototype.isBone=!0;class ms extends qn{constructor(e=null,t=1,r=1,n,i,o,l,u,c=kn,f=kn,h,p){super(null,o,l,u,c,f,n,i,h,p);this.image={data:e,width:t,height:r},this.magFilter=c,this.minFilter=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}ms.prototype.isDataTexture=!0;const GE=new zt,Lw=new zt;class zc{constructor(e=[],t=[]){this.uuid=Wr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new zt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new zt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let i=0,o=e.length;i<o;i++){const l=e[i]?e[i].matrixWorld:Lw;GE.multiplyMatrices(l,t[i]),GE.toArray(r,i*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new zc(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Av(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new ms(t,e,e,cr,yi);return this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){const i=e.bones[r];let o=t[i];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new Vc),this.bones.push(o),this.boneInverses.push(new zt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){const o=t[n];e.bones.push(o.uuid);const l=r[n];e.boneInverses.push(l.toArray())}return e}}class gs extends hn{constructor(e,t,r,n=1){typeof r=="number"&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(e,t,r);this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}gs.prototype.isInstancedBufferAttribute=!0;const jE=new zt,VE=new zt,kc=[],Gl=new Kn;class Qh extends Kn{constructor(e,t,r){super(e,t);this.instanceMatrix=new gs(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,n=this.count;if(Gl.geometry=this.geometry,Gl.material=this.material,Gl.material!==void 0)for(let i=0;i<n;i++){this.getMatrixAt(i,jE),VE.multiplyMatrices(r,jE),Gl.matrixWorld=VE,Gl.raycast(e,kc);for(let o=0,l=kc.length;o<l;o++){const u=kc[o];u.instanceId=i,u.object=this,t.push(u)}kc.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new gs(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Qh.prototype.isInstancedMesh=!0;class rr extends er{constructor(e){super();this.type="LineBasicMaterial",this.color=new Ft(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}rr.prototype.isLineBasicMaterial=!0;const zE=new Ie,kE=new Ie,KE=new zt,Jh=new Ta,Kc=new Ea;class ea extends un{constructor(e=new Jt,t=new rr){super();this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,r=[0];for(let n=1,i=t.count;n<i;n++)zE.fromBufferAttribute(t,n-1),kE.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=zE.distanceTo(kE);e.setAttribute("lineDistance",new jt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Kc.copy(r.boundingSphere),Kc.applyMatrix4(n),Kc.radius+=i,e.ray.intersectsSphere(Kc)===!1)return;KE.copy(n).invert(),Jh.copy(e.ray).applyMatrix4(KE);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=new Ie,f=new Ie,h=new Ie,p=new Ie,E=this.isLineSegments?2:1;if(r.isBufferGeometry){const v=r.index,y=r.attributes.position;if(v!==null){const _=Math.max(0,o.start),g=Math.min(v.count,o.start+o.count);for(let R=_,S=g-1;R<S;R+=E){const x=v.getX(R),w=v.getX(R+1);if(c.fromBufferAttribute(y,x),f.fromBufferAttribute(y,w),Jh.distanceSqToSegment(c,f,p,h)>u)continue;p.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(p);b<e.near||b>e.far||t.push({distance:b,point:h.clone().applyMatrix4(this.matrixWorld),index:R,face:null,faceIndex:null,object:this})}}else{const _=Math.max(0,o.start),g=Math.min(y.count,o.start+o.count);for(let R=_,S=g-1;R<S;R+=E){if(c.fromBufferAttribute(y,R),f.fromBufferAttribute(y,R+1),Jh.distanceSqToSegment(c,f,p,h)>u)continue;p.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(p);w<e.near||w>e.far||t.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:R,face:null,faceIndex:null,object:this})}}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=n.length;i<o;i++){const l=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}ea.prototype.isLine=!0;const YE=new Ie,XE=new Ie;class wr extends ea{constructor(e,t){super(e,t);this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,r=[];for(let n=0,i=t.count;n<i;n+=2)YE.fromBufferAttribute(t,n),XE.fromBufferAttribute(t,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+YE.distanceTo(XE);e.setAttribute("lineDistance",new jt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}wr.prototype.isLineSegments=!0;class Zh extends ea{constructor(e,t){super(e,t);this.type="LineLoop"}}Zh.prototype.isLineLoop=!0;class _s extends er{constructor(e){super();this.type="PointsMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}_s.prototype.isPointsMaterial=!0;const QE=new zt,qh=new Ta,Yc=new Ea,Xc=new Ie;class jl extends un{constructor(e=new Jt,t=new _s){super();this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Yc.copy(r.boundingSphere),Yc.applyMatrix4(n),Yc.radius+=i,e.ray.intersectsSphere(Yc)===!1)return;QE.copy(n).invert(),qh.copy(e.ray).applyMatrix4(QE);const l=i/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l;if(r.isBufferGeometry){const c=r.index,h=r.attributes.position;if(c!==null){const p=Math.max(0,o.start),E=Math.min(c.count,o.start+o.count);for(let v=p,M=E;v<M;v++){const y=c.getX(v);Xc.fromBufferAttribute(h,y),JE(Xc,y,u,n,e,t,this)}}else{const p=Math.max(0,o.start),E=Math.min(h.count,o.start+o.count);for(let v=p,M=E;v<M;v++)Xc.fromBufferAttribute(h,v),JE(Xc,v,u,n,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=n.length;i<o;i++){const l=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=i}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}jl.prototype.isPoints=!0;function JE(m,e,t,r,n,i,o){const l=qh.distanceSqToPoint(m);if(l<t){const u=new Ie;qh.closestPointToPoint(m,u),u.applyMatrix4(r);const c=n.ray.origin.distanceTo(u);if(c<n.near||c>n.far)return;i.push({distance:c,distanceToRay:Math.sqrt(l),point:u,index:e,face:null,object:o})}}class ZE extends qn{constructor(e,t,r,n,i,o,l,u,c){super(e,t,r,n,i,o,l,u,c);this.format=l!==void 0?l:es,this.minFilter=o!==void 0?o:Jn,this.magFilter=i!==void 0?i:Jn,this.generateMipmaps=!1;const f=this;function h(){f.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}ZE.prototype.isVideoTexture=!0;class $h extends qn{constructor(e,t,r,n,i,o,l,u,c,f,h,p){super(null,o,l,u,c,f,n,i,h,p);this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}$h.prototype.isCompressedTexture=!0;class qE extends qn{constructor(e,t,r,n,i,o,l,u,c){super(e,t,r,n,i,o,l,u,c);this.needsUpdate=!0}}qE.prototype.isCanvasTexture=!0;class $E extends qn{constructor(e,t,r,n,i,o,l,u,c,f){if(f=f!==void 0?f:ts,f!==ts&&f!==qs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&f===ts&&(r=yl),r===void 0&&f===qs&&(r=Zs);super(null,n,i,o,l,u,f,r,c);this.image={width:e,height:t},this.magFilter=l!==void 0?l:kn,this.minFilter=u!==void 0?u:kn,this.flipY=!1,this.generateMipmaps=!1}}$E.prototype.isDepthTexture=!0;class Co extends Jt{constructor(e=1,t=8,r=0,n=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},t=Math.max(3,t);const i=[],o=[],l=[],u=[],c=new Ie,f=new Et;o.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(let h=0,p=3;h<=t;h++,p+=3){const E=r+h/t*n;c.x=e*Math.cos(E),c.y=e*Math.sin(E),o.push(c.x,c.y,c.z),l.push(0,0,1),f.x=(o[p]/e+1)/2,f.y=(o[p+1]/e+1)/2,u.push(f.x,f.y)}for(let h=1;h<=t;h++)i.push(h,h+1,0);this.setIndex(i),this.setAttribute("position",new jt(o,3)),this.setAttribute("normal",new jt(l,3)),this.setAttribute("uv",new jt(u,2))}static fromJSON(e){return new Co(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Da extends Jt{constructor(e=1,t=1,r=1,n=8,i=1,o=!1,l=0,u=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:l,thetaLength:u};const c=this;n=Math.floor(n),i=Math.floor(i);const f=[],h=[],p=[],E=[];let v=0;const M=[],y=r/2;let _=0;g(),o===!1&&(e>0&&R(!0),t>0&&R(!1)),this.setIndex(f),this.setAttribute("position",new jt(h,3)),this.setAttribute("normal",new jt(p,3)),this.setAttribute("uv",new jt(E,2));function g(){const S=new Ie,x=new Ie;let w=0;const C=(t-e)/r;for(let b=0;b<=i;b++){const P=[],A=b/i,I=A*(t-e)+e;for(let F=0;F<=n;F++){const G=F/n,V=G*u+l,k=Math.sin(V),H=Math.cos(V);x.x=I*k,x.y=-A*r+y,x.z=I*H,h.push(x.x,x.y,x.z),S.set(k,C,H).normalize(),p.push(S.x,S.y,S.z),E.push(G,1-A),P.push(v++)}M.push(P)}for(let b=0;b<n;b++)for(let P=0;P<i;P++){const A=M[P][b],I=M[P+1][b],F=M[P+1][b+1],G=M[P][b+1];f.push(A,I,G),f.push(I,F,G),w+=6}c.addGroup(_,w,0),_+=w}function R(S){const x=v,w=new Et,C=new Ie;let b=0;const P=S===!0?e:t,A=S===!0?1:-1;for(let F=1;F<=n;F++)h.push(0,y*A,0),p.push(0,A,0),E.push(.5,.5),v++;const I=v;for(let F=0;F<=n;F++){const V=F/n*u+l,k=Math.cos(V),H=Math.sin(V);C.x=P*H,C.y=y*A,C.z=P*k,h.push(C.x,C.y,C.z),p.push(0,A,0),w.x=k*.5+.5,w.y=H*.5*A+.5,E.push(w.x,w.y),v++}for(let F=0;F<n;F++){const G=x+F,V=I+F;S===!0?f.push(V,V+1,G):f.push(V+1,V,G),b+=3}c.addGroup(_,b,S===!0?1:2),_+=b}}static fromJSON(e){return new Da(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bo extends Da{constructor(e=1,t=1,r=8,n=1,i=!1,o=0,l=Math.PI*2){super(0,e,t,r,n,i,o,l);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:l}}static fromJSON(e){return new bo(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Si extends Jt{constructor(e=[],t=[],r=1,n=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};const i=[],o=[];l(n),c(r),f(),this.setAttribute("position",new jt(i,3)),this.setAttribute("normal",new jt(i.slice(),3)),this.setAttribute("uv",new jt(o,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function l(g){const R=new Ie,S=new Ie,x=new Ie;for(let w=0;w<t.length;w+=3)E(t[w+0],R),E(t[w+1],S),E(t[w+2],x),u(R,S,x,g)}function u(g,R,S,x){const w=x+1,C=[];for(let b=0;b<=w;b++){C[b]=[];const P=g.clone().lerp(S,b/w),A=R.clone().lerp(S,b/w),I=w-b;for(let F=0;F<=I;F++)F===0&&b===w?C[b][F]=P:C[b][F]=P.clone().lerp(A,F/I)}for(let b=0;b<w;b++)for(let P=0;P<2*(w-b)-1;P++){const A=Math.floor(P/2);P%2==0?(p(C[b][A+1]),p(C[b+1][A]),p(C[b][A])):(p(C[b][A+1]),p(C[b+1][A+1]),p(C[b+1][A]))}}function c(g){const R=new Ie;for(let S=0;S<i.length;S+=3)R.x=i[S+0],R.y=i[S+1],R.z=i[S+2],R.normalize().multiplyScalar(g),i[S+0]=R.x,i[S+1]=R.y,i[S+2]=R.z}function f(){const g=new Ie;for(let R=0;R<i.length;R+=3){g.x=i[R+0],g.y=i[R+1],g.z=i[R+2];const S=y(g)/2/Math.PI+.5,x=_(g)/Math.PI+.5;o.push(S,1-x)}v(),h()}function h(){for(let g=0;g<o.length;g+=6){const R=o[g+0],S=o[g+2],x=o[g+4],w=Math.max(R,S,x),C=Math.min(R,S,x);w>.9&&C<.1&&(R<.2&&(o[g+0]+=1),S<.2&&(o[g+2]+=1),x<.2&&(o[g+4]+=1))}}function p(g){i.push(g.x,g.y,g.z)}function E(g,R){const S=g*3;R.x=e[S+0],R.y=e[S+1],R.z=e[S+2]}function v(){const g=new Ie,R=new Ie,S=new Ie,x=new Ie,w=new Et,C=new Et,b=new Et;for(let P=0,A=0;P<i.length;P+=9,A+=6){g.set(i[P+0],i[P+1],i[P+2]),R.set(i[P+3],i[P+4],i[P+5]),S.set(i[P+6],i[P+7],i[P+8]),w.set(o[A+0],o[A+1]),C.set(o[A+2],o[A+3]),b.set(o[A+4],o[A+5]),x.copy(g).add(R).add(S).divideScalar(3);const I=y(x);M(w,A+0,g,I),M(C,A+2,R,I),M(b,A+4,S,I)}}function M(g,R,S,x){x<0&&g.x===1&&(o[R]=g.x-1),S.x===0&&S.z===0&&(o[R]=x/2/Math.PI+.5)}function y(g){return Math.atan2(g.z,-g.x)}function _(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(e){return new Si(e.vertices,e.indices,e.radius,e.details)}}class Io extends Si{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(i,o,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Io(e.radius,e.detail)}}const Qc=new Ie,Jc=new Ie,ep=new Ie,Zc=new Gn;class tp extends Jt{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const n=Math.pow(10,4),i=Math.cos(as*t),o=e.getIndex(),l=e.getAttribute("position"),u=o?o.count:l.count,c=[0,0,0],f=["a","b","c"],h=new Array(3),p={},E=[];for(let v=0;v<u;v+=3){o?(c[0]=o.getX(v),c[1]=o.getX(v+1),c[2]=o.getX(v+2)):(c[0]=v,c[1]=v+1,c[2]=v+2);const{a:M,b:y,c:_}=Zc;if(M.fromBufferAttribute(l,c[0]),y.fromBufferAttribute(l,c[1]),_.fromBufferAttribute(l,c[2]),Zc.getNormal(ep),h[0]=`${Math.round(M.x*n)},${Math.round(M.y*n)},${Math.round(M.z*n)}`,h[1]=`${Math.round(y.x*n)},${Math.round(y.y*n)},${Math.round(y.z*n)}`,h[2]=`${Math.round(_.x*n)},${Math.round(_.y*n)},${Math.round(_.z*n)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let g=0;g<3;g++){const R=(g+1)%3,S=h[g],x=h[R],w=Zc[f[g]],C=Zc[f[R]],b=`${S}_${x}`,P=`${x}_${S}`;P in p&&p[P]?(ep.dot(p[P].normal)<=i&&(E.push(w.x,w.y,w.z),E.push(C.x,C.y,C.z)),p[P]=null):b in p||(p[b]={index0:c[g],index1:c[R],normal:ep.clone()})}}for(const v in p)if(p[v]){const{index0:M,index1:y}=p[v];Qc.fromBufferAttribute(l,M),Jc.fromBufferAttribute(l,y),E.push(Qc.x,Qc.y,Qc.z),E.push(Jc.x,Jc.y,Jc.z)}this.setAttribute("position",new jt(E,3))}}}class Vr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,n=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),i+=r.distanceTo(n),t.push(i),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let n=0;const i=r.length;let o;t?o=t:o=e*r[i-1];let l=0,u=i-1,c;for(;l<=u;)if(n=Math.floor(l+(u-l)/2),c=r[n]-o,c<0)l=n+1;else if(c>0)u=n-1;else{u=n;break}if(n=u,r[n]===o)return n/(i-1);const f=r[n],p=r[n+1]-f,E=(o-f)/p;return(n+E)/(i-1)}getTangent(e,t){const r=1e-4;let n=e-r,i=e+r;n<0&&(n=0),i>1&&(i=1);const o=this.getPoint(n),l=this.getPoint(i),u=t||(o.isVector2?new Et:new Ie);return u.copy(l).sub(o).normalize(),u}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Ie,n=[],i=[],o=[],l=new Ie,u=new zt;for(let E=0;E<=e;E++){const v=E/e;n[E]=this.getTangentAt(v,new Ie)}i[0]=new Ie,o[0]=new Ie;let c=Number.MAX_VALUE;const f=Math.abs(n[0].x),h=Math.abs(n[0].y),p=Math.abs(n[0].z);f<=c&&(c=f,r.set(1,0,0)),h<=c&&(c=h,r.set(0,1,0)),p<=c&&r.set(0,0,1),l.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],l),o[0].crossVectors(n[0],i[0]);for(let E=1;E<=e;E++){if(i[E]=i[E-1].clone(),o[E]=o[E-1].clone(),l.crossVectors(n[E-1],n[E]),l.length()>Number.EPSILON){l.normalize();const v=Math.acos(hr(n[E-1].dot(n[E]),-1,1));i[E].applyMatrix4(u.makeRotationAxis(l,v))}o[E].crossVectors(n[E],i[E])}if(t===!0){let E=Math.acos(hr(i[0].dot(i[e]),-1,1));E/=e,n[0].dot(l.crossVectors(i[0],i[e]))>0&&(E=-E);for(let v=1;v<=e;v++)i[v].applyMatrix4(u.makeRotationAxis(n[v],E*v)),o[v].crossVectors(n[v],i[v])}return{tangents:n,normals:i,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Vl extends Vr{constructor(e=0,t=0,r=1,n=1,i=0,o=Math.PI*2,l=!1,u=0){super();this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(e,t){const r=t||new Et,n=Math.PI*2;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(o?i=0:i=n),this.aClockwise===!0&&!o&&(i===n?i=-n:i=i-n);const l=this.aStartAngle+e*i;let u=this.aX+this.xRadius*Math.cos(l),c=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const f=Math.cos(this.aRotation),h=Math.sin(this.aRotation),p=u-this.aX,E=c-this.aY;u=p*f-E*h+this.aX,c=p*h+E*f+this.aY}return r.set(u,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Vl.prototype.isEllipseCurve=!0;class np extends Vl{constructor(e,t,r,n,i,o){super(e,t,r,r,n,i,o);this.type="ArcCurve"}}np.prototype.isArcCurve=!0;function rp(){let m=0,e=0,t=0,r=0;function n(i,o,l,u){m=i,e=l,t=-3*i+3*o-2*l-u,r=2*i-2*o+l+u}return{initCatmullRom:function(i,o,l,u,c){n(o,l,c*(l-i),c*(u-o))},initNonuniformCatmullRom:function(i,o,l,u,c,f,h){let p=(o-i)/c-(l-i)/(c+f)+(l-o)/f,E=(l-o)/f-(u-o)/(f+h)+(u-l)/h;p*=f,E*=f,n(o,l,p,E)},calc:function(i){const o=i*i,l=o*i;return m+e*i+t*o+r*l}}}const qc=new Ie,ip=new rp,ap=new rp,sp=new rp;class op extends Vr{constructor(e=[],t=!1,r="centripetal",n=.5){super();this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new Ie){const r=t,n=this.points,i=n.length,o=(i-(this.closed?0:1))*e;let l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:u===0&&l===i-1&&(l=i-2,u=1);let c,f;this.closed||l>0?c=n[(l-1)%i]:(qc.subVectors(n[0],n[1]).add(n[0]),c=qc);const h=n[l%i],p=n[(l+1)%i];if(this.closed||l+2<i?f=n[(l+2)%i]:(qc.subVectors(n[i-1],n[i-2]).add(n[i-1]),f=qc),this.curveType==="centripetal"||this.curveType==="chordal"){const E=this.curveType==="chordal"?.5:.25;let v=Math.pow(c.distanceToSquared(h),E),M=Math.pow(h.distanceToSquared(p),E),y=Math.pow(p.distanceToSquared(f),E);M<1e-4&&(M=1),v<1e-4&&(v=M),y<1e-4&&(y=M),ip.initNonuniformCatmullRom(c.x,h.x,p.x,f.x,v,M,y),ap.initNonuniformCatmullRom(c.y,h.y,p.y,f.y,v,M,y),sp.initNonuniformCatmullRom(c.z,h.z,p.z,f.z,v,M,y)}else this.curveType==="catmullrom"&&(ip.initCatmullRom(c.x,h.x,p.x,f.x,this.tension),ap.initCatmullRom(c.y,h.y,p.y,f.y,this.tension),sp.initCatmullRom(c.z,h.z,p.z,f.z,this.tension));return r.set(ip.calc(u),ap.calc(u),sp.calc(u)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const n=e.points[t];this.points.push(new Ie().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}op.prototype.isCatmullRomCurve3=!0;function ey(m,e,t,r,n){const i=(r-e)*.5,o=(n-t)*.5,l=m*m,u=m*l;return(2*t-2*r+i+o)*u+(-3*t+3*r-2*i-o)*l+i*m+t}function Nw(m,e){const t=1-m;return t*t*e}function Fw(m,e){return 2*(1-m)*m*e}function Bw(m,e){return m*m*e}function zl(m,e,t,r){return Nw(m,e)+Fw(m,t)+Bw(m,r)}function Uw(m,e){const t=1-m;return t*t*t*e}function Ww(m,e){const t=1-m;return 3*t*t*m*e}function Hw(m,e){return 3*(1-m)*m*m*e}function Gw(m,e){return m*m*m*e}function kl(m,e,t,r,n){return Uw(m,e)+Ww(m,t)+Hw(m,r)+Gw(m,n)}class $c extends Vr{constructor(e=new Et,t=new Et,r=new Et,n=new Et){super();this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new Et){const r=t,n=this.v0,i=this.v1,o=this.v2,l=this.v3;return r.set(kl(e,n.x,i.x,o.x,l.x),kl(e,n.y,i.y,o.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}$c.prototype.isCubicBezierCurve=!0;class lp extends Vr{constructor(e=new Ie,t=new Ie,r=new Ie,n=new Ie){super();this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new Ie){const r=t,n=this.v0,i=this.v1,o=this.v2,l=this.v3;return r.set(kl(e,n.x,i.x,o.x,l.x),kl(e,n.y,i.y,o.y,l.y),kl(e,n.z,i.z,o.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}lp.prototype.isCubicBezierCurve3=!0;class Kl extends Vr{constructor(e=new Et,t=new Et){super();this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Et){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const r=t||new Et;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Kl.prototype.isLineCurve=!0;class ty extends Vr{constructor(e=new Ie,t=new Ie){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Ie){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ef extends Vr{constructor(e=new Et,t=new Et,r=new Et){super();this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Et){const r=t,n=this.v0,i=this.v1,o=this.v2;return r.set(zl(e,n.x,i.x,o.x),zl(e,n.y,i.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}ef.prototype.isQuadraticBezierCurve=!0;class tf extends Vr{constructor(e=new Ie,t=new Ie,r=new Ie){super();this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ie){const r=t,n=this.v0,i=this.v1,o=this.v2;return r.set(zl(e,n.x,i.x,o.x),zl(e,n.y,i.y,o.y),zl(e,n.z,i.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}tf.prototype.isQuadraticBezierCurve3=!0;class nf extends Vr{constructor(e=[]){super();this.type="SplineCurve",this.points=e}getPoint(e,t=new Et){const r=t,n=this.points,i=(n.length-1)*e,o=Math.floor(i),l=i-o,u=n[o===0?o:o-1],c=n[o],f=n[o>n.length-2?n.length-1:o+1],h=n[o>n.length-3?n.length-1:o+2];return r.set(ey(l,u.x,c.x,f.x,h.x),ey(l,u.y,c.y,f.y,h.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const n=e.points[t];this.points.push(new Et().fromArray(n))}return this}}nf.prototype.isSplineCurve=!0;var up=Object.freeze({__proto__:null,ArcCurve:np,CatmullRomCurve3:op,CubicBezierCurve:$c,CubicBezierCurve3:lp,EllipseCurve:Vl,LineCurve:Kl,LineCurve3:ty,QuadraticBezierCurve:ef,QuadraticBezierCurve3:tf,SplineCurve:nf});class ny extends Vr{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Kl(t,e))}getPoint(e,t){const r=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=r){const o=n[i]-r,l=this.curves[i],u=l.getLength(),c=u===0?0:1-o/u;return l.getPointAt(c,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let n=0,i=this.curves;n<i.length;n++){const o=i[n],l=o&&o.isEllipseCurve?e*2:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,u=o.getPoints(l);for(let c=0;c<u.length;c++){const f=u[c];r&&r.equals(f)||(t.push(f),r=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const n=e.curves[t];this.curves.push(new up[n.type]().fromJSON(n))}return this}}class Yl extends ny{constructor(e){super();this.type="Path",this.currentPoint=new Et,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new Kl(this.currentPoint.clone(),new Et(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){const i=new ef(this.currentPoint.clone(),new Et(e,t),new Et(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,o){const l=new $c(this.currentPoint.clone(),new Et(e,t),new Et(r,n),new Et(i,o));return this.curves.push(l),this.currentPoint.set(i,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new nf(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,o){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+l,t+u,r,n,i,o),this}absarc(e,t,r,n,i,o){return this.absellipse(e,t,r,r,n,i,o),this}ellipse(e,t,r,n,i,o,l,u){const c=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+c,t+f,r,n,i,o,l,u),this}absellipse(e,t,r,n,i,o,l,u){const c=new Vl(e,t,r,n,i,o,l,u);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const f=c.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ai extends Yl{constructor(e){super(e);this.uuid=Wr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const n=e.holes[t];this.holes.push(new Yl().fromJSON(n))}return this}}const jw={triangulate:function(m,e,t=2){const r=e&&e.length,n=r?e[0]*t:m.length;let i=ry(m,0,n,t,!0);const o=[];if(!i||i.next===i.prev)return o;let l,u,c,f,h,p,E;if(r&&(i=Yw(m,e,i,t)),m.length>80*t){l=c=m[0],u=f=m[1];for(let v=t;v<n;v+=t)h=m[v],p=m[v+1],h<l&&(l=h),p<u&&(u=p),h>c&&(c=h),p>f&&(f=p);E=Math.max(c-l,f-u),E=E!==0?1/E:0}return Xl(i,o,t,l,u,E),o}};function ry(m,e,t,r,n){let i,o;if(n===iO(m,e,t,r)>0)for(i=e;i<t;i+=r)o=sy(i,m[i],m[i+1],o);else for(i=t-r;i>=e;i-=r)o=sy(i,m[i],m[i+1],o);return o&&rf(o,o.next)&&(Jl(o),o=o.next),o}function Pa(m,e){if(!m)return m;e||(e=m);let t=m,r;do if(r=!1,!t.steiner&&(rf(t,t.next)||Ln(t.prev,t,t.next)===0)){if(Jl(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function Xl(m,e,t,r,n,i,o){if(!m)return;!o&&i&&qw(m,r,n,i);let l=m,u,c;for(;m.prev!==m.next;){if(u=m.prev,c=m.next,i?zw(m,r,n,i):Vw(m)){e.push(u.i/t),e.push(m.i/t),e.push(c.i/t),Jl(m),m=c.next,l=c.next;continue}if(m=c,m===l){o?o===1?(m=kw(Pa(m),e,t),Xl(m,e,t,r,n,i,2)):o===2&&Kw(m,e,t,r,n,i):Xl(Pa(m),e,t,r,n,i,1);break}}}function Vw(m){const e=m.prev,t=m,r=m.next;if(Ln(e,t,r)>=0)return!1;let n=m.next.next;for(;n!==m.prev;){if(Do(e.x,e.y,t.x,t.y,r.x,r.y,n.x,n.y)&&Ln(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function zw(m,e,t,r){const n=m.prev,i=m,o=m.next;if(Ln(n,i,o)>=0)return!1;const l=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,u=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,c=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,f=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y,h=cp(l,u,e,t,r),p=cp(c,f,e,t,r);let E=m.prevZ,v=m.nextZ;for(;E&&E.z>=h&&v&&v.z<=p;){if(E!==m.prev&&E!==m.next&&Do(n.x,n.y,i.x,i.y,o.x,o.y,E.x,E.y)&&Ln(E.prev,E,E.next)>=0||(E=E.prevZ,v!==m.prev&&v!==m.next&&Do(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&Ln(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;E&&E.z>=h;){if(E!==m.prev&&E!==m.next&&Do(n.x,n.y,i.x,i.y,o.x,o.y,E.x,E.y)&&Ln(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;v&&v.z<=p;){if(v!==m.prev&&v!==m.next&&Do(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&Ln(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function kw(m,e,t){let r=m;do{const n=r.prev,i=r.next.next;!rf(n,i)&&iy(n,r,r.next,i)&&Ql(n,i)&&Ql(i,n)&&(e.push(n.i/t),e.push(r.i/t),e.push(i.i/t),Jl(r),Jl(r.next),r=m=i),r=r.next}while(r!==m);return Pa(r)}function Kw(m,e,t,r,n,i){let o=m;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&tO(o,l)){let u=ay(o,l);o=Pa(o,o.next),u=Pa(u,u.next),Xl(o,e,t,r,n,i),Xl(u,e,t,r,n,i);return}l=l.next}o=o.next}while(o!==m)}function Yw(m,e,t,r){const n=[];let i,o,l,u,c;for(i=0,o=e.length;i<o;i++)l=e[i]*r,u=i<o-1?e[i+1]*r:m.length,c=ry(m,l,u,r,!1),c===c.next&&(c.steiner=!0),n.push(eO(c));for(n.sort(Xw),i=0;i<n.length;i++)Qw(n[i],t),t=Pa(t,t.next);return t}function Xw(m,e){return m.x-e.x}function Qw(m,e){if(e=Jw(m,e),e){const t=ay(e,m);Pa(e,e.next),Pa(t,t.next)}}function Jw(m,e){let t=e;const r=m.x,n=m.y;let i=-1/0,o;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){const p=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=r&&p>i){if(i=p,p===r){if(n===t.y)return t;if(n===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(r===i)return o;const l=o,u=o.x,c=o.y;let f=1/0,h;t=o;do r>=t.x&&t.x>=u&&r!==t.x&&Do(n<c?r:i,n,u,c,n<c?i:r,n,t.x,t.y)&&(h=Math.abs(n-t.y)/(r-t.x),Ql(t,m)&&(h<f||h===f&&(t.x>o.x||t.x===o.x&&Zw(o,t)))&&(o=t,f=h)),t=t.next;while(t!==l);return o}function Zw(m,e){return Ln(m.prev,m,e.prev)<0&&Ln(e.next,m,m.next)<0}function qw(m,e,t,r){let n=m;do n.z===null&&(n.z=cp(n.x,n.y,e,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==m);n.prevZ.nextZ=null,n.prevZ=null,$w(n)}function $w(m){let e,t,r,n,i,o,l,u,c=1;do{for(t=m,m=null,i=null,o=0;t;){for(o++,r=t,l=0,e=0;e<c&&(l++,r=r.nextZ,!!r);e++);for(u=c;l>0||u>0&&r;)l!==0&&(u===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,l--):(n=r,r=r.nextZ,u--),i?i.nextZ=n:m=n,n.prevZ=i,i=n;t=r}i.nextZ=null,c*=2}while(o>1);return m}function cp(m,e,t,r,n){return m=32767*(m-t)*n,e=32767*(e-r)*n,m=(m|m<<8)&16711935,m=(m|m<<4)&252645135,m=(m|m<<2)&858993459,m=(m|m<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,m|e<<1}function eO(m){let e=m,t=m;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==m);return t}function Do(m,e,t,r,n,i,o,l){return(n-o)*(e-l)-(m-o)*(i-l)>=0&&(m-o)*(r-l)-(t-o)*(e-l)>=0&&(t-o)*(i-l)-(n-o)*(r-l)>=0}function tO(m,e){return m.next.i!==e.i&&m.prev.i!==e.i&&!nO(m,e)&&(Ql(m,e)&&Ql(e,m)&&rO(m,e)&&(Ln(m.prev,m,e.prev)||Ln(m,e.prev,e))||rf(m,e)&&Ln(m.prev,m,m.next)>0&&Ln(e.prev,e,e.next)>0)}function Ln(m,e,t){return(e.y-m.y)*(t.x-e.x)-(e.x-m.x)*(t.y-e.y)}function rf(m,e){return m.x===e.x&&m.y===e.y}function iy(m,e,t,r){const n=sf(Ln(m,e,t)),i=sf(Ln(m,e,r)),o=sf(Ln(t,r,m)),l=sf(Ln(t,r,e));return!!(n!==i&&o!==l||n===0&&af(m,t,e)||i===0&&af(m,r,e)||o===0&&af(t,m,r)||l===0&&af(t,e,r))}function af(m,e,t){return e.x<=Math.max(m.x,t.x)&&e.x>=Math.min(m.x,t.x)&&e.y<=Math.max(m.y,t.y)&&e.y>=Math.min(m.y,t.y)}function sf(m){return m>0?1:m<0?-1:0}function nO(m,e){let t=m;do{if(t.i!==m.i&&t.next.i!==m.i&&t.i!==e.i&&t.next.i!==e.i&&iy(t,t.next,m,e))return!0;t=t.next}while(t!==m);return!1}function Ql(m,e){return Ln(m.prev,m,m.next)<0?Ln(m,e,m.next)>=0&&Ln(m,m.prev,e)>=0:Ln(m,e,m.prev)<0||Ln(m,m.next,e)<0}function rO(m,e){let t=m,r=!1;const n=(m.x+e.x)/2,i=(m.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&n<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==m);return r}function ay(m,e){const t=new fp(m.i,m.x,m.y),r=new fp(e.i,e.x,e.y),n=m.next,i=e.prev;return m.next=e,e.prev=m,t.next=n,n.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function sy(m,e,t,r){const n=new fp(m,e,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Jl(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function fp(m,e,t){this.i=m,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iO(m,e,t,r){let n=0;for(let i=e,o=t-r;i<t;i+=r)n+=(m[o]-m[i])*(m[i+1]+m[o+1]),o=i;return n}class xi{static area(e){const t=e.length;let r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return r*.5}static isClockWise(e){return xi.area(e)<0}static triangulateShape(e,t){const r=[],n=[],i=[];oy(e),ly(r,e);let o=e.length;t.forEach(oy);for(let u=0;u<t.length;u++)n.push(o),o+=t[u].length,ly(r,t[u]);const l=jw.triangulate(r,n);for(let u=0;u<l.length;u+=3)i.push(l.slice(u,u+3));return i}}function oy(m){const e=m.length;e>2&&m[e-1].equals(m[0])&&m.pop()}function ly(m,e){for(let t=0;t<e.length;t++)m.push(e[t].x),m.push(e[t].y)}class Ri extends Jt{constructor(e=new Ai([new Et(.5,.5),new Et(-.5,.5),new Et(-.5,-.5),new Et(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,n=[],i=[];for(let l=0,u=e.length;l<u;l++){const c=e[l];o(c)}this.setAttribute("position",new jt(n,3)),this.setAttribute("uv",new jt(i,2)),this.computeVertexNormals();function o(l){const u=[],c=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1;let h=t.depth!==void 0?t.depth:1,p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,E=t.bevelThickness!==void 0?t.bevelThickness:.2,v=t.bevelSize!==void 0?t.bevelSize:E-.1,M=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3;const _=t.extrudePath,g=t.UVGenerator!==void 0?t.UVGenerator:aO;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),h=t.amount);let R,S=!1,x,w,C,b;_&&(R=_.getSpacedPoints(f),S=!0,p=!1,x=_.computeFrenetFrames(f,!1),w=new Ie,C=new Ie,b=new Ie),p||(y=0,E=0,v=0,M=0);const P=l.extractPoints(c);let A=P.shape;const I=P.holes;if(!xi.isClockWise(A)){A=A.reverse();for(let ue=0,$=I.length;ue<$;ue++){const W=I[ue];xi.isClockWise(W)&&(I[ue]=W.reverse())}}const G=xi.triangulateShape(A,I),V=A;for(let ue=0,$=I.length;ue<$;ue++){const W=I[ue];A=A.concat(W)}function k(ue,$,W){return $||console.error("THREE.ExtrudeGeometry: vec does not exist"),$.clone().multiplyScalar(W).add(ue)}const H=A.length,J=G.length;function K(ue,$,W){let B,L,D;const O=ue.x-$.x,U=ue.y-$.y,fe=W.x-ue.x,ye=W.y-ue.y,_e=O*O+U*U,ee=O*ye-U*fe;if(Math.abs(ee)>Number.EPSILON){const j=Math.sqrt(_e),X=Math.sqrt(fe*fe+ye*ye),z=$.x-U/j,oe=$.y+O/j,se=W.x-ye/X,ce=W.y+fe/X,Se=((se-z)*ye-(ce-oe)*fe)/(O*ye-U*fe);B=z+O*Se-ue.x,L=oe+U*Se-ue.y;const Me=B*B+L*L;if(Me<=2)return new Et(B,L);D=Math.sqrt(Me/2)}else{let j=!1;O>Number.EPSILON?fe>Number.EPSILON&&(j=!0):O<-Number.EPSILON?fe<-Number.EPSILON&&(j=!0):Math.sign(U)===Math.sign(ye)&&(j=!0),j?(B=-U,L=O,D=Math.sqrt(_e)):(B=O,L=U,D=Math.sqrt(_e/2))}return new Et(B/D,L/D)}const ae=[];for(let ue=0,$=V.length,W=$-1,B=ue+1;ue<$;ue++,W++,B++)W===$&&(W=0),B===$&&(B=0),ae[ue]=K(V[ue],V[W],V[B]);const re=[];let le,me=ae.concat();for(let ue=0,$=I.length;ue<$;ue++){const W=I[ue];le=[];for(let B=0,L=W.length,D=L-1,O=B+1;B<L;B++,D++,O++)D===L&&(D=0),O===L&&(O=0),le[B]=K(W[B],W[D],W[O]);re.push(le),me=me.concat(le)}for(let ue=0;ue<y;ue++){const $=ue/y,W=E*Math.cos($*Math.PI/2),B=v*Math.sin($*Math.PI/2)+M;for(let L=0,D=V.length;L<D;L++){const O=k(V[L],ae[L],B);pe(O.x,O.y,-W)}for(let L=0,D=I.length;L<D;L++){const O=I[L];le=re[L];for(let U=0,fe=O.length;U<fe;U++){const ye=k(O[U],le[U],B);pe(ye.x,ye.y,-W)}}}const de=v+M;for(let ue=0;ue<H;ue++){const $=p?k(A[ue],me[ue],de):A[ue];S?(C.copy(x.normals[0]).multiplyScalar($.x),w.copy(x.binormals[0]).multiplyScalar($.y),b.copy(R[0]).add(C).add(w),pe(b.x,b.y,b.z)):pe($.x,$.y,0)}for(let ue=1;ue<=f;ue++)for(let $=0;$<H;$++){const W=p?k(A[$],me[$],de):A[$];S?(C.copy(x.normals[ue]).multiplyScalar(W.x),w.copy(x.binormals[ue]).multiplyScalar(W.y),b.copy(R[ue]).add(C).add(w),pe(b.x,b.y,b.z)):pe(W.x,W.y,h/f*ue)}for(let ue=y-1;ue>=0;ue--){const $=ue/y,W=E*Math.cos($*Math.PI/2),B=v*Math.sin($*Math.PI/2)+M;for(let L=0,D=V.length;L<D;L++){const O=k(V[L],ae[L],B);pe(O.x,O.y,h+W)}for(let L=0,D=I.length;L<D;L++){const O=I[L];le=re[L];for(let U=0,fe=O.length;U<fe;U++){const ye=k(O[U],le[U],B);S?pe(ye.x,ye.y+R[f-1].y,R[f-1].x+W):pe(ye.x,ye.y,h+W)}}}te(),q();function te(){const ue=n.length/3;if(p){let $=0,W=H*$;for(let B=0;B<J;B++){const L=G[B];he(L[2]+W,L[1]+W,L[0]+W)}$=f+y*2,W=H*$;for(let B=0;B<J;B++){const L=G[B];he(L[0]+W,L[1]+W,L[2]+W)}}else{for(let $=0;$<J;$++){const W=G[$];he(W[2],W[1],W[0])}for(let $=0;$<J;$++){const W=G[$];he(W[0]+H*f,W[1]+H*f,W[2]+H*f)}}r.addGroup(ue,n.length/3-ue,0)}function q(){const ue=n.length/3;let $=0;Z(V,$),$+=V.length;for(let W=0,B=I.length;W<B;W++){const L=I[W];Z(L,$),$+=L.length}r.addGroup(ue,n.length/3-ue,1)}function Z(ue,$){let W=ue.length;for(;--W>=0;){const B=W;let L=W-1;L<0&&(L=ue.length-1);for(let D=0,O=f+y*2;D<O;D++){const U=H*D,fe=H*(D+1),ye=$+B+U,_e=$+L+U,ee=$+L+fe,j=$+B+fe;Q(ye,_e,ee,j)}}}function pe(ue,$,W){u.push(ue),u.push($),u.push(W)}function he(ue,$,W){Y(ue),Y($),Y(W);const B=n.length/3,L=g.generateTopUV(r,n,B-3,B-2,B-1);ie(L[0]),ie(L[1]),ie(L[2])}function Q(ue,$,W,B){Y(ue),Y($),Y(B),Y($),Y(W),Y(B);const L=n.length/3,D=g.generateSideWallUV(r,n,L-6,L-3,L-2,L-1);ie(D[0]),ie(D[1]),ie(D[3]),ie(D[1]),ie(D[2]),ie(D[3])}function Y(ue){n.push(u[ue*3+0]),n.push(u[ue*3+1]),n.push(u[ue*3+2])}function ie(ue){i.push(ue.x),i.push(ue.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return sO(t,r,e)}static fromJSON(e,t){const r=[];for(let i=0,o=e.shapes.length;i<o;i++){const l=t[e.shapes[i]];r.push(l)}const n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new up[n.type]().fromJSON(n)),new Ri(r,e.options)}}const aO={generateTopUV:function(m,e,t,r,n){const i=e[t*3],o=e[t*3+1],l=e[r*3],u=e[r*3+1],c=e[n*3],f=e[n*3+1];return[new Et(i,o),new Et(l,u),new Et(c,f)]},generateSideWallUV:function(m,e,t,r,n,i){const o=e[t*3],l=e[t*3+1],u=e[t*3+2],c=e[r*3],f=e[r*3+1],h=e[r*3+2],p=e[n*3],E=e[n*3+1],v=e[n*3+2],M=e[i*3],y=e[i*3+1],_=e[i*3+2];return Math.abs(l-f)<Math.abs(o-c)?[new Et(o,1-u),new Et(c,1-h),new Et(p,1-v),new Et(M,1-_)]:[new Et(l,1-u),new Et(f,1-h),new Et(E,1-v),new Et(y,1-_)]}};function sO(m,e,t){if(t.shapes=[],Array.isArray(m))for(let r=0,n=m.length;r<n;r++){const i=m[r];t.shapes.push(i.uuid)}else t.shapes.push(m.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Po extends Si{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,i,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Po(e.radius,e.detail)}}class wo extends Jt{constructor(e=[new Et(0,.5),new Et(.5,0),new Et(0,-.5)],t=12,r=0,n=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=hr(n,0,Math.PI*2);const i=[],o=[],l=[],u=1/t,c=new Ie,f=new Et;for(let h=0;h<=t;h++){const p=r+h*u*n,E=Math.sin(p),v=Math.cos(p);for(let M=0;M<=e.length-1;M++)c.x=e[M].x*E,c.y=e[M].y,c.z=e[M].x*v,o.push(c.x,c.y,c.z),f.x=h/t,f.y=M/(e.length-1),l.push(f.x,f.y)}for(let h=0;h<t;h++)for(let p=0;p<e.length-1;p++){const E=p+h*e.length,v=E,M=E+e.length,y=E+e.length+1,_=E+1;i.push(v,M,_),i.push(M,y,_)}if(this.setIndex(i),this.setAttribute("position",new jt(o,3)),this.setAttribute("uv",new jt(l,2)),this.computeVertexNormals(),n===Math.PI*2){const h=this.attributes.normal.array,p=new Ie,E=new Ie,v=new Ie,M=t*e.length*3;for(let y=0,_=0;y<e.length;y++,_+=3)p.x=h[_+0],p.y=h[_+1],p.z=h[_+2],E.x=h[M+_+0],E.y=h[M+_+1],E.z=h[M+_+2],v.addVectors(p,E).normalize(),h[_+0]=h[M+_+0]=v.x,h[_+1]=h[M+_+1]=v.y,h[_+2]=h[M+_+2]=v.z}}static fromJSON(e){return new wo(e.points,e.segments,e.phiStart,e.phiLength)}}class vs extends Si{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,n,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vs(e.radius,e.detail)}}class Oo extends Jt{constructor(e=.5,t=1,r=8,n=1,i=0,o=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},r=Math.max(3,r),n=Math.max(1,n);const l=[],u=[],c=[],f=[];let h=e;const p=(t-e)/n,E=new Ie,v=new Et;for(let M=0;M<=n;M++){for(let y=0;y<=r;y++){const _=i+y/r*o;E.x=h*Math.cos(_),E.y=h*Math.sin(_),u.push(E.x,E.y,E.z),c.push(0,0,1),v.x=(E.x/t+1)/2,v.y=(E.y/t+1)/2,f.push(v.x,v.y)}h+=p}for(let M=0;M<n;M++){const y=M*(r+1);for(let _=0;_<r;_++){const g=_+y,R=g,S=g+r+1,x=g+r+2,w=g+1;l.push(R,S,w),l.push(S,x,w)}}this.setIndex(l),this.setAttribute("position",new jt(u,3)),this.setAttribute("normal",new jt(c,3)),this.setAttribute("uv",new jt(f,2))}static fromJSON(e){return new Oo(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Es extends Jt{constructor(e=new Ai([new Et(0,.5),new Et(-.5,-.5),new Et(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],n=[],i=[],o=[];let l=0,u=0;if(Array.isArray(e)===!1)c(e);else for(let f=0;f<e.length;f++)c(e[f]),this.addGroup(l,u,f),l+=u,u=0;this.setIndex(r),this.setAttribute("position",new jt(n,3)),this.setAttribute("normal",new jt(i,3)),this.setAttribute("uv",new jt(o,2));function c(f){const h=n.length/3,p=f.extractPoints(t);let E=p.shape;const v=p.holes;xi.isClockWise(E)===!1&&(E=E.reverse());for(let y=0,_=v.length;y<_;y++){const g=v[y];xi.isClockWise(g)===!0&&(v[y]=g.reverse())}const M=xi.triangulateShape(E,v);for(let y=0,_=v.length;y<_;y++){const g=v[y];E=E.concat(g)}for(let y=0,_=E.length;y<_;y++){const g=E[y];n.push(g.x,g.y,0),i.push(0,0,1),o.push(g.x,g.y)}for(let y=0,_=M.length;y<_;y++){const g=M[y],R=g[0]+h,S=g[1]+h,x=g[2]+h;r.push(R,S,x),u+=3}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return oO(t,e)}static fromJSON(e,t){const r=[];for(let n=0,i=e.shapes.length;n<i;n++){const o=t[e.shapes[n]];r.push(o)}return new Es(r,e.curveSegments)}}function oO(m,e){if(e.shapes=[],Array.isArray(m))for(let t=0,r=m.length;t<r;t++){const n=m[t];e.shapes.push(n.uuid)}else e.shapes.push(m.uuid);return e}class ys extends Jt{constructor(e=1,t=32,r=16,n=0,i=Math.PI*2,o=0,l=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const u=Math.min(o+l,Math.PI);let c=0;const f=[],h=new Ie,p=new Ie,E=[],v=[],M=[],y=[];for(let _=0;_<=r;_++){const g=[],R=_/r;let S=0;_==0&&o==0?S=.5/t:_==r&&u==Math.PI&&(S=-.5/t);for(let x=0;x<=t;x++){const w=x/t;h.x=-e*Math.cos(n+w*i)*Math.sin(o+R*l),h.y=e*Math.cos(o+R*l),h.z=e*Math.sin(n+w*i)*Math.sin(o+R*l),v.push(h.x,h.y,h.z),p.copy(h).normalize(),M.push(p.x,p.y,p.z),y.push(w+S,1-R),g.push(c++)}f.push(g)}for(let _=0;_<r;_++)for(let g=0;g<t;g++){const R=f[_][g+1],S=f[_][g],x=f[_+1][g],w=f[_+1][g+1];(_!==0||o>0)&&E.push(R,S,w),(_!==r-1||u<Math.PI)&&E.push(S,x,w)}this.setIndex(E),this.setAttribute("position",new jt(v,3)),this.setAttribute("normal",new jt(M,3)),this.setAttribute("uv",new jt(y,2))}static fromJSON(e){return new ys(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Lo extends Si{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,n,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Lo(e.radius,e.detail)}}class No extends Jt{constructor(e=1,t=.4,r=8,n=6,i=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);const o=[],l=[],u=[],c=[],f=new Ie,h=new Ie,p=new Ie;for(let E=0;E<=r;E++)for(let v=0;v<=n;v++){const M=v/n*i,y=E/r*Math.PI*2;h.x=(e+t*Math.cos(y))*Math.cos(M),h.y=(e+t*Math.cos(y))*Math.sin(M),h.z=t*Math.sin(y),l.push(h.x,h.y,h.z),f.x=e*Math.cos(M),f.y=e*Math.sin(M),p.subVectors(h,f).normalize(),u.push(p.x,p.y,p.z),c.push(v/n),c.push(E/r)}for(let E=1;E<=r;E++)for(let v=1;v<=n;v++){const M=(n+1)*E+v-1,y=(n+1)*(E-1)+v-1,_=(n+1)*(E-1)+v,g=(n+1)*E+v;o.push(M,y,g),o.push(y,_,g)}this.setIndex(o),this.setAttribute("position",new jt(l,3)),this.setAttribute("normal",new jt(u,3)),this.setAttribute("uv",new jt(c,2))}static fromJSON(e){return new No(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Fo extends Jt{constructor(e=1,t=.4,r=64,n=8,i=2,o=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:o},r=Math.floor(r),n=Math.floor(n);const l=[],u=[],c=[],f=[],h=new Ie,p=new Ie,E=new Ie,v=new Ie,M=new Ie,y=new Ie,_=new Ie;for(let R=0;R<=r;++R){const S=R/r*i*Math.PI*2;g(S,i,o,e,E),g(S+.01,i,o,e,v),y.subVectors(v,E),_.addVectors(v,E),M.crossVectors(y,_),_.crossVectors(M,y),M.normalize(),_.normalize();for(let x=0;x<=n;++x){const w=x/n*Math.PI*2,C=-t*Math.cos(w),b=t*Math.sin(w);h.x=E.x+(C*_.x+b*M.x),h.y=E.y+(C*_.y+b*M.y),h.z=E.z+(C*_.z+b*M.z),u.push(h.x,h.y,h.z),p.subVectors(h,E).normalize(),c.push(p.x,p.y,p.z),f.push(R/r),f.push(x/n)}}for(let R=1;R<=r;R++)for(let S=1;S<=n;S++){const x=(n+1)*(R-1)+(S-1),w=(n+1)*R+(S-1),C=(n+1)*R+S,b=(n+1)*(R-1)+S;l.push(x,w,b),l.push(w,C,b)}this.setIndex(l),this.setAttribute("position",new jt(u,3)),this.setAttribute("normal",new jt(c,3)),this.setAttribute("uv",new jt(f,2));function g(R,S,x,w,C){const b=Math.cos(R),P=Math.sin(R),A=x/S*R,I=Math.cos(A);C.x=w*(2+I)*.5*b,C.y=w*(2+I)*P*.5,C.z=w*Math.sin(A)*.5}}static fromJSON(e){return new Fo(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Bo extends Jt{constructor(e=new tf(new Ie(-1,-1,0),new Ie(-1,1,0),new Ie(1,1,0)),t=64,r=1,n=8,i=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};const o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new Ie,u=new Ie,c=new Et;let f=new Ie;const h=[],p=[],E=[],v=[];M(),this.setIndex(v),this.setAttribute("position",new jt(h,3)),this.setAttribute("normal",new jt(p,3)),this.setAttribute("uv",new jt(E,2));function M(){for(let R=0;R<t;R++)y(R);y(i===!1?t:0),g(),_()}function y(R){f=e.getPointAt(R/t,f);const S=o.normals[R],x=o.binormals[R];for(let w=0;w<=n;w++){const C=w/n*Math.PI*2,b=Math.sin(C),P=-Math.cos(C);u.x=P*S.x+b*x.x,u.y=P*S.y+b*x.y,u.z=P*S.z+b*x.z,u.normalize(),p.push(u.x,u.y,u.z),l.x=f.x+r*u.x,l.y=f.y+r*u.y,l.z=f.z+r*u.z,h.push(l.x,l.y,l.z)}}function _(){for(let R=1;R<=t;R++)for(let S=1;S<=n;S++){const x=(n+1)*(R-1)+(S-1),w=(n+1)*R+(S-1),C=(n+1)*R+S,b=(n+1)*(R-1)+S;v.push(x,w,b),v.push(w,C,b)}}function g(){for(let R=0;R<=t;R++)for(let S=0;S<=n;S++)c.x=R/t,c.y=S/n,E.push(c.x,c.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Bo(new up[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class dp extends Jt{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,n=new Ie,i=new Ie;if(e.index!==null){const o=e.attributes.position,l=e.index;let u=e.groups;u.length===0&&(u=[{start:0,count:l.count,materialIndex:0}]);for(let c=0,f=u.length;c<f;++c){const h=u[c],p=h.start,E=h.count;for(let v=p,M=p+E;v<M;v+=3)for(let y=0;y<3;y++){const _=l.getX(v+y),g=l.getX(v+(y+1)%3);n.fromBufferAttribute(o,_),i.fromBufferAttribute(o,g),uy(n,i,r)===!0&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}}else{const o=e.attributes.position;for(let l=0,u=o.count/3;l<u;l++)for(let c=0;c<3;c++){const f=3*l+c,h=3*l+(c+1)%3;n.fromBufferAttribute(o,f),i.fromBufferAttribute(o,h),uy(n,i,r)===!0&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new jt(t,3))}}}function uy(m,e,t){const r=`${m.x},${m.y},${m.z}-${e.x},${e.y},${e.z}`,n=`${e.x},${e.y},${e.z}-${m.x},${m.y},${m.z}`;return t.has(r)===!0||t.has(n)===!0?!1:(t.add(r,n),!0)}var cy=Object.freeze({__proto__:null,BoxGeometry:qi,BoxBufferGeometry:qi,CircleGeometry:Co,CircleBufferGeometry:Co,ConeGeometry:bo,ConeBufferGeometry:bo,CylinderGeometry:Da,CylinderBufferGeometry:Da,DodecahedronGeometry:Io,DodecahedronBufferGeometry:Io,EdgesGeometry:tp,ExtrudeGeometry:Ri,ExtrudeBufferGeometry:Ri,IcosahedronGeometry:Po,IcosahedronBufferGeometry:Po,LatheGeometry:wo,LatheBufferGeometry:wo,OctahedronGeometry:vs,OctahedronBufferGeometry:vs,PlaneGeometry:cs,PlaneBufferGeometry:cs,PolyhedronGeometry:Si,PolyhedronBufferGeometry:Si,RingGeometry:Oo,RingBufferGeometry:Oo,ShapeGeometry:Es,ShapeBufferGeometry:Es,SphereGeometry:ys,SphereBufferGeometry:ys,TetrahedronGeometry:Lo,TetrahedronBufferGeometry:Lo,TorusGeometry:No,TorusBufferGeometry:No,TorusKnotGeometry:Fo,TorusKnotBufferGeometry:Fo,TubeGeometry:Bo,TubeBufferGeometry:Bo,WireframeGeometry:dp});class hp extends er{constructor(e){super();this.type="ShadowMaterial",this.color=new Ft(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}hp.prototype.isShadowMaterial=!0;class of extends er{constructor(e){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=is,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}of.prototype.isMeshStandardMaterial=!0;class pp extends of{constructor(e){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Et(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Ft(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ft(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ft(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}pp.prototype.isMeshPhysicalMaterial=!0;class mp extends er{constructor(e){super();this.type="MeshPhongMaterial",this.color=new Ft(16777215),this.specular=new Ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=is,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}mp.prototype.isMeshPhongMaterial=!0;class gp extends er{constructor(e){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ft(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=is,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}gp.prototype.isMeshToonMaterial=!0;class _p extends er{constructor(e){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=is,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}_p.prototype.isMeshNormalMaterial=!0;class vp extends er{constructor(e){super();this.type="MeshLambertMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pl,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}vp.prototype.isMeshLambertMaterial=!0;class Ep extends er{constructor(e){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ft(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=is,this.normalScale=new Et(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Ep.prototype.isMeshMatcapMaterial=!0;class yp extends rr{constructor(e){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}yp.prototype.isLineDashedMaterial=!0;var lO=Object.freeze({__proto__:null,ShadowMaterial:hp,SpriteMaterial:Fc,RawShaderMaterial:vo,ShaderMaterial:$i,PointsMaterial:_s,MeshPhysicalMaterial:pp,MeshStandardMaterial:of,MeshPhongMaterial:mp,MeshToonMaterial:gp,MeshNormalMaterial:_p,MeshLambertMaterial:vp,MeshDepthMaterial:Oc,MeshDistanceMaterial:Lc,MeshBasicMaterial:Zi,MeshMatcapMaterial:Ep,LineDashedMaterial:yp,LineBasicMaterial:rr,Material:er});const Pn={arraySlice:function(m,e,t){return Pn.isTypedArray(m)?new m.constructor(m.subarray(e,t!==void 0?t:m.length)):m.slice(e,t)},convertArray:function(m,e,t){return!m||!t&&m.constructor===e?m:typeof e.BYTES_PER_ELEMENT=="number"?new e(m):Array.prototype.slice.call(m)},isTypedArray:function(m){return ArrayBuffer.isView(m)&&!(m instanceof DataView)},getKeyframeOrder:function(m){function e(n,i){return m[n]-m[i]}const t=m.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r},sortedArray:function(m,e,t){const r=m.length,n=new m.constructor(r);for(let i=0,o=0;o!==r;++i){const l=t[i]*e;for(let u=0;u!==e;++u)n[o++]=m[l+u]}return n},flattenJSON:function(m,e,t,r){let n=1,i=m[0];for(;i!==void 0&&i[r]===void 0;)i=m[n++];if(i===void 0)return;let o=i[r];if(o!==void 0)if(Array.isArray(o))do o=i[r],o!==void 0&&(e.push(i.time),t.push.apply(t,o)),i=m[n++];while(i!==void 0);else if(o.toArray!==void 0)do o=i[r],o!==void 0&&(e.push(i.time),o.toArray(t,t.length)),i=m[n++];while(i!==void 0);else do o=i[r],o!==void 0&&(e.push(i.time),t.push(o)),i=m[n++];while(i!==void 0)},subclip:function(m,e,t,r,n=30){const i=m.clone();i.name=e;const o=[];for(let u=0;u<i.tracks.length;++u){const c=i.tracks[u],f=c.getValueSize(),h=[],p=[];for(let E=0;E<c.times.length;++E){const v=c.times[E]*n;if(!(v<t||v>=r)){h.push(c.times[E]);for(let M=0;M<f;++M)p.push(c.values[E*f+M])}}h.length!==0&&(c.times=Pn.convertArray(h,c.times.constructor),c.values=Pn.convertArray(p,c.values.constructor),o.push(c))}i.tracks=o;let l=1/0;for(let u=0;u<i.tracks.length;++u)l>i.tracks[u].times[0]&&(l=i.tracks[u].times[0]);for(let u=0;u<i.tracks.length;++u)i.tracks[u].shift(-1*l);return i.resetDuration(),i},makeClipAdditive:function(m,e=0,t=m,r=30){r<=0&&(r=30);const n=t.tracks.length,i=e/r;for(let o=0;o<n;++o){const l=t.tracks[o],u=l.ValueTypeName;if(u==="bool"||u==="string")continue;const c=m.tracks.find(function(_){return _.name===l.name&&_.ValueTypeName===u});if(c===void 0)continue;let f=0;const h=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=h/3);let p=0;const E=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=E/3);const v=l.times.length-1;let M;if(i<=l.times[0]){const _=f,g=h-f;M=Pn.arraySlice(l.values,_,g)}else if(i>=l.times[v]){const _=v*h+f,g=_+h-f;M=Pn.arraySlice(l.values,_,g)}else{const _=l.createInterpolant(),g=f,R=h-f;_.evaluate(i),M=Pn.arraySlice(_.resultBuffer,g,R)}u==="quaternion"&&new pr().fromArray(M).normalize().conjugate().toArray(M);const y=c.times.length;for(let _=0;_<y;++_){const g=_*E+p;if(u==="quaternion")pr.multiplyQuaternionsFlat(c.values,g,M,0,c.values,g);else{const R=E-p*2;for(let S=0;S<R;++S)c.values[g+S]-=M[S]}}}return m.blendMode=oh,m}};class ta{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let o;n:{r:if(!(e<n)){for(let l=r+2;;){if(n===void 0){if(e<i)break r;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===l)break;if(i=n,n=t[++r],e<n)break t}o=t.length;break n}if(!(e>=i)){const l=t[1];e<l&&(r=2,i=l);for(let u=r-2;;){if(i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===u)break;if(n=i,i=t[--r-1],e>=i)break t}o=r,r=0;break n}break e}for(;r<o;){const l=r+o>>>1;e<t[l]?o=l:r=l+1}if(n=t[r],i=t[r-1],i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(n===void 0)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let o=0;o!==n;++o)t[o]=r[i+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}ta.prototype.beforeStart_=ta.prototype.copySampleValue_;ta.prototype.afterEnd_=ta.prototype.copySampleValue_;class fy extends ta{constructor(e,t,r,n){super(e,t,r,n);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ns,endingEnd:ns}}intervalChanged_(e,t,r){const n=this.parameterPositions;let i=e-2,o=e+1,l=n[i],u=n[o];if(l===void 0)switch(this.getSettings_().endingStart){case rs:i=e,l=2*t-r;break;case Al:i=n.length-2,l=t+n[i]-n[i+1];break;default:i=e,l=r}if(u===void 0)switch(this.getSettings_().endingEnd){case rs:o=e,u=2*r-t;break;case Al:o=1,u=r+n[1]-n[0];break;default:o=e-1,u=t}const c=(r-t)*.5,f=this.valueSize;this._weightPrev=c/(t-l),this._weightNext=c/(u-r),this._offsetPrev=i*f,this._offsetNext=o*f}interpolate_(e,t,r,n){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,f=this._offsetPrev,h=this._offsetNext,p=this._weightPrev,E=this._weightNext,v=(r-t)/(n-t),M=v*v,y=M*v,_=-p*y+2*p*M-p*v,g=(1+p)*y+(-1.5-2*p)*M+(-.5+p)*v+1,R=(-1-E)*y+(1.5+E)*M+.5*v,S=E*y-E*M;for(let x=0;x!==l;++x)i[x]=_*o[f+x]+g*o[c+x]+R*o[u+x]+S*o[h+x];return i}}class Tp extends ta{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=e*l,c=u-l,f=(r-t)/(n-t),h=1-f;for(let p=0;p!==l;++p)i[p]=o[c+p]*h+o[u+p]*f;return i}}class dy extends ta{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class di{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pn.convertArray(t,this.TimeBufferType),this.values=Pn.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Pn.convertArray(e.times,Array),values:Pn.convertArray(e.values,Array)};const n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new dy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Tp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fy(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ml:t=this.InterpolantFactoryMethodDiscrete;break;case Sl:t=this.InterpolantFactoryMethodLinear;break;case nc:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ml;case this.InterpolantFactoryMethodLinear:return Sl;case this.InterpolantFactoryMethodSmooth:return nc}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){const r=this.times,n=r.length;let i=0,o=n-1;for(;i!==n&&r[i]<e;)++i;for(;o!==-1&&r[o]>t;)--o;if(++o,i!==0||o!==n){i>=o&&(o=Math.max(o,1),i=o-1);const l=this.getValueSize();this.times=Pn.arraySlice(r,i,o),this.values=Pn.arraySlice(this.values,i*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,n=this.values,i=r.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==i;l++){const u=r[l];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,u),e=!1;break}if(o!==null&&o>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,u,o),e=!1;break}o=u}if(n!==void 0&&Pn.isTypedArray(n))for(let l=0,u=n.length;l!==u;++l){const c=n[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}optimize(){const e=Pn.arraySlice(this.times),t=Pn.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===nc,i=e.length-1;let o=1;for(let l=1;l<i;++l){let u=!1;const c=e[l],f=e[l+1];if(c!==f&&(l!==1||c!==e[0]))if(n)u=!0;else{const h=l*r,p=h-r,E=h+r;for(let v=0;v!==r;++v){const M=t[h+v];if(M!==t[p+v]||M!==t[E+v]){u=!0;break}}}if(u){if(l!==o){e[o]=e[l];const h=l*r,p=o*r;for(let E=0;E!==r;++E)t[p+E]=t[h+E]}++o}}if(i>0){e[o]=e[i];for(let l=i*r,u=o*r,c=0;c!==r;++c)t[u+c]=t[l+c];++o}return o!==e.length?(this.times=Pn.arraySlice(e,0,o),this.values=Pn.arraySlice(t,0,o*r)):(this.times=e,this.values=t),this}clone(){const e=Pn.arraySlice(this.times,0),t=Pn.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}di.prototype.TimeBufferType=Float32Array;di.prototype.ValueBufferType=Float32Array;di.prototype.DefaultInterpolation=Sl;class Ts extends di{}Ts.prototype.ValueTypeName="bool";Ts.prototype.ValueBufferType=Array;Ts.prototype.DefaultInterpolation=Ml;Ts.prototype.InterpolantFactoryMethodLinear=void 0;Ts.prototype.InterpolantFactoryMethodSmooth=void 0;class Mp extends di{}Mp.prototype.ValueTypeName="color";class Zl extends di{}Zl.prototype.ValueTypeName="number";class hy extends ta{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,u=(r-t)/(n-t);let c=e*l;for(let f=c+l;c!==f;c+=4)pr.slerpFlat(i,0,o,c-l,o,c,u);return i}}class Uo extends di{InterpolantFactoryMethodLinear(e){return new hy(this.times,this.values,this.getValueSize(),e)}}Uo.prototype.ValueTypeName="quaternion";Uo.prototype.DefaultInterpolation=Sl;Uo.prototype.InterpolantFactoryMethodSmooth=void 0;class Ms extends di{}Ms.prototype.ValueTypeName="string";Ms.prototype.ValueBufferType=Array;Ms.prototype.DefaultInterpolation=Ml;Ms.prototype.InterpolantFactoryMethodLinear=void 0;Ms.prototype.InterpolantFactoryMethodSmooth=void 0;class ql extends di{}ql.prototype.ValueTypeName="vector";class $l{constructor(e,t=-1,r,n=rc){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=Wr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,n=1/(e.fps||1);for(let o=0,l=r.length;o!==l;++o)t.push(cO(r[o]).scale(n));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,o=r.length;i!==o;++i)t.push(di.toJSON(r[i]));return n}static CreateFromMorphTargetSequence(e,t,r,n){const i=t.length,o=[];for(let l=0;l<i;l++){let u=[],c=[];u.push((l+i-1)%i,l,(l+1)%i),c.push(0,1,0);const f=Pn.getKeyframeOrder(u);u=Pn.sortedArray(u,1,f),c=Pn.sortedArray(c,1,f),!n&&u[0]===0&&(u.push(i),c.push(c[0])),o.push(new Zl(".morphTargetInfluences["+t[l].name+"]",u,c).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const n={},i=/^([\w-]*?)([\d]+)$/;for(let l=0,u=e.length;l<u;l++){const c=e[l],f=c.name.match(i);if(f&&f.length>1){const h=f[1];let p=n[h];p||(n[h]=p=[]),p.push(c)}}const o=[];for(const l in n)o.push(this.CreateFromMorphTargetSequence(l,n[l],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(h,p,E,v,M){if(E.length!==0){const y=[],_=[];Pn.flattenJSON(E,y,_,v),y.length!==0&&M.push(new h(p,y,_))}},n=[],i=e.name||"default",o=e.fps||30,l=e.blendMode;let u=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const p=c[h].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const E={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let M=0;M<p[v].morphTargets.length;M++)E[p[v].morphTargets[M]]=-1;for(const M in E){const y=[],_=[];for(let g=0;g!==p[v].morphTargets.length;++g){const R=p[v];y.push(R.time),_.push(R.morphTarget===M?1:0)}n.push(new Zl(".morphTargetInfluence["+M+"]",y,_))}u=E.length*(o||1)}else{const E=".bones["+t[h].name+"]";r(ql,E+".position",p,"pos",n),r(Uo,E+".quaternion",p,"rot",n),r(ql,E+".scale",p,"scl",n)}}return n.length===0?null:new this(i,u,n,l)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,n=e.length;r!==n;++r){const i=this.tracks[r];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function uO(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Zl;case"vector":case"vector2":case"vector3":case"vector4":return ql;case"color":return Mp;case"quaternion":return Uo;case"bool":case"boolean":return Ts;case"string":return Ms}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}function cO(m){if(m.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=uO(m.type);if(m.times===void 0){const t=[],r=[];Pn.flattenJSON(m.keys,t,r,"value"),m.times=t,m.values=r}return e.parse!==void 0?e.parse(m):new e(m.name,m.times,m.values,m.interpolation)}const Ss={enabled:!1,files:{},add:function(m,e){this.enabled!==!1&&(this.files[m]=e)},get:function(m){if(this.enabled!==!1)return this.files[m]},remove:function(m){delete this.files[m]},clear:function(){this.files={}}};class Sp{constructor(e,t,r){const n=this;let i=!1,o=0,l=0,u;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(f){l++,i===!1&&n.onStart!==void 0&&n.onStart(f,o,l),i=!0},this.itemEnd=function(f){o++,n.onProgress!==void 0&&n.onProgress(f,o,l),o===l&&(i=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(f){n.onError!==void 0&&n.onError(f)},this.resolveURL=function(f){return u?u(f):f},this.setURLModifier=function(f){return u=f,this},this.addHandler=function(f,h){return c.push(f,h),this},this.removeHandler=function(f){const h=c.indexOf(f);return h!==-1&&c.splice(h,2),this},this.getHandler=function(f){for(let h=0,p=c.length;h<p;h+=2){const E=c[h],v=c[h+1];if(E.global&&(E.lastIndex=0),E.test(f))return v}return null}}}const py=new Sp;class xr{constructor(e){this.manager=e!==void 0?e:py,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(n,i){r.load(e,n,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const na={};class Ci extends xr{constructor(e){super(e)}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Ss.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(na[e]!==void 0){na[e].push({onLoad:t,onProgress:r,onError:n});return}na[e]=[],na[e].push({onLoad:t,onProgress:r,onError:n});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(o).then(l=>{if(l.status===200||l.status===0){l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");const u=na[e],c=l.body.getReader(),f=l.headers.get("Content-Length"),h=f?parseInt(f):0,p=h!==0;let E=0;return new ReadableStream({start(v){M();function M(){c.read().then(({done:y,value:_})=>{if(y)v.close();else{E+=_.byteLength;const g=new ProgressEvent("progress",{lengthComputable:p,loaded:E,total:h});for(let R=0,S=u.length;R<S;R++){const x=u[R];x.onProgress&&x.onProgress(g)}v.enqueue(_),M()}})}}})}else throw Error(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`)}).then(l=>{const u=new Response(l);switch(this.responseType){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,this.mimeType));case"json":return u.json();default:return u.text()}}).then(l=>{Ss.add(e,l);const u=na[e];delete na[e];for(let c=0,f=u.length;c<f;c++){const h=u[c];h.onLoad&&h.onLoad(l)}this.manager.itemEnd(e)}).catch(l=>{const u=na[e];delete na[e];for(let c=0,f=u.length;c<f;c++){const h=u[c];h.onError&&h.onError(l)}this.manager.itemError(e),this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class fO extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=new Ci(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(i.parse(JSON.parse(l)))}catch(u){n?n(u):console.error(u),i.manager.itemError(e)}},r,n)}parse(e){const t=[];for(let r=0;r<e.length;r++){const n=$l.parse(e[r]);t.push(n)}return t}}class dO extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=[],l=new $h,u=new Ci(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(i.withCredentials);let c=0;function f(h){u.load(e[h],function(p){const E=i.parse(p,!0);o[h]={width:E.width,height:E.height,format:E.format,mipmaps:E.mipmaps},c+=1,c===6&&(E.mipmapCount===1&&(l.minFilter=Jn),l.image=o,l.format=E.format,l.needsUpdate=!0,t&&t(l))},r,n)}if(Array.isArray(e))for(let h=0,p=e.length;h<p;++h)f(h);else u.load(e,function(h){const p=i.parse(h,!0);if(p.isCubemap){const E=p.mipmaps.length/p.mipmapCount;for(let v=0;v<E;v++){o[v]={mipmaps:[]};for(let M=0;M<p.mipmapCount;M++)o[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+M]),o[v].format=p.format,o[v].width=p.width,o[v].height=p.height}l.image=o}else l.image.width=p.width,l.image.height=p.height,l.mipmaps=p.mipmaps;p.mipmapCount===1&&(l.minFilter=Jn),l.format=p.format,l.needsUpdate=!0,t&&t(l)},r,n);return l}}class eu extends xr{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Ss.get(e);if(o!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;const l=lc("img");function u(){f(),Ss.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(h){f(),n&&n(h),i.manager.itemError(e),i.manager.itemEnd(e)}function f(){l.removeEventListener("load",u,!1),l.removeEventListener("error",c,!1)}return l.addEventListener("load",u,!1),l.addEventListener("error",c,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),i.manager.itemStart(e),l.src=e,l}}class my extends xr{constructor(e){super(e)}load(e,t,r,n){const i=new go,o=new eu(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let l=0;function u(c){o.load(e[c],function(f){i.images[c]=f,l++,l===6&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(let c=0;c<e.length;++c)u(c);return i}}class gy extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=new ms,l=new Ci(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(i.withCredentials),l.load(e,function(u){const c=i.parse(u);!c||(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:ur,o.wrapT=c.wrapT!==void 0?c.wrapT:ur,o.magFilter=c.magFilter!==void 0?c.magFilter:Jn,o.minFilter=c.minFilter!==void 0?c.minFilter:Jn,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=qa),c.mipmapCount===1&&(o.minFilter=Jn),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},r,n),o}}class _y extends xr{constructor(e){super(e)}load(e,t,r,n){const i=new qn,o=new eu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){i.image=l,i.needsUpdate=!0,t!==void 0&&t(i)},r,n),i}}class hi extends un{constructor(e,t=1){super();this.type="Light",this.color=new Ft(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}hi.prototype.isLight=!0;class Ap extends hi{constructor(e,t,r){super(e,r);this.type="HemisphereLight",this.position.copy(un.DefaultUp),this.updateMatrix(),this.groundColor=new Ft(t)}copy(e){return hi.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Ap.prototype.isHemisphereLight=!0;const vy=new zt,Ey=new Ie,yy=new Ie;class xp{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Et(512,512),this.map=null,this.mapPass=null,this.matrix=new zt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wl,this._frameExtents=new Et(1,1),this._viewportCount=1,this._viewports=[new Mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;Ey.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ey),yy.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(yy),t.updateMatrixWorld(),vy.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vy),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Ty extends xp{constructor(){super(new nr(50,1,.5,500));this.focus=1}updateMatrices(e){const t=this.camera,r=xl*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Ty.prototype.isSpotLightShadow=!0;class Rp extends hi{constructor(e,t,r=0,n=Math.PI/3,i=0,o=1){super(e,t);this.type="SpotLight",this.position.copy(un.DefaultUp),this.updateMatrix(),this.target=new un,this.distance=r,this.angle=n,this.penumbra=i,this.decay=o,this.shadow=new Ty}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Rp.prototype.isSpotLight=!0;const My=new zt,tu=new Ie,Cp=new Ie;class Sy extends xp{constructor(){super(new nr(90,1,.5,500));this._frameExtents=new Et(4,2),this._viewportCount=6,this._viewports=[new Mn(2,1,1,1),new Mn(0,1,1,1),new Mn(3,1,1,1),new Mn(1,1,1,1),new Mn(3,0,1,1),new Mn(1,0,1,1)],this._cubeDirections=[new Ie(1,0,0),new Ie(-1,0,0),new Ie(0,0,1),new Ie(0,0,-1),new Ie(0,1,0),new Ie(0,-1,0)],this._cubeUps=[new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,0,1),new Ie(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),tu.setFromMatrixPosition(e.matrixWorld),r.position.copy(tu),Cp.copy(r.position),Cp.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Cp),r.updateMatrixWorld(),n.makeTranslation(-tu.x,-tu.y,-tu.z),My.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(My)}}Sy.prototype.isPointLightShadow=!0;class bp extends hi{constructor(e,t,r=0,n=1){super(e,t);this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new Sy}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}bp.prototype.isPointLight=!0;class Ay extends xp{constructor(){super(new Ol(-5,5,5,-5,.5,500))}}Ay.prototype.isDirectionalLightShadow=!0;class Ip extends hi{constructor(e,t){super(e,t);this.type="DirectionalLight",this.position.copy(un.DefaultUp),this.updateMatrix(),this.target=new un,this.shadow=new Ay}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Ip.prototype.isDirectionalLight=!0;class Dp extends hi{constructor(e,t){super(e,t);this.type="AmbientLight"}}Dp.prototype.isAmbientLight=!0;class Pp extends hi{constructor(e,t,r=10,n=10){super(e,t);this.type="RectAreaLight",this.width=r,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}Pp.prototype.isRectAreaLight=!0;class wp{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,n=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*n),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*n)),t.addScaledVector(o[5],1.092548*(n*i)),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],1.092548*(r*i)),t.addScaledVector(o[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){const r=e.x,n=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*n),t.addScaledVector(o[2],2*.511664*i),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*n),t.addScaledVector(o[5],2*.429043*n*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],2*.429043*r*i),t.addScaledVector(o[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+n*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+n*3);return e}static getBasisAt(e,t){const r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}}wp.prototype.isSphericalHarmonics3=!0;class nu extends hi{constructor(e=new wp,t=1){super(void 0,t);this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}nu.prototype.isLightProbe=!0;class xy extends xr{constructor(e){super(e);this.textures={}}load(e,t,r,n){const i=this,o=new Ci(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(l){try{t(i.parse(JSON.parse(l)))}catch(u){n?n(u):console.error(u),i.manager.itemError(e)}},r,n)}parse(e){const t=this.textures;function r(i){return t[i]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",i),t[i]}const n=new lO[e.type];if(e.uuid!==void 0&&(n.uuid=e.uuid),e.name!==void 0&&(n.name=e.name),e.color!==void 0&&n.color!==void 0&&n.color.setHex(e.color),e.roughness!==void 0&&(n.roughness=e.roughness),e.metalness!==void 0&&(n.metalness=e.metalness),e.sheen!==void 0&&(n.sheen=e.sheen),e.sheenColor!==void 0&&(n.sheenColor=new Ft().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(n.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(e.emissive),e.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(e.specular),e.specularIntensity!==void 0&&(n.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&n.specularColor!==void 0&&n.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(n.shininess=e.shininess),e.clearcoat!==void 0&&(n.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(n.transmission=e.transmission),e.thickness!==void 0&&(n.thickness=e.thickness),e.attenuationDistance!==void 0&&(n.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&n.attenuationColor!==void 0&&n.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(n.fog=e.fog),e.flatShading!==void 0&&(n.flatShading=e.flatShading),e.blending!==void 0&&(n.blending=e.blending),e.combine!==void 0&&(n.combine=e.combine),e.side!==void 0&&(n.side=e.side),e.shadowSide!==void 0&&(n.shadowSide=e.shadowSide),e.opacity!==void 0&&(n.opacity=e.opacity),e.format!==void 0&&(n.format=e.format),e.transparent!==void 0&&(n.transparent=e.transparent),e.alphaTest!==void 0&&(n.alphaTest=e.alphaTest),e.depthTest!==void 0&&(n.depthTest=e.depthTest),e.depthWrite!==void 0&&(n.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(n.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(n.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(n.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(n.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(n.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(n.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(n.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(n.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(n.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(n.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(n.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(n.rotation=e.rotation),e.linewidth!==1&&(n.linewidth=e.linewidth),e.dashSize!==void 0&&(n.dashSize=e.dashSize),e.gapSize!==void 0&&(n.gapSize=e.gapSize),e.scale!==void 0&&(n.scale=e.scale),e.polygonOffset!==void 0&&(n.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(n.dithering=e.dithering),e.alphaToCoverage!==void 0&&(n.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(n.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(n.visible=e.visible),e.toneMapped!==void 0&&(n.toneMapped=e.toneMapped),e.userData!==void 0&&(n.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const i in e.uniforms){const o=e.uniforms[i];switch(n.uniforms[i]={},o.type){case"t":n.uniforms[i].value=r(o.value);break;case"c":n.uniforms[i].value=new Ft().setHex(o.value);break;case"v2":n.uniforms[i].value=new Et().fromArray(o.value);break;case"v3":n.uniforms[i].value=new Ie().fromArray(o.value);break;case"v4":n.uniforms[i].value=new Mn().fromArray(o.value);break;case"m3":n.uniforms[i].value=new Zn().fromArray(o.value);break;case"m4":n.uniforms[i].value=new zt().fromArray(o.value);break;default:n.uniforms[i].value=o.value}}if(e.defines!==void 0&&(n.defines=e.defines),e.vertexShader!==void 0&&(n.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(n.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const i in e.extensions)n.extensions[i]=e.extensions[i];if(e.shading!==void 0&&(n.flatShading=e.shading===1),e.size!==void 0&&(n.size=e.size),e.sizeAttenuation!==void 0&&(n.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(n.map=r(e.map)),e.matcap!==void 0&&(n.matcap=r(e.matcap)),e.alphaMap!==void 0&&(n.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(n.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(n.bumpScale=e.bumpScale),e.normalMap!==void 0&&(n.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(n.normalMapType=e.normalMapType),e.normalScale!==void 0){let i=e.normalScale;Array.isArray(i)===!1&&(i=[i,i]),n.normalScale=new Et().fromArray(i)}return e.displacementMap!==void 0&&(n.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(n.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(n.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(n.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(n.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(n.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(n.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(n.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(n.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(n.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(n.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(n.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(n.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(n.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(n.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(n.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(n.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(n.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(n.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(n.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new Et().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(n.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(n.thicknessMap=r(e.thicknessMap)),e.sheenColorMap!==void 0&&(n.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}}class lf{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Op extends Jt{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Op.prototype.isInstancedBufferGeometry=!0;class Ry extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=new Ci(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(l){try{t(i.parse(JSON.parse(l)))}catch(u){n?n(u):console.error(u),i.manager.itemError(e)}},r,n)}parse(e){const t={},r={};function n(E,v){if(t[v]!==void 0)return t[v];const y=E.interleavedBuffers[v],_=i(E,y.buffer),g=to(y.type,_),R=new ps(g,y.stride);return R.uuid=y.uuid,t[v]=R,R}function i(E,v){if(r[v]!==void 0)return r[v];const y=E.arrayBuffers[v],_=new Uint32Array(y).buffer;return r[v]=_,_}const o=e.isInstancedBufferGeometry?new Op:new Jt,l=e.data.index;if(l!==void 0){const E=to(l.type,l.array);o.setIndex(new hn(E,1))}const u=e.data.attributes;for(const E in u){const v=u[E];let M;if(v.isInterleavedBufferAttribute){const y=n(e.data,v.data);M=new Ia(y,v.itemSize,v.offset,v.normalized)}else{const y=to(v.type,v.array),_=v.isInstancedBufferAttribute?gs:hn;M=new _(y,v.itemSize,v.normalized)}v.name!==void 0&&(M.name=v.name),v.usage!==void 0&&M.setUsage(v.usage),v.updateRange!==void 0&&(M.updateRange.offset=v.updateRange.offset,M.updateRange.count=v.updateRange.count),o.setAttribute(E,M)}const c=e.data.morphAttributes;if(c)for(const E in c){const v=c[E],M=[];for(let y=0,_=v.length;y<_;y++){const g=v[y];let R;if(g.isInterleavedBufferAttribute){const S=n(e.data,g.data);R=new Ia(S,g.itemSize,g.offset,g.normalized)}else{const S=to(g.type,g.array);R=new hn(S,g.itemSize,g.normalized)}g.name!==void 0&&(R.name=g.name),M.push(R)}o.morphAttributes[E]=M}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let E=0,v=h.length;E!==v;++E){const M=h[E];o.addGroup(M.start,M.count,M.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const E=new Ie;p.center!==void 0&&E.fromArray(p.center),o.boundingSphere=new Ea(E,p.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class hO extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=this.path===""?lf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new Ci(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){let c=null;try{c=JSON.parse(u)}catch(h){n!==void 0&&n(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const f=c.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}i.parse(c,t)},r,n)}async loadAsync(e,t){const r=this,n=this.path===""?lf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new Ci(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const o=await i.loadAsync(e,t),l=JSON.parse(o),u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(l)}parse(e,t){const r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),l=this.parseTextures(e.textures,o),u=this.parseMaterials(e.materials,l),c=this.parseObject(e.object,i,u,l,r),f=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,f),t!==void 0){let h=!1;for(const p in o)if(o[p]instanceof HTMLImageElement){h=!0;break}h===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),i=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,i),l=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,n,l,o,t),c=this.parseSkeletons(e.skeletons,u);return this.bindSkeletons(u,c),u}parseShapes(e){const t={};if(e!==void 0)for(let r=0,n=e.length;r<n;r++){const i=new Ai().fromJSON(e[r]);t[i.uuid]=i}return t}parseSkeletons(e,t){const r={},n={};if(t.traverse(function(i){i.isBone&&(n[i.uuid]=i)}),e!==void 0)for(let i=0,o=e.length;i<o;i++){const l=new zc().fromJSON(e[i],n);r[l.uuid]=l}return r}parseGeometries(e,t){const r={};if(e!==void 0){const n=new Ry;for(let i=0,o=e.length;i<o;i++){let l;const u=e[i];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":l=n.parse(u);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:u.type in cy?l=cy[u.type].fromJSON(u,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${u.type}"`)}l.uuid=u.uuid,u.name!==void 0&&(l.name=u.name),l.isBufferGeometry===!0&&u.userData!==void 0&&(l.userData=u.userData),r[u.uuid]=l}}return r}parseMaterials(e,t){const r={},n={};if(e!==void 0){const i=new xy;i.setTextures(t);for(let o=0,l=e.length;o<l;o++){const u=e[o];if(u.type==="MultiMaterial"){const c=[];for(let f=0;f<u.materials.length;f++){const h=u.materials[f];r[h.uuid]===void 0&&(r[h.uuid]=i.parse(h)),c.push(r[h.uuid])}n[u.uuid]=c}else r[u.uuid]===void 0&&(r[u.uuid]=i.parse(u)),n[u.uuid]=r[u.uuid]}}return n}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const n=e[r],i=$l.parse(n);t[i.uuid]=i}return t}parseImages(e,t){const r=this,n={};let i;function o(u){return r.manager.itemStart(u),i.load(u,function(){r.manager.itemEnd(u)},void 0,function(){r.manager.itemError(u),r.manager.itemEnd(u)})}function l(u){if(typeof u=="string"){const c=u,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return o(f)}else return u.data?{data:to(u.type,u.data),width:u.width,height:u.height}:null}if(e!==void 0&&e.length>0){const u=new Sp(t);i=new eu(u),i.setCrossOrigin(this.crossOrigin);for(let c=0,f=e.length;c<f;c++){const h=e[c],p=h.url;if(Array.isArray(p)){n[h.uuid]=[];for(let E=0,v=p.length;E<v;E++){const M=p[E],y=l(M);y!==null&&(y instanceof HTMLImageElement?n[h.uuid].push(y):n[h.uuid].push(new ms(y.data,y.width,y.height)))}}else{const E=l(h.url);E!==null&&(n[h.uuid]=E)}}}return n}async parseImagesAsync(e){const t=this,r={};let n;async function i(o){if(typeof o=="string"){const l=o,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await n.loadAsync(u)}else return o.data?{data:to(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){n=new eu(this.manager),n.setCrossOrigin(this.crossOrigin);for(let o=0,l=e.length;o<l;o++){const u=e[o],c=u.url;if(Array.isArray(c)){r[u.uuid]=[];for(let f=0,h=c.length;f<h;f++){const p=c[f],E=await i(p);E!==null&&(E instanceof HTMLImageElement?r[u.uuid].push(E):r[u.uuid].push(new ms(E.data,E.width,E.height)))}}else{const f=await i(u.url);f!==null&&(r[u.uuid]=f)}}}return r}parseTextures(e,t){function r(i,o){return typeof i=="number"?i:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",i),o[i])}const n={};if(e!==void 0)for(let i=0,o=e.length;i<o;i++){const l=e[i];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);let u;const c=t[l.image];Array.isArray(c)?(u=new go(c),c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new ms(c.data,c.width,c.height):u=new qn(c),c&&(u.needsUpdate=!0)),u.uuid=l.uuid,l.name!==void 0&&(u.name=l.name),l.mapping!==void 0&&(u.mapping=r(l.mapping,pO)),l.offset!==void 0&&u.offset.fromArray(l.offset),l.repeat!==void 0&&u.repeat.fromArray(l.repeat),l.center!==void 0&&u.center.fromArray(l.center),l.rotation!==void 0&&(u.rotation=l.rotation),l.wrap!==void 0&&(u.wrapS=r(l.wrap[0],Cy),u.wrapT=r(l.wrap[1],Cy)),l.format!==void 0&&(u.format=l.format),l.type!==void 0&&(u.type=l.type),l.encoding!==void 0&&(u.encoding=l.encoding),l.minFilter!==void 0&&(u.minFilter=r(l.minFilter,by)),l.magFilter!==void 0&&(u.magFilter=r(l.magFilter,by)),l.anisotropy!==void 0&&(u.anisotropy=l.anisotropy),l.flipY!==void 0&&(u.flipY=l.flipY),l.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(u.unpackAlignment=l.unpackAlignment),l.userData!==void 0&&(u.userData=l.userData),n[l.uuid]=u}return n}parseObject(e,t,r,n,i){let o;function l(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function u(p){if(p!==void 0){if(Array.isArray(p)){const E=[];for(let v=0,M=p.length;v<M;v++){const y=p[v];r[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),E.push(r[y])}return E}return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),r[p]}}function c(p){return n[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),n[p]}let f,h;switch(e.type){case"Scene":o=new Nc,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ft(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Bl(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Fl(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new nr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ol(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Dp(e.color,e.intensity);break;case"DirectionalLight":o=new Ip(e.color,e.intensity);break;case"PointLight":o=new bp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Pp(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Rp(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Ap(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new nu().fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),h=u(e.material),o=new jc(f,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),h=u(e.material),o=new Kn(f,h);break;case"InstancedMesh":f=l(e.geometry),h=u(e.material);const p=e.count,E=e.instanceMatrix,v=e.instanceColor;o=new Qh(f,h,p),o.instanceMatrix=new gs(new Float32Array(E.array),16),v!==void 0&&(o.instanceColor=new gs(new Float32Array(v.array),v.itemSize));break;case"LOD":o=new FE;break;case"Line":o=new ea(l(e.geometry),u(e.material));break;case"LineLoop":o=new Zh(l(e.geometry),u(e.material));break;case"LineSegments":o=new wr(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":o=new jl(l(e.geometry),u(e.material));break;case"Sprite":o=new Wc(u(e.material));break;case"Group":o=new hs;break;case"Bone":o=new Vc;break;default:o=new un}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let E=0;E<p.length;E++)o.add(this.parseObject(p[E],t,r,n,i))}if(e.animations!==void 0){const p=e.animations;for(let E=0;E<p.length;E++){const v=p[E];o.animations.push(i[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const p=e.levels;for(let E=0;E<p.length;E++){const v=p[E],M=o.getObjectByProperty("uuid",v.object);M!==void 0&&o.addLevel(M,v.distance)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const n=t[r.skeleton];n===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(n,r.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const pO={UVMapping:$u,CubeReflectionMapping:Ja,CubeRefractionMapping:Za,EquirectangularReflectionMapping:ml,EquirectangularRefractionMapping:gl,CubeUVReflectionMapping:Js,CubeUVRefractionMapping:_l},Cy={RepeatWrapping:vl,ClampToEdgeWrapping:ur,MirroredRepeatWrapping:El},by={NearestFilter:kn,NearestMipmapNearestFilter:ec,NearestMipmapLinearFilter:tc,LinearFilter:Jn,LinearMipmapNearestFilter:Jd,LinearMipmapLinearFilter:qa};class Iy extends xr{constructor(e){super(e);typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Ss.get(e);if(o!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader,fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(u){Ss.add(e,u),t&&t(u),i.manager.itemEnd(e)}).catch(function(u){n&&n(u),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}}Iy.prototype.isImageBitmapLoader=!0;let uf;const Lp={getContext:function(){return uf===void 0&&(uf=new(window.AudioContext||window.webkitAudioContext)),uf},setContext:function(m){uf=m}};class Dy extends xr{constructor(e){super(e)}load(e,t,r,n){const i=this,o=new Ci(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);Lp.getContext().decodeAudioData(u,function(f){t(f)})}catch(u){n?n(u):console.error(u),i.manager.itemError(e)}},r,n)}}class Py extends nu{constructor(e,t,r=1){super(void 0,r);const n=new Ft().set(e),i=new Ft().set(t),o=new Ie(n.r,n.g,n.b),l=new Ie(i.r,i.g,i.b),u=Math.sqrt(Math.PI),c=u*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(l).multiplyScalar(u),this.sh.coefficients[1].copy(o).sub(l).multiplyScalar(c)}}Py.prototype.isHemisphereLightProbe=!0;class wy extends nu{constructor(e,t=1){super(void 0,t);const r=new Ft().set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}}wy.prototype.isAmbientLightProbe=!0;const Oy=new zt,Ly=new zt;class mO{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new nr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new nr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const n=e.projectionMatrix.clone(),i=t.eyeSep/2,o=i*t.near/t.focus,l=t.near*Math.tan(as*t.fov*.5)/t.zoom;let u,c;Ly.elements[12]=-i,Oy.elements[12]=i,u=-l*t.aspect+o,c=l*t.aspect+o,n.elements[0]=2*t.near/(c-u),n.elements[8]=(c+u)/(c-u),this.cameraL.projectionMatrix.copy(n),u=-l*t.aspect-o,c=l*t.aspect-o,n.elements[0]=2*t.near/(c-u),n.elements[8]=(c+u)/(c-u),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Ly),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Oy)}}class Ny{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Fy(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Fy();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Fy(){return(typeof performance=="undefined"?Date:performance).now()}const As=new Ie,By=new pr,gO=new Ie,xs=new Ie;class _O extends un{constructor(){super();this.type="AudioListener",this.context=Lp.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Ny}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(As,By,gO),xs.set(0,0,-1).applyQuaternion(By),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(As.x,n),t.positionY.linearRampToValueAtTime(As.y,n),t.positionZ.linearRampToValueAtTime(As.z,n),t.forwardX.linearRampToValueAtTime(xs.x,n),t.forwardY.linearRampToValueAtTime(xs.y,n),t.forwardZ.linearRampToValueAtTime(xs.z,n),t.upX.linearRampToValueAtTime(r.x,n),t.upY.linearRampToValueAtTime(r.y,n),t.upZ.linearRampToValueAtTime(r.z,n)}else t.setPosition(As.x,As.y,As.z),t.setOrientation(xs.x,xs.y,xs.z,r.x,r.y,r.z)}}class Np extends un{constructor(e){super();this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Rs=new Ie,Uy=new pr,vO=new Ie,Cs=new Ie;class EO extends Np{constructor(e){super(e);this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Rs,Uy,vO),Cs.set(0,0,1).applyQuaternion(Uy);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Rs.x,r),t.positionY.linearRampToValueAtTime(Rs.y,r),t.positionZ.linearRampToValueAtTime(Rs.z,r),t.orientationX.linearRampToValueAtTime(Cs.x,r),t.orientationY.linearRampToValueAtTime(Cs.y,r),t.orientationZ.linearRampToValueAtTime(Cs.z,r)}else t.setPosition(Rs.x,Rs.y,Rs.z),t.setOrientation(Cs.x,Cs.y,Cs.z)}}class Wy{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class Hy{constructor(e,t,r){this.binding=e,this.valueSize=r;let n,i,o;switch(t){case"quaternion":n=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:n=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,n=this.valueSize,i=e*n+n;let o=this.cumulativeWeight;if(o===0){for(let l=0;l!==n;++l)r[i+l]=r[l];o=t}else{o+=t;const l=t/o;this._mixBufferRegion(r,i,0,l,n)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,n=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const u=t*this._origIndex;this._mixBufferRegion(r,n,u,1-i,t)}o>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let u=t,c=t+t;u!==c;++u)if(r[u]!==r[u+t]){l.setValue(r,n);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let i=r,o=n;i!==o;++i)t[i]=t[n+i%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let o=0;o!==i;++o)e[t+o]=e[r+o]}_slerp(e,t,r,n){pr.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){const o=this._workIndex*i;pr.multiplyQuaternionsFlat(e,o,e,t,e,r),pr.slerpFlat(e,t,e,t,e,o,n)}_lerp(e,t,r,n,i){const o=1-n;for(let l=0;l!==i;++l){const u=t+l;e[u]=e[u]*o+e[r+l]*n}}_lerpAdditive(e,t,r,n,i){for(let o=0;o!==i;++o){const l=t+o;e[l]=e[l]+e[r+o]*n}}}const Fp="\\[\\]\\.:\\/",yO=new RegExp("["+Fp+"]","g"),Bp="[^"+Fp+"]",TO="[^"+Fp.replace("\\.","")+"]",MO=/((?:WC+[\/:])*)/.source.replace("WC",Bp),SO=/(WCOD+)?/.source.replace("WCOD",TO),AO=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Bp),xO=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Bp),RO=new RegExp("^"+MO+SO+AO+xO+"$"),CO=["material","materials","bones"];class bO{constructor(e,t,r){const n=r||mn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class mn{constructor(e,t,r){this.path=t,this.parsedPath=r||mn.parseTrackName(t),this.node=mn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new mn.Composite(e,t,r):new mn(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(yO,"")}static parseTrackName(e){const t=RO.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){const i=r.nodeName.substring(n+1);CO.indexOf(i)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(i){for(let o=0;o<i.length;o++){const l=i[o];if(l.name===t||l.uuid===t)return l;const u=r(l.children);if(u)return u}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,n=t.propertyName;let i=t.propertyIndex;if(e||(e=mn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===c){c=f;break}break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[n];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(i!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}mn.Composite=bO;mn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};mn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};mn.prototype.GetterByBindingType=[mn.prototype._getValue_direct,mn.prototype._getValue_array,mn.prototype._getValue_arrayElement,mn.prototype._getValue_toArray];mn.prototype.SetterByBindingTypeAndVersioning=[[mn.prototype._setValue_direct,mn.prototype._setValue_direct_setNeedsUpdate,mn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_array,mn.prototype._setValue_array_setNeedsUpdate,mn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_arrayElement,mn.prototype._setValue_arrayElement_setNeedsUpdate,mn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_fromArray,mn.prototype._setValue_fromArray_setNeedsUpdate,mn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Gy{constructor(){this.uuid=Wr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,n=arguments.length;r!==n;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,o=i.length;let l,u=e.length,c=this.nCachedObjects_;for(let f=0,h=arguments.length;f!==h;++f){const p=arguments[f],E=p.uuid;let v=t[E];if(v===void 0){v=u++,t[E]=v,e.push(p);for(let M=0,y=o;M!==y;++M)i[M].push(new mn(p,r[M],n[M]))}else if(v<c){l=e[v];const M=--c,y=e[M];t[y.uuid]=v,e[v]=y,t[E]=M,e[M]=p;for(let _=0,g=o;_!==g;++_){const R=i[_],S=R[M];let x=R[v];R[v]=S,x===void 0&&(x=new mn(p,r[_],n[_])),R[M]=x}}else e[v]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let i=this.nCachedObjects_;for(let o=0,l=arguments.length;o!==l;++o){const u=arguments[o],c=u.uuid,f=t[c];if(f!==void 0&&f>=i){const h=i++,p=e[h];t[p.uuid]=f,e[f]=p,t[c]=h,e[h]=u;for(let E=0,v=n;E!==v;++E){const M=r[E],y=M[h],_=M[f];M[f]=y,M[h]=_}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length;let i=this.nCachedObjects_,o=e.length;for(let l=0,u=arguments.length;l!==u;++l){const c=arguments[l],f=c.uuid,h=t[f];if(h!==void 0)if(delete t[f],h<i){const p=--i,E=e[p],v=--o,M=e[v];t[E.uuid]=h,e[h]=E,t[M.uuid]=p,e[p]=M,e.pop();for(let y=0,_=n;y!==_;++y){const g=r[y],R=g[p],S=g[v];g[h]=R,g[p]=S,g.pop()}}else{const p=--o,E=e[p];p>0&&(t[E.uuid]=h),e[h]=E,e.pop();for(let v=0,M=n;v!==M;++v){const y=r[v];y[h]=y[p],y.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const r=this._bindingsIndicesByPath;let n=r[e];const i=this._bindings;if(n!==void 0)return i[n];const o=this._paths,l=this._parsedPaths,u=this._objects,c=u.length,f=this.nCachedObjects_,h=new Array(c);n=i.length,r[e]=n,o.push(e),l.push(t),i.push(h);for(let p=f,E=u.length;p!==E;++p){const v=u[p];h[p]=new mn(v,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const n=this._paths,i=this._parsedPaths,o=this._bindings,l=o.length-1,u=o[l],c=e[l];t[c]=r,o[r]=u,o.pop(),i[r]=i[l],i.pop(),n[r]=n[l],n.pop()}}}Gy.prototype.isAnimationObjectGroup=!0;class IO{constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;const i=t.tracks,o=i.length,l=new Array(o),u={endingStart:ns,endingEnd:ns};for(let c=0;c!==o;++c){const f=i[c].createInterpolant(null);l[c]=f,f.settings=u}this._interpolantSettings=u,this._interpolants=l,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=gv,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const n=this._clip.duration,i=e._clip.duration,o=i/n,l=n/i;e.warp(1,o,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const n=this._mixer,i=n.time,o=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=n._lendControlInterpolant(),this._timeScaleInterpolant=l);const u=l.parameterPositions,c=l.sampleValues;return u[0]=i,u[1]=i+r,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled){this._updateWeight(e);return}const i=this._startTime;if(i!==null){const u=(e-i)*r;if(u<0||r===0)return;this._startTime=null,t=r*u}t*=this._updateTimeScale(e);const o=this._updateTime(t),l=this._updateWeight(e);if(l>0){const u=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case oh:for(let f=0,h=u.length;f!==h;++f)u[f].evaluate(o),c[f].accumulateAdditive(l);break;case rc:default:for(let f=0,h=u.length;f!==h;++f)u[f].evaluate(o),c[f].accumulate(n,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;r!==null&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let n=this.time+e,i=this._loopCount;const o=r===_v;if(e===0)return i===-1?n:o&&(i&1)==1?t-n:n;if(r===mv){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),n>=t||n<0){const l=Math.floor(n/t);n-=t*l,i+=Math.abs(l);const u=this.repetitions-i;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=n;if(o&&(i&1)==1)return t-n}return n}_setEndings(e,t,r){const n=this._interpolantSettings;r?(n.endingStart=rs,n.endingEnd=rs):(e?n.endingStart=this.zeroSlopeAtStart?rs:ns:n.endingStart=Al,t?n.endingEnd=this.zeroSlopeAtEnd?rs:ns:n.endingEnd=Al)}_scheduleFading(e,t,r){const n=this._mixer,i=n.time;let o=this._weightInterpolant;o===null&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);const l=o.parameterPositions,u=o.sampleValues;return l[0]=i,u[0]=t,l[1]=i+e,u[1]=r,this}}class jy extends ga{constructor(e){super();this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,l=e._interpolants,u=r.uuid,c=this._bindingsByRootAndName;let f=c[u];f===void 0&&(f={},c[u]=f);for(let h=0;h!==i;++h){const p=n[h],E=p.name;let v=f[E];if(v!==void 0)o[h]=v;else{if(v=o[h],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,u,E));continue}const M=t&&t._propertyBindings[h].binding.parsedPath;v=new Hy(mn.create(r,E,M),p.ValueTypeName,p.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,u,E),o[h]=v}l[h].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,r)}const t=e._propertyBindings;for(let r=0,n=t.length;r!==n;++r){const i=t[r];i.useCount++==0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,n=t.length;r!==n;++r){const i=t[r];--i.useCount==0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const n=this._actions,i=this._actionsByClip;let o=i[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{const l=o.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,o=this._actionsByClip,l=o[i],u=l.knownActions,c=u[u.length-1],f=e._byClipCacheIndex;c._byClipCacheIndex=f,u[f]=c,u.pop(),e._byClipCacheIndex=null;const h=l.actionByRoot,p=(e._localRoot||this._root).uuid;delete h[p],u.length===0&&delete o[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,n=t.length;r!==n;++r){const i=t[r];--i.referenceCount==0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){const n=this._bindingsByRootAndName,i=this._bindings;let o=n[t];o===void 0&&(o={},n[t]=o),o[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,l=o[n],u=t[t.length-1],c=e._cacheIndex;u._cacheIndex=c,t[c]=u,t.pop(),delete l[i],Object.keys(l).length===0&&delete o[n]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new Tp(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){const n=t||this._root,i=n.uuid;let o=typeof e=="string"?$l.findByName(n,e):e;const l=o!==null?o.uuid:e,u=this._actionsByClip[l];let c=null;if(r===void 0&&(o!==null?r=o.blendMode:r=rc),u!==void 0){const h=u.actionByRoot[i];if(h!==void 0&&h.blendMode===r)return h;c=u.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const f=new IO(this,o,t,r);return this._bindAction(f,c),this._addInactiveAction(f,l,i),f}existingAction(e,t){const r=t||this._root,n=r.uuid,i=typeof e=="string"?$l.findByName(r,e):e,o=i?i.uuid:e,l=this._actionsByClip[o];return l!==void 0&&l.actionByRoot[n]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(n,e,i,o);const l=this._bindings,u=this._nActiveBindings;for(let c=0;c!==u;++c)l[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(i!==void 0){const o=i.knownActions;for(let l=0,u=o.length;l!==u;++l){const c=o[l];this._deactivateAction(c);const f=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=f,t[f]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete n[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const l=r[o].actionByRoot,u=l[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const n=this._bindingsByRootAndName,i=n[t];if(i!==void 0)for(const o in i){const l=i[o];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}jy.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class cf{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new cf(this.value.clone===void 0?this.value:this.value.clone())}}class Vy extends ps{constructor(e,t,r=1){super(e,t);this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}Vy.prototype.isInstancedInterleavedBuffer=!0;class zy{constructor(e,t,r,n,i){this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=n,this.count=i,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}zy.prototype.isGLBufferAttribute=!0;class DO{constructor(e,t,r=0,n=1/0){this.ray=new Ta(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new Ah,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return Up(e,this,r,t),r.sort(ky),r}intersectObjects(e,t=!0,r=[]){for(let n=0,i=e.length;n<i;n++)Up(e[n],this,r,t);return r.sort(ky),r}}function ky(m,e){return m.distance-e.distance}function Up(m,e,t,r){if(m.layers.test(e.layers)&&m.raycast(e,t),r===!0){const n=m.children;for(let i=0,o=n.length;i<o;i++)Up(n[i],e,t,!0)}}class PO{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(hr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class wO{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const Ky=new Et;class Wo{constructor(e=new Et(1/0,1/0),t=new Et(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ky.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ky.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Wo.prototype.isBox2=!0;const Yy=new Ie,ff=new Ie;class Xy{constructor(e=new Ie,t=new Ie){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Yy.subVectors(e,this.start),ff.subVectors(this.end,this.start);const r=ff.dot(ff);let i=ff.dot(Yy)/r;return t&&(i=hr(i,0,1)),i}closestPointToPoint(e,t,r){const n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Qy=new Ie;class OO extends un{constructor(e,t){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const r=new Jt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,l=1,u=32;o<u;o++,l++){const c=o/u*Math.PI*2,f=l/u*Math.PI*2;n.push(Math.cos(c),Math.sin(c),1,Math.cos(f),Math.sin(f),1)}r.setAttribute("position",new jt(n,3));const i=new rr({fog:!1,toneMapped:!1});this.cone=new wr(r,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Qy.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Qy),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const wa=new Ie,df=new zt,Wp=new zt;class Jy extends wr{constructor(e){const t=Zy(e),r=new Jt,n=[],i=[],o=new Ft(0,0,1),l=new Ft(0,1,0);for(let c=0;c<t.length;c++){const f=t[c];f.parent&&f.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(l.r,l.g,l.b))}r.setAttribute("position",new jt(n,3)),r.setAttribute("color",new jt(i,3));const u=new rr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,u);this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,n=r.getAttribute("position");Wp.copy(this.root.matrixWorld).invert();for(let i=0,o=0;i<t.length;i++){const l=t[i];l.parent&&l.parent.isBone&&(df.multiplyMatrices(Wp,l.matrixWorld),wa.setFromMatrixPosition(df),n.setXYZ(o,wa.x,wa.y,wa.z),df.multiplyMatrices(Wp,l.parent.matrixWorld),wa.setFromMatrixPosition(df),n.setXYZ(o+1,wa.x,wa.y,wa.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Zy(m){const e=[];m&&m.isBone&&e.push(m);for(let t=0;t<m.children.length;t++)e.push.apply(e,Zy(m.children[t]));return e}class LO extends Kn{constructor(e,t,r){const n=new ys(t,4,2),i=new Zi({wireframe:!0,fog:!1,toneMapped:!1});super(n,i);this.light=e,this.light.updateMatrixWorld(),this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const NO=new Ie,qy=new Ft,$y=new Ft;class FO extends un{constructor(e,t,r){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;const n=new vs(t);n.rotateY(Math.PI*.5),this.material=new Zi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=n.getAttribute("position"),o=new Float32Array(i.count*3);n.setAttribute("color",new hn(o,3)),this.add(new Kn(n,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");qy.copy(this.light.color),$y.copy(this.light.groundColor);for(let r=0,n=t.count;r<n;r++){const i=r<n/2?qy:$y;t.setXYZ(r,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(NO.setFromMatrixPosition(this.light.matrixWorld).negate())}}class eT extends wr{constructor(e=10,t=10,r=4473924,n=8947848){r=new Ft(r),n=new Ft(n);const i=t/2,o=e/t,l=e/2,u=[],c=[];for(let p=0,E=0,v=-l;p<=t;p++,v+=o){u.push(-l,0,v,l,0,v),u.push(v,0,-l,v,0,l);const M=p===i?r:n;M.toArray(c,E),E+=3,M.toArray(c,E),E+=3,M.toArray(c,E),E+=3,M.toArray(c,E),E+=3}const f=new Jt;f.setAttribute("position",new jt(u,3)),f.setAttribute("color",new jt(c,3));const h=new rr({vertexColors:!0,toneMapped:!1});super(f,h);this.type="GridHelper"}}class BO extends wr{constructor(e=10,t=16,r=8,n=64,i=4473924,o=8947848){i=new Ft(i),o=new Ft(o);const l=[],u=[];for(let h=0;h<=t;h++){const p=h/t*(Math.PI*2),E=Math.sin(p)*e,v=Math.cos(p)*e;l.push(0,0,0),l.push(E,0,v);const M=h&1?i:o;u.push(M.r,M.g,M.b),u.push(M.r,M.g,M.b)}for(let h=0;h<=r;h++){const p=h&1?i:o,E=e-e/r*h;for(let v=0;v<n;v++){let M=v/n*(Math.PI*2),y=Math.sin(M)*E,_=Math.cos(M)*E;l.push(y,0,_),u.push(p.r,p.g,p.b),M=(v+1)/n*(Math.PI*2),y=Math.sin(M)*E,_=Math.cos(M)*E,l.push(y,0,_),u.push(p.r,p.g,p.b)}}const c=new Jt;c.setAttribute("position",new jt(l,3)),c.setAttribute("color",new jt(u,3));const f=new rr({vertexColors:!0,toneMapped:!1});super(c,f);this.type="PolarGridHelper"}}const tT=new Ie,hf=new Ie,nT=new Ie;class UO extends un{constructor(e,t,r){super();this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t===void 0&&(t=1);let n=new Jt;n.setAttribute("position",new jt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new rr({fog:!1,toneMapped:!1});this.lightPlane=new ea(n,i),this.add(this.lightPlane),n=new Jt,n.setAttribute("position",new jt([0,0,0,0,0,1],3)),this.targetLine=new ea(n,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){tT.setFromMatrixPosition(this.light.matrixWorld),hf.setFromMatrixPosition(this.light.target.matrixWorld),nT.subVectors(hf,tT),this.lightPlane.lookAt(hf),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(hf),this.targetLine.scale.z=nT.length()}}const pf=new Ie,Fn=new Pl;class WO extends wr{constructor(e){const t=new Jt,r=new rr({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],o={},l=new Ft(16755200),u=new Ft(16711680),c=new Ft(43775),f=new Ft(16777215),h=new Ft(3355443);p("n1","n2",l),p("n2","n4",l),p("n4","n3",l),p("n3","n1",l),p("f1","f2",l),p("f2","f4",l),p("f4","f3",l),p("f3","f1",l),p("n1","f1",l),p("n2","f2",l),p("n3","f3",l),p("n4","f4",l),p("p","n1",u),p("p","n2",u),p("p","n3",u),p("p","n4",u),p("u1","u2",c),p("u2","u3",c),p("u3","u1",c),p("c","t",f),p("p","c",h),p("cn1","cn2",h),p("cn3","cn4",h),p("cf1","cf2",h),p("cf3","cf4",h);function p(v,M,y){E(v,y),E(M,y)}function E(v,M){n.push(0,0,0),i.push(M.r,M.g,M.b),o[v]===void 0&&(o[v]=[]),o[v].push(n.length/3-1)}t.setAttribute("position",new jt(n,3)),t.setAttribute("color",new jt(i,3));super(t,r);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap,r=1,n=1;Fn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Vn("c",t,e,Fn,0,0,-1),Vn("t",t,e,Fn,0,0,1),Vn("n1",t,e,Fn,-r,-n,-1),Vn("n2",t,e,Fn,r,-n,-1),Vn("n3",t,e,Fn,-r,n,-1),Vn("n4",t,e,Fn,r,n,-1),Vn("f1",t,e,Fn,-r,-n,1),Vn("f2",t,e,Fn,r,-n,1),Vn("f3",t,e,Fn,-r,n,1),Vn("f4",t,e,Fn,r,n,1),Vn("u1",t,e,Fn,r*.7,n*1.1,-1),Vn("u2",t,e,Fn,-r*.7,n*1.1,-1),Vn("u3",t,e,Fn,0,n*2,-1),Vn("cf1",t,e,Fn,-r,0,1),Vn("cf2",t,e,Fn,r,0,1),Vn("cf3",t,e,Fn,0,-n,1),Vn("cf4",t,e,Fn,0,n,1),Vn("cn1",t,e,Fn,-r,0,-1),Vn("cn2",t,e,Fn,r,0,-1),Vn("cn3",t,e,Fn,0,-n,-1),Vn("cn4",t,e,Fn,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Vn(m,e,t,r,n,i,o){pf.set(n,i,o).unproject(r);const l=e[m];if(l!==void 0){const u=t.getAttribute("position");for(let c=0,f=l.length;c<f;c++)u.setXYZ(l[c],pf.x,pf.y,pf.z)}}const mf=new Hr;class rT extends wr{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(8*3),i=new Jt;i.setIndex(new hn(r,1)),i.setAttribute("position",new hn(n,3));super(i,new rr({color:t,toneMapped:!1}));this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&mf.setFromObject(this.object),mf.isEmpty())return;const t=mf.min,r=mf.max,n=this.geometry.attributes.position,i=n.array;i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=t.x,i[4]=r.y,i[5]=r.z,i[6]=t.x,i[7]=t.y,i[8]=r.z,i[9]=r.x,i[10]=t.y,i[11]=r.z,i[12]=r.x,i[13]=r.y,i[14]=t.z,i[15]=t.x,i[16]=r.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=r.x,i[22]=t.y,i[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return wr.prototype.copy.call(this,e),this.object=e.object,this}}class HO extends wr{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],i=new Jt;i.setIndex(new hn(r,1)),i.setAttribute("position",new jt(n,3));super(i,new rr({color:t,toneMapped:!1}));this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class GO extends ea{constructor(e,t=1,r=16776960){const n=r,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new Jt;o.setAttribute("position",new jt(i,3)),o.computeBoundingSphere();super(o,new rr({color:n,toneMapped:!1}));this.type="PlaneHelper",this.plane=e,this.size=t;const l=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],u=new Jt;u.setAttribute("position",new jt(l,3)),u.computeBoundingSphere(),this.add(new Kn(u,new Zi({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Hn:Ya,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const iT=new Ie;let gf,Hp;class jO extends un{constructor(e=new Ie(0,0,1),t=new Ie(0,0,0),r=1,n=16776960,i=r*.2,o=i*.2){super();this.type="ArrowHelper",gf===void 0&&(gf=new Jt,gf.setAttribute("position",new jt([0,0,0,0,1,0],3)),Hp=new Da(0,.5,1,5,1),Hp.translate(0,-.5,0)),this.position.copy(t),this.line=new ea(gf,new rr({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Kn(Hp,new Zi({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{iT.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(iT,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class aT extends wr{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Jt;n.setAttribute("position",new jt(t,3)),n.setAttribute("color",new jt(r,3));const i=new rr({vertexColors:!0,toneMapped:!1});super(n,i);this.type="AxesHelper"}setColors(e,t,r){const n=new Ft,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class VO{constructor(){this.type="ShapePath",this.color=new Ft,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Yl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,o){return this.currentPath.bezierCurveTo(e,t,r,n,i,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function r(g){const R=[];for(let S=0,x=g.length;S<x;S++){const w=g[S],C=new Ai;C.curves=w.curves,R.push(C)}return R}function n(g,R){const S=R.length;let x=!1;for(let w=S-1,C=0;C<S;w=C++){let b=R[w],P=R[C],A=P.x-b.x,I=P.y-b.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(b=R[C],A=-A,P=R[w],I=-I),g.y<b.y||g.y>P.y)continue;if(g.y===b.y){if(g.x===b.x)return!0}else{const F=I*(g.x-b.x)-A*(g.y-b.y);if(F===0)return!0;if(F<0)continue;x=!x}}else{if(g.y!==b.y)continue;if(P.x<=g.x&&g.x<=b.x||b.x<=g.x&&g.x<=P.x)return!0}}return x}const i=xi.isClockWise,o=this.subPaths;if(o.length===0)return[];if(t===!0)return r(o);let l,u,c;const f=[];if(o.length===1)return u=o[0],c=new Ai,c.curves=u.curves,f.push(c),f;let h=!i(o[0].getPoints());h=e?!h:h;const p=[],E=[];let v=[],M=0,y;E[M]=void 0,v[M]=[];for(let g=0,R=o.length;g<R;g++)u=o[g],y=u.getPoints(),l=i(y),l=e?!l:l,l?(!h&&E[M]&&M++,E[M]={s:new Ai,p:y},E[M].s.curves=u.curves,h&&M++,v[M]=[]):v[M].push({h:u,p:y[0]});if(!E[0])return r(o);if(E.length>1){let g=!1;const R=[];for(let S=0,x=E.length;S<x;S++)p[S]=[];for(let S=0,x=E.length;S<x;S++){const w=v[S];for(let C=0;C<w.length;C++){const b=w[C];let P=!0;for(let A=0;A<E.length;A++)n(b.p,E[A].p)&&(S!==A&&R.push({froms:S,tos:A,hole:C}),P?(P=!1,p[A].push(b)):g=!0);P&&p[S].push(b)}}R.length>0&&(g||(v=p))}let _;for(let g=0,R=E.length;g<R;g++){c=E[g].s,f.push(c),_=v[g];for(let S=0,x=_.length;S<x;S++)c.holes.push(_[S].h)}return f}}const sT=new Float32Array(1),zO=new Int32Array(sT.buffer);class kO{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),sT[0]=e;const t=zO[0];let r=t>>16&32768,n=t>>12&2047;const i=t>>23&255;return i<103?r:i>142?(r|=31744,r|=(i==255?0:1)&&t&8388607,r):i<113?(n|=2048,r|=(n>>114-i)+(n>>113-i&1),r):(r|=i-112<<10|n>>1,r+=n&1,r)}}const KO=0,YO=1,XO=0,QO=1,JO=2;function ZO(m){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),m}function qO(m=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),m.isMultiMaterial=!0,m.materials=m,m.clone=function(){return m.slice()},m}function $O(m,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new jl(m,e)}function eL(m){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Wc(m)}function tL(m,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new jl(m,e)}function nL(m){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new _s(m)}function rL(m){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new _s(m)}function iL(m){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new _s(m)}function aL(m,e,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ie(m,e,t)}function sL(m,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new hn(m,e).setUsage(eo)}function oL(m,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Gv(m,e)}function lL(m,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new jv(m,e)}function uL(m,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Vv(m,e)}function cL(m,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new zv(m,e)}function fL(m,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new _c(m,e)}function dL(m,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new kv(m,e)}function hL(m,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new vc(m,e)}function pL(m,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new jt(m,e)}function mL(m,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Yv(m,e)}Vr.create=function(m,e){return console.log("THREE.Curve.create() has been deprecated"),m.prototype=Object.create(Vr.prototype),m.prototype.constructor=m,m.prototype.getPoint=e,m};Yl.prototype.fromPoints=function(m){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(m)};function gL(m){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new aT(m)}function _L(m,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rT(m,e)}function vL(m,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new wr(new tp(m.geometry),new rr({color:e!==void 0?e:16777215}))}eT.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};Jy.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function EL(m,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new wr(new dp(m.geometry),new rr({color:e!==void 0?e:16777215}))}xr.prototype.extractUrlBase=function(m){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),lf.extractUrlBase(m)};xr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function yL(m){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ci(m)}function TL(m){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new gy(m)}Wo.prototype.center=function(m){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(m)};Wo.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Wo.prototype.isIntersectionBox=function(m){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)};Wo.prototype.size=function(m){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(m)};Hr.prototype.center=function(m){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(m)};Hr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Hr.prototype.isIntersectionBox=function(m){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)};Hr.prototype.isIntersectionSphere=function(m){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(m)};Hr.prototype.size=function(m){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(m)};Ea.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};wl.prototype.setFromMatrix=function(m){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(m)};Xy.prototype.center=function(m){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(m)};Zn.prototype.flattenToArrayOffset=function(m,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(m,e)};Zn.prototype.multiplyVector3=function(m){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),m.applyMatrix3(this)};Zn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};Zn.prototype.applyToBufferAttribute=function(m){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),m.applyMatrix3(this)};Zn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};Zn.prototype.getInverse=function(m){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(m).invert()};zt.prototype.extractPosition=function(m){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(m)};zt.prototype.flattenToArrayOffset=function(m,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(m,e)};zt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Ie().setFromMatrixColumn(this,3)};zt.prototype.setRotationFromQuaternion=function(m){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(m)};zt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};zt.prototype.multiplyVector3=function(m){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)};zt.prototype.multiplyVector4=function(m){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)};zt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};zt.prototype.rotateAxis=function(m){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),m.transformDirection(this)};zt.prototype.crossVector=function(m){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)};zt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};zt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};zt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};zt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};zt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};zt.prototype.applyToBufferAttribute=function(m){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),m.applyMatrix4(this)};zt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};zt.prototype.makeFrustum=function(m,e,t,r,n,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(m,e,r,t,n,i)};zt.prototype.getInverse=function(m){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(m).invert()};Ti.prototype.isIntersectionLine=function(m){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(m)};pr.prototype.multiplyVector3=function(m){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),m.applyQuaternion(this)};pr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};Ta.prototype.isIntersectionBox=function(m){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(m)};Ta.prototype.isIntersectionPlane=function(m){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(m)};Ta.prototype.isIntersectionSphere=function(m){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(m)};Gn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};Gn.prototype.barycoordFromPoint=function(m,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(m,e)};Gn.prototype.midpoint=function(m){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(m)};Gn.prototypenormal=function(m){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(m)};Gn.prototype.plane=function(m){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(m)};Gn.barycoordFromPoint=function(m,e,t,r,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gn.getBarycoord(m,e,t,r,n)};Gn.normal=function(m,e,t,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gn.getNormal(m,e,t,r)};Ai.prototype.extractAllPoints=function(m){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(m)};Ai.prototype.extrude=function(m){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ri(this,m)};Ai.prototype.makeGeometry=function(m){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Es(this,m)};Et.prototype.fromAttribute=function(m,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,e,t)};Et.prototype.distanceToManhattan=function(m){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(m)};Et.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Ie.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};Ie.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};Ie.prototype.getPositionFromMatrix=function(m){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(m)};Ie.prototype.getScaleFromMatrix=function(m){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(m)};Ie.prototype.getColumnFromMatrix=function(m,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,m)};Ie.prototype.applyProjection=function(m){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(m)};Ie.prototype.fromAttribute=function(m,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,e,t)};Ie.prototype.distanceToManhattan=function(m){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(m)};Ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Mn.prototype.fromAttribute=function(m,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(m,e,t)};Mn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};un.prototype.getChildByName=function(m){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(m)};un.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};un.prototype.translate=function(m,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,m)};un.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};un.prototype.applyMatrix=function(m){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(m)};Object.defineProperties(un.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(m){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=m}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Kn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(Kn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),vv},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});jc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};nr.prototype.setLens=function(m,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(m)};Object.defineProperties(hi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(m){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=m}},shadowCameraLeft:{set:function(m){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=m}},shadowCameraRight:{set:function(m){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=m}},shadowCameraTop:{set:function(m){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=m}},shadowCameraBottom:{set:function(m){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=m}},shadowCameraNear:{set:function(m){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=m}},shadowCameraFar:{set:function(m){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=m}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(m){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=m}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(m){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=m}},shadowMapHeight:{set:function(m){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=m}}});Object.defineProperties(hn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===eo},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(eo)}}});hn.prototype.setDynamic=function(m){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(m===!0?eo:$s),this};hn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},hn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Jt.prototype.addIndex=function(m){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(m)};Jt.prototype.addAttribute=function(m,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(m,new hn(arguments[1],arguments[2]))):m==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(m,e)};Jt.prototype.addDrawCall=function(m,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(m,e)};Jt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};Jt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};Jt.prototype.removeAttribute=function(m){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(m)};Jt.prototype.applyMatrix=function(m){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(m)};Object.defineProperties(Jt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});ps.prototype.setDynamic=function(m){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(m===!0?eo:$s),this};ps.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Ri.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Ri.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Ri.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};Nc.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};cf.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this};Object.defineProperties(er.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ft}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(m){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===jd}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(m){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=m}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties($i.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(m){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=m}}});Sn.prototype.clearTarget=function(m,e,t,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(m),this.clear(e,t,r)};Sn.prototype.animate=function(m){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(m)};Sn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};Sn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};Sn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};Sn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};Sn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};Sn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};Sn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};Sn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};Sn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};Sn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};Sn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};Sn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};Sn.prototype.enableScissorTest=function(m){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(m)};Sn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};Sn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};Sn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};Sn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Sn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};Sn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};Sn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};Sn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};Sn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};Sn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(Sn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(m){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=m}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(m){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=m}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(m){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=m===!0?ma:fr}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(IE.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function ML(m,e,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new bc(m,t)}Object.defineProperties(oi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(m){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=m}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(m){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=m}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(m){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=m}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(m){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=m}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(m){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=m}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(m){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=m}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(m){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=m}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(m){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=m}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(m){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=m}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(m){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=m}}});Np.prototype.load=function(m){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new Dy().load(m,function(r){e.setBuffer(r)}),this};Wy.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};Cc.prototype.updateCubeMap=function(m,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(m,e)};Cc.prototype.clear=function(m,e,t,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(m,e,t,r)};ss.crossOrigin=void 0;ss.loadTexture=function(m,e,t,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const n=new _y;n.setCrossOrigin(this.crossOrigin);const i=n.load(m,t,void 0,r);return e&&(i.mapping=e),i};ss.loadTextureCube=function(m,e,t,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const n=new my;n.setCrossOrigin(this.crossOrigin);const i=n.load(m,t,void 0,r);return e&&(i.mapping=e),i};ss.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};ss.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function SL(){console.error("THREE.CanvasRenderer has been removed")}function AL(){console.error("THREE.JSONLoader has been removed.")}const xL={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function RL(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function CL(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new Jt}function bL(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new Jt}function IL(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function DL(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function PL(){console.error("THREE.ImmediateRenderObject has been removed.")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Wd}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Wd);var wL=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ACESFilmicToneMapping:T_,AddEquation:Qa,AddOperation:__,AdditiveAnimationBlendMode:oh,AdditiveBlending:Vd,AlphaFormat:I_,AlwaysDepth:c_,AlwaysStencilFunc:Sv,AmbientLight:Dp,AmbientLightProbe:wy,AnimationClip:$l,AnimationLoader:fO,AnimationMixer:jy,AnimationObjectGroup:Gy,AnimationUtils:Pn,ArcCurve:np,ArrayCamera:Kh,ArrowHelper:jO,Audio:Np,AudioAnalyser:Wy,AudioContext:Lp,AudioListener:_O,AudioLoader:Dy,AxesHelper:aT,AxisHelper:gL,BackSide:Hn,BasicDepthPacking:yv,BasicShadowMap:hC,BinaryTextureLoader:TL,Bone:Vc,BooleanKeyframeTrack:Ts,BoundingBoxHelper:_L,Box2:Wo,Box3:Hr,Box3Helper:HO,BoxBufferGeometry:qi,BoxGeometry:qi,BoxHelper:rT,BufferAttribute:hn,BufferGeometry:Jt,BufferGeometryLoader:Ry,ByteType:S_,Cache:Ss,Camera:Pl,CameraHelper:WO,CanvasRenderer:SL,CanvasTexture:qE,CatmullRomCurve3:op,CineonToneMapping:y_,CircleBufferGeometry:Co,CircleGeometry:Co,ClampToEdgeWrapping:ur,Clock:Ny,Color:Ft,ColorKeyframeTrack:Mp,CompressedTexture:$h,CompressedTextureLoader:dO,ConeBufferGeometry:bo,ConeGeometry:bo,CubeCamera:Cc,CubeReflectionMapping:Ja,CubeRefractionMapping:Za,CubeTexture:go,CubeTextureLoader:my,CubeUVReflectionMapping:Js,CubeUVRefractionMapping:_l,CubicBezierCurve:$c,CubicBezierCurve3:lp,CubicInterpolant:fy,CullFaceBack:Hd,CullFaceFront:Qg,CullFaceFrontBack:dC,CullFaceNone:Xg,Curve:Vr,CurvePath:ny,CustomBlending:Zg,CustomToneMapping:M_,CylinderBufferGeometry:Da,CylinderGeometry:Da,Cylindrical:wO,DataTexture:ms,DataTexture2DArray:wc,DataTexture3D:Vh,DataTextureLoader:gy,DataUtils:kO,DecrementStencilOp:AC,DecrementWrapStencilOp:RC,DefaultLoadingManager:py,DepthFormat:ts,DepthStencilFormat:qs,DepthTexture:$E,DirectionalLight:Ip,DirectionalLightHelper:UO,DiscreteInterpolant:dy,DodecahedronBufferGeometry:Io,DodecahedronGeometry:Io,DoubleSide:Xa,DstAlphaFactor:i_,DstColorFactor:s_,DynamicBufferAttribute:sL,DynamicCopyUsage:HC,DynamicDrawUsage:eo,DynamicReadUsage:BC,EdgesGeometry:tp,EdgesHelper:vL,EllipseCurve:Vl,EqualDepth:d_,EqualStencilFunc:DC,EquirectangularReflectionMapping:ml,EquirectangularRefractionMapping:gl,Euler:us,EventDispatcher:ga,ExtrudeBufferGeometry:Ri,ExtrudeGeometry:Ri,FaceColors:QO,FileLoader:Ci,FlatShading:jd,Float16BufferAttribute:Kv,Float32Attribute:pL,Float32BufferAttribute:jt,Float64Attribute:mL,Float64BufferAttribute:Yv,FloatType:yi,Fog:Bl,FogExp2:Fl,Font:DL,FontLoader:IL,FrontSide:Ya,Frustum:wl,GLBufferAttribute:zy,GLSL1:jC,GLSL3:fh,GammaEncoding:ic,GreaterDepth:p_,GreaterEqualDepth:h_,GreaterEqualStencilFunc:LC,GreaterStencilFunc:wC,GridHelper:eT,Group:hs,HalfFloatType:$a,HemisphereLight:Ap,HemisphereLightHelper:FO,HemisphereLightProbe:Py,IcosahedronBufferGeometry:Po,IcosahedronGeometry:Po,ImageBitmapLoader:Iy,ImageLoader:eu,ImageUtils:ss,ImmediateRenderObject:PL,IncrementStencilOp:SC,IncrementWrapStencilOp:xC,InstancedBufferAttribute:gs,InstancedBufferGeometry:Op,InstancedInterleavedBuffer:Vy,InstancedMesh:Qh,Int16Attribute:cL,Int16BufferAttribute:zv,Int32Attribute:dL,Int32BufferAttribute:kv,Int8Attribute:oL,Int8BufferAttribute:Gv,IntType:x_,InterleavedBuffer:ps,InterleavedBufferAttribute:Ia,Interpolant:ta,InterpolateDiscrete:Ml,InterpolateLinear:Sl,InterpolateSmooth:nc,InvertStencilOp:CC,JSONLoader:AL,KeepStencilOp:sc,KeyframeTrack:di,LOD:FE,LatheBufferGeometry:wo,LatheGeometry:wo,Layers:Ah,LensFlare:RL,LessDepth:f_,LessEqualDepth:qu,LessEqualStencilFunc:PC,LessStencilFunc:IC,Light:hi,LightProbe:nu,Line:ea,Line3:Xy,LineBasicMaterial:rr,LineCurve:Kl,LineCurve3:ty,LineDashedMaterial:yp,LineLoop:Zh,LinePieces:YO,LineSegments:wr,LineStrip:KO,LinearEncoding:fr,LinearFilter:Jn,LinearInterpolant:Tp,LinearMipMapLinearFilter:vC,LinearMipMapNearestFilter:_C,LinearMipmapLinearFilter:qa,LinearMipmapNearestFilter:Jd,LinearToneMapping:v_,Loader:xr,LoaderUtils:lf,LoadingManager:Sp,LogLuvEncoding:Ev,LoopOnce:mv,LoopPingPong:_v,LoopRepeat:gv,LuminanceAlphaFormat:P_,LuminanceFormat:D_,MOUSE:cC,Material:er,MaterialLoader:xy,Math:Rv,MathUtils:Rv,Matrix3:Zn,Matrix4:zt,MaxEquation:Yd,Mesh:Kn,MeshBasicMaterial:Zi,MeshDepthMaterial:Oc,MeshDistanceMaterial:Lc,MeshFaceMaterial:ZO,MeshLambertMaterial:vp,MeshMatcapMaterial:Ep,MeshNormalMaterial:_p,MeshPhongMaterial:mp,MeshPhysicalMaterial:pp,MeshStandardMaterial:of,MeshToonMaterial:gp,MinEquation:Kd,MirroredRepeatWrapping:El,MixOperation:g_,MultiMaterial:qO,MultiplyBlending:kd,MultiplyOperation:pl,NearestFilter:kn,NearestMipMapLinearFilter:gC,NearestMipMapNearestFilter:mC,NearestMipmapLinearFilter:tc,NearestMipmapNearestFilter:ec,NeverDepth:u_,NeverStencilFunc:bC,NoBlending:zi,NoColors:XO,NoToneMapping:pa,NormalAnimationBlendMode:rc,NormalBlending:Qs,NotEqualDepth:m_,NotEqualStencilFunc:OC,NumberKeyframeTrack:Zl,Object3D:un,ObjectLoader:hO,ObjectSpaceNormalMap:Mv,OctahedronBufferGeometry:vs,OctahedronGeometry:vs,OneFactor:t_,OneMinusDstAlphaFactor:a_,OneMinusDstColorFactor:o_,OneMinusSrcAlphaFactor:Qd,OneMinusSrcColorFactor:r_,OrthographicCamera:Ol,PCFShadowMap:Gd,PCFSoftShadowMap:Jg,PMREMGenerator:nE,ParametricGeometry:CL,Particle:eL,ParticleBasicMaterial:rL,ParticleSystem:tL,ParticleSystemMaterial:iL,Path:Yl,PerspectiveCamera:nr,Plane:Ti,PlaneBufferGeometry:cs,PlaneGeometry:cs,PlaneHelper:GO,PointCloud:$O,PointCloudMaterial:nL,PointLight:bp,PointLightHelper:LO,Points:jl,PointsMaterial:_s,PolarGridHelper:BO,PolyhedronBufferGeometry:Si,PolyhedronGeometry:Si,PositionalAudio:EO,PropertyBinding:mn,PropertyMixer:Hy,QuadraticBezierCurve:ef,QuadraticBezierCurve3:tf,Quaternion:pr,QuaternionKeyframeTrack:Uo,QuaternionLinearInterpolant:hy,REVISION:Wd,RGBADepthPacking:Tv,RGBAFormat:cr,RGBAIntegerFormat:U_,RGBA_ASTC_10x10_Format:Z_,RGBA_ASTC_10x5_Format:X_,RGBA_ASTC_10x6_Format:Q_,RGBA_ASTC_10x8_Format:J_,RGBA_ASTC_12x10_Format:q_,RGBA_ASTC_12x12_Format:$_,RGBA_ASTC_4x4_Format:H_,RGBA_ASTC_5x4_Format:G_,RGBA_ASTC_5x5_Format:j_,RGBA_ASTC_6x5_Format:V_,RGBA_ASTC_6x6_Format:z_,RGBA_ASTC_8x5_Format:k_,RGBA_ASTC_8x6_Format:K_,RGBA_ASTC_8x8_Format:Y_,RGBA_BPTC_Format:ev,RGBA_ETC2_EAC_Format:sh,RGBA_PVRTC_2BPPV1_Format:ih,RGBA_PVRTC_4BPPV1_Format:rh,RGBA_S3TC_DXT1_Format:qd,RGBA_S3TC_DXT3_Format:$d,RGBA_S3TC_DXT5_Format:eh,RGBDEncoding:ch,RGBEEncoding:ac,RGBEFormat:w_,RGBFormat:es,RGBIntegerFormat:B_,RGBM16Encoding:uh,RGBM7Encoding:lh,RGB_ETC1_Format:W_,RGB_ETC2_Format:ah,RGB_PVRTC_2BPPV1_Format:nh,RGB_PVRTC_4BPPV1_Format:th,RGB_S3TC_DXT1_Format:Zd,RGFormat:N_,RGIntegerFormat:F_,RawShaderMaterial:vo,Ray:Ta,Raycaster:DO,RectAreaLight:Pp,RedFormat:O_,RedIntegerFormat:L_,ReinhardToneMapping:E_,RepeatWrapping:vl,ReplaceStencilOp:MC,ReverseSubtractEquation:$g,RingBufferGeometry:Oo,RingGeometry:Oo,SRGB8_ALPHA8_ASTC_10x10_Format:dv,SRGB8_ALPHA8_ASTC_10x5_Format:uv,SRGB8_ALPHA8_ASTC_10x6_Format:cv,SRGB8_ALPHA8_ASTC_10x8_Format:fv,SRGB8_ALPHA8_ASTC_12x10_Format:hv,SRGB8_ALPHA8_ASTC_12x12_Format:pv,SRGB8_ALPHA8_ASTC_4x4_Format:tv,SRGB8_ALPHA8_ASTC_5x4_Format:nv,SRGB8_ALPHA8_ASTC_5x5_Format:rv,SRGB8_ALPHA8_ASTC_6x5_Format:iv,SRGB8_ALPHA8_ASTC_6x6_Format:av,SRGB8_ALPHA8_ASTC_8x5_Format:sv,SRGB8_ALPHA8_ASTC_8x6_Format:ov,SRGB8_ALPHA8_ASTC_8x8_Format:lv,Scene:Nc,SceneUtils:xL,ShaderChunk:on,ShaderLib:fi,ShaderMaterial:$i,ShadowMaterial:hp,Shape:Ai,ShapeBufferGeometry:Es,ShapeGeometry:Es,ShapePath:VO,ShapeUtils:xi,ShortType:A_,Skeleton:zc,SkeletonHelper:Jy,SkinnedMesh:jc,SmoothShading:pC,Sphere:Ea,SphereBufferGeometry:ys,SphereGeometry:ys,Spherical:PO,SphericalHarmonics3:wp,SplineCurve:nf,SpotLight:Rp,SpotLightHelper:OO,Sprite:Wc,SpriteMaterial:Fc,SrcAlphaFactor:Xd,SrcAlphaSaturateFactor:l_,SrcColorFactor:n_,StaticCopyUsage:WC,StaticDrawUsage:$s,StaticReadUsage:FC,StereoCamera:mO,StreamCopyUsage:GC,StreamDrawUsage:NC,StreamReadUsage:UC,StringKeyframeTrack:Ms,SubtractEquation:qg,SubtractiveBlending:zd,TOUCH:fC,TangentSpaceNormalMap:is,TetrahedronBufferGeometry:Lo,TetrahedronGeometry:Lo,TextGeometry:bL,Texture:qn,TextureLoader:_y,TorusBufferGeometry:No,TorusGeometry:No,TorusKnotBufferGeometry:Fo,TorusKnotGeometry:Fo,Triangle:Gn,TriangleFanDrawMode:yC,TriangleStripDrawMode:EC,TrianglesDrawMode:vv,TubeBufferGeometry:Bo,TubeGeometry:Bo,UVMapping:$u,Uint16Attribute:fL,Uint16BufferAttribute:_c,Uint32Attribute:hL,Uint32BufferAttribute:vc,Uint8Attribute:lL,Uint8BufferAttribute:jv,Uint8ClampedAttribute:uL,Uint8ClampedBufferAttribute:Vv,Uniform:cf,UniformsLib:Ot,UniformsUtils:Qv,UnsignedByteType:ki,UnsignedInt248Type:Zs,UnsignedIntType:Tl,UnsignedShort4444Type:R_,UnsignedShort5551Type:C_,UnsignedShort565Type:b_,UnsignedShortType:yl,VSMShadowMap:Xs,Vector2:Et,Vector3:Ie,Vector4:Mn,VectorKeyframeTrack:ql,Vertex:aL,VertexColors:JO,VideoTexture:ZE,WebGL1Renderer:PE,WebGLCubeRenderTarget:bc,WebGLMultipleRenderTargets:Iv,WebGLMultisampleRenderTarget:mh,WebGLRenderTarget:oi,WebGLRenderTargetCube:ML,WebGLRenderer:Sn,WebGLUtils:DE,WireframeGeometry:dp,WireframeHelper:EL,WrapAroundEnding:Al,XHRLoader:yL,ZeroCurvatureEnding:ns,ZeroFactor:e_,ZeroSlopeEnding:rs,ZeroStencilOp:TC,sRGBEncoding:ma}),Gp={exports:{}},OL=KR(wL);(function(m,e){var t=OL;t.OrbitControls=function(r,n){n===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=r,this.domElement=n,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.touches={ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(o),i.update(),f=c.NONE},this.update=function(){var z=new t.Vector3,oe=new t.Quaternion().setFromUnitVectors(r.up,new t.Vector3(0,1,0)),se=oe.clone().inverse(),ce=new t.Vector3,Se=new t.Quaternion;return function(){var ve=i.object.position;return z.copy(ve).sub(i.target),z.applyQuaternion(oe),p.setFromVector3(z),i.autoRotate&&f===c.NONE&&F(A()),i.enableDamping?(p.theta+=E.theta*i.dampingFactor,p.phi+=E.phi*i.dampingFactor):(p.theta+=E.theta,p.phi+=E.phi),p.theta=Math.max(i.minAzimuthAngle,Math.min(i.maxAzimuthAngle,p.theta)),p.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,p.phi)),p.makeSafe(),p.radius*=v,p.radius=Math.max(i.minDistance,Math.min(i.maxDistance,p.radius)),i.enableDamping===!0?i.target.addScaledVector(M,i.dampingFactor):i.target.add(M),z.setFromSpherical(p),z.applyQuaternion(se),ve.copy(i.target).add(z),i.object.lookAt(i.target),i.enableDamping===!0?(E.theta*=1-i.dampingFactor,E.phi*=1-i.dampingFactor,M.multiplyScalar(1-i.dampingFactor)):(E.set(0,0,0),M.set(0,0,0)),v=1,y||ce.distanceToSquared(i.object.position)>h||8*(1-Se.dot(i.object.quaternion))>h?(i.dispatchEvent(o),ce.copy(i.object.position),Se.copy(i.object.quaternion),y=!1,!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",X,!1),i.domElement.removeEventListener("mousedown",D,!1),i.domElement.removeEventListener("wheel",fe,!1),i.domElement.removeEventListener("touchstart",_e,!1),i.domElement.removeEventListener("touchend",j,!1),i.domElement.removeEventListener("touchmove",ee,!1),document.removeEventListener("mousemove",O,!1),document.removeEventListener("mouseup",U,!1),i.domElement.removeEventListener("keydown",ye,!1)};var i=this,o={type:"change"},l={type:"start"},u={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=c.NONE,h=1e-6,p=new t.Spherical,E=new t.Spherical,v=1,M=new t.Vector3,y=!1,_=new t.Vector2,g=new t.Vector2,R=new t.Vector2,S=new t.Vector2,x=new t.Vector2,w=new t.Vector2,C=new t.Vector2,b=new t.Vector2,P=new t.Vector2;function A(){return 2*Math.PI/60/60*i.autoRotateSpeed}function I(){return Math.pow(.95,i.zoomSpeed)}function F(z){E.theta-=z}function G(z){E.phi-=z}var V=function(){var z=new t.Vector3;return function(se,ce){z.setFromMatrixColumn(ce,0),z.multiplyScalar(-se),M.add(z)}}(),k=function(){var z=new t.Vector3;return function(se,ce){i.screenSpacePanning===!0?z.setFromMatrixColumn(ce,1):(z.setFromMatrixColumn(ce,0),z.crossVectors(i.object.up,z)),z.multiplyScalar(se),M.add(z)}}(),H=function(){var z=new t.Vector3;return function(se,ce){var Se=i.domElement;if(i.object.isPerspectiveCamera){var Me=i.object.position;z.copy(Me).sub(i.target);var ve=z.length();ve*=Math.tan(i.object.fov/2*Math.PI/180),V(2*se*ve/Se.clientHeight,i.object.matrix),k(2*ce*ve/Se.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(V(se*(i.object.right-i.object.left)/i.object.zoom/Se.clientWidth,i.object.matrix),k(ce*(i.object.top-i.object.bottom)/i.object.zoom/Se.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function J(z){i.object.isPerspectiveCamera?v/=z:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*z)),i.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function K(z){i.object.isPerspectiveCamera?v*=z:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/z)),i.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ae(z){_.set(z.clientX,z.clientY)}function re(z){C.set(z.clientX,z.clientY)}function le(z){S.set(z.clientX,z.clientY)}function me(z){g.set(z.clientX,z.clientY),R.subVectors(g,_).multiplyScalar(i.rotateSpeed);var oe=i.domElement;F(2*Math.PI*R.x/oe.clientHeight),G(2*Math.PI*R.y/oe.clientHeight),_.copy(g),i.update()}function de(z){b.set(z.clientX,z.clientY),P.subVectors(b,C),P.y>0?J(I()):P.y<0&&K(I()),C.copy(b),i.update()}function te(z){x.set(z.clientX,z.clientY),w.subVectors(x,S).multiplyScalar(i.panSpeed),H(w.x,w.y),S.copy(x),i.update()}function q(z){z.deltaY<0?K(I()):z.deltaY>0&&J(I()),i.update()}function Z(z){var oe=!1;switch(z.keyCode){case i.keys.UP:H(0,i.keyPanSpeed),oe=!0;break;case i.keys.BOTTOM:H(0,-i.keyPanSpeed),oe=!0;break;case i.keys.LEFT:H(i.keyPanSpeed,0),oe=!0;break;case i.keys.RIGHT:H(-i.keyPanSpeed,0),oe=!0;break}oe&&(z.preventDefault(),i.update())}function pe(z){if(z.touches.length==1)_.set(z.touches[0].pageX,z.touches[0].pageY);else{var oe=.5*(z.touches[0].pageX+z.touches[1].pageX),se=.5*(z.touches[0].pageY+z.touches[1].pageY);_.set(oe,se)}}function he(z){if(z.touches.length==1)S.set(z.touches[0].pageX,z.touches[0].pageY);else{var oe=.5*(z.touches[0].pageX+z.touches[1].pageX),se=.5*(z.touches[0].pageY+z.touches[1].pageY);S.set(oe,se)}}function Q(z){var oe=z.touches[0].pageX-z.touches[1].pageX,se=z.touches[0].pageY-z.touches[1].pageY,ce=Math.sqrt(oe*oe+se*se);C.set(0,ce)}function Y(z){i.enableZoom&&Q(z),i.enablePan&&he(z)}function ie(z){i.enableZoom&&Q(z),i.enableRotate&&pe(z)}function ue(z){if(z.touches.length==1)g.set(z.touches[0].pageX,z.touches[0].pageY);else{var oe=.5*(z.touches[0].pageX+z.touches[1].pageX),se=.5*(z.touches[0].pageY+z.touches[1].pageY);g.set(oe,se)}R.subVectors(g,_).multiplyScalar(i.rotateSpeed);var ce=i.domElement;F(2*Math.PI*R.x/ce.clientHeight),G(2*Math.PI*R.y/ce.clientHeight),_.copy(g)}function $(z){if(z.touches.length==1)x.set(z.touches[0].pageX,z.touches[0].pageY);else{var oe=.5*(z.touches[0].pageX+z.touches[1].pageX),se=.5*(z.touches[0].pageY+z.touches[1].pageY);x.set(oe,se)}w.subVectors(x,S).multiplyScalar(i.panSpeed),H(w.x,w.y),S.copy(x)}function W(z){var oe=z.touches[0].pageX-z.touches[1].pageX,se=z.touches[0].pageY-z.touches[1].pageY,ce=Math.sqrt(oe*oe+se*se);b.set(0,ce),P.set(0,Math.pow(b.y/C.y,i.zoomSpeed)),J(P.y),C.copy(b)}function B(z){i.enableZoom&&W(z),i.enablePan&&$(z)}function L(z){i.enableZoom&&W(z),i.enableRotate&&ue(z)}function D(z){if(i.enabled!==!1){switch(z.preventDefault(),i.domElement.focus?i.domElement.focus():window.focus(),z.button){case 0:switch(i.mouseButtons.LEFT){case t.MOUSE.ROTATE:if(z.ctrlKey||z.metaKey||z.shiftKey){if(i.enablePan===!1)return;le(z),f=c.PAN}else{if(i.enableRotate===!1)return;ae(z),f=c.ROTATE}break;case t.MOUSE.PAN:if(z.ctrlKey||z.metaKey||z.shiftKey){if(i.enableRotate===!1)return;ae(z),f=c.ROTATE}else{if(i.enablePan===!1)return;le(z),f=c.PAN}break;default:f=c.NONE}break;case 1:switch(i.mouseButtons.MIDDLE){case t.MOUSE.DOLLY:if(i.enableZoom===!1)return;re(z),f=c.DOLLY;break;default:f=c.NONE}break;case 2:switch(i.mouseButtons.RIGHT){case t.MOUSE.ROTATE:if(i.enableRotate===!1)return;ae(z),f=c.ROTATE;break;case t.MOUSE.PAN:if(i.enablePan===!1)return;le(z),f=c.PAN;break;default:f=c.NONE}break}f!==c.NONE&&(document.addEventListener("mousemove",O,!1),document.addEventListener("mouseup",U,!1),i.dispatchEvent(l))}}function O(z){if(i.enabled!==!1)switch(z.preventDefault(),f){case c.ROTATE:if(i.enableRotate===!1)return;me(z);break;case c.DOLLY:if(i.enableZoom===!1)return;de(z);break;case c.PAN:if(i.enablePan===!1)return;te(z);break}}function U(z){i.enabled!==!1&&(document.removeEventListener("mousemove",O,!1),document.removeEventListener("mouseup",U,!1),i.dispatchEvent(u),f=c.NONE)}function fe(z){i.enabled===!1||i.enableZoom===!1||f!==c.NONE&&f!==c.ROTATE||(z.preventDefault(),z.stopPropagation(),i.dispatchEvent(l),q(z),i.dispatchEvent(u))}function ye(z){i.enabled===!1||i.enableKeys===!1||i.enablePan===!1||Z(z)}function _e(z){if(i.enabled!==!1){switch(z.preventDefault(),z.touches.length){case 1:switch(i.touches.ONE){case t.TOUCH.ROTATE:if(i.enableRotate===!1)return;pe(z),f=c.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(i.enablePan===!1)return;he(z),f=c.TOUCH_PAN;break;default:f=c.NONE}break;case 2:switch(i.touches.TWO){case t.TOUCH.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Y(z),f=c.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ie(z),f=c.TOUCH_DOLLY_ROTATE;break;default:f=c.NONE}break;default:f=c.NONE}f!==c.NONE&&i.dispatchEvent(l)}}function ee(z){if(i.enabled!==!1)switch(z.preventDefault(),z.stopPropagation(),f){case c.TOUCH_ROTATE:if(i.enableRotate===!1)return;ue(z),i.update();break;case c.TOUCH_PAN:if(i.enablePan===!1)return;$(z),i.update();break;case c.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;B(z),i.update();break;case c.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;L(z),i.update();break;default:f=c.NONE}}function j(z){i.enabled!==!1&&(i.dispatchEvent(u),f=c.NONE)}function X(z){i.enabled!==!1&&z.preventDefault()}i.domElement.addEventListener("contextmenu",X,!1),i.domElement.addEventListener("mousedown",D,!1),i.domElement.addEventListener("wheel",fe,!1),i.domElement.addEventListener("touchstart",_e,!1),i.domElement.addEventListener("touchend",j,!1),i.domElement.addEventListener("touchmove",ee,!1),i.domElement.addEventListener("keydown",ye,!1),i.domElement.tabIndex===-1&&(i.domElement.tabIndex=0),this.update()},t.OrbitControls.prototype=Object.create(t.EventDispatcher.prototype),t.OrbitControls.prototype.constructor=t.OrbitControls,t.MapControls=function(r,n){t.OrbitControls.call(this,r,n),this.mouseButtons.LEFT=t.MOUSE.PAN,this.mouseButtons.RIGHT=t.MOUSE.ROTATE,this.touches.ONE=t.TOUCH.PAN,this.touches.TWO=t.TOUCH.DOLLY_ROTATE},t.MapControls.prototype=Object.create(t.EventDispatcher.prototype),t.MapControls.prototype.constructor=t.MapControls,m.exports=e.default=t.OrbitControls})(Gp,Gp.exports);var M1=Gp.exports,oT={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(m,e){(function(){var t,r="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",l="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",c=500,f="__lodash_placeholder__",h=1,p=2,E=4,v=1,M=2,y=1,_=2,g=4,R=8,S=16,x=32,w=64,C=128,b=256,P=512,A=30,I="...",F=800,G=16,V=1,k=2,H=3,J=1/0,K=9007199254740991,ae=17976931348623157e292,re=0/0,le=4294967295,me=le-1,de=le>>>1,te=[["ary",C],["bind",y],["bindKey",_],["curry",R],["curryRight",S],["flip",P],["partial",x],["partialRight",w],["rearg",b]],q="[object Arguments]",Z="[object Array]",pe="[object AsyncFunction]",he="[object Boolean]",Q="[object Date]",Y="[object DOMException]",ie="[object Error]",ue="[object Function]",$="[object GeneratorFunction]",W="[object Map]",B="[object Number]",L="[object Null]",D="[object Object]",O="[object Promise]",U="[object Proxy]",fe="[object RegExp]",ye="[object Set]",_e="[object String]",ee="[object Symbol]",j="[object Undefined]",X="[object WeakMap]",z="[object WeakSet]",oe="[object ArrayBuffer]",se="[object DataView]",ce="[object Float32Array]",Se="[object Float64Array]",Me="[object Int8Array]",ve="[object Int16Array]",be="[object Int32Array]",Ne="[object Uint8Array]",Ue="[object Uint8ClampedArray]",Xe="[object Uint16Array]",ot="[object Uint32Array]",ct=/\b__p \+= '';/g,xt=/\b(__p \+=) '' \+/g,Bt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Lt=/&(?:amp|lt|gt|quot|#39);/g,Pt=/[&<>"']/g,Ht=RegExp(Lt.source),Oe=RegExp(Pt.source),ze=/<%-([\s\S]+?)%>/g,Fe=/<%([\s\S]+?)%>/g,Ce=/<%=([\s\S]+?)%>/g,we=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qe=/^\w*$/,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,st=/[\\^$.*+?()[\]{}|]/g,at=RegExp(st.source),Ae=/^\s+/,Be=/\s/,We=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Te=/\{\n\/\* \[wrapped with (.+)\] \*/,De=/,? & /,Ze=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nt=/[()=,{}\[\]\/\s]/,ge=/\\(\\)?/g,Pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,Ye=/^[-+]0x[0-9a-f]+$/i,$e=/^0b[01]+$/i,ht=/^\[object .+?Constructor\]$/,bt=/^0o[0-7]+$/i,It=/^(?:0|[1-9]\d*)$/,Dt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gt=/($^)/,Yt=/['\n\r\u2028\u2029\\]/g,An="\\ud800-\\udfff",bn="\\u0300-\\u036f",tt="\\ufe20-\\ufe2f",mt="\\u20d0-\\u20ff",wt=bn+tt+mt,Ve="\\u2700-\\u27bf",ut="a-z\\xdf-\\xf6\\xf8-\\xff",He="\\xac\\xb1\\xd7\\xf7",rt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",dt="\\u2000-\\u206f",yt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",At="A-Z\\xc0-\\xd6\\xd8-\\xde",ke="\\ufe0e\\ufe0f",Mt=He+rt+dt+yt,Rt="['\u2019]",kt="["+An+"]",rn="["+Mt+"]",_n="["+wt+"]",En="\\d+",pn="["+Ve+"]",ar="["+ut+"]",zr="[^"+An+Mt+En+Ve+ut+At+"]",kr="\\ud83c[\\udffb-\\udfff]",mr="(?:"+_n+"|"+kr+")",Ii="[^"+An+"]",Di="(?:\\ud83c[\\udde6-\\uddff]){2}",ei="[\\ud800-\\udbff][\\udc00-\\udfff]",gr="["+At+"]",ia="\\u200d",Pi="(?:"+ar+"|"+zr+")",Ds="(?:"+gr+"|"+zr+")",Oa="(?:"+Rt+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Rt+"(?:D|LL|M|RE|S|T|VE))?",La=mr+"?",Na="["+ke+"]?",aa="(?:"+ia+"(?:"+[Ii,Di,ei].join("|")+")"+Na+La+")*",ws="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ge=Na+La+aa,ft="(?:"+[pn,Di,ei].join("|")+")"+Ge,Ct="(?:"+[Ii+_n+"?",_n,Di,ei,kt].join("|")+")",Wt=RegExp(Rt,"g"),Zt=RegExp(_n,"g"),$t=RegExp(kr+"(?="+kr+")|"+Ct+Ge,"g"),sn=RegExp([gr+"?"+ar+"+"+Oa+"(?="+[rn,gr,"$"].join("|")+")",Ds+"+"+Ps+"(?="+[rn,gr+Pi,"$"].join("|")+")",gr+"?"+Pi+"+"+Oa,gr+"+"+Ps,Fa,ws,En,ft].join("|"),"g"),sr=RegExp("["+ia+An+wt+ke+"]"),wn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mi=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sf=-1,Rn={};Rn[ce]=Rn[Se]=Rn[Me]=Rn[ve]=Rn[be]=Rn[Ne]=Rn[Ue]=Rn[Xe]=Rn[ot]=!0,Rn[q]=Rn[Z]=Rn[oe]=Rn[he]=Rn[se]=Rn[Q]=Rn[ie]=Rn[ue]=Rn[W]=Rn[B]=Rn[D]=Rn[fe]=Rn[ye]=Rn[_e]=Rn[X]=!1;var yn={};yn[q]=yn[Z]=yn[oe]=yn[se]=yn[he]=yn[Q]=yn[ce]=yn[Se]=yn[Me]=yn[ve]=yn[be]=yn[W]=yn[B]=yn[D]=yn[fe]=yn[ye]=yn[_e]=yn[ee]=yn[Ne]=yn[Ue]=yn[Xe]=yn[ot]=!0,yn[ie]=yn[ue]=yn[X]=!1;var Af={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},xf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Cf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bf=parseFloat,If=parseInt,iu=typeof cl=="object"&&cl&&cl.Object===Object&&cl,Df=typeof self=="object"&&self&&self.Object===Object&&self,Yn=iu||Df||Function("return this")(),zo=e&&!e.nodeType&&e,wi=zo&&!0&&m&&!m.nodeType&&m,au=wi&&wi.exports===zo,ko=au&&iu.process,Rr=function(){try{var Je=wi&&wi.require&&wi.require("util").types;return Je||ko&&ko.binding&&ko.binding("util")}catch{}}(),Os=Rr&&Rr.isArrayBuffer,su=Rr&&Rr.isDate,ou=Rr&&Rr.isMap,lu=Rr&&Rr.isRegExp,uu=Rr&&Rr.isSet,cu=Rr&&Rr.isTypedArray;function or(Je,pt,lt){switch(lt.length){case 0:return Je.call(pt);case 1:return Je.call(pt,lt[0]);case 2:return Je.call(pt,lt[0],lt[1]);case 3:return Je.call(pt,lt[0],lt[1],lt[2])}return Je.apply(pt,lt)}function Pf(Je,pt,lt,Ut){for(var qt=-1,gn=Je==null?0:Je.length;++qt<gn;){var Xn=Je[qt];pt(Ut,Xn,lt(Xn),Je)}return Ut}function Cr(Je,pt){for(var lt=-1,Ut=Je==null?0:Je.length;++lt<Ut&&pt(Je[lt],lt,Je)!==!1;);return Je}function wf(Je,pt){for(var lt=Je==null?0:Je.length;lt--&&pt(Je[lt],lt,Je)!==!1;);return Je}function fu(Je,pt){for(var lt=-1,Ut=Je==null?0:Je.length;++lt<Ut;)if(!pt(Je[lt],lt,Je))return!1;return!0}function gi(Je,pt){for(var lt=-1,Ut=Je==null?0:Je.length,qt=0,gn=[];++lt<Ut;){var Xn=Je[lt];pt(Xn,lt,Je)&&(gn[qt++]=Xn)}return gn}function Ls(Je,pt){var lt=Je==null?0:Je.length;return!!lt&&Ke(Je,pt,0)>-1}function sa(Je,pt,lt){for(var Ut=-1,qt=Je==null?0:Je.length;++Ut<qt;)if(lt(pt,Je[Ut]))return!0;return!1}function In(Je,pt){for(var lt=-1,Ut=Je==null?0:Je.length,qt=Array(Ut);++lt<Ut;)qt[lt]=pt(Je[lt],lt,Je);return qt}function ti(Je,pt){for(var lt=-1,Ut=pt.length,qt=Je.length;++lt<Ut;)Je[qt+lt]=pt[lt];return Je}function Ko(Je,pt,lt,Ut){var qt=-1,gn=Je==null?0:Je.length;for(Ut&&gn&&(lt=Je[++qt]);++qt<gn;)lt=pt(lt,Je[qt],qt,Je);return lt}function Yo(Je,pt,lt,Ut){var qt=Je==null?0:Je.length;for(Ut&&qt&&(lt=Je[--qt]);qt--;)lt=pt(lt,Je[qt],qt,Je);return lt}function Ba(Je,pt){for(var lt=-1,Ut=Je==null?0:Je.length;++lt<Ut;)if(pt(Je[lt],lt,Je))return!0;return!1}var Of=xn("length");function Lf(Je){return Je.split("")}function du(Je){return Je.match(Ze)||[]}function Xo(Je,pt,lt){var Ut;return lt(Je,function(qt,gn,Xn){if(pt(qt,gn,Xn))return Ut=gn,!1}),Ut}function Ua(Je,pt,lt,Ut){for(var qt=Je.length,gn=lt+(Ut?1:-1);Ut?gn--:++gn<qt;)if(pt(Je[gn],gn,Je))return gn;return-1}function Ke(Je,pt,lt){return pt===pt?bT(Je,pt,lt):Ua(Je,Gt,lt)}function St(Je,pt,lt,Ut){for(var qt=lt-1,gn=Je.length;++qt<gn;)if(Ut(Je[qt],pt))return qt;return-1}function Gt(Je){return Je!==Je}function dn(Je,pt){var lt=Je==null?0:Je.length;return lt?Nf(Je,pt)/lt:re}function xn(Je){return function(pt){return pt==null?t:pt[Je]}}function ni(Je){return function(pt){return Je==null?t:Je[pt]}}function Oi(Je,pt,lt,Ut,qt){return qt(Je,function(gn,Xn,Cn){lt=Ut?(Ut=!1,gn):pt(lt,gn,Xn,Cn)}),lt}function vT(Je,pt){var lt=Je.length;for(Je.sort(pt);lt--;)Je[lt]=Je[lt].value;return Je}function Nf(Je,pt){for(var lt,Ut=-1,qt=Je.length;++Ut<qt;){var gn=pt(Je[Ut]);gn!==t&&(lt=lt===t?gn:lt+gn)}return lt}function Ff(Je,pt){for(var lt=-1,Ut=Array(Je);++lt<Je;)Ut[lt]=pt(lt);return Ut}function ET(Je,pt){return In(pt,function(lt){return[lt,Je[lt]]})}function kp(Je){return Je&&Je.slice(0,Qp(Je)+1).replace(Ae,"")}function Lr(Je){return function(pt){return Je(pt)}}function Bf(Je,pt){return In(pt,function(lt){return Je[lt]})}function Qo(Je,pt){return Je.has(pt)}function Kp(Je,pt){for(var lt=-1,Ut=Je.length;++lt<Ut&&Ke(pt,Je[lt],0)>-1;);return lt}function Yp(Je,pt){for(var lt=Je.length;lt--&&Ke(pt,Je[lt],0)>-1;);return lt}function yT(Je,pt){for(var lt=Je.length,Ut=0;lt--;)Je[lt]===pt&&++Ut;return Ut}var TT=ni(Af),MT=ni(xf);function ST(Je){return"\\"+Cf[Je]}function AT(Je,pt){return Je==null?t:Je[pt]}function Ns(Je){return sr.test(Je)}function xT(Je){return wn.test(Je)}function RT(Je){for(var pt,lt=[];!(pt=Je.next()).done;)lt.push(pt.value);return lt}function Uf(Je){var pt=-1,lt=Array(Je.size);return Je.forEach(function(Ut,qt){lt[++pt]=[qt,Ut]}),lt}function Xp(Je,pt){return function(lt){return Je(pt(lt))}}function oa(Je,pt){for(var lt=-1,Ut=Je.length,qt=0,gn=[];++lt<Ut;){var Xn=Je[lt];(Xn===pt||Xn===f)&&(Je[lt]=f,gn[qt++]=lt)}return gn}function hu(Je){var pt=-1,lt=Array(Je.size);return Je.forEach(function(Ut){lt[++pt]=Ut}),lt}function CT(Je){var pt=-1,lt=Array(Je.size);return Je.forEach(function(Ut){lt[++pt]=[Ut,Ut]}),lt}function bT(Je,pt,lt){for(var Ut=lt-1,qt=Je.length;++Ut<qt;)if(Je[Ut]===pt)return Ut;return-1}function IT(Je,pt,lt){for(var Ut=lt+1;Ut--;)if(Je[Ut]===pt)return Ut;return Ut}function Fs(Je){return Ns(Je)?PT(Je):Of(Je)}function ri(Je){return Ns(Je)?wT(Je):Lf(Je)}function Qp(Je){for(var pt=Je.length;pt--&&Be.test(Je.charAt(pt)););return pt}var DT=ni(Rf);function PT(Je){for(var pt=$t.lastIndex=0;$t.test(Je);)++pt;return pt}function wT(Je){return Je.match($t)||[]}function OT(Je){return Je.match(sn)||[]}var LT=function Je(pt){pt=pt==null?Yn:Bs.defaults(Yn.Object(),pt,Bs.pick(Yn,mi));var lt=pt.Array,Ut=pt.Date,qt=pt.Error,gn=pt.Function,Xn=pt.Math,Cn=pt.Object,Wf=pt.RegExp,NT=pt.String,Kr=pt.TypeError,pu=lt.prototype,FT=gn.prototype,Us=Cn.prototype,mu=pt["__core-js_shared__"],gu=FT.toString,Tn=Us.hasOwnProperty,BT=0,Jp=function(){var d=/[^.]+$/.exec(mu&&mu.keys&&mu.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),_u=Us.toString,UT=gu.call(Cn),WT=Yn._,HT=Wf("^"+gu.call(Tn).replace(st,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vu=au?pt.Buffer:t,la=pt.Symbol,Eu=pt.Uint8Array,Zp=vu?vu.allocUnsafe:t,yu=Xp(Cn.getPrototypeOf,Cn),qp=Cn.create,$p=Us.propertyIsEnumerable,Tu=pu.splice,em=la?la.isConcatSpreadable:t,Jo=la?la.iterator:t,Wa=la?la.toStringTag:t,Mu=function(){try{var d=za(Cn,"defineProperty");return d({},"",{}),d}catch{}}(),GT=pt.clearTimeout!==Yn.clearTimeout&&pt.clearTimeout,jT=Ut&&Ut.now!==Yn.Date.now&&Ut.now,VT=pt.setTimeout!==Yn.setTimeout&&pt.setTimeout,Su=Xn.ceil,Au=Xn.floor,Hf=Cn.getOwnPropertySymbols,zT=vu?vu.isBuffer:t,tm=pt.isFinite,kT=pu.join,KT=Xp(Cn.keys,Cn),Qn=Xn.max,_r=Xn.min,YT=Ut.now,XT=pt.parseInt,nm=Xn.random,QT=pu.reverse,Gf=za(pt,"DataView"),Zo=za(pt,"Map"),jf=za(pt,"Promise"),Ws=za(pt,"Set"),qo=za(pt,"WeakMap"),$o=za(Cn,"create"),xu=qo&&new qo,Hs={},JT=ka(Gf),ZT=ka(Zo),qT=ka(jf),$T=ka(Ws),e0=ka(qo),Ru=la?la.prototype:t,el=Ru?Ru.valueOf:t,rm=Ru?Ru.toString:t;function xe(d){if(Nn(d)&&!en(d)&&!(d instanceof cn)){if(d instanceof Yr)return d;if(Tn.call(d,"__wrapped__"))return ig(d)}return new Yr(d)}var Gs=function(){function d(){}return function(T){if(!On(T))return{};if(qp)return qp(T);d.prototype=T;var N=new d;return d.prototype=t,N}}();function Cu(){}function Yr(d,T){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=t}xe.templateSettings={escape:ze,evaluate:Fe,interpolate:Ce,variable:"",imports:{_:xe}},xe.prototype=Cu.prototype,xe.prototype.constructor=xe,Yr.prototype=Gs(Cu.prototype),Yr.prototype.constructor=Yr;function cn(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=le,this.__views__=[]}function t0(){var d=new cn(this.__wrapped__);return d.__actions__=br(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=br(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=br(this.__views__),d}function n0(){if(this.__filtered__){var d=new cn(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function r0(){var d=this.__wrapped__.value(),T=this.__dir__,N=en(d),ne=T<0,Ee=N?d.length:0,Re=mM(0,Ee,this.__views__),Le=Re.start,je=Re.end,et=je-Le,_t=ne?je:Le-1,vt=this.__iteratees__,Tt=vt.length,Nt=0,Vt=_r(et,this.__takeCount__);if(!N||!ne&&Ee==et&&Vt==et)return Cm(d,this.__actions__);var Xt=[];e:for(;et--&&Nt<Vt;){_t+=T;for(var nn=-1,Qt=d[_t];++nn<Tt;){var ln=vt[nn],fn=ln.iteratee,Br=ln.type,Sr=fn(Qt);if(Br==k)Qt=Sr;else if(!Sr){if(Br==V)continue e;break e}}Xt[Nt++]=Qt}return Xt}cn.prototype=Gs(Cu.prototype),cn.prototype.constructor=cn;function Ha(d){var T=-1,N=d==null?0:d.length;for(this.clear();++T<N;){var ne=d[T];this.set(ne[0],ne[1])}}function i0(){this.__data__=$o?$o(null):{},this.size=0}function a0(d){var T=this.has(d)&&delete this.__data__[d];return this.size-=T?1:0,T}function s0(d){var T=this.__data__;if($o){var N=T[d];return N===u?t:N}return Tn.call(T,d)?T[d]:t}function o0(d){var T=this.__data__;return $o?T[d]!==t:Tn.call(T,d)}function l0(d,T){var N=this.__data__;return this.size+=this.has(d)?0:1,N[d]=$o&&T===t?u:T,this}Ha.prototype.clear=i0,Ha.prototype.delete=a0,Ha.prototype.get=s0,Ha.prototype.has=o0,Ha.prototype.set=l0;function Li(d){var T=-1,N=d==null?0:d.length;for(this.clear();++T<N;){var ne=d[T];this.set(ne[0],ne[1])}}function u0(){this.__data__=[],this.size=0}function c0(d){var T=this.__data__,N=bu(T,d);if(N<0)return!1;var ne=T.length-1;return N==ne?T.pop():Tu.call(T,N,1),--this.size,!0}function f0(d){var T=this.__data__,N=bu(T,d);return N<0?t:T[N][1]}function d0(d){return bu(this.__data__,d)>-1}function h0(d,T){var N=this.__data__,ne=bu(N,d);return ne<0?(++this.size,N.push([d,T])):N[ne][1]=T,this}Li.prototype.clear=u0,Li.prototype.delete=c0,Li.prototype.get=f0,Li.prototype.has=d0,Li.prototype.set=h0;function Ni(d){var T=-1,N=d==null?0:d.length;for(this.clear();++T<N;){var ne=d[T];this.set(ne[0],ne[1])}}function p0(){this.size=0,this.__data__={hash:new Ha,map:new(Zo||Li),string:new Ha}}function m0(d){var T=Hu(this,d).delete(d);return this.size-=T?1:0,T}function g0(d){return Hu(this,d).get(d)}function _0(d){return Hu(this,d).has(d)}function v0(d,T){var N=Hu(this,d),ne=N.size;return N.set(d,T),this.size+=N.size==ne?0:1,this}Ni.prototype.clear=p0,Ni.prototype.delete=m0,Ni.prototype.get=g0,Ni.prototype.has=_0,Ni.prototype.set=v0;function Ga(d){var T=-1,N=d==null?0:d.length;for(this.__data__=new Ni;++T<N;)this.add(d[T])}function E0(d){return this.__data__.set(d,u),this}function y0(d){return this.__data__.has(d)}Ga.prototype.add=Ga.prototype.push=E0,Ga.prototype.has=y0;function ii(d){var T=this.__data__=new Li(d);this.size=T.size}function T0(){this.__data__=new Li,this.size=0}function M0(d){var T=this.__data__,N=T.delete(d);return this.size=T.size,N}function S0(d){return this.__data__.get(d)}function A0(d){return this.__data__.has(d)}function x0(d,T){var N=this.__data__;if(N instanceof Li){var ne=N.__data__;if(!Zo||ne.length<n-1)return ne.push([d,T]),this.size=++N.size,this;N=this.__data__=new Ni(ne)}return N.set(d,T),this.size=N.size,this}ii.prototype.clear=T0,ii.prototype.delete=M0,ii.prototype.get=S0,ii.prototype.has=A0,ii.prototype.set=x0;function im(d,T){var N=en(d),ne=!N&&Ka(d),Ee=!N&&!ne&&ha(d),Re=!N&&!ne&&!Ee&&ks(d),Le=N||ne||Ee||Re,je=Le?Ff(d.length,NT):[],et=je.length;for(var _t in d)(T||Tn.call(d,_t))&&!(Le&&(_t=="length"||Ee&&(_t=="offset"||_t=="parent")||Re&&(_t=="buffer"||_t=="byteLength"||_t=="byteOffset")||Wi(_t,et)))&&je.push(_t);return je}function am(d){var T=d.length;return T?d[$f(0,T-1)]:t}function R0(d,T){return Gu(br(d),ja(T,0,d.length))}function C0(d){return Gu(br(d))}function Vf(d,T,N){(N!==t&&!ai(d[T],N)||N===t&&!(T in d))&&Fi(d,T,N)}function tl(d,T,N){var ne=d[T];(!(Tn.call(d,T)&&ai(ne,N))||N===t&&!(T in d))&&Fi(d,T,N)}function bu(d,T){for(var N=d.length;N--;)if(ai(d[N][0],T))return N;return-1}function b0(d,T,N,ne){return ua(d,function(Ee,Re,Le){T(ne,Ee,N(Ee),Le)}),ne}function sm(d,T){return d&&vi(T,$n(T),d)}function I0(d,T){return d&&vi(T,Dr(T),d)}function Fi(d,T,N){T=="__proto__"&&Mu?Mu(d,T,{configurable:!0,enumerable:!0,value:N,writable:!0}):d[T]=N}function zf(d,T){for(var N=-1,ne=T.length,Ee=lt(ne),Re=d==null;++N<ne;)Ee[N]=Re?t:Ad(d,T[N]);return Ee}function ja(d,T,N){return d===d&&(N!==t&&(d=d<=N?d:N),T!==t&&(d=d>=T?d:T)),d}function Xr(d,T,N,ne,Ee,Re){var Le,je=T&h,et=T&p,_t=T&E;if(N&&(Le=Ee?N(d,ne,Ee,Re):N(d)),Le!==t)return Le;if(!On(d))return d;var vt=en(d);if(vt){if(Le=_M(d),!je)return br(d,Le)}else{var Tt=vr(d),Nt=Tt==ue||Tt==$;if(ha(d))return Dm(d,je);if(Tt==D||Tt==q||Nt&&!Ee){if(Le=et||Nt?{}:Qm(d),!je)return et?sM(d,I0(Le,d)):aM(d,sm(Le,d))}else{if(!yn[Tt])return Ee?d:{};Le=vM(d,Tt,je)}}Re||(Re=new ii);var Vt=Re.get(d);if(Vt)return Vt;Re.set(d,Le),Ag(d)?d.forEach(function(Qt){Le.add(Xr(Qt,T,N,Qt,d,Re))}):Mg(d)&&d.forEach(function(Qt,ln){Le.set(ln,Xr(Qt,T,N,ln,d,Re))});var Xt=_t?et?cd:ud:et?Dr:$n,nn=vt?t:Xt(d);return Cr(nn||d,function(Qt,ln){nn&&(ln=Qt,Qt=d[ln]),tl(Le,ln,Xr(Qt,T,N,ln,d,Re))}),Le}function D0(d){var T=$n(d);return function(N){return om(N,d,T)}}function om(d,T,N){var ne=N.length;if(d==null)return!ne;for(d=Cn(d);ne--;){var Ee=N[ne],Re=T[Ee],Le=d[Ee];if(Le===t&&!(Ee in d)||!Re(Le))return!1}return!0}function lm(d,T,N){if(typeof d!="function")throw new Kr(o);return ll(function(){d.apply(t,N)},T)}function nl(d,T,N,ne){var Ee=-1,Re=Ls,Le=!0,je=d.length,et=[],_t=T.length;if(!je)return et;N&&(T=In(T,Lr(N))),ne?(Re=sa,Le=!1):T.length>=n&&(Re=Qo,Le=!1,T=new Ga(T));e:for(;++Ee<je;){var vt=d[Ee],Tt=N==null?vt:N(vt);if(vt=ne||vt!==0?vt:0,Le&&Tt===Tt){for(var Nt=_t;Nt--;)if(T[Nt]===Tt)continue e;et.push(vt)}else Re(T,Tt,ne)||et.push(vt)}return et}var ua=Nm(_i),um=Nm(Kf,!0);function P0(d,T){var N=!0;return ua(d,function(ne,Ee,Re){return N=!!T(ne,Ee,Re),N}),N}function Iu(d,T,N){for(var ne=-1,Ee=d.length;++ne<Ee;){var Re=d[ne],Le=T(Re);if(Le!=null&&(je===t?Le===Le&&!Fr(Le):N(Le,je)))var je=Le,et=Re}return et}function w0(d,T,N,ne){var Ee=d.length;for(N=tn(N),N<0&&(N=-N>Ee?0:Ee+N),ne=ne===t||ne>Ee?Ee:tn(ne),ne<0&&(ne+=Ee),ne=N>ne?0:Rg(ne);N<ne;)d[N++]=T;return d}function cm(d,T){var N=[];return ua(d,function(ne,Ee,Re){T(ne,Ee,Re)&&N.push(ne)}),N}function lr(d,T,N,ne,Ee){var Re=-1,Le=d.length;for(N||(N=yM),Ee||(Ee=[]);++Re<Le;){var je=d[Re];T>0&&N(je)?T>1?lr(je,T-1,N,ne,Ee):ti(Ee,je):ne||(Ee[Ee.length]=je)}return Ee}var kf=Fm(),fm=Fm(!0);function _i(d,T){return d&&kf(d,T,$n)}function Kf(d,T){return d&&fm(d,T,$n)}function Du(d,T){return gi(T,function(N){return Hi(d[N])})}function Va(d,T){T=fa(T,d);for(var N=0,ne=T.length;d!=null&&N<ne;)d=d[Ei(T[N++])];return N&&N==ne?d:t}function dm(d,T,N){var ne=T(d);return en(d)?ne:ti(ne,N(d))}function Tr(d){return d==null?d===t?j:L:Wa&&Wa in Cn(d)?pM(d):CM(d)}function Yf(d,T){return d>T}function O0(d,T){return d!=null&&Tn.call(d,T)}function L0(d,T){return d!=null&&T in Cn(d)}function N0(d,T,N){return d>=_r(T,N)&&d<Qn(T,N)}function Xf(d,T,N){for(var ne=N?sa:Ls,Ee=d[0].length,Re=d.length,Le=Re,je=lt(Re),et=1/0,_t=[];Le--;){var vt=d[Le];Le&&T&&(vt=In(vt,Lr(T))),et=_r(vt.length,et),je[Le]=!N&&(T||Ee>=120&&vt.length>=120)?new Ga(Le&&vt):t}vt=d[0];var Tt=-1,Nt=je[0];e:for(;++Tt<Ee&&_t.length<et;){var Vt=vt[Tt],Xt=T?T(Vt):Vt;if(Vt=N||Vt!==0?Vt:0,!(Nt?Qo(Nt,Xt):ne(_t,Xt,N))){for(Le=Re;--Le;){var nn=je[Le];if(!(nn?Qo(nn,Xt):ne(d[Le],Xt,N)))continue e}Nt&&Nt.push(Xt),_t.push(Vt)}}return _t}function F0(d,T,N,ne){return _i(d,function(Ee,Re,Le){T(ne,N(Ee),Re,Le)}),ne}function rl(d,T,N){T=fa(T,d),d=$m(d,T);var ne=d==null?d:d[Ei(Jr(T))];return ne==null?t:or(ne,d,N)}function hm(d){return Nn(d)&&Tr(d)==q}function B0(d){return Nn(d)&&Tr(d)==oe}function U0(d){return Nn(d)&&Tr(d)==Q}function il(d,T,N,ne,Ee){return d===T?!0:d==null||T==null||!Nn(d)&&!Nn(T)?d!==d&&T!==T:W0(d,T,N,ne,il,Ee)}function W0(d,T,N,ne,Ee,Re){var Le=en(d),je=en(T),et=Le?Z:vr(d),_t=je?Z:vr(T);et=et==q?D:et,_t=_t==q?D:_t;var vt=et==D,Tt=_t==D,Nt=et==_t;if(Nt&&ha(d)){if(!ha(T))return!1;Le=!0,vt=!1}if(Nt&&!vt)return Re||(Re=new ii),Le||ks(d)?Km(d,T,N,ne,Ee,Re):dM(d,T,et,N,ne,Ee,Re);if(!(N&v)){var Vt=vt&&Tn.call(d,"__wrapped__"),Xt=Tt&&Tn.call(T,"__wrapped__");if(Vt||Xt){var nn=Vt?d.value():d,Qt=Xt?T.value():T;return Re||(Re=new ii),Ee(nn,Qt,N,ne,Re)}}return Nt?(Re||(Re=new ii),hM(d,T,N,ne,Ee,Re)):!1}function H0(d){return Nn(d)&&vr(d)==W}function Qf(d,T,N,ne){var Ee=N.length,Re=Ee,Le=!ne;if(d==null)return!Re;for(d=Cn(d);Ee--;){var je=N[Ee];if(Le&&je[2]?je[1]!==d[je[0]]:!(je[0]in d))return!1}for(;++Ee<Re;){je=N[Ee];var et=je[0],_t=d[et],vt=je[1];if(Le&&je[2]){if(_t===t&&!(et in d))return!1}else{var Tt=new ii;if(ne)var Nt=ne(_t,vt,et,d,T,Tt);if(!(Nt===t?il(vt,_t,v|M,ne,Tt):Nt))return!1}}return!0}function pm(d){if(!On(d)||MM(d))return!1;var T=Hi(d)?HT:ht;return T.test(ka(d))}function G0(d){return Nn(d)&&Tr(d)==fe}function j0(d){return Nn(d)&&vr(d)==ye}function V0(d){return Nn(d)&&Yu(d.length)&&!!Rn[Tr(d)]}function mm(d){return typeof d=="function"?d:d==null?Pr:typeof d=="object"?en(d)?vm(d[0],d[1]):_m(d):Bg(d)}function Jf(d){if(!ol(d))return KT(d);var T=[];for(var N in Cn(d))Tn.call(d,N)&&N!="constructor"&&T.push(N);return T}function z0(d){if(!On(d))return RM(d);var T=ol(d),N=[];for(var ne in d)ne=="constructor"&&(T||!Tn.call(d,ne))||N.push(ne);return N}function Zf(d,T){return d<T}function gm(d,T){var N=-1,ne=Ir(d)?lt(d.length):[];return ua(d,function(Ee,Re,Le){ne[++N]=T(Ee,Re,Le)}),ne}function _m(d){var T=dd(d);return T.length==1&&T[0][2]?Zm(T[0][0],T[0][1]):function(N){return N===d||Qf(N,d,T)}}function vm(d,T){return pd(d)&&Jm(T)?Zm(Ei(d),T):function(N){var ne=Ad(N,d);return ne===t&&ne===T?xd(N,d):il(T,ne,v|M)}}function Pu(d,T,N,ne,Ee){d!==T&&kf(T,function(Re,Le){if(Ee||(Ee=new ii),On(Re))k0(d,T,Le,N,Pu,ne,Ee);else{var je=ne?ne(gd(d,Le),Re,Le+"",d,T,Ee):t;je===t&&(je=Re),Vf(d,Le,je)}},Dr)}function k0(d,T,N,ne,Ee,Re,Le){var je=gd(d,N),et=gd(T,N),_t=Le.get(et);if(_t){Vf(d,N,_t);return}var vt=Re?Re(je,et,N+"",d,T,Le):t,Tt=vt===t;if(Tt){var Nt=en(et),Vt=!Nt&&ha(et),Xt=!Nt&&!Vt&&ks(et);vt=et,Nt||Vt||Xt?en(je)?vt=je:Un(je)?vt=br(je):Vt?(Tt=!1,vt=Dm(et,!0)):Xt?(Tt=!1,vt=Pm(et,!0)):vt=[]:ul(et)||Ka(et)?(vt=je,Ka(je)?vt=Cg(je):(!On(je)||Hi(je))&&(vt=Qm(et))):Tt=!1}Tt&&(Le.set(et,vt),Ee(vt,et,ne,Re,Le),Le.delete(et)),Vf(d,N,vt)}function Em(d,T){var N=d.length;if(!!N)return T+=T<0?N:0,Wi(T,N)?d[T]:t}function ym(d,T,N){T.length?T=In(T,function(Re){return en(Re)?function(Le){return Va(Le,Re.length===1?Re[0]:Re)}:Re}):T=[Pr];var ne=-1;T=In(T,Lr(Kt()));var Ee=gm(d,function(Re,Le,je){var et=In(T,function(_t){return _t(Re)});return{criteria:et,index:++ne,value:Re}});return vT(Ee,function(Re,Le){return iM(Re,Le,N)})}function K0(d,T){return Tm(d,T,function(N,ne){return xd(d,ne)})}function Tm(d,T,N){for(var ne=-1,Ee=T.length,Re={};++ne<Ee;){var Le=T[ne],je=Va(d,Le);N(je,Le)&&al(Re,fa(Le,d),je)}return Re}function Y0(d){return function(T){return Va(T,d)}}function qf(d,T,N,ne){var Ee=ne?St:Ke,Re=-1,Le=T.length,je=d;for(d===T&&(T=br(T)),N&&(je=In(d,Lr(N)));++Re<Le;)for(var et=0,_t=T[Re],vt=N?N(_t):_t;(et=Ee(je,vt,et,ne))>-1;)je!==d&&Tu.call(je,et,1),Tu.call(d,et,1);return d}function Mm(d,T){for(var N=d?T.length:0,ne=N-1;N--;){var Ee=T[N];if(N==ne||Ee!==Re){var Re=Ee;Wi(Ee)?Tu.call(d,Ee,1):nd(d,Ee)}}return d}function $f(d,T){return d+Au(nm()*(T-d+1))}function X0(d,T,N,ne){for(var Ee=-1,Re=Qn(Su((T-d)/(N||1)),0),Le=lt(Re);Re--;)Le[ne?Re:++Ee]=d,d+=N;return Le}function ed(d,T){var N="";if(!d||T<1||T>K)return N;do T%2&&(N+=d),T=Au(T/2),T&&(d+=d);while(T);return N}function an(d,T){return _d(qm(d,T,Pr),d+"")}function Q0(d){return am(Ks(d))}function J0(d,T){var N=Ks(d);return Gu(N,ja(T,0,N.length))}function al(d,T,N,ne){if(!On(d))return d;T=fa(T,d);for(var Ee=-1,Re=T.length,Le=Re-1,je=d;je!=null&&++Ee<Re;){var et=Ei(T[Ee]),_t=N;if(et==="__proto__"||et==="constructor"||et==="prototype")return d;if(Ee!=Le){var vt=je[et];_t=ne?ne(vt,et,je):t,_t===t&&(_t=On(vt)?vt:Wi(T[Ee+1])?[]:{})}tl(je,et,_t),je=je[et]}return d}var Sm=xu?function(d,T){return xu.set(d,T),d}:Pr,Z0=Mu?function(d,T){return Mu(d,"toString",{configurable:!0,enumerable:!1,value:Cd(T),writable:!0})}:Pr;function q0(d){return Gu(Ks(d))}function Qr(d,T,N){var ne=-1,Ee=d.length;T<0&&(T=-T>Ee?0:Ee+T),N=N>Ee?Ee:N,N<0&&(N+=Ee),Ee=T>N?0:N-T>>>0,T>>>=0;for(var Re=lt(Ee);++ne<Ee;)Re[ne]=d[ne+T];return Re}function $0(d,T){var N;return ua(d,function(ne,Ee,Re){return N=T(ne,Ee,Re),!N}),!!N}function wu(d,T,N){var ne=0,Ee=d==null?ne:d.length;if(typeof T=="number"&&T===T&&Ee<=de){for(;ne<Ee;){var Re=ne+Ee>>>1,Le=d[Re];Le!==null&&!Fr(Le)&&(N?Le<=T:Le<T)?ne=Re+1:Ee=Re}return Ee}return td(d,T,Pr,N)}function td(d,T,N,ne){var Ee=0,Re=d==null?0:d.length;if(Re===0)return 0;T=N(T);for(var Le=T!==T,je=T===null,et=Fr(T),_t=T===t;Ee<Re;){var vt=Au((Ee+Re)/2),Tt=N(d[vt]),Nt=Tt!==t,Vt=Tt===null,Xt=Tt===Tt,nn=Fr(Tt);if(Le)var Qt=ne||Xt;else _t?Qt=Xt&&(ne||Nt):je?Qt=Xt&&Nt&&(ne||!Vt):et?Qt=Xt&&Nt&&!Vt&&(ne||!nn):Vt||nn?Qt=!1:Qt=ne?Tt<=T:Tt<T;Qt?Ee=vt+1:Re=vt}return _r(Re,me)}function Am(d,T){for(var N=-1,ne=d.length,Ee=0,Re=[];++N<ne;){var Le=d[N],je=T?T(Le):Le;if(!N||!ai(je,et)){var et=je;Re[Ee++]=Le===0?0:Le}}return Re}function xm(d){return typeof d=="number"?d:Fr(d)?re:+d}function Nr(d){if(typeof d=="string")return d;if(en(d))return In(d,Nr)+"";if(Fr(d))return rm?rm.call(d):"";var T=d+"";return T=="0"&&1/d==-J?"-0":T}function ca(d,T,N){var ne=-1,Ee=Ls,Re=d.length,Le=!0,je=[],et=je;if(N)Le=!1,Ee=sa;else if(Re>=n){var _t=T?null:cM(d);if(_t)return hu(_t);Le=!1,Ee=Qo,et=new Ga}else et=T?[]:je;e:for(;++ne<Re;){var vt=d[ne],Tt=T?T(vt):vt;if(vt=N||vt!==0?vt:0,Le&&Tt===Tt){for(var Nt=et.length;Nt--;)if(et[Nt]===Tt)continue e;T&&et.push(Tt),je.push(vt)}else Ee(et,Tt,N)||(et!==je&&et.push(Tt),je.push(vt))}return je}function nd(d,T){return T=fa(T,d),d=$m(d,T),d==null||delete d[Ei(Jr(T))]}function Rm(d,T,N,ne){return al(d,T,N(Va(d,T)),ne)}function Ou(d,T,N,ne){for(var Ee=d.length,Re=ne?Ee:-1;(ne?Re--:++Re<Ee)&&T(d[Re],Re,d););return N?Qr(d,ne?0:Re,ne?Re+1:Ee):Qr(d,ne?Re+1:0,ne?Ee:Re)}function Cm(d,T){var N=d;return N instanceof cn&&(N=N.value()),Ko(T,function(ne,Ee){return Ee.func.apply(Ee.thisArg,ti([ne],Ee.args))},N)}function rd(d,T,N){var ne=d.length;if(ne<2)return ne?ca(d[0]):[];for(var Ee=-1,Re=lt(ne);++Ee<ne;)for(var Le=d[Ee],je=-1;++je<ne;)je!=Ee&&(Re[Ee]=nl(Re[Ee]||Le,d[je],T,N));return ca(lr(Re,1),T,N)}function bm(d,T,N){for(var ne=-1,Ee=d.length,Re=T.length,Le={};++ne<Ee;){var je=ne<Re?T[ne]:t;N(Le,d[ne],je)}return Le}function id(d){return Un(d)?d:[]}function ad(d){return typeof d=="function"?d:Pr}function fa(d,T){return en(d)?d:pd(d,T)?[d]:rg(vn(d))}var eM=an;function da(d,T,N){var ne=d.length;return N=N===t?ne:N,!T&&N>=ne?d:Qr(d,T,N)}var Im=GT||function(d){return Yn.clearTimeout(d)};function Dm(d,T){if(T)return d.slice();var N=d.length,ne=Zp?Zp(N):new d.constructor(N);return d.copy(ne),ne}function sd(d){var T=new d.constructor(d.byteLength);return new Eu(T).set(new Eu(d)),T}function tM(d,T){var N=T?sd(d.buffer):d.buffer;return new d.constructor(N,d.byteOffset,d.byteLength)}function nM(d){var T=new d.constructor(d.source,qe.exec(d));return T.lastIndex=d.lastIndex,T}function rM(d){return el?Cn(el.call(d)):{}}function Pm(d,T){var N=T?sd(d.buffer):d.buffer;return new d.constructor(N,d.byteOffset,d.length)}function wm(d,T){if(d!==T){var N=d!==t,ne=d===null,Ee=d===d,Re=Fr(d),Le=T!==t,je=T===null,et=T===T,_t=Fr(T);if(!je&&!_t&&!Re&&d>T||Re&&Le&&et&&!je&&!_t||ne&&Le&&et||!N&&et||!Ee)return 1;if(!ne&&!Re&&!_t&&d<T||_t&&N&&Ee&&!ne&&!Re||je&&N&&Ee||!Le&&Ee||!et)return-1}return 0}function iM(d,T,N){for(var ne=-1,Ee=d.criteria,Re=T.criteria,Le=Ee.length,je=N.length;++ne<Le;){var et=wm(Ee[ne],Re[ne]);if(et){if(ne>=je)return et;var _t=N[ne];return et*(_t=="desc"?-1:1)}}return d.index-T.index}function Om(d,T,N,ne){for(var Ee=-1,Re=d.length,Le=N.length,je=-1,et=T.length,_t=Qn(Re-Le,0),vt=lt(et+_t),Tt=!ne;++je<et;)vt[je]=T[je];for(;++Ee<Le;)(Tt||Ee<Re)&&(vt[N[Ee]]=d[Ee]);for(;_t--;)vt[je++]=d[Ee++];return vt}function Lm(d,T,N,ne){for(var Ee=-1,Re=d.length,Le=-1,je=N.length,et=-1,_t=T.length,vt=Qn(Re-je,0),Tt=lt(vt+_t),Nt=!ne;++Ee<vt;)Tt[Ee]=d[Ee];for(var Vt=Ee;++et<_t;)Tt[Vt+et]=T[et];for(;++Le<je;)(Nt||Ee<Re)&&(Tt[Vt+N[Le]]=d[Ee++]);return Tt}function br(d,T){var N=-1,ne=d.length;for(T||(T=lt(ne));++N<ne;)T[N]=d[N];return T}function vi(d,T,N,ne){var Ee=!N;N||(N={});for(var Re=-1,Le=T.length;++Re<Le;){var je=T[Re],et=ne?ne(N[je],d[je],je,N,d):t;et===t&&(et=d[je]),Ee?Fi(N,je,et):tl(N,je,et)}return N}function aM(d,T){return vi(d,hd(d),T)}function sM(d,T){return vi(d,Ym(d),T)}function Lu(d,T){return function(N,ne){var Ee=en(N)?Pf:b0,Re=T?T():{};return Ee(N,d,Kt(ne,2),Re)}}function js(d){return an(function(T,N){var ne=-1,Ee=N.length,Re=Ee>1?N[Ee-1]:t,Le=Ee>2?N[2]:t;for(Re=d.length>3&&typeof Re=="function"?(Ee--,Re):t,Le&&Mr(N[0],N[1],Le)&&(Re=Ee<3?t:Re,Ee=1),T=Cn(T);++ne<Ee;){var je=N[ne];je&&d(T,je,ne,Re)}return T})}function Nm(d,T){return function(N,ne){if(N==null)return N;if(!Ir(N))return d(N,ne);for(var Ee=N.length,Re=T?Ee:-1,Le=Cn(N);(T?Re--:++Re<Ee)&&ne(Le[Re],Re,Le)!==!1;);return N}}function Fm(d){return function(T,N,ne){for(var Ee=-1,Re=Cn(T),Le=ne(T),je=Le.length;je--;){var et=Le[d?je:++Ee];if(N(Re[et],et,Re)===!1)break}return T}}function oM(d,T,N){var ne=T&y,Ee=sl(d);function Re(){var Le=this&&this!==Yn&&this instanceof Re?Ee:d;return Le.apply(ne?N:this,arguments)}return Re}function Bm(d){return function(T){T=vn(T);var N=Ns(T)?ri(T):t,ne=N?N[0]:T.charAt(0),Ee=N?da(N,1).join(""):T.slice(1);return ne[d]()+Ee}}function Vs(d){return function(T){return Ko(Ng(Lg(T).replace(Wt,"")),d,"")}}function sl(d){return function(){var T=arguments;switch(T.length){case 0:return new d;case 1:return new d(T[0]);case 2:return new d(T[0],T[1]);case 3:return new d(T[0],T[1],T[2]);case 4:return new d(T[0],T[1],T[2],T[3]);case 5:return new d(T[0],T[1],T[2],T[3],T[4]);case 6:return new d(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new d(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var N=Gs(d.prototype),ne=d.apply(N,T);return On(ne)?ne:N}}function lM(d,T,N){var ne=sl(d);function Ee(){for(var Re=arguments.length,Le=lt(Re),je=Re,et=zs(Ee);je--;)Le[je]=arguments[je];var _t=Re<3&&Le[0]!==et&&Le[Re-1]!==et?[]:oa(Le,et);if(Re-=_t.length,Re<N)return jm(d,T,Nu,Ee.placeholder,t,Le,_t,t,t,N-Re);var vt=this&&this!==Yn&&this instanceof Ee?ne:d;return or(vt,this,Le)}return Ee}function Um(d){return function(T,N,ne){var Ee=Cn(T);if(!Ir(T)){var Re=Kt(N,3);T=$n(T),N=function(je){return Re(Ee[je],je,Ee)}}var Le=d(T,N,ne);return Le>-1?Ee[Re?T[Le]:Le]:t}}function Wm(d){return Ui(function(T){var N=T.length,ne=N,Ee=Yr.prototype.thru;for(d&&T.reverse();ne--;){var Re=T[ne];if(typeof Re!="function")throw new Kr(o);if(Ee&&!Le&&Wu(Re)=="wrapper")var Le=new Yr([],!0)}for(ne=Le?ne:N;++ne<N;){Re=T[ne];var je=Wu(Re),et=je=="wrapper"?fd(Re):t;et&&md(et[0])&&et[1]==(C|R|x|b)&&!et[4].length&&et[9]==1?Le=Le[Wu(et[0])].apply(Le,et[3]):Le=Re.length==1&&md(Re)?Le[je]():Le.thru(Re)}return function(){var _t=arguments,vt=_t[0];if(Le&&_t.length==1&&en(vt))return Le.plant(vt).value();for(var Tt=0,Nt=N?T[Tt].apply(this,_t):vt;++Tt<N;)Nt=T[Tt].call(this,Nt);return Nt}})}function Nu(d,T,N,ne,Ee,Re,Le,je,et,_t){var vt=T&C,Tt=T&y,Nt=T&_,Vt=T&(R|S),Xt=T&P,nn=Nt?t:sl(d);function Qt(){for(var ln=arguments.length,fn=lt(ln),Br=ln;Br--;)fn[Br]=arguments[Br];if(Vt)var Sr=zs(Qt),Ur=yT(fn,Sr);if(ne&&(fn=Om(fn,ne,Ee,Vt)),Re&&(fn=Lm(fn,Re,Le,Vt)),ln-=Ur,Vt&&ln<_t){var Wn=oa(fn,Sr);return jm(d,T,Nu,Qt.placeholder,N,fn,Wn,je,et,_t-ln)}var si=Tt?N:this,ji=Nt?si[d]:d;return ln=fn.length,je?fn=bM(fn,je):Xt&&ln>1&&fn.reverse(),vt&&et<ln&&(fn.length=et),this&&this!==Yn&&this instanceof Qt&&(ji=nn||sl(ji)),ji.apply(si,fn)}return Qt}function Hm(d,T){return function(N,ne){return F0(N,d,T(ne),{})}}function Fu(d,T){return function(N,ne){var Ee;if(N===t&&ne===t)return T;if(N!==t&&(Ee=N),ne!==t){if(Ee===t)return ne;typeof N=="string"||typeof ne=="string"?(N=Nr(N),ne=Nr(ne)):(N=xm(N),ne=xm(ne)),Ee=d(N,ne)}return Ee}}function od(d){return Ui(function(T){return T=In(T,Lr(Kt())),an(function(N){var ne=this;return d(T,function(Ee){return or(Ee,ne,N)})})})}function Bu(d,T){T=T===t?" ":Nr(T);var N=T.length;if(N<2)return N?ed(T,d):T;var ne=ed(T,Su(d/Fs(T)));return Ns(T)?da(ri(ne),0,d).join(""):ne.slice(0,d)}function uM(d,T,N,ne){var Ee=T&y,Re=sl(d);function Le(){for(var je=-1,et=arguments.length,_t=-1,vt=ne.length,Tt=lt(vt+et),Nt=this&&this!==Yn&&this instanceof Le?Re:d;++_t<vt;)Tt[_t]=ne[_t];for(;et--;)Tt[_t++]=arguments[++je];return or(Nt,Ee?N:this,Tt)}return Le}function Gm(d){return function(T,N,ne){return ne&&typeof ne!="number"&&Mr(T,N,ne)&&(N=ne=t),T=Gi(T),N===t?(N=T,T=0):N=Gi(N),ne=ne===t?T<N?1:-1:Gi(ne),X0(T,N,ne,d)}}function Uu(d){return function(T,N){return typeof T=="string"&&typeof N=="string"||(T=Zr(T),N=Zr(N)),d(T,N)}}function jm(d,T,N,ne,Ee,Re,Le,je,et,_t){var vt=T&R,Tt=vt?Le:t,Nt=vt?t:Le,Vt=vt?Re:t,Xt=vt?t:Re;T|=vt?x:w,T&=~(vt?w:x),T&g||(T&=~(y|_));var nn=[d,T,Ee,Vt,Tt,Xt,Nt,je,et,_t],Qt=N.apply(t,nn);return md(d)&&eg(Qt,nn),Qt.placeholder=ne,tg(Qt,d,T)}function ld(d){var T=Xn[d];return function(N,ne){if(N=Zr(N),ne=ne==null?0:_r(tn(ne),292),ne&&tm(N)){var Ee=(vn(N)+"e").split("e"),Re=T(Ee[0]+"e"+(+Ee[1]+ne));return Ee=(vn(Re)+"e").split("e"),+(Ee[0]+"e"+(+Ee[1]-ne))}return T(N)}}var cM=Ws&&1/hu(new Ws([,-0]))[1]==J?function(d){return new Ws(d)}:Dd;function Vm(d){return function(T){var N=vr(T);return N==W?Uf(T):N==ye?CT(T):ET(T,d(T))}}function Bi(d,T,N,ne,Ee,Re,Le,je){var et=T&_;if(!et&&typeof d!="function")throw new Kr(o);var _t=ne?ne.length:0;if(_t||(T&=~(x|w),ne=Ee=t),Le=Le===t?Le:Qn(tn(Le),0),je=je===t?je:tn(je),_t-=Ee?Ee.length:0,T&w){var vt=ne,Tt=Ee;ne=Ee=t}var Nt=et?t:fd(d),Vt=[d,T,N,ne,Ee,vt,Tt,Re,Le,je];if(Nt&&xM(Vt,Nt),d=Vt[0],T=Vt[1],N=Vt[2],ne=Vt[3],Ee=Vt[4],je=Vt[9]=Vt[9]===t?et?0:d.length:Qn(Vt[9]-_t,0),!je&&T&(R|S)&&(T&=~(R|S)),!T||T==y)var Xt=oM(d,T,N);else T==R||T==S?Xt=lM(d,T,je):(T==x||T==(y|x))&&!Ee.length?Xt=uM(d,T,N,ne):Xt=Nu.apply(t,Vt);var nn=Nt?Sm:eg;return tg(nn(Xt,Vt),d,T)}function zm(d,T,N,ne){return d===t||ai(d,Us[N])&&!Tn.call(ne,N)?T:d}function km(d,T,N,ne,Ee,Re){return On(d)&&On(T)&&(Re.set(T,d),Pu(d,T,t,km,Re),Re.delete(T)),d}function fM(d){return ul(d)?t:d}function Km(d,T,N,ne,Ee,Re){var Le=N&v,je=d.length,et=T.length;if(je!=et&&!(Le&&et>je))return!1;var _t=Re.get(d),vt=Re.get(T);if(_t&&vt)return _t==T&&vt==d;var Tt=-1,Nt=!0,Vt=N&M?new Ga:t;for(Re.set(d,T),Re.set(T,d);++Tt<je;){var Xt=d[Tt],nn=T[Tt];if(ne)var Qt=Le?ne(nn,Xt,Tt,T,d,Re):ne(Xt,nn,Tt,d,T,Re);if(Qt!==t){if(Qt)continue;Nt=!1;break}if(Vt){if(!Ba(T,function(ln,fn){if(!Qo(Vt,fn)&&(Xt===ln||Ee(Xt,ln,N,ne,Re)))return Vt.push(fn)})){Nt=!1;break}}else if(!(Xt===nn||Ee(Xt,nn,N,ne,Re))){Nt=!1;break}}return Re.delete(d),Re.delete(T),Nt}function dM(d,T,N,ne,Ee,Re,Le){switch(N){case se:if(d.byteLength!=T.byteLength||d.byteOffset!=T.byteOffset)return!1;d=d.buffer,T=T.buffer;case oe:return!(d.byteLength!=T.byteLength||!Re(new Eu(d),new Eu(T)));case he:case Q:case B:return ai(+d,+T);case ie:return d.name==T.name&&d.message==T.message;case fe:case _e:return d==T+"";case W:var je=Uf;case ye:var et=ne&v;if(je||(je=hu),d.size!=T.size&&!et)return!1;var _t=Le.get(d);if(_t)return _t==T;ne|=M,Le.set(d,T);var vt=Km(je(d),je(T),ne,Ee,Re,Le);return Le.delete(d),vt;case ee:if(el)return el.call(d)==el.call(T)}return!1}function hM(d,T,N,ne,Ee,Re){var Le=N&v,je=ud(d),et=je.length,_t=ud(T),vt=_t.length;if(et!=vt&&!Le)return!1;for(var Tt=et;Tt--;){var Nt=je[Tt];if(!(Le?Nt in T:Tn.call(T,Nt)))return!1}var Vt=Re.get(d),Xt=Re.get(T);if(Vt&&Xt)return Vt==T&&Xt==d;var nn=!0;Re.set(d,T),Re.set(T,d);for(var Qt=Le;++Tt<et;){Nt=je[Tt];var ln=d[Nt],fn=T[Nt];if(ne)var Br=Le?ne(fn,ln,Nt,T,d,Re):ne(ln,fn,Nt,d,T,Re);if(!(Br===t?ln===fn||Ee(ln,fn,N,ne,Re):Br)){nn=!1;break}Qt||(Qt=Nt=="constructor")}if(nn&&!Qt){var Sr=d.constructor,Ur=T.constructor;Sr!=Ur&&"constructor"in d&&"constructor"in T&&!(typeof Sr=="function"&&Sr instanceof Sr&&typeof Ur=="function"&&Ur instanceof Ur)&&(nn=!1)}return Re.delete(d),Re.delete(T),nn}function Ui(d){return _d(qm(d,t,og),d+"")}function ud(d){return dm(d,$n,hd)}function cd(d){return dm(d,Dr,Ym)}var fd=xu?function(d){return xu.get(d)}:Dd;function Wu(d){for(var T=d.name+"",N=Hs[T],ne=Tn.call(Hs,T)?N.length:0;ne--;){var Ee=N[ne],Re=Ee.func;if(Re==null||Re==d)return Ee.name}return T}function zs(d){var T=Tn.call(xe,"placeholder")?xe:d;return T.placeholder}function Kt(){var d=xe.iteratee||bd;return d=d===bd?mm:d,arguments.length?d(arguments[0],arguments[1]):d}function Hu(d,T){var N=d.__data__;return TM(T)?N[typeof T=="string"?"string":"hash"]:N.map}function dd(d){for(var T=$n(d),N=T.length;N--;){var ne=T[N],Ee=d[ne];T[N]=[ne,Ee,Jm(Ee)]}return T}function za(d,T){var N=AT(d,T);return pm(N)?N:t}function pM(d){var T=Tn.call(d,Wa),N=d[Wa];try{d[Wa]=t;var ne=!0}catch{}var Ee=_u.call(d);return ne&&(T?d[Wa]=N:delete d[Wa]),Ee}var hd=Hf?function(d){return d==null?[]:(d=Cn(d),gi(Hf(d),function(T){return $p.call(d,T)}))}:Pd,Ym=Hf?function(d){for(var T=[];d;)ti(T,hd(d)),d=yu(d);return T}:Pd,vr=Tr;(Gf&&vr(new Gf(new ArrayBuffer(1)))!=se||Zo&&vr(new Zo)!=W||jf&&vr(jf.resolve())!=O||Ws&&vr(new Ws)!=ye||qo&&vr(new qo)!=X)&&(vr=function(d){var T=Tr(d),N=T==D?d.constructor:t,ne=N?ka(N):"";if(ne)switch(ne){case JT:return se;case ZT:return W;case qT:return O;case $T:return ye;case e0:return X}return T});function mM(d,T,N){for(var ne=-1,Ee=N.length;++ne<Ee;){var Re=N[ne],Le=Re.size;switch(Re.type){case"drop":d+=Le;break;case"dropRight":T-=Le;break;case"take":T=_r(T,d+Le);break;case"takeRight":d=Qn(d,T-Le);break}}return{start:d,end:T}}function gM(d){var T=d.match(Te);return T?T[1].split(De):[]}function Xm(d,T,N){T=fa(T,d);for(var ne=-1,Ee=T.length,Re=!1;++ne<Ee;){var Le=Ei(T[ne]);if(!(Re=d!=null&&N(d,Le)))break;d=d[Le]}return Re||++ne!=Ee?Re:(Ee=d==null?0:d.length,!!Ee&&Yu(Ee)&&Wi(Le,Ee)&&(en(d)||Ka(d)))}function _M(d){var T=d.length,N=new d.constructor(T);return T&&typeof d[0]=="string"&&Tn.call(d,"index")&&(N.index=d.index,N.input=d.input),N}function Qm(d){return typeof d.constructor=="function"&&!ol(d)?Gs(yu(d)):{}}function vM(d,T,N){var ne=d.constructor;switch(T){case oe:return sd(d);case he:case Q:return new ne(+d);case se:return tM(d,N);case ce:case Se:case Me:case ve:case be:case Ne:case Ue:case Xe:case ot:return Pm(d,N);case W:return new ne;case B:case _e:return new ne(d);case fe:return nM(d);case ye:return new ne;case ee:return rM(d)}}function EM(d,T){var N=T.length;if(!N)return d;var ne=N-1;return T[ne]=(N>1?"& ":"")+T[ne],T=T.join(N>2?", ":" "),d.replace(We,`{
/* [wrapped with `+T+`] */
`)}function yM(d){return en(d)||Ka(d)||!!(em&&d&&d[em])}function Wi(d,T){var N=typeof d;return T=T==null?K:T,!!T&&(N=="number"||N!="symbol"&&It.test(d))&&d>-1&&d%1==0&&d<T}function Mr(d,T,N){if(!On(N))return!1;var ne=typeof T;return(ne=="number"?Ir(N)&&Wi(T,N.length):ne=="string"&&T in N)?ai(N[T],d):!1}function pd(d,T){if(en(d))return!1;var N=typeof d;return N=="number"||N=="symbol"||N=="boolean"||d==null||Fr(d)?!0:Qe.test(d)||!we.test(d)||T!=null&&d in Cn(T)}function TM(d){var T=typeof d;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?d!=="__proto__":d===null}function md(d){var T=Wu(d),N=xe[T];if(typeof N!="function"||!(T in cn.prototype))return!1;if(d===N)return!0;var ne=fd(N);return!!ne&&d===ne[0]}function MM(d){return!!Jp&&Jp in d}var SM=mu?Hi:wd;function ol(d){var T=d&&d.constructor,N=typeof T=="function"&&T.prototype||Us;return d===N}function Jm(d){return d===d&&!On(d)}function Zm(d,T){return function(N){return N==null?!1:N[d]===T&&(T!==t||d in Cn(N))}}function AM(d){var T=ku(d,function(ne){return N.size===c&&N.clear(),ne}),N=T.cache;return T}function xM(d,T){var N=d[1],ne=T[1],Ee=N|ne,Re=Ee<(y|_|C),Le=ne==C&&N==R||ne==C&&N==b&&d[7].length<=T[8]||ne==(C|b)&&T[7].length<=T[8]&&N==R;if(!(Re||Le))return d;ne&y&&(d[2]=T[2],Ee|=N&y?0:g);var je=T[3];if(je){var et=d[3];d[3]=et?Om(et,je,T[4]):je,d[4]=et?oa(d[3],f):T[4]}return je=T[5],je&&(et=d[5],d[5]=et?Lm(et,je,T[6]):je,d[6]=et?oa(d[5],f):T[6]),je=T[7],je&&(d[7]=je),ne&C&&(d[8]=d[8]==null?T[8]:_r(d[8],T[8])),d[9]==null&&(d[9]=T[9]),d[0]=T[0],d[1]=Ee,d}function RM(d){var T=[];if(d!=null)for(var N in Cn(d))T.push(N);return T}function CM(d){return _u.call(d)}function qm(d,T,N){return T=Qn(T===t?d.length-1:T,0),function(){for(var ne=arguments,Ee=-1,Re=Qn(ne.length-T,0),Le=lt(Re);++Ee<Re;)Le[Ee]=ne[T+Ee];Ee=-1;for(var je=lt(T+1);++Ee<T;)je[Ee]=ne[Ee];return je[T]=N(Le),or(d,this,je)}}function $m(d,T){return T.length<2?d:Va(d,Qr(T,0,-1))}function bM(d,T){for(var N=d.length,ne=_r(T.length,N),Ee=br(d);ne--;){var Re=T[ne];d[ne]=Wi(Re,N)?Ee[Re]:t}return d}function gd(d,T){if(!(T==="constructor"&&typeof d[T]=="function")&&T!="__proto__")return d[T]}var eg=ng(Sm),ll=VT||function(d,T){return Yn.setTimeout(d,T)},_d=ng(Z0);function tg(d,T,N){var ne=T+"";return _d(d,EM(ne,IM(gM(ne),N)))}function ng(d){var T=0,N=0;return function(){var ne=YT(),Ee=G-(ne-N);if(N=ne,Ee>0){if(++T>=F)return arguments[0]}else T=0;return d.apply(t,arguments)}}function Gu(d,T){var N=-1,ne=d.length,Ee=ne-1;for(T=T===t?ne:T;++N<T;){var Re=$f(N,Ee),Le=d[Re];d[Re]=d[N],d[N]=Le}return d.length=T,d}var rg=AM(function(d){var T=[];return d.charCodeAt(0)===46&&T.push(""),d.replace(it,function(N,ne,Ee,Re){T.push(Ee?Re.replace(ge,"$1"):ne||N)}),T});function Ei(d){if(typeof d=="string"||Fr(d))return d;var T=d+"";return T=="0"&&1/d==-J?"-0":T}function ka(d){if(d!=null){try{return gu.call(d)}catch{}try{return d+""}catch{}}return""}function IM(d,T){return Cr(te,function(N){var ne="_."+N[0];T&N[1]&&!Ls(d,ne)&&d.push(ne)}),d.sort()}function ig(d){if(d instanceof cn)return d.clone();var T=new Yr(d.__wrapped__,d.__chain__);return T.__actions__=br(d.__actions__),T.__index__=d.__index__,T.__values__=d.__values__,T}function DM(d,T,N){(N?Mr(d,T,N):T===t)?T=1:T=Qn(tn(T),0);var ne=d==null?0:d.length;if(!ne||T<1)return[];for(var Ee=0,Re=0,Le=lt(Su(ne/T));Ee<ne;)Le[Re++]=Qr(d,Ee,Ee+=T);return Le}function PM(d){for(var T=-1,N=d==null?0:d.length,ne=0,Ee=[];++T<N;){var Re=d[T];Re&&(Ee[ne++]=Re)}return Ee}function wM(){var d=arguments.length;if(!d)return[];for(var T=lt(d-1),N=arguments[0],ne=d;ne--;)T[ne-1]=arguments[ne];return ti(en(N)?br(N):[N],lr(T,1))}var OM=an(function(d,T){return Un(d)?nl(d,lr(T,1,Un,!0)):[]}),LM=an(function(d,T){var N=Jr(T);return Un(N)&&(N=t),Un(d)?nl(d,lr(T,1,Un,!0),Kt(N,2)):[]}),NM=an(function(d,T){var N=Jr(T);return Un(N)&&(N=t),Un(d)?nl(d,lr(T,1,Un,!0),t,N):[]});function FM(d,T,N){var ne=d==null?0:d.length;return ne?(T=N||T===t?1:tn(T),Qr(d,T<0?0:T,ne)):[]}function BM(d,T,N){var ne=d==null?0:d.length;return ne?(T=N||T===t?1:tn(T),T=ne-T,Qr(d,0,T<0?0:T)):[]}function UM(d,T){return d&&d.length?Ou(d,Kt(T,3),!0,!0):[]}function WM(d,T){return d&&d.length?Ou(d,Kt(T,3),!0):[]}function HM(d,T,N,ne){var Ee=d==null?0:d.length;return Ee?(N&&typeof N!="number"&&Mr(d,T,N)&&(N=0,ne=Ee),w0(d,T,N,ne)):[]}function ag(d,T,N){var ne=d==null?0:d.length;if(!ne)return-1;var Ee=N==null?0:tn(N);return Ee<0&&(Ee=Qn(ne+Ee,0)),Ua(d,Kt(T,3),Ee)}function sg(d,T,N){var ne=d==null?0:d.length;if(!ne)return-1;var Ee=ne-1;return N!==t&&(Ee=tn(N),Ee=N<0?Qn(ne+Ee,0):_r(Ee,ne-1)),Ua(d,Kt(T,3),Ee,!0)}function og(d){var T=d==null?0:d.length;return T?lr(d,1):[]}function GM(d){var T=d==null?0:d.length;return T?lr(d,J):[]}function jM(d,T){var N=d==null?0:d.length;return N?(T=T===t?1:tn(T),lr(d,T)):[]}function VM(d){for(var T=-1,N=d==null?0:d.length,ne={};++T<N;){var Ee=d[T];ne[Ee[0]]=Ee[1]}return ne}function lg(d){return d&&d.length?d[0]:t}function zM(d,T,N){var ne=d==null?0:d.length;if(!ne)return-1;var Ee=N==null?0:tn(N);return Ee<0&&(Ee=Qn(ne+Ee,0)),Ke(d,T,Ee)}function kM(d){var T=d==null?0:d.length;return T?Qr(d,0,-1):[]}var KM=an(function(d){var T=In(d,id);return T.length&&T[0]===d[0]?Xf(T):[]}),YM=an(function(d){var T=Jr(d),N=In(d,id);return T===Jr(N)?T=t:N.pop(),N.length&&N[0]===d[0]?Xf(N,Kt(T,2)):[]}),XM=an(function(d){var T=Jr(d),N=In(d,id);return T=typeof T=="function"?T:t,T&&N.pop(),N.length&&N[0]===d[0]?Xf(N,t,T):[]});function QM(d,T){return d==null?"":kT.call(d,T)}function Jr(d){var T=d==null?0:d.length;return T?d[T-1]:t}function JM(d,T,N){var ne=d==null?0:d.length;if(!ne)return-1;var Ee=ne;return N!==t&&(Ee=tn(N),Ee=Ee<0?Qn(ne+Ee,0):_r(Ee,ne-1)),T===T?IT(d,T,Ee):Ua(d,Gt,Ee,!0)}function ZM(d,T){return d&&d.length?Em(d,tn(T)):t}var qM=an(ug);function ug(d,T){return d&&d.length&&T&&T.length?qf(d,T):d}function $M(d,T,N){return d&&d.length&&T&&T.length?qf(d,T,Kt(N,2)):d}function eS(d,T,N){return d&&d.length&&T&&T.length?qf(d,T,t,N):d}var tS=Ui(function(d,T){var N=d==null?0:d.length,ne=zf(d,T);return Mm(d,In(T,function(Ee){return Wi(Ee,N)?+Ee:Ee}).sort(wm)),ne});function nS(d,T){var N=[];if(!(d&&d.length))return N;var ne=-1,Ee=[],Re=d.length;for(T=Kt(T,3);++ne<Re;){var Le=d[ne];T(Le,ne,d)&&(N.push(Le),Ee.push(ne))}return Mm(d,Ee),N}function vd(d){return d==null?d:QT.call(d)}function rS(d,T,N){var ne=d==null?0:d.length;return ne?(N&&typeof N!="number"&&Mr(d,T,N)?(T=0,N=ne):(T=T==null?0:tn(T),N=N===t?ne:tn(N)),Qr(d,T,N)):[]}function iS(d,T){return wu(d,T)}function aS(d,T,N){return td(d,T,Kt(N,2))}function sS(d,T){var N=d==null?0:d.length;if(N){var ne=wu(d,T);if(ne<N&&ai(d[ne],T))return ne}return-1}function oS(d,T){return wu(d,T,!0)}function lS(d,T,N){return td(d,T,Kt(N,2),!0)}function uS(d,T){var N=d==null?0:d.length;if(N){var ne=wu(d,T,!0)-1;if(ai(d[ne],T))return ne}return-1}function cS(d){return d&&d.length?Am(d):[]}function fS(d,T){return d&&d.length?Am(d,Kt(T,2)):[]}function dS(d){var T=d==null?0:d.length;return T?Qr(d,1,T):[]}function hS(d,T,N){return d&&d.length?(T=N||T===t?1:tn(T),Qr(d,0,T<0?0:T)):[]}function pS(d,T,N){var ne=d==null?0:d.length;return ne?(T=N||T===t?1:tn(T),T=ne-T,Qr(d,T<0?0:T,ne)):[]}function mS(d,T){return d&&d.length?Ou(d,Kt(T,3),!1,!0):[]}function gS(d,T){return d&&d.length?Ou(d,Kt(T,3)):[]}var _S=an(function(d){return ca(lr(d,1,Un,!0))}),vS=an(function(d){var T=Jr(d);return Un(T)&&(T=t),ca(lr(d,1,Un,!0),Kt(T,2))}),ES=an(function(d){var T=Jr(d);return T=typeof T=="function"?T:t,ca(lr(d,1,Un,!0),t,T)});function yS(d){return d&&d.length?ca(d):[]}function TS(d,T){return d&&d.length?ca(d,Kt(T,2)):[]}function MS(d,T){return T=typeof T=="function"?T:t,d&&d.length?ca(d,t,T):[]}function Ed(d){if(!(d&&d.length))return[];var T=0;return d=gi(d,function(N){if(Un(N))return T=Qn(N.length,T),!0}),Ff(T,function(N){return In(d,xn(N))})}function cg(d,T){if(!(d&&d.length))return[];var N=Ed(d);return T==null?N:In(N,function(ne){return or(T,t,ne)})}var SS=an(function(d,T){return Un(d)?nl(d,T):[]}),AS=an(function(d){return rd(gi(d,Un))}),xS=an(function(d){var T=Jr(d);return Un(T)&&(T=t),rd(gi(d,Un),Kt(T,2))}),RS=an(function(d){var T=Jr(d);return T=typeof T=="function"?T:t,rd(gi(d,Un),t,T)}),CS=an(Ed);function bS(d,T){return bm(d||[],T||[],tl)}function IS(d,T){return bm(d||[],T||[],al)}var DS=an(function(d){var T=d.length,N=T>1?d[T-1]:t;return N=typeof N=="function"?(d.pop(),N):t,cg(d,N)});function fg(d){var T=xe(d);return T.__chain__=!0,T}function PS(d,T){return T(d),d}function ju(d,T){return T(d)}var wS=Ui(function(d){var T=d.length,N=T?d[0]:0,ne=this.__wrapped__,Ee=function(Re){return zf(Re,d)};return T>1||this.__actions__.length||!(ne instanceof cn)||!Wi(N)?this.thru(Ee):(ne=ne.slice(N,+N+(T?1:0)),ne.__actions__.push({func:ju,args:[Ee],thisArg:t}),new Yr(ne,this.__chain__).thru(function(Re){return T&&!Re.length&&Re.push(t),Re}))});function OS(){return fg(this)}function LS(){return new Yr(this.value(),this.__chain__)}function NS(){this.__values__===t&&(this.__values__=xg(this.value()));var d=this.__index__>=this.__values__.length,T=d?t:this.__values__[this.__index__++];return{done:d,value:T}}function FS(){return this}function BS(d){for(var T,N=this;N instanceof Cu;){var ne=ig(N);ne.__index__=0,ne.__values__=t,T?Ee.__wrapped__=ne:T=ne;var Ee=ne;N=N.__wrapped__}return Ee.__wrapped__=d,T}function US(){var d=this.__wrapped__;if(d instanceof cn){var T=d;return this.__actions__.length&&(T=new cn(this)),T=T.reverse(),T.__actions__.push({func:ju,args:[vd],thisArg:t}),new Yr(T,this.__chain__)}return this.thru(vd)}function WS(){return Cm(this.__wrapped__,this.__actions__)}var HS=Lu(function(d,T,N){Tn.call(d,N)?++d[N]:Fi(d,N,1)});function GS(d,T,N){var ne=en(d)?fu:P0;return N&&Mr(d,T,N)&&(T=t),ne(d,Kt(T,3))}function jS(d,T){var N=en(d)?gi:cm;return N(d,Kt(T,3))}var VS=Um(ag),zS=Um(sg);function kS(d,T){return lr(Vu(d,T),1)}function KS(d,T){return lr(Vu(d,T),J)}function YS(d,T,N){return N=N===t?1:tn(N),lr(Vu(d,T),N)}function dg(d,T){var N=en(d)?Cr:ua;return N(d,Kt(T,3))}function hg(d,T){var N=en(d)?wf:um;return N(d,Kt(T,3))}var XS=Lu(function(d,T,N){Tn.call(d,N)?d[N].push(T):Fi(d,N,[T])});function QS(d,T,N,ne){d=Ir(d)?d:Ks(d),N=N&&!ne?tn(N):0;var Ee=d.length;return N<0&&(N=Qn(Ee+N,0)),Xu(d)?N<=Ee&&d.indexOf(T,N)>-1:!!Ee&&Ke(d,T,N)>-1}var JS=an(function(d,T,N){var ne=-1,Ee=typeof T=="function",Re=Ir(d)?lt(d.length):[];return ua(d,function(Le){Re[++ne]=Ee?or(T,Le,N):rl(Le,T,N)}),Re}),ZS=Lu(function(d,T,N){Fi(d,N,T)});function Vu(d,T){var N=en(d)?In:gm;return N(d,Kt(T,3))}function qS(d,T,N,ne){return d==null?[]:(en(T)||(T=T==null?[]:[T]),N=ne?t:N,en(N)||(N=N==null?[]:[N]),ym(d,T,N))}var $S=Lu(function(d,T,N){d[N?0:1].push(T)},function(){return[[],[]]});function eA(d,T,N){var ne=en(d)?Ko:Oi,Ee=arguments.length<3;return ne(d,Kt(T,4),N,Ee,ua)}function tA(d,T,N){var ne=en(d)?Yo:Oi,Ee=arguments.length<3;return ne(d,Kt(T,4),N,Ee,um)}function nA(d,T){var N=en(d)?gi:cm;return N(d,Ku(Kt(T,3)))}function rA(d){var T=en(d)?am:Q0;return T(d)}function iA(d,T,N){(N?Mr(d,T,N):T===t)?T=1:T=tn(T);var ne=en(d)?R0:J0;return ne(d,T)}function aA(d){var T=en(d)?C0:q0;return T(d)}function sA(d){if(d==null)return 0;if(Ir(d))return Xu(d)?Fs(d):d.length;var T=vr(d);return T==W||T==ye?d.size:Jf(d).length}function oA(d,T,N){var ne=en(d)?Ba:$0;return N&&Mr(d,T,N)&&(T=t),ne(d,Kt(T,3))}var lA=an(function(d,T){if(d==null)return[];var N=T.length;return N>1&&Mr(d,T[0],T[1])?T=[]:N>2&&Mr(T[0],T[1],T[2])&&(T=[T[0]]),ym(d,lr(T,1),[])}),zu=jT||function(){return Yn.Date.now()};function uA(d,T){if(typeof T!="function")throw new Kr(o);return d=tn(d),function(){if(--d<1)return T.apply(this,arguments)}}function pg(d,T,N){return T=N?t:T,T=d&&T==null?d.length:T,Bi(d,C,t,t,t,t,T)}function mg(d,T){var N;if(typeof T!="function")throw new Kr(o);return d=tn(d),function(){return--d>0&&(N=T.apply(this,arguments)),d<=1&&(T=t),N}}var yd=an(function(d,T,N){var ne=y;if(N.length){var Ee=oa(N,zs(yd));ne|=x}return Bi(d,ne,T,N,Ee)}),gg=an(function(d,T,N){var ne=y|_;if(N.length){var Ee=oa(N,zs(gg));ne|=x}return Bi(T,ne,d,N,Ee)});function _g(d,T,N){T=N?t:T;var ne=Bi(d,R,t,t,t,t,t,T);return ne.placeholder=_g.placeholder,ne}function vg(d,T,N){T=N?t:T;var ne=Bi(d,S,t,t,t,t,t,T);return ne.placeholder=vg.placeholder,ne}function Eg(d,T,N){var ne,Ee,Re,Le,je,et,_t=0,vt=!1,Tt=!1,Nt=!0;if(typeof d!="function")throw new Kr(o);T=Zr(T)||0,On(N)&&(vt=!!N.leading,Tt="maxWait"in N,Re=Tt?Qn(Zr(N.maxWait)||0,T):Re,Nt="trailing"in N?!!N.trailing:Nt);function Vt(Wn){var si=ne,ji=Ee;return ne=Ee=t,_t=Wn,Le=d.apply(ji,si),Le}function Xt(Wn){return _t=Wn,je=ll(ln,T),vt?Vt(Wn):Le}function nn(Wn){var si=Wn-et,ji=Wn-_t,Ug=T-si;return Tt?_r(Ug,Re-ji):Ug}function Qt(Wn){var si=Wn-et,ji=Wn-_t;return et===t||si>=T||si<0||Tt&&ji>=Re}function ln(){var Wn=zu();if(Qt(Wn))return fn(Wn);je=ll(ln,nn(Wn))}function fn(Wn){return je=t,Nt&&ne?Vt(Wn):(ne=Ee=t,Le)}function Br(){je!==t&&Im(je),_t=0,ne=et=Ee=je=t}function Sr(){return je===t?Le:fn(zu())}function Ur(){var Wn=zu(),si=Qt(Wn);if(ne=arguments,Ee=this,et=Wn,si){if(je===t)return Xt(et);if(Tt)return Im(je),je=ll(ln,T),Vt(et)}return je===t&&(je=ll(ln,T)),Le}return Ur.cancel=Br,Ur.flush=Sr,Ur}var cA=an(function(d,T){return lm(d,1,T)}),fA=an(function(d,T,N){return lm(d,Zr(T)||0,N)});function dA(d){return Bi(d,P)}function ku(d,T){if(typeof d!="function"||T!=null&&typeof T!="function")throw new Kr(o);var N=function(){var ne=arguments,Ee=T?T.apply(this,ne):ne[0],Re=N.cache;if(Re.has(Ee))return Re.get(Ee);var Le=d.apply(this,ne);return N.cache=Re.set(Ee,Le)||Re,Le};return N.cache=new(ku.Cache||Ni),N}ku.Cache=Ni;function Ku(d){if(typeof d!="function")throw new Kr(o);return function(){var T=arguments;switch(T.length){case 0:return!d.call(this);case 1:return!d.call(this,T[0]);case 2:return!d.call(this,T[0],T[1]);case 3:return!d.call(this,T[0],T[1],T[2])}return!d.apply(this,T)}}function hA(d){return mg(2,d)}var pA=eM(function(d,T){T=T.length==1&&en(T[0])?In(T[0],Lr(Kt())):In(lr(T,1),Lr(Kt()));var N=T.length;return an(function(ne){for(var Ee=-1,Re=_r(ne.length,N);++Ee<Re;)ne[Ee]=T[Ee].call(this,ne[Ee]);return or(d,this,ne)})}),Td=an(function(d,T){var N=oa(T,zs(Td));return Bi(d,x,t,T,N)}),yg=an(function(d,T){var N=oa(T,zs(yg));return Bi(d,w,t,T,N)}),mA=Ui(function(d,T){return Bi(d,b,t,t,t,T)});function gA(d,T){if(typeof d!="function")throw new Kr(o);return T=T===t?T:tn(T),an(d,T)}function _A(d,T){if(typeof d!="function")throw new Kr(o);return T=T==null?0:Qn(tn(T),0),an(function(N){var ne=N[T],Ee=da(N,0,T);return ne&&ti(Ee,ne),or(d,this,Ee)})}function vA(d,T,N){var ne=!0,Ee=!0;if(typeof d!="function")throw new Kr(o);return On(N)&&(ne="leading"in N?!!N.leading:ne,Ee="trailing"in N?!!N.trailing:Ee),Eg(d,T,{leading:ne,maxWait:T,trailing:Ee})}function EA(d){return pg(d,1)}function yA(d,T){return Td(ad(T),d)}function TA(){if(!arguments.length)return[];var d=arguments[0];return en(d)?d:[d]}function MA(d){return Xr(d,E)}function SA(d,T){return T=typeof T=="function"?T:t,Xr(d,E,T)}function AA(d){return Xr(d,h|E)}function xA(d,T){return T=typeof T=="function"?T:t,Xr(d,h|E,T)}function RA(d,T){return T==null||om(d,T,$n(T))}function ai(d,T){return d===T||d!==d&&T!==T}var CA=Uu(Yf),bA=Uu(function(d,T){return d>=T}),Ka=hm(function(){return arguments}())?hm:function(d){return Nn(d)&&Tn.call(d,"callee")&&!$p.call(d,"callee")},en=lt.isArray,IA=Os?Lr(Os):B0;function Ir(d){return d!=null&&Yu(d.length)&&!Hi(d)}function Un(d){return Nn(d)&&Ir(d)}function DA(d){return d===!0||d===!1||Nn(d)&&Tr(d)==he}var ha=zT||wd,PA=su?Lr(su):U0;function wA(d){return Nn(d)&&d.nodeType===1&&!ul(d)}function OA(d){if(d==null)return!0;if(Ir(d)&&(en(d)||typeof d=="string"||typeof d.splice=="function"||ha(d)||ks(d)||Ka(d)))return!d.length;var T=vr(d);if(T==W||T==ye)return!d.size;if(ol(d))return!Jf(d).length;for(var N in d)if(Tn.call(d,N))return!1;return!0}function LA(d,T){return il(d,T)}function NA(d,T,N){N=typeof N=="function"?N:t;var ne=N?N(d,T):t;return ne===t?il(d,T,t,N):!!ne}function Md(d){if(!Nn(d))return!1;var T=Tr(d);return T==ie||T==Y||typeof d.message=="string"&&typeof d.name=="string"&&!ul(d)}function FA(d){return typeof d=="number"&&tm(d)}function Hi(d){if(!On(d))return!1;var T=Tr(d);return T==ue||T==$||T==pe||T==U}function Tg(d){return typeof d=="number"&&d==tn(d)}function Yu(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=K}function On(d){var T=typeof d;return d!=null&&(T=="object"||T=="function")}function Nn(d){return d!=null&&typeof d=="object"}var Mg=ou?Lr(ou):H0;function BA(d,T){return d===T||Qf(d,T,dd(T))}function UA(d,T,N){return N=typeof N=="function"?N:t,Qf(d,T,dd(T),N)}function WA(d){return Sg(d)&&d!=+d}function HA(d){if(SM(d))throw new qt(i);return pm(d)}function GA(d){return d===null}function jA(d){return d==null}function Sg(d){return typeof d=="number"||Nn(d)&&Tr(d)==B}function ul(d){if(!Nn(d)||Tr(d)!=D)return!1;var T=yu(d);if(T===null)return!0;var N=Tn.call(T,"constructor")&&T.constructor;return typeof N=="function"&&N instanceof N&&gu.call(N)==UT}var Sd=lu?Lr(lu):G0;function VA(d){return Tg(d)&&d>=-K&&d<=K}var Ag=uu?Lr(uu):j0;function Xu(d){return typeof d=="string"||!en(d)&&Nn(d)&&Tr(d)==_e}function Fr(d){return typeof d=="symbol"||Nn(d)&&Tr(d)==ee}var ks=cu?Lr(cu):V0;function zA(d){return d===t}function kA(d){return Nn(d)&&vr(d)==X}function KA(d){return Nn(d)&&Tr(d)==z}var YA=Uu(Zf),XA=Uu(function(d,T){return d<=T});function xg(d){if(!d)return[];if(Ir(d))return Xu(d)?ri(d):br(d);if(Jo&&d[Jo])return RT(d[Jo]());var T=vr(d),N=T==W?Uf:T==ye?hu:Ks;return N(d)}function Gi(d){if(!d)return d===0?d:0;if(d=Zr(d),d===J||d===-J){var T=d<0?-1:1;return T*ae}return d===d?d:0}function tn(d){var T=Gi(d),N=T%1;return T===T?N?T-N:T:0}function Rg(d){return d?ja(tn(d),0,le):0}function Zr(d){if(typeof d=="number")return d;if(Fr(d))return re;if(On(d)){var T=typeof d.valueOf=="function"?d.valueOf():d;d=On(T)?T+"":T}if(typeof d!="string")return d===0?d:+d;d=kp(d);var N=$e.test(d);return N||bt.test(d)?If(d.slice(2),N?2:8):Ye.test(d)?re:+d}function Cg(d){return vi(d,Dr(d))}function QA(d){return d?ja(tn(d),-K,K):d===0?d:0}function vn(d){return d==null?"":Nr(d)}var JA=js(function(d,T){if(ol(T)||Ir(T)){vi(T,$n(T),d);return}for(var N in T)Tn.call(T,N)&&tl(d,N,T[N])}),bg=js(function(d,T){vi(T,Dr(T),d)}),Qu=js(function(d,T,N,ne){vi(T,Dr(T),d,ne)}),ZA=js(function(d,T,N,ne){vi(T,$n(T),d,ne)}),qA=Ui(zf);function $A(d,T){var N=Gs(d);return T==null?N:sm(N,T)}var ex=an(function(d,T){d=Cn(d);var N=-1,ne=T.length,Ee=ne>2?T[2]:t;for(Ee&&Mr(T[0],T[1],Ee)&&(ne=1);++N<ne;)for(var Re=T[N],Le=Dr(Re),je=-1,et=Le.length;++je<et;){var _t=Le[je],vt=d[_t];(vt===t||ai(vt,Us[_t])&&!Tn.call(d,_t))&&(d[_t]=Re[_t])}return d}),tx=an(function(d){return d.push(t,km),or(Ig,t,d)});function nx(d,T){return Xo(d,Kt(T,3),_i)}function rx(d,T){return Xo(d,Kt(T,3),Kf)}function ix(d,T){return d==null?d:kf(d,Kt(T,3),Dr)}function ax(d,T){return d==null?d:fm(d,Kt(T,3),Dr)}function sx(d,T){return d&&_i(d,Kt(T,3))}function ox(d,T){return d&&Kf(d,Kt(T,3))}function lx(d){return d==null?[]:Du(d,$n(d))}function ux(d){return d==null?[]:Du(d,Dr(d))}function Ad(d,T,N){var ne=d==null?t:Va(d,T);return ne===t?N:ne}function cx(d,T){return d!=null&&Xm(d,T,O0)}function xd(d,T){return d!=null&&Xm(d,T,L0)}var fx=Hm(function(d,T,N){T!=null&&typeof T.toString!="function"&&(T=_u.call(T)),d[T]=N},Cd(Pr)),dx=Hm(function(d,T,N){T!=null&&typeof T.toString!="function"&&(T=_u.call(T)),Tn.call(d,T)?d[T].push(N):d[T]=[N]},Kt),hx=an(rl);function $n(d){return Ir(d)?im(d):Jf(d)}function Dr(d){return Ir(d)?im(d,!0):z0(d)}function px(d,T){var N={};return T=Kt(T,3),_i(d,function(ne,Ee,Re){Fi(N,T(ne,Ee,Re),ne)}),N}function mx(d,T){var N={};return T=Kt(T,3),_i(d,function(ne,Ee,Re){Fi(N,Ee,T(ne,Ee,Re))}),N}var gx=js(function(d,T,N){Pu(d,T,N)}),Ig=js(function(d,T,N,ne){Pu(d,T,N,ne)}),_x=Ui(function(d,T){var N={};if(d==null)return N;var ne=!1;T=In(T,function(Re){return Re=fa(Re,d),ne||(ne=Re.length>1),Re}),vi(d,cd(d),N),ne&&(N=Xr(N,h|p|E,fM));for(var Ee=T.length;Ee--;)nd(N,T[Ee]);return N});function vx(d,T){return Dg(d,Ku(Kt(T)))}var Ex=Ui(function(d,T){return d==null?{}:K0(d,T)});function Dg(d,T){if(d==null)return{};var N=In(cd(d),function(ne){return[ne]});return T=Kt(T),Tm(d,N,function(ne,Ee){return T(ne,Ee[0])})}function yx(d,T,N){T=fa(T,d);var ne=-1,Ee=T.length;for(Ee||(Ee=1,d=t);++ne<Ee;){var Re=d==null?t:d[Ei(T[ne])];Re===t&&(ne=Ee,Re=N),d=Hi(Re)?Re.call(d):Re}return d}function Tx(d,T,N){return d==null?d:al(d,T,N)}function Mx(d,T,N,ne){return ne=typeof ne=="function"?ne:t,d==null?d:al(d,T,N,ne)}var Pg=Vm($n),wg=Vm(Dr);function Sx(d,T,N){var ne=en(d),Ee=ne||ha(d)||ks(d);if(T=Kt(T,4),N==null){var Re=d&&d.constructor;Ee?N=ne?new Re:[]:On(d)?N=Hi(Re)?Gs(yu(d)):{}:N={}}return(Ee?Cr:_i)(d,function(Le,je,et){return T(N,Le,je,et)}),N}function Ax(d,T){return d==null?!0:nd(d,T)}function xx(d,T,N){return d==null?d:Rm(d,T,ad(N))}function Rx(d,T,N,ne){return ne=typeof ne=="function"?ne:t,d==null?d:Rm(d,T,ad(N),ne)}function Ks(d){return d==null?[]:Bf(d,$n(d))}function Cx(d){return d==null?[]:Bf(d,Dr(d))}function bx(d,T,N){return N===t&&(N=T,T=t),N!==t&&(N=Zr(N),N=N===N?N:0),T!==t&&(T=Zr(T),T=T===T?T:0),ja(Zr(d),T,N)}function Ix(d,T,N){return T=Gi(T),N===t?(N=T,T=0):N=Gi(N),d=Zr(d),N0(d,T,N)}function Dx(d,T,N){if(N&&typeof N!="boolean"&&Mr(d,T,N)&&(T=N=t),N===t&&(typeof T=="boolean"?(N=T,T=t):typeof d=="boolean"&&(N=d,d=t)),d===t&&T===t?(d=0,T=1):(d=Gi(d),T===t?(T=d,d=0):T=Gi(T)),d>T){var ne=d;d=T,T=ne}if(N||d%1||T%1){var Ee=nm();return _r(d+Ee*(T-d+bf("1e-"+((Ee+"").length-1))),T)}return $f(d,T)}var Px=Vs(function(d,T,N){return T=T.toLowerCase(),d+(N?Og(T):T)});function Og(d){return Rd(vn(d).toLowerCase())}function Lg(d){return d=vn(d),d&&d.replace(Dt,TT).replace(Zt,"")}function wx(d,T,N){d=vn(d),T=Nr(T);var ne=d.length;N=N===t?ne:ja(tn(N),0,ne);var Ee=N;return N-=T.length,N>=0&&d.slice(N,Ee)==T}function Ox(d){return d=vn(d),d&&Oe.test(d)?d.replace(Pt,MT):d}function Lx(d){return d=vn(d),d&&at.test(d)?d.replace(st,"\\$&"):d}var Nx=Vs(function(d,T,N){return d+(N?"-":"")+T.toLowerCase()}),Fx=Vs(function(d,T,N){return d+(N?" ":"")+T.toLowerCase()}),Bx=Bm("toLowerCase");function Ux(d,T,N){d=vn(d),T=tn(T);var ne=T?Fs(d):0;if(!T||ne>=T)return d;var Ee=(T-ne)/2;return Bu(Au(Ee),N)+d+Bu(Su(Ee),N)}function Wx(d,T,N){d=vn(d),T=tn(T);var ne=T?Fs(d):0;return T&&ne<T?d+Bu(T-ne,N):d}function Hx(d,T,N){d=vn(d),T=tn(T);var ne=T?Fs(d):0;return T&&ne<T?Bu(T-ne,N)+d:d}function Gx(d,T,N){return N||T==null?T=0:T&&(T=+T),XT(vn(d).replace(Ae,""),T||0)}function jx(d,T,N){return(N?Mr(d,T,N):T===t)?T=1:T=tn(T),ed(vn(d),T)}function Vx(){var d=arguments,T=vn(d[0]);return d.length<3?T:T.replace(d[1],d[2])}var zx=Vs(function(d,T,N){return d+(N?"_":"")+T.toLowerCase()});function kx(d,T,N){return N&&typeof N!="number"&&Mr(d,T,N)&&(T=N=t),N=N===t?le:N>>>0,N?(d=vn(d),d&&(typeof T=="string"||T!=null&&!Sd(T))&&(T=Nr(T),!T&&Ns(d))?da(ri(d),0,N):d.split(T,N)):[]}var Kx=Vs(function(d,T,N){return d+(N?" ":"")+Rd(T)});function Yx(d,T,N){return d=vn(d),N=N==null?0:ja(tn(N),0,d.length),T=Nr(T),d.slice(N,N+T.length)==T}function Xx(d,T,N){var ne=xe.templateSettings;N&&Mr(d,T,N)&&(T=t),d=vn(d),T=Qu({},T,ne,zm);var Ee=Qu({},T.imports,ne.imports,zm),Re=$n(Ee),Le=Bf(Ee,Re),je,et,_t=0,vt=T.interpolate||gt,Tt="__p += '",Nt=Wf((T.escape||gt).source+"|"+vt.source+"|"+(vt===Ce?Pe:gt).source+"|"+(T.evaluate||gt).source+"|$","g"),Vt="//# sourceURL="+(Tn.call(T,"sourceURL")?(T.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sf+"]")+`
`;d.replace(Nt,function(Qt,ln,fn,Br,Sr,Ur){return fn||(fn=Br),Tt+=d.slice(_t,Ur).replace(Yt,ST),ln&&(je=!0,Tt+=`' +
__e(`+ln+`) +
'`),Sr&&(et=!0,Tt+=`';
`+Sr+`;
__p += '`),fn&&(Tt+=`' +
((__t = (`+fn+`)) == null ? '' : __t) +
'`),_t=Ur+Qt.length,Qt}),Tt+=`';
`;var Xt=Tn.call(T,"variable")&&T.variable;if(!Xt)Tt=`with (obj) {
`+Tt+`
}
`;else if(nt.test(Xt))throw new qt(l);Tt=(et?Tt.replace(ct,""):Tt).replace(xt,"$1").replace(Bt,"$1;"),Tt="function("+(Xt||"obj")+`) {
`+(Xt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(je?", __e = _.escape":"")+(et?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Tt+`return __p
}`;var nn=Fg(function(){return gn(Re,Vt+"return "+Tt).apply(t,Le)});if(nn.source=Tt,Md(nn))throw nn;return nn}function Qx(d){return vn(d).toLowerCase()}function Jx(d){return vn(d).toUpperCase()}function Zx(d,T,N){if(d=vn(d),d&&(N||T===t))return kp(d);if(!d||!(T=Nr(T)))return d;var ne=ri(d),Ee=ri(T),Re=Kp(ne,Ee),Le=Yp(ne,Ee)+1;return da(ne,Re,Le).join("")}function qx(d,T,N){if(d=vn(d),d&&(N||T===t))return d.slice(0,Qp(d)+1);if(!d||!(T=Nr(T)))return d;var ne=ri(d),Ee=Yp(ne,ri(T))+1;return da(ne,0,Ee).join("")}function $x(d,T,N){if(d=vn(d),d&&(N||T===t))return d.replace(Ae,"");if(!d||!(T=Nr(T)))return d;var ne=ri(d),Ee=Kp(ne,ri(T));return da(ne,Ee).join("")}function eR(d,T){var N=A,ne=I;if(On(T)){var Ee="separator"in T?T.separator:Ee;N="length"in T?tn(T.length):N,ne="omission"in T?Nr(T.omission):ne}d=vn(d);var Re=d.length;if(Ns(d)){var Le=ri(d);Re=Le.length}if(N>=Re)return d;var je=N-Fs(ne);if(je<1)return ne;var et=Le?da(Le,0,je).join(""):d.slice(0,je);if(Ee===t)return et+ne;if(Le&&(je+=et.length-je),Sd(Ee)){if(d.slice(je).search(Ee)){var _t,vt=et;for(Ee.global||(Ee=Wf(Ee.source,vn(qe.exec(Ee))+"g")),Ee.lastIndex=0;_t=Ee.exec(vt);)var Tt=_t.index;et=et.slice(0,Tt===t?je:Tt)}}else if(d.indexOf(Nr(Ee),je)!=je){var Nt=et.lastIndexOf(Ee);Nt>-1&&(et=et.slice(0,Nt))}return et+ne}function tR(d){return d=vn(d),d&&Ht.test(d)?d.replace(Lt,DT):d}var nR=Vs(function(d,T,N){return d+(N?" ":"")+T.toUpperCase()}),Rd=Bm("toUpperCase");function Ng(d,T,N){return d=vn(d),T=N?t:T,T===t?xT(d)?OT(d):du(d):d.match(T)||[]}var Fg=an(function(d,T){try{return or(d,t,T)}catch(N){return Md(N)?N:new qt(N)}}),rR=Ui(function(d,T){return Cr(T,function(N){N=Ei(N),Fi(d,N,yd(d[N],d))}),d});function iR(d){var T=d==null?0:d.length,N=Kt();return d=T?In(d,function(ne){if(typeof ne[1]!="function")throw new Kr(o);return[N(ne[0]),ne[1]]}):[],an(function(ne){for(var Ee=-1;++Ee<T;){var Re=d[Ee];if(or(Re[0],this,ne))return or(Re[1],this,ne)}})}function aR(d){return D0(Xr(d,h))}function Cd(d){return function(){return d}}function sR(d,T){return d==null||d!==d?T:d}var oR=Wm(),lR=Wm(!0);function Pr(d){return d}function bd(d){return mm(typeof d=="function"?d:Xr(d,h))}function uR(d){return _m(Xr(d,h))}function cR(d,T){return vm(d,Xr(T,h))}var fR=an(function(d,T){return function(N){return rl(N,d,T)}}),dR=an(function(d,T){return function(N){return rl(d,N,T)}});function Id(d,T,N){var ne=$n(T),Ee=Du(T,ne);N==null&&!(On(T)&&(Ee.length||!ne.length))&&(N=T,T=d,d=this,Ee=Du(T,$n(T)));var Re=!(On(N)&&"chain"in N)||!!N.chain,Le=Hi(d);return Cr(Ee,function(je){var et=T[je];d[je]=et,Le&&(d.prototype[je]=function(){var _t=this.__chain__;if(Re||_t){var vt=d(this.__wrapped__),Tt=vt.__actions__=br(this.__actions__);return Tt.push({func:et,args:arguments,thisArg:d}),vt.__chain__=_t,vt}return et.apply(d,ti([this.value()],arguments))})}),d}function hR(){return Yn._===this&&(Yn._=WT),this}function Dd(){}function pR(d){return d=tn(d),an(function(T){return Em(T,d)})}var mR=od(In),gR=od(fu),_R=od(Ba);function Bg(d){return pd(d)?xn(Ei(d)):Y0(d)}function vR(d){return function(T){return d==null?t:Va(d,T)}}var ER=Gm(),yR=Gm(!0);function Pd(){return[]}function wd(){return!1}function TR(){return{}}function MR(){return""}function SR(){return!0}function AR(d,T){if(d=tn(d),d<1||d>K)return[];var N=le,ne=_r(d,le);T=Kt(T),d-=le;for(var Ee=Ff(ne,T);++N<d;)T(N);return Ee}function xR(d){return en(d)?In(d,Ei):Fr(d)?[d]:br(rg(vn(d)))}function RR(d){var T=++BT;return vn(d)+T}var CR=Fu(function(d,T){return d+T},0),bR=ld("ceil"),IR=Fu(function(d,T){return d/T},1),DR=ld("floor");function PR(d){return d&&d.length?Iu(d,Pr,Yf):t}function wR(d,T){return d&&d.length?Iu(d,Kt(T,2),Yf):t}function OR(d){return dn(d,Pr)}function LR(d,T){return dn(d,Kt(T,2))}function NR(d){return d&&d.length?Iu(d,Pr,Zf):t}function FR(d,T){return d&&d.length?Iu(d,Kt(T,2),Zf):t}var BR=Fu(function(d,T){return d*T},1),UR=ld("round"),WR=Fu(function(d,T){return d-T},0);function HR(d){return d&&d.length?Nf(d,Pr):0}function GR(d,T){return d&&d.length?Nf(d,Kt(T,2)):0}return xe.after=uA,xe.ary=pg,xe.assign=JA,xe.assignIn=bg,xe.assignInWith=Qu,xe.assignWith=ZA,xe.at=qA,xe.before=mg,xe.bind=yd,xe.bindAll=rR,xe.bindKey=gg,xe.castArray=TA,xe.chain=fg,xe.chunk=DM,xe.compact=PM,xe.concat=wM,xe.cond=iR,xe.conforms=aR,xe.constant=Cd,xe.countBy=HS,xe.create=$A,xe.curry=_g,xe.curryRight=vg,xe.debounce=Eg,xe.defaults=ex,xe.defaultsDeep=tx,xe.defer=cA,xe.delay=fA,xe.difference=OM,xe.differenceBy=LM,xe.differenceWith=NM,xe.drop=FM,xe.dropRight=BM,xe.dropRightWhile=UM,xe.dropWhile=WM,xe.fill=HM,xe.filter=jS,xe.flatMap=kS,xe.flatMapDeep=KS,xe.flatMapDepth=YS,xe.flatten=og,xe.flattenDeep=GM,xe.flattenDepth=jM,xe.flip=dA,xe.flow=oR,xe.flowRight=lR,xe.fromPairs=VM,xe.functions=lx,xe.functionsIn=ux,xe.groupBy=XS,xe.initial=kM,xe.intersection=KM,xe.intersectionBy=YM,xe.intersectionWith=XM,xe.invert=fx,xe.invertBy=dx,xe.invokeMap=JS,xe.iteratee=bd,xe.keyBy=ZS,xe.keys=$n,xe.keysIn=Dr,xe.map=Vu,xe.mapKeys=px,xe.mapValues=mx,xe.matches=uR,xe.matchesProperty=cR,xe.memoize=ku,xe.merge=gx,xe.mergeWith=Ig,xe.method=fR,xe.methodOf=dR,xe.mixin=Id,xe.negate=Ku,xe.nthArg=pR,xe.omit=_x,xe.omitBy=vx,xe.once=hA,xe.orderBy=qS,xe.over=mR,xe.overArgs=pA,xe.overEvery=gR,xe.overSome=_R,xe.partial=Td,xe.partialRight=yg,xe.partition=$S,xe.pick=Ex,xe.pickBy=Dg,xe.property=Bg,xe.propertyOf=vR,xe.pull=qM,xe.pullAll=ug,xe.pullAllBy=$M,xe.pullAllWith=eS,xe.pullAt=tS,xe.range=ER,xe.rangeRight=yR,xe.rearg=mA,xe.reject=nA,xe.remove=nS,xe.rest=gA,xe.reverse=vd,xe.sampleSize=iA,xe.set=Tx,xe.setWith=Mx,xe.shuffle=aA,xe.slice=rS,xe.sortBy=lA,xe.sortedUniq=cS,xe.sortedUniqBy=fS,xe.split=kx,xe.spread=_A,xe.tail=dS,xe.take=hS,xe.takeRight=pS,xe.takeRightWhile=mS,xe.takeWhile=gS,xe.tap=PS,xe.throttle=vA,xe.thru=ju,xe.toArray=xg,xe.toPairs=Pg,xe.toPairsIn=wg,xe.toPath=xR,xe.toPlainObject=Cg,xe.transform=Sx,xe.unary=EA,xe.union=_S,xe.unionBy=vS,xe.unionWith=ES,xe.uniq=yS,xe.uniqBy=TS,xe.uniqWith=MS,xe.unset=Ax,xe.unzip=Ed,xe.unzipWith=cg,xe.update=xx,xe.updateWith=Rx,xe.values=Ks,xe.valuesIn=Cx,xe.without=SS,xe.words=Ng,xe.wrap=yA,xe.xor=AS,xe.xorBy=xS,xe.xorWith=RS,xe.zip=CS,xe.zipObject=bS,xe.zipObjectDeep=IS,xe.zipWith=DS,xe.entries=Pg,xe.entriesIn=wg,xe.extend=bg,xe.extendWith=Qu,Id(xe,xe),xe.add=CR,xe.attempt=Fg,xe.camelCase=Px,xe.capitalize=Og,xe.ceil=bR,xe.clamp=bx,xe.clone=MA,xe.cloneDeep=AA,xe.cloneDeepWith=xA,xe.cloneWith=SA,xe.conformsTo=RA,xe.deburr=Lg,xe.defaultTo=sR,xe.divide=IR,xe.endsWith=wx,xe.eq=ai,xe.escape=Ox,xe.escapeRegExp=Lx,xe.every=GS,xe.find=VS,xe.findIndex=ag,xe.findKey=nx,xe.findLast=zS,xe.findLastIndex=sg,xe.findLastKey=rx,xe.floor=DR,xe.forEach=dg,xe.forEachRight=hg,xe.forIn=ix,xe.forInRight=ax,xe.forOwn=sx,xe.forOwnRight=ox,xe.get=Ad,xe.gt=CA,xe.gte=bA,xe.has=cx,xe.hasIn=xd,xe.head=lg,xe.identity=Pr,xe.includes=QS,xe.indexOf=zM,xe.inRange=Ix,xe.invoke=hx,xe.isArguments=Ka,xe.isArray=en,xe.isArrayBuffer=IA,xe.isArrayLike=Ir,xe.isArrayLikeObject=Un,xe.isBoolean=DA,xe.isBuffer=ha,xe.isDate=PA,xe.isElement=wA,xe.isEmpty=OA,xe.isEqual=LA,xe.isEqualWith=NA,xe.isError=Md,xe.isFinite=FA,xe.isFunction=Hi,xe.isInteger=Tg,xe.isLength=Yu,xe.isMap=Mg,xe.isMatch=BA,xe.isMatchWith=UA,xe.isNaN=WA,xe.isNative=HA,xe.isNil=jA,xe.isNull=GA,xe.isNumber=Sg,xe.isObject=On,xe.isObjectLike=Nn,xe.isPlainObject=ul,xe.isRegExp=Sd,xe.isSafeInteger=VA,xe.isSet=Ag,xe.isString=Xu,xe.isSymbol=Fr,xe.isTypedArray=ks,xe.isUndefined=zA,xe.isWeakMap=kA,xe.isWeakSet=KA,xe.join=QM,xe.kebabCase=Nx,xe.last=Jr,xe.lastIndexOf=JM,xe.lowerCase=Fx,xe.lowerFirst=Bx,xe.lt=YA,xe.lte=XA,xe.max=PR,xe.maxBy=wR,xe.mean=OR,xe.meanBy=LR,xe.min=NR,xe.minBy=FR,xe.stubArray=Pd,xe.stubFalse=wd,xe.stubObject=TR,xe.stubString=MR,xe.stubTrue=SR,xe.multiply=BR,xe.nth=ZM,xe.noConflict=hR,xe.noop=Dd,xe.now=zu,xe.pad=Ux,xe.padEnd=Wx,xe.padStart=Hx,xe.parseInt=Gx,xe.random=Dx,xe.reduce=eA,xe.reduceRight=tA,xe.repeat=jx,xe.replace=Vx,xe.result=yx,xe.round=UR,xe.runInContext=Je,xe.sample=rA,xe.size=sA,xe.snakeCase=zx,xe.some=oA,xe.sortedIndex=iS,xe.sortedIndexBy=aS,xe.sortedIndexOf=sS,xe.sortedLastIndex=oS,xe.sortedLastIndexBy=lS,xe.sortedLastIndexOf=uS,xe.startCase=Kx,xe.startsWith=Yx,xe.subtract=WR,xe.sum=HR,xe.sumBy=GR,xe.template=Xx,xe.times=AR,xe.toFinite=Gi,xe.toInteger=tn,xe.toLength=Rg,xe.toLower=Qx,xe.toNumber=Zr,xe.toSafeInteger=QA,xe.toString=vn,xe.toUpper=Jx,xe.trim=Zx,xe.trimEnd=qx,xe.trimStart=$x,xe.truncate=eR,xe.unescape=tR,xe.uniqueId=RR,xe.upperCase=nR,xe.upperFirst=Rd,xe.each=dg,xe.eachRight=hg,xe.first=lg,Id(xe,function(){var d={};return _i(xe,function(T,N){Tn.call(xe.prototype,N)||(d[N]=T)}),d}(),{chain:!1}),xe.VERSION=r,Cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){xe[d].placeholder=xe}),Cr(["drop","take"],function(d,T){cn.prototype[d]=function(N){N=N===t?1:Qn(tn(N),0);var ne=this.__filtered__&&!T?new cn(this):this.clone();return ne.__filtered__?ne.__takeCount__=_r(N,ne.__takeCount__):ne.__views__.push({size:_r(N,le),type:d+(ne.__dir__<0?"Right":"")}),ne},cn.prototype[d+"Right"]=function(N){return this.reverse()[d](N).reverse()}}),Cr(["filter","map","takeWhile"],function(d,T){var N=T+1,ne=N==V||N==H;cn.prototype[d]=function(Ee){var Re=this.clone();return Re.__iteratees__.push({iteratee:Kt(Ee,3),type:N}),Re.__filtered__=Re.__filtered__||ne,Re}}),Cr(["head","last"],function(d,T){var N="take"+(T?"Right":"");cn.prototype[d]=function(){return this[N](1).value()[0]}}),Cr(["initial","tail"],function(d,T){var N="drop"+(T?"":"Right");cn.prototype[d]=function(){return this.__filtered__?new cn(this):this[N](1)}}),cn.prototype.compact=function(){return this.filter(Pr)},cn.prototype.find=function(d){return this.filter(d).head()},cn.prototype.findLast=function(d){return this.reverse().find(d)},cn.prototype.invokeMap=an(function(d,T){return typeof d=="function"?new cn(this):this.map(function(N){return rl(N,d,T)})}),cn.prototype.reject=function(d){return this.filter(Ku(Kt(d)))},cn.prototype.slice=function(d,T){d=tn(d);var N=this;return N.__filtered__&&(d>0||T<0)?new cn(N):(d<0?N=N.takeRight(-d):d&&(N=N.drop(d)),T!==t&&(T=tn(T),N=T<0?N.dropRight(-T):N.take(T-d)),N)},cn.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},cn.prototype.toArray=function(){return this.take(le)},_i(cn.prototype,function(d,T){var N=/^(?:filter|find|map|reject)|While$/.test(T),ne=/^(?:head|last)$/.test(T),Ee=xe[ne?"take"+(T=="last"?"Right":""):T],Re=ne||/^find/.test(T);!Ee||(xe.prototype[T]=function(){var Le=this.__wrapped__,je=ne?[1]:arguments,et=Le instanceof cn,_t=je[0],vt=et||en(Le),Tt=function(ln){var fn=Ee.apply(xe,ti([ln],je));return ne&&Nt?fn[0]:fn};vt&&N&&typeof _t=="function"&&_t.length!=1&&(et=vt=!1);var Nt=this.__chain__,Vt=!!this.__actions__.length,Xt=Re&&!Nt,nn=et&&!Vt;if(!Re&&vt){Le=nn?Le:new cn(this);var Qt=d.apply(Le,je);return Qt.__actions__.push({func:ju,args:[Tt],thisArg:t}),new Yr(Qt,Nt)}return Xt&&nn?d.apply(this,je):(Qt=this.thru(Tt),Xt?ne?Qt.value()[0]:Qt.value():Qt)})}),Cr(["pop","push","shift","sort","splice","unshift"],function(d){var T=pu[d],N=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",ne=/^(?:pop|shift)$/.test(d);xe.prototype[d]=function(){var Ee=arguments;if(ne&&!this.__chain__){var Re=this.value();return T.apply(en(Re)?Re:[],Ee)}return this[N](function(Le){return T.apply(en(Le)?Le:[],Ee)})}}),_i(cn.prototype,function(d,T){var N=xe[T];if(N){var ne=N.name+"";Tn.call(Hs,ne)||(Hs[ne]=[]),Hs[ne].push({name:T,func:N})}}),Hs[Nu(t,_).name]=[{name:"wrapper",func:t}],cn.prototype.clone=t0,cn.prototype.reverse=n0,cn.prototype.value=r0,xe.prototype.at=wS,xe.prototype.chain=OS,xe.prototype.commit=LS,xe.prototype.next=NS,xe.prototype.plant=BS,xe.prototype.reverse=US,xe.prototype.toJSON=xe.prototype.valueOf=xe.prototype.value=WS,xe.prototype.first=xe.prototype.head,Jo&&(xe.prototype[Jo]=FS),xe},Bs=LT();wi?((wi.exports=Bs)._=Bs,zo._=Bs):Yn._=Bs}).call(cl)})(oT,oT.exports);var lT={exports:{}};(function(m,e){(function(r,n){m.exports=n()})(window,function(){return function(t){var r={};function n(i){if(r[i])return r[i].exports;var o=r[i]={i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=r,n.d=function(i,o,l){n.o(i,o)||Object.defineProperty(i,o,{enumerable:!0,get:l})},n.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,o){if(o&1&&(i=n(i)),o&8||o&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),o&2&&typeof i!="string")for(var u in i)n.d(l,u,function(c){return i[c]}.bind(null,u));return l},n.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(o,"a",o),o},n.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},n.p="/dist/",n(n.s="./index.js")}({"./externals/base64.js":function(t,r,n){var i={};i.encode=function(l){for(var u=[],c=0;c<l.length;++c){var f=l.charCodeAt(c);f<128?u.push(f):f<2048?(u.push(192|f>>6),u.push(128|63&f)):f<65536?(u.push(224|f>>12),u.push(128|63&f>>6),u.push(128|63&f)):(u.push(240|f>>18),u.push(128|63&f>>12),u.push(128|63&f>>6),u.push(128|63&f))}return u},i.decode=function(l){for(var u=[],c=0;c<l.length;){var f=l[c++];f<128||(f<224?(f=(31&f)<<6,f|=63&l[c++]):f<240?(f=(15&f)<<12,f|=(63&l[c++])<<6,f|=63&l[c++]):(f=(7&f)<<18,f|=(63&l[c++])<<12,f|=(63&l[c++])<<6,f|=63&l[c++])),u.push(String.fromCharCode(f))}return u.join("")};var o={};(function(l){var u=function(E){for(var v=0,M=[],y=0|E.length/3;0<y--;){var _=(E[v]<<16)+(E[v+1]<<8)+E[v+2];v+=3,M.push(l.charAt(63&_>>18)),M.push(l.charAt(63&_>>12)),M.push(l.charAt(63&_>>6)),M.push(l.charAt(63&_))}if(E.length-v==2){var _=(E[v]<<16)+(E[v+1]<<8);M.push(l.charAt(63&_>>18)),M.push(l.charAt(63&_>>12)),M.push(l.charAt(63&_>>6)),M.push("=")}else if(E.length-v==1){var _=E[v]<<16;M.push(l.charAt(63&_>>18)),M.push(l.charAt(63&_>>12)),M.push("==")}return M.join("")},c=function(){for(var p=[],E=0;E<l.length;++E)p[l.charCodeAt(E)]=E;return p["=".charCodeAt(0)]=0,p}(),f=function(E){for(var v=0,M=[],y=0|E.length/4;0<y--;){var _=(c[E.charCodeAt(v)]<<18)+(c[E.charCodeAt(v+1)]<<12)+(c[E.charCodeAt(v+2)]<<6)+c[E.charCodeAt(v+3)];M.push(255&_>>16),M.push(255&_>>8),M.push(255&_),v+=4}return M&&(E.charAt(v-2)=="="?(M.pop(),M.pop()):E.charAt(v-1)=="="&&M.pop()),M},h={};h.encode=function(p){for(var E=[],v=0;v<p.length;++v)E.push(p.charCodeAt(v));return E},h.decode=function(p){for(var E=0;E<s.length;++E)a[E]=String.fromCharCode(a[E]);return a.join("")},o.decodeArray=function(p){var E=f(p);return new Uint8Array(E)},o.encodeASCII=function(p){var E=h.encode(p);return u(E)},o.decodeASCII=function(p){var E=f(p);return h.decode(E)},o.encode=function(p){var E=i.encode(p);return u(E)},o.decode=function(p){var E=f(p);return i.decode(E)}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),r.decode=o.decode,r.decodeArray=o.decodeArray,r.encode=o.encode,r.encodeASCII=o.encodeASCII},"./externals/cea608-parser.js":function(t,r,n){(function(i){var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},l=function(A){var I=A;return o.hasOwnProperty(A)&&(I=o[A]),String.fromCharCode(I)},u=15,c=32,f={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},h={17:2,18:4,21:6,22:8,23:10,19:13,20:15},p={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},E={25:2,26:4,29:6,30:8,31:10,27:13,28:15},v=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],M={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(A){this.time=A},log:function(A,I){var F=this.verboseFilter[A];this.verboseLevel>=F&&console.log(this.time+" ["+A+"] "+I)}},y=function(A){for(var I=[],F=0;F<A.length;F++)I.push(A[F].toString(16));return I},_=function(A,I,F,G,V){this.foreground=A||"white",this.underline=I||!1,this.italics=F||!1,this.background=G||"black",this.flash=V||!1};_.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(A){for(var I=["foreground","underline","italics","background","flash"],F=0;F<I.length;F++){var G=I[F];A.hasOwnProperty(G)&&(this[G]=A[G])}},isDefault:function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},equals:function(A){return this.foreground===A.foreground&&this.underline===A.underline&&this.italics===A.italics&&this.background===A.background&&this.flash===A.flash},copy:function(A){this.foreground=A.foreground,this.underline=A.underline,this.italics=A.italics,this.background=A.background,this.flash=A.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var g=function(A,I,F,G,V,k){this.uchar=A||" ",this.penState=new _(I,F,G,V,k)};g.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(A,I){this.uchar=A,this.penState.copy(I)},setPenState:function(A){this.penState.copy(A)},equals:function(A){return this.uchar===A.uchar&&this.penState.equals(A.penState)},copy:function(A){this.uchar=A.uchar,this.penState.copy(A.penState)},isEmpty:function(){return this.uchar===" "&&this.penState.isDefault()}};var R=function(){this.chars=[];for(var A=0;A<c;A++)this.chars.push(new g);this.pos=0,this.currPenState=new _};R.prototype={equals:function(A){for(var I=!0,F=0;F<c;F++)if(!this.chars[F].equals(A.chars[F])){I=!1;break}return I},copy:function(A){for(var I=0;I<c;I++)this.chars[I].copy(A.chars[I])},isEmpty:function(){for(var A=!0,I=0;I<c;I++)if(!this.chars[I].isEmpty()){A=!1;break}return A},setCursor:function(A){this.pos!==A&&(this.pos=A),this.pos<0?(M.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>c&&(M.log("ERROR","Too large cursor position "+this.pos),this.pos=c)},moveCursor:function(A){var I=this.pos+A;if(A>1)for(var F=this.pos+1;F<I+1;F++)this.chars[F].setPenState(this.currPenState);this.setCursor(I)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(A){A>=144&&this.backSpace();var I=l(A);if(this.pos>=c){M.log("ERROR","Cannot insert "+A.toString(16)+" ("+I+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(I,this.currPenState),this.moveCursor(1)},clearFromPos:function(A){var I;for(I=A;I<c;I++)this.chars[I].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var A=[],I=!0,F=0;F<c;F++){var G=this.chars[F].uchar;G!==" "&&(I=!1),A.push(G)}return I?"":A.join("")},setPenStyles:function(A){this.currPenState.setStyles(A);var I=this.chars[this.pos];I.setPenState(this.currPenState)}};var S=function(){this.rows=[];for(var A=0;A<u;A++)this.rows.push(new R);this.currRow=u-1,this.nrRollUpRows=null,this.reset()};S.prototype={reset:function(){for(var A=0;A<u;A++)this.rows[A].clear();this.currRow=u-1},equals:function(A){for(var I=!0,F=0;F<u;F++)if(!this.rows[F].equals(A.rows[F])){I=!1;break}return I},copy:function(A){for(var I=0;I<u;I++)this.rows[I].copy(A.rows[I])},isEmpty:function(){for(var A=!0,I=0;I<u;I++)if(!this.rows[I].isEmpty()){A=!1;break}return A},backSpace:function(){var A=this.rows[this.currRow];A.backSpace()},clearToEndOfRow:function(){var A=this.rows[this.currRow];A.clearToEndOfRow()},insertChar:function(A){var I=this.rows[this.currRow];I.insertChar(A)},setPen:function(A){var I=this.rows[this.currRow];I.setPenStyles(A)},moveCursor:function(A){var I=this.rows[this.currRow];I.moveCursor(A)},setCursor:function(A){M.log("INFO","setCursor: "+A);var I=this.rows[this.currRow];I.setCursor(A)},setPAC:function(A){M.log("INFO","pacData = "+JSON.stringify(A));var I=A.row-1;this.nrRollUpRows&&I<this.nrRollUpRows-1&&(I=this.nrRollUpRows-1),this.currRow=I;var F=this.rows[this.currRow];if(A.indent!==null){var G=A.indent,V=Math.max(G-1,0);F.setCursor(A.indent),A.color=F.chars[V].penState.foreground}var k={foreground:A.color,underline:A.underline,italics:A.italics,background:"black",flash:!1};this.setPen(k)},setBkgData:function(A){M.log("INFO","bkgData = "+JSON.stringify(A)),this.backSpace(),this.setPen(A),this.insertChar(32)},setRollUpRows:function(A){this.nrRollUpRows=A},rollUp:function(){if(this.nrRollUpRows===null){M.log("DEBUG","roll_up but nrRollUpRows not set yet");return}M.log("TEXT",this.getDisplayText());var A=this.currRow+1-this.nrRollUpRows,I=this.rows.splice(A,1)[0];I.clear(),this.rows.splice(this.currRow,0,I),M.log("INFO","Rolling up")},getDisplayText:function(A){A=A||!1;for(var I=[],F="",G=-1,V=0;V<u;V++){var k=this.rows[V].getTextString();k&&(G=V+1,A?I.push("Row "+G+': "'+k+'"'):I.push(k.trim()))}return I.length>0&&(A?F="["+I.join(" | ")+"]":F=I.join(`
`)),F},getTextAndFormat:function(){return this.rows}};var x=function(A,I){this.chNr=A,this.outputFilter=I,this.mode=null,this.verbose=0,this.displayedMemory=new S,this.nonDisplayedMemory=new S,this.lastOutputScreen=new S,this.currRollUpRow=this.displayedMemory.rows[u-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};x.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[u-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(A){this.outputFilter=A},setPAC:function(A){this.writeScreen.setPAC(A)},setBkgData:function(A){this.writeScreen.setBkgData(A)},setMode:function(A){A!==this.mode&&(this.mode=A,M.log("INFO","MODE="+A),this.mode=="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=A)},insertChars:function(A){for(var I=0;I<A.length;I++)this.writeScreen.insertChar(A[I]);var F=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";M.log("INFO",F+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(M.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){M.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){M.log("INFO","BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){M.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(A){M.log("INFO","RU("+A+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(A)},cc_FON:function(){M.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){M.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){M.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){M.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){M.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){M.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){M.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(M.log("INFO","EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var A=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=A,this.writeScreen=this.nonDisplayedMemory,M.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(A){M.log("INFO","TO("+A+") - Tab Offset"),this.writeScreen.moveCursor(A)},cc_MIDROW:function(A){var I={flash:!1};if(I.underline=A%2==1,I.italics=A>=46,I.italics)I.foreground="white";else{var F=Math.floor(A/2)-16,G=["white","green","blue","cyan","red","yellow","magenta"];I.foreground=G[F]}M.log("INFO","MIDROW: "+JSON.stringify(I)),this.writeScreen.setPen(I)},outputDataUpdate:function(){var A=M.time;A!==null&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(A,this.displayedMemory),this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=A:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,A,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:A),this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(A){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,A,this.displayedMemory),this.cueStartTime=A))}};var w=function(A,I,F){this.field=A||1,this.outputs=[I,F],this.channels=[new x(1,I),new x(2,F)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};w.prototype={getHandler:function(A){return this.channels[A].getHandler()},setHandler:function(A,I){this.channels[A].setHandler(I)},addData:function(A,I){var F,G,V,k=!1;this.lastTime=A,M.setTime(A);for(var H=0;H<I.length;H+=2){if(G=I[H]&127,V=I[H+1]&127,G>=16&&G<=31&&G===this.lastCmdA&&V===this.lastCmdB){this.lastCmdA=null,this.lastCmdB=null,M.log("DEBUG","Repeated command ("+y([G,V])+") is dropped");continue}if(G===0&&V===0){this.dataCounters.padding+=2;continue}else M.log("DATA","["+y([I[H],I[H+1]])+"] -> ("+y([G,V])+")");if(F=this.parseCmd(G,V),F||(F=this.parseMidrow(G,V)),F||(F=this.parsePAC(G,V)),F||(F=this.parseBackgroundAttributes(G,V)),!F&&(k=this.parseChars(G,V),k))if(this.currChNr&&this.currChNr>=0){var J=this.channels[this.currChNr-1];J.insertChars(k)}else M.log("WARNING","No channel found yet. TEXT-MODE?");F?this.dataCounters.cmd+=2:k?this.dataCounters.char+=2:(this.dataCounters.other+=2,M.log("WARNING","Couldn't parse cleaned data "+y([G,V])+" orig: "+y([I[H],I[H+1]])))}},parseCmd:function(A,I){var F=null,G=(A===20||A===21||A===28||A===29)&&32<=I&&I<=47,V=(A===23||A===31)&&33<=I&&I<=35;if(!(G||V))return!1;A===20||A===21||A===23?F=1:F=2;var k=this.channels[F-1];return A===20||A===21||A===28||A===29?I===32?k.cc_RCL():I===33?k.cc_BS():I===34?k.cc_AOF():I===35?k.cc_AON():I===36?k.cc_DER():I===37?k.cc_RU(2):I===38?k.cc_RU(3):I===39?k.cc_RU(4):I===40?k.cc_FON():I===41?k.cc_RDC():I===42?k.cc_TR():I===43?k.cc_RTD():I===44?k.cc_EDM():I===45?k.cc_CR():I===46?k.cc_ENM():I===47&&k.cc_EOC():k.cc_TO(I-32),this.lastCmdA=A,this.lastCmdB=I,this.currChNr=F,!0},parseMidrow:function(A,I){var F=null;if((A===17||A===25)&&32<=I&&I<=47){if(A===17?F=1:F=2,F!==this.currChNr)return M.log("ERROR","Mismatch channel in midrow parsing"),!1;var G=this.channels[F-1];return G.insertChars([32]),G.cc_MIDROW(I),M.log("DEBUG","MIDROW ("+y([A,I])+")"),this.lastCmdA=A,this.lastCmdB=I,!0}return!1},parsePAC:function(A,I){var F=null,G=null,V=(17<=A&&A<=23||25<=A&&A<=31)&&64<=I&&I<=127,k=(A===16||A===24)&&64<=I&&I<=95;if(!(V||k))return!1;F=A<=23?1:2,64<=I&&I<=95?G=F===1?f[A]:p[A]:G=F===1?h[A]:E[A];var H=this.interpretPAC(G,I),J=this.channels[F-1];return J.setPAC(H),this.lastCmdA=A,this.lastCmdB=I,this.currChNr=F,!0},interpretPAC:function(A,I){var F=I,G={color:null,italics:!1,indent:null,underline:!1,row:A};return I>95?F=I-96:F=I-64,G.underline=(F&1)==1,F<=13?G.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(F/2)]:F<=15?(G.italics=!0,G.color="white"):G.indent=Math.floor((F-16)/2)*4,G},parseChars:function(A,I){var F=null,G=null,V=null;if(A>=25?(F=2,V=A-8):(F=1,V=A),17<=V&&V<=19){var k=I;V===17?k=I+80:V===18?k=I+112:k=I+144,M.log("INFO","Special char '"+l(k)+"' in channel "+F),G=[k],this.lastCmdA=A,this.lastCmdB=I}else 32<=A&&A<=127&&(G=I===0?[A]:[A,I],this.lastCmdA=null,this.lastCmdB=null);if(G){var H=y(G);M.log("DEBUG","Char codes =  "+H.join(","))}return G},parseBackgroundAttributes:function(A,I){var F,G,V,k,H=(A===16||A===24)&&32<=I&&I<=47,J=(A===23||A===31)&&45<=I&&I<=47;return H||J?(F={},A===16||A===24?(G=Math.floor((I-32)/2),F.background=v[G],I%2==1&&(F.background=F.background+"_semi")):I===45?F.background="transparent":(F.foreground="black",I===47&&(F.underline=!0)),V=A<24?1:2,k=this.channels[V-1],k.setBkgData(F),this.lastCmdA=A,this.lastCmdB=I,!0):!1},reset:function(){for(var A=0;A<this.channels.length;A++)this.channels[A]&&this.channels[A].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(A){for(var I=0;I<this.channels.length;I++)this.channels[I]&&this.channels[I].cueSplitAtTime(A)}};var C=function(A,I,F){for(var G=0,V=I,k=0,H=[],J=function(de,te,q,Z){if(de!==4||te<8)return null;var pe=q.getUint8(Z),he=q.getUint16(Z+1),Q=q.getUint32(Z+3),Y=q.getUint8(Z+7);return pe==181&&he==49&&Q==1195456820&&Y==3};V<I+F;){if(G=A.getUint32(V),k=A.getUint8(V+4)&31,k===6)for(var K=V+5,ae=-1;K<V+4+G-1;){ae=0;for(var re=255;re===255;)re=A.getUint8(K),ae+=re,K++;var le=0;for(re=255;re===255;)re=A.getUint8(K),le+=re,K++;J(ae,le,A,K)&&H.push([K,le]),K+=le}V+=G+4}return H},b=function(A,I){var F=I[0],G=[[],[]];F+=8;var V=A.getUint8(F)&31;F+=2;for(var k=0;k<V;k++){var H=A.getUint8(F),J=H&4,K=H&3;F++;var ae=A.getUint8(F);F++;var re=A.getUint8(F);F++,J&&(ae&127)+(re&127)!=0&&(K===0?(G[0].push(ae),G[0].push(re)):K===1&&(G[1].push(ae),G[1].push(re)))}return G};i.logger=M,i.PenState=_,i.CaptionScreen=S,i.Cea608Parser=w,i.findCea608Nalus=C,i.extractCea608DataFromRange=b})(r)},"./externals/xml2json.js":function(t,r,n){n.r(r);function i(o){var l="1.2.0";o=o||{},u();function u(){o.escapeMode===void 0&&(o.escapeMode=!0),o.attributePrefix===void 0&&(o.attributePrefix="_"),o.arrayAccessForm=o.arrayAccessForm||"none",o.emptyNodeForm=o.emptyNodeForm||"text",o.enableToStringFunc===void 0&&(o.enableToStringFunc=!0),o.arrayAccessFormPaths=o.arrayAccessFormPaths||[],o.skipEmptyTextNodesForObj===void 0&&(o.skipEmptyTextNodesForObj=!0),o.stripWhitespaces===void 0&&(o.stripWhitespaces=!0),o.datetimeAccessFormPaths=o.datetimeAccessFormPaths||[],o.useDoubleQuotes===void 0&&(o.useDoubleQuotes=!1),o.xmlElementsFilter=o.xmlElementsFilter||[],o.jsonPropertiesFilter=o.jsonPropertiesFilter||[],o.keepCData===void 0&&(o.keepCData=!1),o.ignoreRoot===void 0&&(o.ignoreRoot=!1)}var c={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function f(k){var H=k.localName;return H==null&&(H=k.baseName),(H==null||H=="")&&(H=k.nodeName),H}function h(k){return k.prefix}function p(k){return typeof k=="string"?k.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):k}function E(k,H,J,K){for(var ae=0;ae<k.length;ae++){var re=k[ae];if(typeof re=="string"){if(re==K)break}else if(re instanceof RegExp){if(re.test(K))break}else if(typeof re=="function"&&re(H,J,K))break}return ae!=k.length}function v(k,H,J){switch(o.arrayAccessForm){case"property":k[H]instanceof Array?k[H+"_asArray"]=k[H]:k[H+"_asArray"]=[k[H]];break}!(k[H]instanceof Array)&&o.arrayAccessFormPaths.length>0&&E(o.arrayAccessFormPaths,k,H,J)&&(k[H]=[k[H]])}function M(k){var H=k.split(/[-T:+Z]/g),J=new Date(H[0],H[1]-1,H[2]),K=H[5].split(".");if(J.setHours(H[3],H[4],K[0]),K.length>1&&J.setMilliseconds(K[1]),H[6]&&H[7]){var ae=H[6]*60+Number(H[7]),re=/\d\d-\d\d:\d\d$/.test(k)?"-":"+";ae=0+(re=="-"?-1*ae:ae),J.setMinutes(J.getMinutes()-ae-J.getTimezoneOffset())}else k.indexOf("Z",k.length-1)!==-1&&(J=new Date(Date.UTC(J.getFullYear(),J.getMonth(),J.getDate(),J.getHours(),J.getMinutes(),J.getSeconds(),J.getMilliseconds())));return J}function y(k,H,J){if(o.datetimeAccessFormPaths.length>0){var K=J.split(".#")[0];return E(o.datetimeAccessFormPaths,k,H,K)?M(k):k}else return k}function _(k,H,J,K){return H==c.ELEMENT_NODE&&o.xmlElementsFilter.length>0?E(o.xmlElementsFilter,k,J,K):!0}function g(k,H){if(k.nodeType==c.DOCUMENT_NODE){for(var J=new Object,K=k.childNodes,ae=0;ae<K.length;ae++){var re=K[ae];if(re.nodeType==c.ELEMENT_NODE)if(o.ignoreRoot)J=g(re);else{J={};var le=f(re);J[le]=g(re)}}return J}else if(k.nodeType==c.ELEMENT_NODE){var J=new Object;J.__cnt=0;for(var me=[],K=k.childNodes,ae=0;ae<K.length;ae++){var re=K[ae],le=f(re);if(re.nodeType!=c.COMMENT_NODE){var de=H+"."+le;if(_(J,re.nodeType,le,de))if(J.__cnt++,J[le]==null){var te=g(re,de);if(le!="#text"||/[^\s]/.test(te)){var q={};q[le]=te,me.push(q)}J[le]=te,v(J,le,de)}else{J[le]!=null&&(J[le]instanceof Array||(J[le]=[J[le]],v(J,le,de)));var te=g(re,de);if(le!="#text"||/[^\s]/.test(te)){var q={};q[le]=te,me.push(q)}J[le][J[le].length]=te}}}J.__children=me;for(var Z=f(k),pe=0;pe<k.attributes.length;pe++){var he=k.attributes[pe];J.__cnt++;for(var Q=he.value,Y=0,ie=o.matchers.length;Y<ie;Y++){var ue=o.matchers[Y];ue.test(he,Z)&&(Q=ue.converter(he.value))}J[o.attributePrefix+he.name]=Q}var $=h(k);return $!=null&&$!=""&&(J.__cnt++,J.__prefix=$),J["#text"]!=null&&(J.__text=J["#text"],J.__text instanceof Array&&(J.__text=J.__text.join(`
`)),o.stripWhitespaces&&(J.__text=J.__text.trim()),delete J["#text"],o.arrayAccessForm=="property"&&delete J["#text_asArray"],J.__text=y(J.__text,le,H+"."+le)),J["#cdata-section"]!=null&&(J.__cdata=J["#cdata-section"],delete J["#cdata-section"],o.arrayAccessForm=="property"&&delete J["#cdata-section_asArray"]),J.__cnt==0&&o.emptyNodeForm=="text"?J="":J.__cnt==1&&J.__text!=null?J=J.__text:J.__cnt==1&&J.__cdata!=null&&!o.keepCData?J=J.__cdata:J.__cnt>1&&J.__text!=null&&o.skipEmptyTextNodesForObj&&(o.stripWhitespaces&&J.__text==""||J.__text.trim()=="")&&delete J.__text,delete J.__cnt,o.enableToStringFunc&&(J.__text!=null||J.__cdata!=null)&&(J.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),J}else if(k.nodeType==c.TEXT_NODE||k.nodeType==c.CDATA_SECTION_NODE)return k.nodeValue}function R(k,H,J,K){var ae="<"+(k!=null&&k.__prefix!=null?k.__prefix+":":"")+H;if(J!=null)for(var re=0;re<J.length;re++){var le=J[re],me=k[le];o.escapeMode&&(me=p(me)),ae+=" "+le.substr(o.attributePrefix.length)+"=",o.useDoubleQuotes?ae+='"'+me+'"':ae+="'"+me+"'"}return K?ae+="/>":ae+=">",ae}function S(k,H){return"</"+(k.__prefix!=null?k.__prefix+":":"")+H+">"}function x(k,H){return k.indexOf(H,k.length-H.length)!==-1}function w(k,H){return!!(o.arrayAccessForm=="property"&&x(H.toString(),"_asArray")||H.toString().indexOf(o.attributePrefix)==0||H.toString().indexOf("__")==0||k[H]instanceof Function)}function C(k){var H=0;if(k instanceof Object)for(var J in k)w(k,J)||H++;return H}function b(k,H,J){return o.jsonPropertiesFilter.length==0||J==""||E(o.jsonPropertiesFilter,k,H,J)}function P(k){var H=[];if(k instanceof Object)for(var J in k)J.toString().indexOf("__")==-1&&J.toString().indexOf(o.attributePrefix)==0&&H.push(J);return H}function A(k){var H="";return k.__cdata!=null&&(H+="<![CDATA["+k.__cdata+"]]>"),k.__text!=null&&(o.escapeMode?H+=p(k.__text):H+=k.__text),H}function I(k){var H="";return k instanceof Object?H+=A(k):k!=null&&(o.escapeMode?H+=p(k):H+=k),H}function F(k,H){return k===""?H:k+"."+H}function G(k,H,J,K){var ae="";if(k.length==0)ae+=R(k,H,J,!0);else for(var re=0;re<k.length;re++)ae+=R(k[re],H,P(k[re]),!1),ae+=V(k[re],F(K,H)),ae+=S(k[re],H);return ae}function V(k,H){var J="",K=C(k);if(K>0){for(var ae in k)if(!(w(k,ae)||H!=""&&!b(k,ae,F(H,ae)))){var re=k[ae],le=P(re);if(re==null||re==null)J+=R(re,ae,le,!0);else if(re instanceof Object)if(re instanceof Array)J+=G(re,ae,le,H);else if(re instanceof Date)J+=R(re,ae,le,!1),J+=re.toISOString(),J+=S(re,ae);else{var me=C(re);me>0||re.__text!=null||re.__cdata!=null?(J+=R(re,ae,le,!1),J+=V(re,F(H,ae)),J+=S(re,ae)):J+=R(re,ae,le,!0)}else J+=R(re,ae,le,!1),J+=I(re),J+=S(re,ae)}}return J+=I(k),J}this.parseXmlString=function(k){if(k===void 0)return null;var H;if(window.DOMParser){var J=new window.DOMParser;try{H=J.parseFromString(k,"text/xml"),H.getElementsByTagNameNS("*","parsererror").length>0&&(H=null)}catch{H=null}}else k.indexOf("<?")==0&&(k=k.substr(k.indexOf("?>")+2)),H=new ActiveXObject("Microsoft.XMLDOM"),H.async="false",H.loadXML(k);return H},this.asArray=function(k){return k===void 0||k==null?[]:k instanceof Array?k:[k]},this.toXmlDateTime=function(k){return k instanceof Date?k.toISOString():typeof k=="number"?new Date(k).toISOString():null},this.asDateTime=function(k){return typeof k=="string"?M(k):k},this.xml2json=function(k){return g(k)},this.xml_str2json=function(k){var H=this.parseXmlString(k);return H!=null?this.xml2json(H):null},this.json2xml_str=function(k){return V(k,"")},this.json2xml=function(k){var H=this.json2xml_str(k);return this.parseXmlString(H)},this.getVersion=function(){return l}}r.default=i},"./index.js":function(t,r,n){n.r(r);var i=n("./index_mediaplayerOnly.js");n.d(r,"MediaPlayer",function(){return i.MediaPlayer});var o=n("./src/streaming/utils/Capabilities.js");n.d(r,"supportsMediaSource",function(){return o.supportsMediaSource});var l=n("./src/streaming/metrics/MetricsReporting.js");n.d(r,"MetricsReporting",function(){return l.default});var u=n("./src/streaming/protection/Protection.js");n.d(r,"Protection",function(){return u.default});var c=n("./src/streaming/MediaPlayerFactory.js");n.d(r,"MediaPlayerFactory",function(){return c.default});var f=n("./src/core/Debug.js");n.d(r,"Debug",function(){return f.default}),dashjs.Protection=u.default,dashjs.MetricsReporting=l.default,dashjs.MediaPlayerFactory=c.default,dashjs.Debug=f.default,dashjs.supportsMediaSource=o.supportsMediaSource,r.default=dashjs},"./index_mediaplayerOnly.js":function(t,r,n){n.r(r),function(i){var o=n("./src/streaming/MediaPlayer.js");n.d(r,"MediaPlayer",function(){return o.default});var l=n("./src/core/FactoryMaker.js");n.d(r,"FactoryMaker",function(){return l.default});var u=n("./src/core/Debug.js");n.d(r,"Debug",function(){return u.default});var c=n("./src/core/Version.js");n("./node_modules/es6-promise/auto.js");var f=typeof window!="undefined"&&window||i,h=f.dashjs;h||(h=f.dashjs={}),h.MediaPlayer=o.default,h.FactoryMaker=l.default,h.Debug=u.default,h.Version=Object(c.getVersionString)(),r.default=h}.call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/base64-js/index.js":function(t,r,n){r.byteLength=p,r.toByteArray=v,r.fromByteArray=_;for(var i=[],o=[],l=typeof Uint8Array!="undefined"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,f=u.length;c<f;++c)i[c]=u[c],o[u.charCodeAt(c)]=c;o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63;function h(g){var R=g.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=g.indexOf("=");S===-1&&(S=R);var x=S===R?0:4-S%4;return[S,x]}function p(g){var R=h(g),S=R[0],x=R[1];return(S+x)*3/4-x}function E(g,R,S){return(R+S)*3/4-S}function v(g){for(var R,S=h(g),x=S[0],w=S[1],C=new l(E(g,x,w)),b=0,P=w>0?x-4:x,A=0;A<P;A+=4)R=o[g.charCodeAt(A)]<<18|o[g.charCodeAt(A+1)]<<12|o[g.charCodeAt(A+2)]<<6|o[g.charCodeAt(A+3)],C[b++]=R>>16&255,C[b++]=R>>8&255,C[b++]=R&255;return w===2&&(R=o[g.charCodeAt(A)]<<2|o[g.charCodeAt(A+1)]>>4,C[b++]=R&255),w===1&&(R=o[g.charCodeAt(A)]<<10|o[g.charCodeAt(A+1)]<<4|o[g.charCodeAt(A+2)]>>2,C[b++]=R>>8&255,C[b++]=R&255),C}function M(g){return i[g>>18&63]+i[g>>12&63]+i[g>>6&63]+i[g&63]}function y(g,R,S){for(var x,w=[],C=R;C<S;C+=3)x=(g[C]<<16&16711680)+(g[C+1]<<8&65280)+(g[C+2]&255),w.push(M(x));return w.join("")}function _(g){for(var R,S=g.length,x=S%3,w=[],C=16383,b=0,P=S-x;b<P;b+=C)w.push(y(g,b,b+C>P?P:b+C));return x===1?(R=g[S-1],w.push(i[R>>2]+i[R<<4&63]+"==")):x===2&&(R=(g[S-2]<<8)+g[S-1],w.push(i[R>>10]+i[R>>4&63]+i[R<<2&63]+"=")),w.join("")}},"./node_modules/codem-isoboxer/dist/iso_boxer.js":function(t,r,n){/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */var i={};i.parseBuffer=function(u){return new o(u).parse()},i.addBoxProcessor=function(u,c){typeof u!="string"||typeof c!="function"||(l.prototype._boxProcessors[u]=c)},i.createFile=function(){return new o},i.createBox=function(u,c,f){var h=l.create(u);return c&&c.append(h,f),h},i.createFullBox=function(u,c,f){var h=i.createBox(u,c,f);return h.version=0,h.flags=0,h},i.Utils={},i.Utils.dataViewToString=function(u,c){var f=c||"utf-8";if(typeof TextDecoder!="undefined")return new TextDecoder(f).decode(u);var h=[],p=0;if(f==="utf-8")for(;p<u.byteLength;){var E=u.getUint8(p++);E<128||(E<224?(E=(E&31)<<6,E|=u.getUint8(p++)&63):E<240?(E=(E&15)<<12,E|=(u.getUint8(p++)&63)<<6,E|=u.getUint8(p++)&63):(E=(E&7)<<18,E|=(u.getUint8(p++)&63)<<12,E|=(u.getUint8(p++)&63)<<6,E|=u.getUint8(p++)&63)),h.push(String.fromCharCode(E))}else for(;p<u.byteLength;)h.push(String.fromCharCode(u.getUint8(p++)));return h.join("")},i.Utils.utf8ToByteArray=function(u){var c,f;if(typeof TextEncoder!="undefined")c=new TextEncoder().encode(u);else for(c=[],f=0;f<u.length;++f){var h=u.charCodeAt(f);h<128?c.push(h):h<2048?(c.push(192|h>>6),c.push(128|63&h)):h<65536?(c.push(224|h>>12),c.push(128|63&h>>6),c.push(128|63&h)):(c.push(240|h>>18),c.push(128|63&h>>12),c.push(128|63&h>>6),c.push(128|63&h))}return c},i.Utils.appendBox=function(u,c,f){if(c._offset=u._cursor.offset,c._root=u._root?u._root:u,c._raw=u._raw,c._parent=u,f!==-1){if(f==null){u.boxes.push(c);return}var h=-1,p;if(typeof f=="number")h=f;else{if(typeof f=="string")p=f;else if(typeof f=="object"&&f.type)p=f.type;else{u.boxes.push(c);return}for(var E=0;E<u.boxes.length;E++)if(p===u.boxes[E].type){h=E+1;break}}u.boxes.splice(h,0,c)}},r.parseBuffer=i.parseBuffer,r.addBoxProcessor=i.addBoxProcessor,r.createFile=i.createFile,r.createBox=i.createBox,r.createFullBox=i.createFullBox,r.Utils=i.Utils,i.Cursor=function(u){this.offset=typeof u=="undefined"?0:u};var o=function(u){this._cursor=new i.Cursor,this.boxes=[],u&&(this._raw=new DataView(u))};o.prototype.fetch=function(u){var c=this.fetchAll(u,!0);return c.length?c[0]:null},o.prototype.fetchAll=function(u,c){var f=[];return o._sweep.call(this,u,f,c),f},o.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var u=l.parse(this);if(typeof u.type=="undefined")break;this.boxes.push(u)}return this},o._sweep=function(u,c,f){this.type&&this.type==u&&c.push(this);for(var h in this.boxes){if(c.length&&f)return;o._sweep.call(this.boxes[h],u,c,f)}},o.prototype.write=function(){var u=0,c;for(c=0;c<this.boxes.length;c++)u+=this.boxes[c].getLength(!1);var f=new Uint8Array(u);for(this._rawo=new DataView(f.buffer),this.bytes=f,this._cursor.offset=0,c=0;c<this.boxes.length;c++)this.boxes[c].write();return f.buffer},o.prototype.append=function(u,c){i.Utils.appendBox(this,u,c)};var l=function(){this._cursor=new i.Cursor};l.parse=function(u){var c=new l;return c._offset=u._cursor.offset,c._root=u._root?u._root:u,c._raw=u._raw,c._parent=u,c._parseBox(),u._cursor.offset=c._raw.byteOffset+c._raw.byteLength,c},l.create=function(u){var c=new l;return c.type=u,c.boxes=[],c},l.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],l.prototype._boxProcessors={},l.prototype._procField=function(u,c,f){this._parsing?this[u]=this._readField(c,f):this._writeField(c,f,this[u])},l.prototype._procFieldArray=function(u,c,f,h){var p;if(this._parsing)for(this[u]=[],p=0;p<c;p++)this[u][p]=this._readField(f,h);else for(p=0;p<this[u].length;p++)this._writeField(f,h,this[u][p])},l.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},l.prototype._procEntries=function(u,c,f){var h;if(this._parsing)for(this[u]=[],h=0;h<c;h++)this[u].push({}),f.call(this,this[u][h]);else for(h=0;h<c;h++)f.call(this,this[u][h])},l.prototype._procSubEntries=function(u,c,f,h){var p;if(this._parsing)for(u[c]=[],p=0;p<f;p++)u[c].push({}),h.call(this,u[c][p]);else for(p=0;p<f;p++)h.call(this,u[c][p])},l.prototype._procEntryField=function(u,c,f,h){this._parsing?u[c]=this._readField(f,h):this._writeField(f,h,u[c])},l.prototype._procSubBoxes=function(u,c){var f;if(this._parsing)for(this[u]=[],f=0;f<c;f++)this[u].push(l.parse(this));else for(f=0;f<c;f++)this._rawo?this[u][f].write():this.size+=this[u][f].getLength()},l.prototype._readField=function(u,c){switch(u){case"uint":return this._readUint(c);case"int":return this._readInt(c);case"template":return this._readTemplate(c);case"string":return c===-1?this._readTerminatedString():this._readString(c);case"data":return this._readData(c);case"utf8":return this._readUTF8String();default:return-1}},l.prototype._readInt=function(u){var c=null,f=this._cursor.offset-this._raw.byteOffset;switch(u){case 8:c=this._raw.getInt8(f);break;case 16:c=this._raw.getInt16(f);break;case 32:c=this._raw.getInt32(f);break;case 64:var h=this._raw.getInt32(f),p=this._raw.getInt32(f+4);c=h*Math.pow(2,32)+p;break}return this._cursor.offset+=u>>3,c},l.prototype._readUint=function(u){var c=null,f=this._cursor.offset-this._raw.byteOffset,h,p;switch(u){case 8:c=this._raw.getUint8(f);break;case 16:c=this._raw.getUint16(f);break;case 24:h=this._raw.getUint16(f),p=this._raw.getUint8(f+2),c=(h<<8)+p;break;case 32:c=this._raw.getUint32(f);break;case 64:h=this._raw.getUint32(f),p=this._raw.getUint32(f+4),c=h*Math.pow(2,32)+p;break}return this._cursor.offset+=u>>3,c},l.prototype._readString=function(u){for(var c="",f=0;f<u;f++){var h=this._readUint(8);c+=String.fromCharCode(h)}return c},l.prototype._readTemplate=function(u){var c=this._readUint(u/2),f=this._readUint(u/2);return c+f/Math.pow(2,u/2)},l.prototype._readTerminatedString=function(){for(var u="";this._cursor.offset-this._offset<this._raw.byteLength;){var c=this._readUint(8);if(c===0)break;u+=String.fromCharCode(c)}return u},l.prototype._readData=function(u){var c=u>0?u:this._raw.byteLength-(this._cursor.offset-this._offset);if(c>0){var f=new Uint8Array(this._raw.buffer,this._cursor.offset,c);return this._cursor.offset+=c,f}else return null},l.prototype._readUTF8String=function(){var u=this._raw.byteLength-(this._cursor.offset-this._offset),c=null;return u>0&&(c=new DataView(this._raw.buffer,this._cursor.offset,u),this._cursor.offset+=u),c&&i.Utils.dataViewToString(c)},l.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},l.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},l.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(l.parse(this))},l.prototype.append=function(u,c){i.Utils.appendBox(this,u,c)},l.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var u=0;u<this.boxes.length;u++)this.size+=this.boxes[u].getLength();return this._data&&this._writeData(this._data),this.size},l.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var u=0;u<this.boxes.length;u++)this.boxes[u].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},l.prototype._writeInt=function(u,c){if(this._rawo){var f=this._cursor.offset-this._rawo.byteOffset;switch(u){case 8:this._rawo.setInt8(f,c);break;case 16:this._rawo.setInt16(f,c);break;case 32:this._rawo.setInt32(f,c);break;case 64:var h=Math.floor(c/Math.pow(2,32)),p=c-h*Math.pow(2,32);this._rawo.setUint32(f,h),this._rawo.setUint32(f+4,p);break}this._cursor.offset+=u>>3}else this.size+=u>>3},l.prototype._writeUint=function(u,c){if(this._rawo){var f=this._cursor.offset-this._rawo.byteOffset,h,p;switch(u){case 8:this._rawo.setUint8(f,c);break;case 16:this._rawo.setUint16(f,c);break;case 24:h=(c&16776960)>>8,p=c&255,this._rawo.setUint16(f,h),this._rawo.setUint8(f+2,p);break;case 32:this._rawo.setUint32(f,c);break;case 64:h=Math.floor(c/Math.pow(2,32)),p=c-h*Math.pow(2,32),this._rawo.setUint32(f,h),this._rawo.setUint32(f+4,p);break}this._cursor.offset+=u>>3}else this.size+=u>>3},l.prototype._writeString=function(u,c){for(var f=0;f<u;f++)this._writeUint(8,c.charCodeAt(f))},l.prototype._writeTerminatedString=function(u){if(u.length!==0){for(var c=0;c<u.length;c++)this._writeUint(8,u.charCodeAt(c));this._writeUint(8,0)}},l.prototype._writeTemplate=function(u,c){var f=Math.floor(c),h=(c-f)*Math.pow(2,u/2);this._writeUint(u/2,f),this._writeUint(u/2,h)},l.prototype._writeData=function(u){var c;if(u)if(this._rawo){if(u instanceof Array){for(var f=this._cursor.offset-this._rawo.byteOffset,c=0;c<u.length;c++)this._rawo.setInt8(f+c,u[c]);this._cursor.offset+=u.length}u instanceof Uint8Array&&(this._root.bytes.set(u,this._cursor.offset),this._cursor.offset+=u.length)}else this.size+=u.length},l.prototype._writeUTF8String=function(u){var c=i.Utils.utf8ToByteArray(u);if(this._rawo)for(var f=new DataView(this._rawo.buffer,this._cursor.offset,c.length),h=0;h<c.length;h++)f.setUint8(h,c[h]);else this.size+=c.length},l.prototype._writeField=function(u,c,f){switch(u){case"uint":this._writeUint(c,f);break;case"int":this._writeInt(c,f);break;case"template":this._writeTemplate(c,f);break;case"string":c==-1?this._writeTerminatedString(f):this._writeString(c,f);break;case"data":this._writeData(f);break;case"utf8":this._writeUTF8String(f);break}},l.prototype._boxProcessors.avc1=l.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},l.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},l.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(u){this._procEntryField(u,"segment_duration","uint",this.version===1?64:32),this._procEntryField(u,"media_time","int",this.version===1?64:32),this._procEntryField(u,"media_rate_integer","int",16),this._procEntryField(u,"media_rate_fraction","int",16)})},l.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},l.prototype._boxProcessors.free=l.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},l.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},l.prototype._boxProcessors.ftyp=l.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var u=-1;this._parsing&&(u=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",u,"string",4)},l.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},l.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},l.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},l.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},l.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},l.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},l.prototype._boxProcessors.mp4a=l.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},l.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},l.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},l.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},l.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},l.prototype._boxProcessors.sdtp=function(){this._procFullBox();var u=-1;this._parsing&&(u=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",u,"uint",8)},l.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(u){this._parsing||(u.reference=(u.reference_type&1)<<31,u.reference|=u.referenced_size&2147483647,u.sap=(u.starts_with_SAP&1)<<31,u.sap|=(u.SAP_type&3)<<28,u.sap|=u.SAP_delta_time&268435455),this._procEntryField(u,"reference","uint",32),this._procEntryField(u,"subsegment_duration","uint",32),this._procEntryField(u,"sap","uint",32),this._parsing&&(u.reference_type=u.reference>>31&1,u.referenced_size=u.reference&2147483647,u.starts_with_SAP=u.sap>>31&1,u.SAP_type=u.sap>>28&7,u.SAP_delta_time=u.sap&268435455)})},l.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},l.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(u){this._procEntryField(u,"ranges_count","uint",32),this._procSubEntries(u,"ranges",u.ranges_count,function(c){this._procEntryField(c,"level","uint",8),this._procEntryField(c,"range_size","uint",24)})})},l.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},l.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(u){this._procEntryField(u,"sample_delta","uint",32),this._procEntryField(u,"subsample_count","uint",16),this._procSubEntries(u,"subsamples",u.subsample_count,function(c){this._procEntryField(c,"subsample_size","uint",this.version===1?32:16),this._procEntryField(c,"subsample_priority","uint",8),this._procEntryField(c,"discardable","uint",8),this._procEntryField(c,"codec_specific_parameters","uint",32)})})},l.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},l.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},l.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},l.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(u){this._procEntryField(u,"time","uint",this.version===1?64:32),this._procEntryField(u,"moof_offset","uint",this.version===1?64:32),this._procEntryField(u,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(u,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(u,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},l.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},l.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},l.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(u){this.flags&256&&this._procEntryField(u,"sample_duration","uint",32),this.flags&512&&this._procEntryField(u,"sample_size","uint",32),this.flags&1024&&this._procEntryField(u,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(u,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},l.prototype._boxProcessors["url "]=l.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},l.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},l.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},l.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},l.prototype._boxProcessors.vtte=function(){}},"./node_modules/core-util-is/lib/util.js":function(t,r,n){(function(i){function o(x){return Array.isArray?Array.isArray(x):S(x)==="[object Array]"}r.isArray=o;function l(x){return typeof x=="boolean"}r.isBoolean=l;function u(x){return x===null}r.isNull=u;function c(x){return x==null}r.isNullOrUndefined=c;function f(x){return typeof x=="number"}r.isNumber=f;function h(x){return typeof x=="string"}r.isString=h;function p(x){return typeof x=="symbol"}r.isSymbol=p;function E(x){return x===void 0}r.isUndefined=E;function v(x){return S(x)==="[object RegExp]"}r.isRegExp=v;function M(x){return typeof x=="object"&&x!==null}r.isObject=M;function y(x){return S(x)==="[object Date]"}r.isDate=y;function _(x){return S(x)==="[object Error]"||x instanceof Error}r.isError=_;function g(x){return typeof x=="function"}r.isFunction=g;function R(x){return x===null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||typeof x=="symbol"||typeof x=="undefined"}r.isPrimitive=R,r.isBuffer=i.isBuffer;function S(x){return Object.prototype.toString.call(x)}}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/es6-promise/auto.js":function(t,r,n){t.exports=n("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(t,r,n){(function(i,o){/*!
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
* @version   v4.2.8+1e68dce6
*/(function(l,u){t.exports=u()})(this,function(){function l(se){var ce=typeof se;return se!==null&&(ce==="object"||ce==="function")}function u(se){return typeof se=="function"}var c=void 0;Array.isArray?c=Array.isArray:c=function(se){return Object.prototype.toString.call(se)==="[object Array]"};var f=c,h=0,p=void 0,E=void 0,v=function(ce,Se){I[h]=ce,I[h+1]=Se,h+=2,h===2&&(E?E(F):V())};function M(se){E=se}function y(se){v=se}var _=typeof window!="undefined"?window:void 0,g=_||{},R=g.MutationObserver||g.WebKitMutationObserver,S=typeof self=="undefined"&&typeof i!="undefined"&&{}.toString.call(i)==="[object process]",x=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function w(){return function(){return i.nextTick(F)}}function C(){return typeof p!="undefined"?function(){p(F)}:A()}function b(){var se=0,ce=new R(F),Se=document.createTextNode("");return ce.observe(Se,{characterData:!0}),function(){Se.data=se=++se%2}}function P(){var se=new MessageChannel;return se.port1.onmessage=F,function(){return se.port2.postMessage(0)}}function A(){var se=setTimeout;return function(){return se(F,1)}}var I=new Array(1e3);function F(){for(var se=0;se<h;se+=2){var ce=I[se],Se=I[se+1];ce(Se),I[se]=void 0,I[se+1]=void 0}h=0}function G(){try{var se=Function("return this")().require("vertx");return p=se.runOnLoop||se.runOnContext,C()}catch{return A()}}var V=void 0;S?V=w():R?V=b():x?V=P():_===void 0?V=G():V=A();function k(se,ce){var Se=this,Me=new this.constructor(K);Me[J]===void 0&&O(Me);var ve=Se._state;if(ve){var be=arguments[ve-1];v(function(){return W(ve,Me,be,Se._result)})}else ue(Se,Me,se,ce);return Me}function H(se){var ce=this;if(se&&typeof se=="object"&&se.constructor===ce)return se;var Se=new ce(K);return he(Se,se),Se}var J=Math.random().toString(36).substring(2);function K(){}var ae=void 0,re=1,le=2;function me(){return new TypeError("You cannot resolve a promise with itself")}function de(){return new TypeError("A promises callback cannot return that same promise.")}function te(se,ce,Se,Me){try{se.call(ce,Se,Me)}catch(ve){return ve}}function q(se,ce,Se){v(function(Me){var ve=!1,be=te(Se,ce,function(Ne){ve||(ve=!0,ce!==Ne?he(Me,Ne):Y(Me,Ne))},function(Ne){ve||(ve=!0,ie(Me,Ne))},"Settle: "+(Me._label||" unknown promise"));!ve&&be&&(ve=!0,ie(Me,be))},se)}function Z(se,ce){ce._state===re?Y(se,ce._result):ce._state===le?ie(se,ce._result):ue(ce,void 0,function(Se){return he(se,Se)},function(Se){return ie(se,Se)})}function pe(se,ce,Se){ce.constructor===se.constructor&&Se===k&&ce.constructor.resolve===H?Z(se,ce):Se===void 0?Y(se,ce):u(Se)?q(se,ce,Se):Y(se,ce)}function he(se,ce){if(se===ce)ie(se,me());else if(l(ce)){var Se=void 0;try{Se=ce.then}catch(Me){ie(se,Me);return}pe(se,ce,Se)}else Y(se,ce)}function Q(se){se._onerror&&se._onerror(se._result),$(se)}function Y(se,ce){se._state===ae&&(se._result=ce,se._state=re,se._subscribers.length!==0&&v($,se))}function ie(se,ce){se._state===ae&&(se._state=le,se._result=ce,v(Q,se))}function ue(se,ce,Se,Me){var ve=se._subscribers,be=ve.length;se._onerror=null,ve[be]=ce,ve[be+re]=Se,ve[be+le]=Me,be===0&&se._state&&v($,se)}function $(se){var ce=se._subscribers,Se=se._state;if(ce.length!==0){for(var Me=void 0,ve=void 0,be=se._result,Ne=0;Ne<ce.length;Ne+=3)Me=ce[Ne],ve=ce[Ne+Se],Me?W(Se,Me,ve,be):ve(be);se._subscribers.length=0}}function W(se,ce,Se,Me){var ve=u(Se),be=void 0,Ne=void 0,Ue=!0;if(ve){try{be=Se(Me)}catch(Xe){Ue=!1,Ne=Xe}if(ce===be){ie(ce,de());return}}else be=Me;ce._state!==ae||(ve&&Ue?he(ce,be):Ue===!1?ie(ce,Ne):se===re?Y(ce,be):se===le&&ie(ce,be))}function B(se,ce){try{ce(function(Me){he(se,Me)},function(Me){ie(se,Me)})}catch(Se){ie(se,Se)}}var L=0;function D(){return L++}function O(se){se[J]=L++,se._state=void 0,se._result=void 0,se._subscribers=[]}function U(){return new Error("Array Methods must be provided an Array")}var fe=function(){function se(ce,Se){this._instanceConstructor=ce,this.promise=new ce(K),this.promise[J]||O(this.promise),f(Se)?(this.length=Se.length,this._remaining=Se.length,this._result=new Array(this.length),this.length===0?Y(this.promise,this._result):(this.length=this.length||0,this._enumerate(Se),this._remaining===0&&Y(this.promise,this._result))):ie(this.promise,U())}return se.prototype._enumerate=function(Se){for(var Me=0;this._state===ae&&Me<Se.length;Me++)this._eachEntry(Se[Me],Me)},se.prototype._eachEntry=function(Se,Me){var ve=this._instanceConstructor,be=ve.resolve;if(be===H){var Ne=void 0,Ue=void 0,Xe=!1;try{Ne=Se.then}catch(ct){Xe=!0,Ue=ct}if(Ne===k&&Se._state!==ae)this._settledAt(Se._state,Me,Se._result);else if(typeof Ne!="function")this._remaining--,this._result[Me]=Se;else if(ve===z){var ot=new ve(K);Xe?ie(ot,Ue):pe(ot,Se,Ne),this._willSettleAt(ot,Me)}else this._willSettleAt(new ve(function(ct){return ct(Se)}),Me)}else this._willSettleAt(be(Se),Me)},se.prototype._settledAt=function(Se,Me,ve){var be=this.promise;be._state===ae&&(this._remaining--,Se===le?ie(be,ve):this._result[Me]=ve),this._remaining===0&&Y(be,this._result)},se.prototype._willSettleAt=function(Se,Me){var ve=this;ue(Se,void 0,function(be){return ve._settledAt(re,Me,be)},function(be){return ve._settledAt(le,Me,be)})},se}();function ye(se){return new fe(this,se).promise}function _e(se){var ce=this;return f(se)?new ce(function(Se,Me){for(var ve=se.length,be=0;be<ve;be++)ce.resolve(se[be]).then(Se,Me)}):new ce(function(Se,Me){return Me(new TypeError("You must pass an array to race."))})}function ee(se){var ce=this,Se=new ce(K);return ie(Se,se),Se}function j(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function X(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var z=function(){function se(ce){this[J]=D(),this._result=this._state=void 0,this._subscribers=[],K!==ce&&(typeof ce!="function"&&j(),this instanceof se?B(this,ce):X())}return se.prototype.catch=function(Se){return this.then(null,Se)},se.prototype.finally=function(Se){var Me=this,ve=Me.constructor;return u(Se)?Me.then(function(be){return ve.resolve(Se()).then(function(){return be})},function(be){return ve.resolve(Se()).then(function(){throw be})}):Me.then(Se,Se)},se}();z.prototype.then=k,z.all=ye,z.race=_e,z.resolve=H,z.reject=ee,z._setScheduler=M,z._setAsap=y,z._asap=v;function oe(){var se=void 0;if(typeof o!="undefined")se=o;else if(typeof self!="undefined")se=self;else try{se=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var ce=se.Promise;if(ce){var Se=null;try{Se=Object.prototype.toString.call(ce.resolve())}catch{}if(Se==="[object Promise]"&&!ce.cast)return}se.Promise=z}return z.polyfill=oe,z.Promise=z,z})}).call(this,n("./node_modules/process/browser.js"),n("./node_modules/webpack/buildin/global.js"))},"./node_modules/fast-deep-equal/index.js":function(t,r,n){var i=Array.isArray,o=Object.keys,l=Object.prototype.hasOwnProperty;t.exports=function u(c,f){if(c===f)return!0;if(c&&f&&typeof c=="object"&&typeof f=="object"){var h=i(c),p=i(f),E,v,M;if(h&&p){if(v=c.length,v!=f.length)return!1;for(E=v;E--!=0;)if(!u(c[E],f[E]))return!1;return!0}if(h!=p)return!1;var y=c instanceof Date,_=f instanceof Date;if(y!=_)return!1;if(y&&_)return c.getTime()==f.getTime();var g=c instanceof RegExp,R=f instanceof RegExp;if(g!=R)return!1;if(g&&R)return c.toString()==f.toString();var S=o(c);if(v=S.length,v!==o(f).length)return!1;for(E=v;E--!=0;)if(!l.call(f,S[E]))return!1;for(E=v;E--!=0;)if(M=S[E],!u(c[M],f[M]))return!1;return!0}return c!==c&&f!==f}},"./node_modules/ieee754/index.js":function(t,r){r.read=function(n,i,o,l,u){var c,f,h=u*8-l-1,p=(1<<h)-1,E=p>>1,v=-7,M=o?u-1:0,y=o?-1:1,_=n[i+M];for(M+=y,c=_&(1<<-v)-1,_>>=-v,v+=h;v>0;c=c*256+n[i+M],M+=y,v-=8);for(f=c&(1<<-v)-1,c>>=-v,v+=l;v>0;f=f*256+n[i+M],M+=y,v-=8);if(c===0)c=1-E;else{if(c===p)return f?NaN:(_?-1:1)*(1/0);f=f+Math.pow(2,l),c=c-E}return(_?-1:1)*f*Math.pow(2,c-l)},r.write=function(n,i,o,l,u,c){var f,h,p,E=c*8-u-1,v=(1<<E)-1,M=v>>1,y=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=l?0:c-1,g=l?1:-1,R=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(h=isNaN(i)?1:0,f=v):(f=Math.floor(Math.log(i)/Math.LN2),i*(p=Math.pow(2,-f))<1&&(f--,p*=2),f+M>=1?i+=y/p:i+=y*Math.pow(2,1-M),i*p>=2&&(f++,p/=2),f+M>=v?(h=0,f=v):f+M>=1?(h=(i*p-1)*Math.pow(2,u),f=f+M):(h=i*Math.pow(2,M-1)*Math.pow(2,u),f=0));u>=8;n[o+_]=h&255,_+=g,h/=256,u-=8);for(f=f<<u|h,E+=u;E>0;n[o+_]=f&255,_+=g,f/=256,E-=8);n[o+_-g]|=R*128}},"./node_modules/imsc/src/main/js/doc.js":function(t,r,n){(function(i,o,l,u,c){i.fromXML=function(B,L,D){var O=o.parser(!0,{xmlns:!0}),U=[],fe=[],ye=[],_e=0,ee=null;O.onclosetag=function(se){if(U[0]instanceof v)for(var ce in U[0].styles)he(U[0],U[0].styles[ce],L);else if(U[0]instanceof A||U[0]instanceof I){if(U[0].contents.length>1){var Se=[U[0].contents[0]],Me;for(Me=1;Me<U[0].contents.length;Me++)U[0].contents[Me]instanceof F&&Se[Se.length-1]instanceof F?Se[Se.length-1].text+=U[0].contents[Me].text:Se.push(U[0].contents[Me]);U[0].contents=Se}U[0]instanceof I&&U[0].contents.length===1&&U[0].contents[0]instanceof F&&(U[0].text=U[0].contents[0].text,delete U[0].contents)}else U[0]instanceof h&&(U[0].node.uri===l.ns_tt&&U[0].node.local==="metadata"?_e--:_e>0&&D&&"onCloseTag"in D&&D.onCloseTag());ye.shift(),fe.shift(),U.shift()},O.ontext=function(se){if(U[0]!==void 0)if(U[0]instanceof I||U[0]instanceof A){var ce=new F;ce.initFromText(ee,U[0],se,ye[0],L),U[0].contents.push(ce)}else U[0]instanceof h&&_e>0&&D&&"onText"in D&&D.onText(se)},O.onopentag=function(se){var ce=se.attributes["xml:space"];ce?ye.unshift(ce.value):ye.length===0?ye.unshift("default"):ye.unshift(ye[0]);var Se=se.attributes["xml:lang"];if(Se?fe.unshift(Se.value):fe.length===0?fe.unshift(""):fe.unshift(fe[0]),se.uri===l.ns_tt)if(se.local==="tt")ee!==null&&$(L,"Two <tt> elements at ("+this.line+","+this.column+")"),ee=new p,ee.initFromNode(se,L),U.unshift(ee);else if(se.local==="head")U[0]instanceof p||$(L,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),ee.head!==null&&$("Second <head> element at ("+this.line+","+this.column+")"),ee.head=new E,U.unshift(ee.head);else if(se.local==="styling")U[0]instanceof E||$(L,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),ee.head.styling!==null&&$("Second <styling> element at ("+this.line+","+this.column+")"),ee.head.styling=new v,U.unshift(ee.head.styling);else if(se.local==="style"){var Me;U[0]instanceof v?(Me=new M,Me.initFromNode(se,L),Me.id?ee.head.styling.styles[Me.id]=Me:ue(L,"<style> element missing @id attribute"),U.unshift(Me)):U[0]instanceof V?(Me=new M,Me.initFromNode(se,L),Y(Me.styleAttrs,U[0].styleAttrs),U.unshift(Me)):$(L,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if(se.local==="layout")U[0]instanceof E||$(L,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),ee.head.layout!==null&&$(L,"Second <layout> element at "+this.line+","+this.column+")"),ee.head.layout=new y,U.unshift(ee.head.layout);else if(se.local==="region"){U[0]instanceof y||$(L,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var ve=new V;ve.initFromNode(ee,se,L),!ve.id||ve.id in ee.head.layout.regions?ue(L,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):ee.head.layout.regions[ve.id]=ve,U.unshift(ve)}else if(se.local==="body"){U[0]instanceof p||$(L,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),ee.body!==null&&$(L,"Second <body> element at "+this.line+","+this.column+")");var be=new b;be.initFromNode(ee,se,L),ee.body=be,U.unshift(be)}else if(se.local==="div"){U[0]instanceof P||U[0]instanceof b||$(L,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var Ne=new P;Ne.initFromNode(ee,U[0],se,L),U[0].contents.push(Ne),U.unshift(Ne)}else if(se.local==="p"){U[0]instanceof P||$(L,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var Ue=new A;Ue.initFromNode(ee,U[0],se,L),U[0].contents.push(Ue),U.unshift(Ue)}else if(se.local==="span"){U[0]instanceof I||U[0]instanceof A||$(L,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var Xe=new I;Xe.initFromNode(ee,U[0],se,ye[0],L),U[0].contents.push(Xe),U.unshift(Xe)}else if(se.local==="br"){U[0]instanceof I||U[0]instanceof A||$(L,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var ot=new G;ot.initFromNode(ee,U[0],se,L),U[0].contents.push(ot),U.unshift(ot)}else if(se.local==="set"){U[0]instanceof I||U[0]instanceof A||U[0]instanceof P||U[0]instanceof b||U[0]instanceof V||U[0]instanceof G||$(L,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var ct=new k;ct.initFromNode(ee,U[0],se,L),U[0].sets.push(ct),U.unshift(ct)}else U.unshift(new h(se));else U.unshift(new h(se));if(U[0]instanceof h){if(se.uri===l.ns_tt&&se.local==="metadata")_e++;else if(_e>0&&D&&"onOpenTag"in D){var xt=[];for(var Bt in se.attributes)xt[se.attributes[Bt].uri+" "+se.attributes[Bt].local]={uri:se.attributes[Bt].uri,local:se.attributes[Bt].local,value:se.attributes[Bt].value};D.onOpenTag(se.uri,se.local,xt)}}},O.write(B).close(),ee.head!==null?delete ee.head.styling:ee.head=new E,ee.head.layout===null&&(ee.head.layout=new y);var j=!1;for(var X in ee.head.layout.regions){j=!0;break}if(!j){var z=V.prototype.createDefaultRegion();ee.head.layout.regions[z.id]=z}for(var oe in ee.head.layout.regions)f(ee,ee.head.layout.regions[oe],null,null);return ee.body&&f(ee,ee.body,null,null),ee};function f(B,L,D,O){var U=O&&O.timeContainer==="seq",fe=0;O&&(U&&D?fe=D.end:fe=O.begin),L.begin=L.explicit_begin?L.explicit_begin+fe:fe;var ye=L.begin,_e=null;for(var ee in L.sets)f(B,L.sets[ee],_e,L),L.timeContainer==="seq"?ye=L.sets[ee].end:ye=Math.max(ye,L.sets[ee].end),_e=L.sets[ee];if(!("contents"in L))U?ye=L.begin:ye=Number.POSITIVE_INFINITY;else for(var j in L.contents)f(B,L.contents[j],_e,L),L.timeContainer==="seq"?ye=L.contents[j].end:ye=Math.max(ye,L.contents[j].end),_e=L.contents[j];L.explicit_end!==null&&L.explicit_dur!==null?L.end=Math.min(L.begin+L.explicit_dur,fe+L.explicit_end):L.explicit_end===null&&L.explicit_dur!==null?L.end=L.begin+L.explicit_dur:L.explicit_end!==null&&L.explicit_dur===null?L.end=fe+L.explicit_end:L.end=ye,delete L.explicit_begin,delete L.explicit_dur,delete L.explicit_end,B._registerEvent(L)}function h(B){this.node=B}function p(){this.events=[],this.head=null,this.body=null}p.prototype.initFromNode=function(B,L){this.cellResolution=de(B,L);var D=te(B,L);this.effectiveFrameRate=D.effectiveFrameRate,this.tickRate=D.tickRate,this.aspectRatio=me(B,L);var O=le(B,l.ns_ttp,"timeBase");O!==null&&O!=="media"&&$(L,"Unsupported time base");var U=q(B,L);U===null?this.pxDimensions={h:480,w:640}:((U.h.unit!=="px"||U.w.unit!=="px")&&$(L,"Extent on TT must be in px or absent"),this.pxDimensions={h:U.h.value,w:U.w.value})},p.prototype._registerEvent=function(B){if(!(B.end<=B.begin)){var L=W(this.events,B.begin);if(L.found||this.events.splice(L.index,0,B.begin),B.end!==Number.POSITIVE_INFINITY){var D=W(this.events,B.end);D.found||this.events.splice(D.index,0,B.end)}}},p.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},p.prototype.getMediaTimeEvents=function(){return this.events};function E(){this.styling=null,this.layout=null}function v(){this.styles={}}function M(){this.id=null,this.styleAttrs=null,this.styleRefs=null}M.prototype.initFromNode=function(B,L){this.id=H(B),this.styleAttrs=re(B,L),this.styleRefs=ae(B)};function y(){this.regions={}}function _(B){this.kind=B}function g(B){this.id=B}g.prototype.initFromNode=function(B,L,D,O){this.id=H(D)};function R(B){this.regionID=B}R.prototype.initFromNode=function(B,L,D,O){this.regionID=J(D)};function S(B){this.styleAttrs=B}S.prototype.initFromNode=function(B,L,D,O){this.styleAttrs=re(D,O),B.head!==null&&B.head.styling!==null&&Q(B.head.styling,ae(D),this.styleAttrs,O)};function x(B){this.sets=B}x.prototype.initFromNode=function(B,L,D,O){this.sets=[]};function w(B){this.contents=B}w.prototype.initFromNode=function(B,L,D,O){this.contents=[]};function C(B,L,D){this.explicit_begin=B,this.explicit_end=L,this.explicit_dur=D}C.prototype.initFromNode=function(B,L,D,O){var U=pe(B,L,D,O);this.explicit_begin=U.explicit_begin,this.explicit_end=U.explicit_end,this.explicit_dur=U.explicit_dur,this.timeContainer=K(D,O)};function b(){_.call(this,"body")}b.prototype.initFromNode=function(B,L,D){S.prototype.initFromNode.call(this,B,null,L,D),C.prototype.initFromNode.call(this,B,null,L,D),x.prototype.initFromNode.call(this,B,null,L,D),R.prototype.initFromNode.call(this,B,null,L,D),w.prototype.initFromNode.call(this,B,null,L,D)};function P(){_.call(this,"div")}P.prototype.initFromNode=function(B,L,D,O){S.prototype.initFromNode.call(this,B,L,D,O),C.prototype.initFromNode.call(this,B,L,D,O),x.prototype.initFromNode.call(this,B,L,D,O),R.prototype.initFromNode.call(this,B,L,D,O),w.prototype.initFromNode.call(this,B,L,D,O)};function A(){_.call(this,"p")}A.prototype.initFromNode=function(B,L,D,O){S.prototype.initFromNode.call(this,B,L,D,O),C.prototype.initFromNode.call(this,B,L,D,O),x.prototype.initFromNode.call(this,B,L,D,O),R.prototype.initFromNode.call(this,B,L,D,O),w.prototype.initFromNode.call(this,B,L,D,O)};function I(){_.call(this,"span")}I.prototype.initFromNode=function(B,L,D,O,U){S.prototype.initFromNode.call(this,B,L,D,U),C.prototype.initFromNode.call(this,B,L,D,U),x.prototype.initFromNode.call(this,B,L,D,U),R.prototype.initFromNode.call(this,B,L,D,U),w.prototype.initFromNode.call(this,B,L,D,U),this.space=O};function F(){_.call(this,"span")}F.prototype.initFromText=function(B,L,D,O,U){C.prototype.initFromNode.call(this,B,L,null,U),this.text=D,this.space=O};function G(){_.call(this,"br")}G.prototype.initFromNode=function(B,L,D,O){R.prototype.initFromNode.call(this,B,L,D,O),C.prototype.initFromNode.call(this,B,L,D,O)};function V(){}V.prototype.createDefaultRegion=function(){var B=new V;return g.call(B,""),S.call(B,{}),x.call(B,[]),C.call(B,0,Number.POSITIVE_INFINITY,null),B},V.prototype.initFromNode=function(B,L,D){g.prototype.initFromNode.call(this,B,null,L,D),S.prototype.initFromNode.call(this,B,null,L,D),C.prototype.initFromNode.call(this,B,null,L,D),x.prototype.initFromNode.call(this,B,null,L,D),B.head!==null&&B.head.styling!==null&&Q(B.head.styling,ae(L),this.styleAttrs,D)};function k(){}k.prototype.initFromNode=function(B,L,D,O){C.prototype.initFromNode.call(this,B,L,D,O);var U=re(D,O);this.qname=null,this.value=null;for(var fe in U){if(this.qname){ue(O,"More than one style specified on set");break}this.qname=fe,this.value=U[fe]}};function H(B){return B&&"xml:id"in B.attributes&&B.attributes["xml:id"].value||null}function J(B){return B&&"region"in B.attributes?B.attributes.region.value:""}function K(B,L){var D=B&&"timeContainer"in B.attributes?B.attributes.timeContainer.value:null;return!D||D==="par"?"par":D==="seq"?"seq":(ue(L,"Illegal value of timeContainer (assuming 'par')"),"par")}function ae(B){return B&&"style"in B.attributes?B.attributes.style.value.split(" "):[]}function re(B,L){var D={};if(B!==null)for(var O in B.attributes){var U=B.attributes[O].uri+" "+B.attributes[O].local,fe=u.byQName[U];if(fe!==void 0){var ye=fe.parse(B.attributes[O].value);ye!==null?(D[U]=ye,fe===u.byName.zIndex&&ie(L,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):ue(L,"Cannot parse styling attribute "+U+" --> "+B.attributes[O].value)}}return D}function le(B,L,D){for(var O in B.attributes)if(B.attributes[O].uri===L&&B.attributes[O].local===D)return B.attributes[O].value;return null}function me(B,L){var D=le(B,l.ns_ittp,"aspectRatio"),O=null;if(D!==null){var U=/(\d+) (\d+)/,fe=U.exec(D);if(fe!==null){var ye=parseInt(fe[1]),_e=parseInt(fe[2]);ye!==0&&_e!==0?O=ye/_e:ue(L,"Illegal aspectRatio values (ignoring)")}else ue(L,"Malformed aspectRatio attribute (ignoring)")}return O}function de(B,L){var D=le(B,l.ns_ttp,"cellResolution"),O=15,U=32;if(D!==null){var fe=/(\d+) (\d+)/,ye=fe.exec(D);ye!==null?(U=parseInt(ye[1]),O=parseInt(ye[2])):ie(L,"Malformed cellResolution value (using initial value instead)")}return{w:U,h:O}}function te(B,L){var D=le(B,l.ns_ttp,"frameRate"),O=30,U;if(D!==null){var fe=/(\d+)/;U=fe.exec(D),U!==null?O=parseInt(U[1]):ie(L,"Malformed frame rate attribute (using initial value instead)")}var ye=le(B,l.ns_ttp,"frameRateMultiplier"),_e=1;if(ye!==null){var ee=/(\d+) (\d+)/;U=ee.exec(ye),U!==null?_e=parseInt(U[1])/parseInt(U[2]):ie(L,"Malformed frame rate multiplier attribute (using initial value instead)")}var j=_e*O,X=1,z=le(B,l.ns_ttp,"tickRate");if(z===null)D!==null&&(X=j);else{var oe=/(\d+)/;U=oe.exec(z),U!==null?X=parseInt(U[1]):ie(L,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:j,tickRate:X}}function q(B,L){var D=le(B,l.ns_tts,"extent");if(D===null)return null;var O=D.split(" ");if(O.length!==2)return ie(L,"Malformed extent (ignoring)"),null;var U=c.parseLength(O[0]),fe=c.parseLength(O[1]);return!fe||!U?(ie(L,"Malformed extent values (ignoring)"),null):{h:fe,w:U}}function Z(B,L,D){var O=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,U=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/,fe=/^(\d+(?:\.\d+)?)f$/,ye=/^(\d+(?:\.\d+)?)t$/,_e=/^(\d+(?:\.\d+)?)ms$/,ee=/^(\d+(?:\.\d+)?)s$/,j=/^(\d+(?:\.\d+)?)h$/,X=/^(\d+(?:\.\d+)?)m$/,z,oe=null;return(z=fe.exec(D))!==null?L!==null&&(oe=parseFloat(z[1])/L):(z=ye.exec(D))!==null?B!==null&&(oe=parseFloat(z[1])/B):(z=_e.exec(D))!==null?oe=parseFloat(z[1])/1e3:(z=ee.exec(D))!==null?oe=parseFloat(z[1]):(z=j.exec(D))!==null?oe=parseFloat(z[1])*3600:(z=X.exec(D))!==null?oe=parseFloat(z[1])*60:(z=O.exec(D))!==null?oe=parseInt(z[1])*3600+parseInt(z[2])*60+parseFloat(z[3]):(z=U.exec(D))!==null&&L!==null&&(oe=parseInt(z[1])*3600+parseInt(z[2])*60+parseInt(z[3])+(z[4]===null?0:parseInt(z[4])/L)),oe}function pe(B,L,D,O){var U=null;D&&"begin"in D.attributes&&(U=Z(B.tickRate,B.effectiveFrameRate,D.attributes.begin.value),U===null&&ie(O,"Malformed begin value "+D.attributes.begin.value+" (using 0)"));var fe=null;D&&"dur"in D.attributes&&(fe=Z(B.tickRate,B.effectiveFrameRate,D.attributes.dur.value),fe===null&&ie(O,"Malformed dur value "+D.attributes.dur.value+" (ignoring)"));var ye=null;return D&&"end"in D.attributes&&(ye=Z(B.tickRate,B.effectiveFrameRate,D.attributes.end.value),ye===null&&ie(O,"Malformed end value (ignoring)")),{explicit_begin:U,explicit_end:ye,explicit_dur:fe}}function he(B,L,D){for(;L.styleRefs.length>0;){var O=L.styleRefs.pop();if(!(O in B.styles)){ue(D,"Non-existant style id referenced");continue}he(B,B.styles[O],D),Y(B.styles[O].styleAttrs,L.styleAttrs)}}function Q(B,L,D,O){for(var U=L.length-1;U>=0;U--){var fe=L[U];if(!(fe in B.styles)){ue(O,"Non-existant style id referenced");continue}Y(B.styles[fe].styleAttrs,D)}}function Y(B,L){for(var D in B)D in L||(L[D]=B[D])}function ie(B,L){if(B&&B.warn&&B.warn(L))throw L}function ue(B,L){if(B&&B.error&&B.error(L))throw L}function $(B,L){throw B&&B.fatal&&B.fatal(L),L}function W(B,L){for(var D=0,O=B.length-1,U;D<=O;){U=Math.floor((D+O)/2);var fe=B[U];if(fe<L)D=U+1;else if(fe>L)O=U-1;else return{found:!0,index:U}}return{found:!1,index:D}}})(r,typeof sax=="undefined"?n("./node_modules/sax/lib/sax.js"):sax,typeof imscNames=="undefined"?n("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles=="undefined"?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils=="undefined"?n("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/html.js":function(t,r,n){(function(i,o,l){i.render=function(x,w,C,b,P,A,I,F,G){var V=b||w.clientHeight,k=P||w.clientWidth;if(x.aspectRatio!==null){var H=V*x.aspectRatio;H>k?V=Math.round(k/x.aspectRatio):k=H}var J=document.createElement("div");J.style.position="relative",J.style.width=k+"px",J.style.height=V+"px",J.style.margin="auto",J.style.top=0,J.style.bottom=0,J.style.left=0,J.style.right=0,J.style.zIndex=0;var K={h:V,w:k,regionH:null,regionW:null,imgResolver:C,displayForcedOnlyMode:A||!1,isd:x,errorHandler:I,previousISDState:F,enableRollUp:G||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};w.appendChild(J);for(var ae in x.contents)u(K,J,x.contents[ae]);return K.currentISDState};function u(x,w,C){var b;if(C.kind==="region"?(b=document.createElement("div"),b.style.position="absolute"):C.kind==="body"||C.kind==="div"?b=document.createElement("div"):C.kind==="p"?b=document.createElement("p"):C.kind==="span"?b=document.createElement("span"):C.kind==="br"&&(b=document.createElement("br")),!b){S(x.errorHandler,"Error processing ISD element kind: "+C.kind);return}b.style.margin="0";for(var P in _){var A=_[P],I=C.styleAttrs[A.qname];I!==void 0&&A.map!==null&&A.map(x,b,C,I)}var F=b;if(C.kind==="region"){var G=C.styleAttrs[l.byName.writingMode.qname];G==="lrtb"||G==="lr"?(x.ipd="lr",x.bpd="tb"):G==="rltb"||G==="rl"?(x.ipd="rl",x.bpd="tb"):G==="tblr"?(x.ipd="tb",x.bpd="lr"):(G==="tbrl"||G==="tb")&&(x.ipd="tb",x.bpd="rl")}var V=C.styleAttrs[l.byName.linePadding.qname];if(V&&V>0){var k=Math.ceil(V*x.h)+"px";x.bpd==="tb"?(F.style.paddingLeft=k,F.style.paddingRight=k):(F.style.paddingTop=k,F.style.paddingBottom=k),x.lp=V}var H=C.styleAttrs[l.byName.multiRowAlign.qname];if(H&&H!=="auto"){var J=document.createElement("span");J.style.display="inline-block",J.style.textAlign=H,b.appendChild(J),F=J,x.mra=H}if(C.styleAttrs[l.byName.fillLineGap.qname]&&(x.flg=!0),C.kind==="span"&&C.text)if(x.lp||x.mra||x.flg)for(var K="",ae=0;ae<C.text.length;ae++){K+=C.text.charAt(ae);var re=C.text.charCodeAt(ae);if(re<55296||re>56319||ae===C.text.length){var le=document.createElement("span");le.textContent=K,b.appendChild(le),K=""}}else b.textContent=C.text;w.appendChild(b);for(var me in C.contents)u(x,F,C.contents[me]);var de=[];if((x.lp||x.mra||x.flg)&&C.kind==="p"&&(v(x,F,de,null),x.mra&&(f(de),x.mra=null),x.lp&&(c(de,x.lp*x.h,x),x.lp=null),x.flg)){var te=E(F.getBoundingClientRect(),x);h(de,te.before,te.after,x),x.flg=null}if(C.kind==="region"&&(v(x,F,de),x.bpd==="tb"&&x.enableRollUp&&C.contents.length>0&&C.styleAttrs[l.byName.displayAlign.qname]==="after")){var q=C.id===""?"_":C.id,Z=new p(q,de);if(x.currentISDState[Z.id]=Z,x.previousISDState&&Z.id in x.previousISDState&&x.previousISDState[Z.id].plist.length>0&&Z.plist.length>1&&Z.plist[Z.plist.length-2].text===x.previousISDState[Z.id].plist[x.previousISDState[Z.id].plist.length-1].text){var pe=b.firstElementChild,he=Z.plist[Z.plist.length-1].after-Z.plist[Z.plist.length-1].before;pe.style.bottom="-"+he+"px",pe.style.transition="transform 0.4s",pe.style.position="relative",pe.style.transform="translateY(-"+he+"px)"}}}function c(x,w,C){for(var b in x){var P=x[b].elements.length,A=x[b].elements[x[b].start_elem],I=x[b].elements[x[b].end_elem],F=Math.ceil(w)+"px",G="-"+Math.ceil(w)+"px";P!==0&&(C.ipd==="lr"?(A.node.style.borderLeftColor=A.bgcolor||"#00000000",A.node.style.borderLeftStyle="solid",A.node.style.borderLeftWidth=F,A.node.style.marginLeft=G):C.ipd==="rl"?(A.node.style.borderRightColor=A.bgcolor||"#00000000",A.node.style.borderRightStyle="solid",A.node.style.borderRightWidth=F,A.node.style.marginRight=G):C.ipd==="tb"&&(A.node.style.borderTopColor=A.bgcolor||"#00000000",A.node.style.borderTopStyle="solid",A.node.style.borderTopWidth=F,A.node.style.marginTop=G),C.ipd==="lr"?(I.node.style.borderRightColor=I.bgcolor||"#00000000",I.node.style.borderRightStyle="solid",I.node.style.borderRightWidth=F,I.node.style.marginRight=G):C.ipd==="rl"?(I.node.style.borderLeftColor=I.bgcolor||"#00000000",I.node.style.borderLeftStyle="solid",I.node.style.borderLeftWidth=F,I.node.style.marginLeft=G):C.ipd==="tb"&&(I.node.style.borderBottomColor=I.bgcolor||"#00000000",I.node.style.borderBottomStyle="solid",I.node.style.borderBottomWidth=F,I.node.style.marginBottom=G))}}function f(x){for(var w=0;w<x.length-1;w++){var C=x[w].elements.length;if(C!==0&&x[w].br===!1){var b=document.createElement("br"),P=x[w].elements[C-1].node;P.parentElement.insertBefore(b,P.nextSibling)}}}function h(x,w,C,b){for(var P=Math.sign(C-w),A=0;A<=x.length;A++){var I;A===0?I=w:A===x.length?I=C:I=(x[A].before+x[A-1].after)/2;var F,G;if(A>0)for(var V=0;V<x[A-1].elements.length;V++)x[A-1].elements[V].bgcolor!==null&&(G=x[A-1].elements[V],P*(G.after-I)<0&&(F=Math.ceil(Math.abs(I-G.after))+"px",G.node.style.backgroundColor=G.bgcolor,b.bpd==="lr"?G.node.style.paddingRight=F:b.bpd==="rl"?G.node.style.paddingLeft=F:b.bpd==="tb"&&(G.node.style.paddingBottom=F)));if(A<x.length)for(var k=0;k<x[A].elements.length;k++)G=x[A].elements[k],G.bgcolor!==null&&P*(G.before-I)>0&&(F=Math.ceil(Math.abs(G.before-I))+"px",G.node.style.backgroundColor=G.bgcolor,b.bpd==="lr"?G.node.style.paddingLeft=F:b.bpd==="rl"?G.node.style.paddingRight=F:b.bpd==="tb"&&(G.node.style.paddingTop=F))}}function p(x,w){this.id=x,this.plist=w}function E(x,w){var C={before:null,after:null,start:null,end:null};return w.bpd==="tb"?(C.before=x.top,C.after=x.bottom,w.ipd==="lr"?(C.start=x.left,C.end=x.right):(C.start=x.right,C.end=x.left)):w.bpd==="lr"?(C.before=x.left,C.after=x.right,C.start=x.top,C.end=x.bottom):w.bpd==="rl"&&(C.before=x.right,C.after=x.left,C.start=x.top,C.end=x.bottom),C}function v(x,w,C,b){var P=w.style.backgroundColor||b;if(w.childElementCount===0)if(w.localName==="span"){var A=w.getBoundingClientRect();if(A.height===0||A.width===0)return;var I=E(A,x);if(C.length===0||!M(I.before,I.after,C[C.length-1].before,C[C.length-1].after))C.push({before:I.before,after:I.after,start:I.start,end:I.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1});else{var F=Math.sign(I.after-I.before),G=Math.sign(I.end-I.start);F*(I.before-C[C.length-1].before)<0&&(C[C.length-1].before=I.before),F*(I.after-C[C.length-1].after)>0&&(C[C.length-1].after=I.after),G*(I.start-C[C.length-1].start)<0&&(C[C.length-1].start=I.start,C[C.length-1].start_elem=C[C.length-1].elements.length),G*(I.end-C[C.length-1].end)>0&&(C[C.length-1].end=I.end,C[C.length-1].end_elem=C[C.length-1].elements.length)}C[C.length-1].text+=w.textContent,C[C.length-1].elements.push({node:w,bgcolor:P,before:I.before,after:I.after})}else w.localName==="br"&&C.length!==0&&(C[C.length-1].br=!0);else for(var V=w.firstChild;V;)V.nodeType===Node.ELEMENT_NODE&&v(x,V,C,P),V=V.nextSibling}function M(x,w,C,b){return w<b&&x>C||b<=w&&C>=x}function y(x,w){this.qname=x,this.map=w}var _=[new y("http://www.w3.org/ns/ttml#styling backgroundColor",function(x,w,C,b){b[3]!==0&&(w.style.backgroundColor="rgba("+b[0].toString()+","+b[1].toString()+","+b[2].toString()+","+(b[3]/255).toString()+")")}),new y("http://www.w3.org/ns/ttml#styling color",function(x,w,C,b){w.style.color="rgba("+b[0].toString()+","+b[1].toString()+","+b[2].toString()+","+(b[3]/255).toString()+")"}),new y("http://www.w3.org/ns/ttml#styling direction",function(x,w,C,b){w.style.direction=b}),new y("http://www.w3.org/ns/ttml#styling display",function(x,w,C,b){}),new y("http://www.w3.org/ns/ttml#styling displayAlign",function(x,w,C,b){w.style.display="flex",w.style.flexDirection="column",b==="before"?w.style.justifyContent="flex-start":b==="center"?w.style.justifyContent="center":b==="after"&&(w.style.justifyContent="flex-end")}),new y("http://www.w3.org/ns/ttml#styling extent",function(x,w,C,b){x.regionH=b.h*x.h,x.regionW=b.w*x.w;var P=0,A=0,I=C.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];I&&(P=(I[0]+I[2])*x.h,A=(I[1]+I[3])*x.w),w.style.height=x.regionH-P+"px",w.style.width=x.regionW-A+"px"}),new y("http://www.w3.org/ns/ttml#styling fontFamily",function(x,w,C,b){var P=[];for(var A in b)b[A]==="monospaceSerif"?(P.push("Courier New"),P.push('"Liberation Mono"'),P.push("Courier"),P.push("monospace")):b[A]==="proportionalSansSerif"?(P.push("Arial"),P.push("Helvetica"),P.push('"Liberation Sans"'),P.push("sans-serif")):b[A]==="monospace"?P.push("monospace"):b[A]==="sansSerif"?P.push("sans-serif"):b[A]==="serif"?P.push("serif"):b[A]==="monospaceSansSerif"?(P.push("Consolas"),P.push("monospace")):b[A]==="proportionalSerif"?P.push("serif"):P.push(b[A]);w.style.fontFamily=P.join(",")}),new y("http://www.w3.org/ns/ttml#styling fontSize",function(x,w,C,b){w.style.fontSize=b*x.h+"px"}),new y("http://www.w3.org/ns/ttml#styling fontStyle",function(x,w,C,b){w.style.fontStyle=b}),new y("http://www.w3.org/ns/ttml#styling fontWeight",function(x,w,C,b){w.style.fontWeight=b}),new y("http://www.w3.org/ns/ttml#styling lineHeight",function(x,w,C,b){b==="normal"?w.style.lineHeight="normal":w.style.lineHeight=b*x.h+"px"}),new y("http://www.w3.org/ns/ttml#styling opacity",function(x,w,C,b){w.style.opacity=b}),new y("http://www.w3.org/ns/ttml#styling origin",function(x,w,C,b){w.style.top=b.h*x.h+"px",w.style.left=b.w*x.w+"px"}),new y("http://www.w3.org/ns/ttml#styling overflow",function(x,w,C,b){w.style.overflow=b}),new y("http://www.w3.org/ns/ttml#styling padding",function(x,w,C,b){var P=[];P[0]=b[0]*x.h+"px",P[1]=b[3]*x.w+"px",P[2]=b[2]*x.h+"px",P[3]=b[1]*x.w+"px",w.style.padding=P.join(" ")}),new y("http://www.w3.org/ns/ttml#styling showBackground",null),new y("http://www.w3.org/ns/ttml#styling textAlign",function(x,w,C,b){var P,A=C.styleAttrs[l.byName.direction.qname];b==="start"?P=A==="rtl"?"right":"left":b==="end"?P=A==="rtl"?"left":"right":P=b,w.style.textAlign=P}),new y("http://www.w3.org/ns/ttml#styling textDecoration",function(x,w,C,b){w.style.textDecoration=b.join(" ").replace("lineThrough","line-through")}),new y("http://www.w3.org/ns/ttml#styling textOutline",function(x,w,C,b){b==="none"?w.style.textShadow="":w.style.textShadow="rgba("+b.color[0].toString()+","+b.color[1].toString()+","+b.color[2].toString()+","+(b.color[3]/255).toString()+") 0px 0px "+b.thickness*x.h+"px"}),new y("http://www.w3.org/ns/ttml#styling unicodeBidi",function(x,w,C,b){var P;b==="bidiOverride"?P="bidi-override":P=b,w.style.unicodeBidi=P}),new y("http://www.w3.org/ns/ttml#styling visibility",function(x,w,C,b){w.style.visibility=b}),new y("http://www.w3.org/ns/ttml#styling wrapOption",function(x,w,C,b){b==="wrap"?C.space==="preserve"?w.style.whiteSpace="pre-wrap":w.style.whiteSpace="normal":C.space==="preserve"?w.style.whiteSpace="pre":w.style.whiteSpace="noWrap"}),new y("http://www.w3.org/ns/ttml#styling writingMode",function(x,w,C,b){b==="lrtb"||b==="lr"||b==="rltb"||b==="rl"?w.style.writingMode="horizontal-tb":b==="tblr"?w.style.writingMode="vertical-lr":(b==="tbrl"||b==="tb")&&(w.style.writingMode="vertical-rl")}),new y("http://www.w3.org/ns/ttml#styling zIndex",function(x,w,C,b){w.style.zIndex=b}),new y("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(x,w,C,b){if(x.imgResolver!==null&&b!==null){var P=document.createElement("img"),A=x.imgResolver(b,P);A&&(P.src=A),P.height=x.regionH,P.width=x.regionW,w.appendChild(P)}}),new y("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(x,w,C,b){x.displayForcedOnlyMode&&b===!1&&(w.style.visibility="hidden")})],g={};for(var R in _)g[_[R].qname]=_[R];function S(x,w){if(x&&x.error&&x.error(w))throw w}})(r,typeof imscNames=="undefined"?n("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles=="undefined"?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/isd.js":function(t,r,n){(function(i,o,l){i.generateISD=function(v,M,y){var _=new h(v),g={};for(var R in v.head.layout.regions){var S=u(v,M,v.head.layout.regions[R],v.body,null,"",v.head.layout.regions[R],y,g);S!==null&&_.contents.push(S.element)}return _};function u(v,M,y,_,g,R,S,x,w){if(M<S.begin||M>=S.end)return null;var C="regionID"in S&&S.regionID!==""?S.regionID:R;if(g!==null&&C!==y.id&&(!("contents"in S)||"contents"in S&&S.contents.length===0||C!==""))return null;var b=new p(S);for(var P in S.sets)M<S.sets[P].begin||M>=S.sets[P].end||(b.styleAttrs[S.sets[P].qname]=S.sets[P].value);var A={};for(var I in b.styleAttrs)if(A[I]=!0,I===l.byName.writingMode.qname&&!(l.byName.direction.qname in b.styleAttrs)){var F=b.styleAttrs[I];F==="lrtb"||F==="lr"?b.styleAttrs[l.byName.direction.qname]="ltr":(F==="rltb"||F==="rl")&&(b.styleAttrs[l.byName.direction.qname]="rtl")}if(g!==null)for(var G in l.all){var V=l.all[G];if(V.qname===l.byName.textDecoration.qname){var k=g.styleAttrs[V.qname],H=b.styleAttrs[V.qname],J=[];H===void 0?J=k:H.indexOf("none")===-1?((H.indexOf("noUnderline")===-1&&k.indexOf("underline")!==-1||H.indexOf("underline")!==-1)&&J.push("underline"),(H.indexOf("noLineThrough")===-1&&k.indexOf("lineThrough")!==-1||H.indexOf("lineThrough")!==-1)&&J.push("lineThrough"),(H.indexOf("noOverline")===-1&&k.indexOf("overline")!==-1||H.indexOf("overline")!==-1)&&J.push("overline")):J.push("none"),b.styleAttrs[V.qname]=J}else V.inherit&&V.qname in g.styleAttrs&&!(V.qname in b.styleAttrs)&&(b.styleAttrs[V.qname]=g.styleAttrs[V.qname])}for(var K in l.all){var ae=l.all[K];ae.qname in b.styleAttrs||(b.kind==="region"||ae.inherit===!1&&ae.initial!==null)&&(b.styleAttrs[ae.qname]=ae.parse(ae.initial),A[ae.qname]=!0)}for(var re in l.all){var le=l.all[re];if(le.qname in A&&le.compute!==null){var me=le.compute(v,g,b,b.styleAttrs[le.qname],w);me!==null?b.styleAttrs[le.qname]=me:E(x,"Style '"+le.qname+"' on element '"+b.kind+"' cannot be computed")}}if(b.styleAttrs[l.byName.display.qname]==="none")return null;var de;g===null?_===null?de=[]:de=[_]:"contents"in S&&(de=S.contents);for(var te in de){var q=u(v,M,y,_,b,C,de[te],x,w);q!==null&&b.contents.push(q.element)}for(var Z in b.styleAttrs){var pe=l.byQName[Z];pe.applies.indexOf(b.kind)===-1&&delete b.styleAttrs[Z]}if(b.kind==="span"&&b.text&&b.space==="default"){var he=b.text.replace(/\s+/g," ");b.text=he}if(b.kind==="p"){var Q=[];c(b,Q);for(var Y=0,ie="after_br",ue=0;;)if(ie==="after_br")Y>=Q.length||Q[Y].kind==="br"?(ie="before_br",ue=Y,Y--):(Q[Y].space!=="preserve"&&(Q[Y].text=Q[Y].text.replace(/^\s+/g,"")),Q[Y].text.length>0?(ie="looking_br",Y++):Q.splice(Y,1));else if(ie==="before_br")if(Y<0||Q[Y].kind==="br"){if(ie="after_br",Y=ue+1,Y>=Q.length)break}else if(Q[Y].space!=="preserve"&&(Q[Y].text=Q[Y].text.replace(/\s+$/g,"")),Q[Y].text.length>0){if(ie="after_br",Y=ue+1,Y>=Q.length)break}else Q.splice(Y,1),Y--;else Y>=Q.length||Q[Y].kind==="br"?(ie="before_br",ue=Y,Y--):Y++;f(b)}return b.kind==="div"&&l.byName.backgroundImage.qname in b.styleAttrs||b.kind==="br"||"contents"in b&&b.contents.length>0||b.kind==="span"&&b.text!==null||b.kind==="region"&&b.styleAttrs[l.byName.showBackground.qname]==="always"?{region_id:C,element:b}:null}function c(v,M){if("contents"in v)for(var y in v.contents)c(v.contents[y],M);else M.push(v)}function f(v){if(v.kind==="br")return!1;if("text"in v)return v.text.length===0;if("contents"in v){for(var M=v.contents.length;M--;)f(v.contents[M])&&v.contents.splice(M,1);return v.contents.length===0}}function h(v){this.contents=[],this.aspectRatio=v.aspectRatio}function p(v){this.kind=v.kind||"region",v.id&&(this.id=v.id),this.styleAttrs={};for(var M in v.styleAttrs)this.styleAttrs[M]=v.styleAttrs[M];"text"in v?this.text=v.text:v.kind!=="br"&&(this.contents=[]),"space"in v&&(this.space=v.space)}function E(v,M){if(v&&v.error&&v.error(M))throw M}})(r,typeof imscNames=="undefined"?n("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles=="undefined"?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/main.js":function(t,r,n){r.generateISD=n("./node_modules/imsc/src/main/js/isd.js").generateISD,r.fromXML=n("./node_modules/imsc/src/main/js/doc.js").fromXML,r.renderHTML=n("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":function(t,r,n){(function(i){i.ns_tt="http://www.w3.org/ns/ttml",i.ns_tts="http://www.w3.org/ns/ttml#styling",i.ns_ttp="http://www.w3.org/ns/ttml#parameter",i.ns_xml="http://www.w3.org/XML/1998/namespace",i.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",i.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",i.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",i.ns_ebutts="urn:ebu:tt:style"})(r)},"./node_modules/imsc/src/main/js/styles.js":function(t,r,n){(function(i,o,l){function u(h,p,E,v,M,y,_,g){this.name=p,this.ns=h,this.qname=h+" "+p,this.inherit=M,this.animatable=y,this.initial=E,this.applies=v,this.parse=_,this.compute=g}i.all=[new u(o.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,l.parseColor,null),new u(o.ns_tts,"color","white",["span"],!0,!0,l.parseColor,null),new u(o.ns_tts,"direction","ltr",["p","span"],!0,!0,function(h){return h},null),new u(o.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(h){return h},null),new u(o.ns_tts,"displayAlign","before",["region"],!1,!0,function(h){return h},null),new u(o.ns_tts,"extent","auto",["tt","region"],!1,!0,function(h){if(h==="auto")return h;var p=h.split(" ");if(p.length!==2)return null;var E=l.parseLength(p[0]),v=l.parseLength(p[1]);return!v||!E?null:{h:v,w:E}},function(h,p,E,v,M){var y,_;if(v==="auto")y=1;else if(v.h.unit==="%")y=v.h.value/100;else if(v.h.unit==="px")y=v.h.value/h.pxDimensions.h;else return null;if(v==="auto")_=1;else if(v.w.unit==="%")_=v.w.value/100;else if(v.w.unit==="px")_=v.w.value/h.pxDimensions.w;else return null;return{h:y,w:_}}),new u(o.ns_tts,"fontFamily","default",["span"],!0,!0,function(h){var p=h.split(","),E=[];for(var v in p)p[v].charAt(0)!=="'"&&p[v].charAt(0)!=='"'&&p[v]==="default"?E.push("monospaceSerif"):E.push(p[v]);return E},null),new u(o.ns_tts,"fontSize","1c",["span"],!0,!0,l.parseLength,function(h,p,E,v,M){var y;if(v.unit==="%")p!==null?y=p.styleAttrs[i.byName.fontSize.qname]*v.value/100:y=v.value/100/h.cellResolution.h;else if(v.unit==="em")p!==null?y=p.styleAttrs[i.byName.fontSize.qname]*v.value:y=v.value/h.cellResolution.h;else if(v.unit==="c")y=v.value/h.cellResolution.h;else if(v.unit==="px")y=v.value/h.pxDimensions.h;else return null;return y}),new u(o.ns_tts,"fontStyle","normal",["span"],!0,!0,function(h){return h},null),new u(o.ns_tts,"fontWeight","normal",["span"],!0,!0,function(h){return h},null),new u(o.ns_tts,"lineHeight","normal",["p"],!0,!0,function(h){return h==="normal"?h:l.parseLength(h)},function(h,p,E,v,M){var y;if(v==="normal")y=v;else if(v.unit==="%")y=E.styleAttrs[i.byName.fontSize.qname]*v.value/100;else if(v.unit==="em")y=E.styleAttrs[i.byName.fontSize.qname]*v.value;else if(v.unit==="c")y=v.value/h.cellResolution.h;else if(v.unit==="px")y=v.value/h.pxDimensions.h;else return null;return y}),new u(o.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new u(o.ns_tts,"origin","auto",["region"],!1,!0,function(h){if(h==="auto")return h;var p=h.split(" ");if(p.length!==2)return null;var E=l.parseLength(p[0]),v=l.parseLength(p[1]);return!v||!E?null:{h:v,w:E}},function(h,p,E,v,M){var y,_;if(v==="auto")y=0;else if(v.h.unit==="%")y=v.h.value/100;else if(v.h.unit==="px")y=v.h.value/h.pxDimensions.h;else return null;if(v==="auto")_=0;else if(v.w.unit==="%")_=v.w.value/100;else if(v.w.unit==="px")_=v.w.value/h.pxDimensions.w;else return null;return{h:y,w:_}}),new u(o.ns_tts,"overflow","hidden",["region"],!1,!0,function(h){return h},null),new u(o.ns_tts,"padding","0px",["region"],!1,!0,function(h){var p=h.split(" ");if(p.length>4)return null;var E=[];for(var v in p){var M=l.parseLength(p[v]);if(!M)return null;E.push(M)}return E},function(h,p,E,v,M){var y;if(v.length===1)y=[v[0],v[0],v[0],v[0]];else if(v.length===2)y=[v[0],v[1],v[0],v[1]];else if(v.length===3)y=[v[0],v[1],v[2],v[1]];else if(v.length===4)y=[v[0],v[1],v[2],v[3]];else return null;var _=E.styleAttrs[i.byName.writingMode.qname];if(_==="lrtb"||_==="lr")y=[y[0],y[3],y[2],y[1]];else if(_==="rltb"||_==="rl")y=[y[0],y[1],y[2],y[3]];else if(_==="tblr")y=[y[3],y[0],y[1],y[2]];else if(_==="tbrl"||_==="tb")y=[y[3],y[2],y[1],y[0]];else return null;var g=[];for(var R in y)if(y[R].value===0)g[R]=0;else if(y[R].unit==="%")R==="0"||R==="2"?g[R]=E.styleAttrs[i.byName.extent.qname].h*y[R].value/100:g[R]=E.styleAttrs[i.byName.extent.qname].w*y[R].value/100;else if(y[R].unit==="em")g[R]=E.styleAttrs[i.byName.fontSize.qname]*y[R].value;else if(y[R].unit==="c")g[R]=y[R].value/h.cellResolution.h;else if(y[R].unit==="px")R==="0"||R==="2"?g[R]=y[R].value/h.pxDimensions.h:g[R]=y[R].value/h.pxDimensions.w;else return null;return g}),new u(o.ns_tts,"showBackground","always",["region"],!1,!0,function(h){return h},null),new u(o.ns_tts,"textAlign","start",["p"],!0,!0,function(h){return h},function(h,p,E,v,M){return v==="left"?"start":v==="right"?"end":v}),new u(o.ns_tts,"textDecoration","none",["span"],!0,!0,function(h){return h.split(" ")},null),new u(o.ns_tts,"textOutline","none",["span"],!0,!0,function(h){if(h==="none")return h;var p={},E=h.split(" ");if(E.length===0||E.length>2)return null;var v=l.parseColor(E[0]);if(p.color=v,v!==null&&E.shift(),E.length!==1)return null;var M=l.parseLength(E[0]);return M?(p.thickness=M,p):null},function(h,p,E,v,M){if(v==="none")return v;var y={};if(v.color===null?y.color=E.styleAttrs[i.byName.color.qname]:y.color=v.color,v.thickness.unit==="%")y.thickness=E.styleAttrs[i.byName.fontSize.qname]*v.thickness.value/100;else if(v.thickness.unit==="em")y.thickness=E.styleAttrs[i.byName.fontSize.qname]*v.thickness.value;else if(v.thickness.unit==="c")y.thickness=v.thickness.value/h.cellResolution.h;else if(v.thickness.unit==="px")y.thickness=v.thickness.value/h.pxDimensions.h;else return null;return y}),new u(o.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(h){return h},null),new u(o.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(h){return h},null),new u(o.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(h){return h},null),new u(o.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(h){return h},null),new u(o.ns_tts,"zIndex","auto",["region"],!1,!0,function(h){var p;return h==="auto"?p=h:(p=parseInt(h),isNaN(p)&&(p=null)),p},null),new u(o.ns_ebutts,"linePadding","0c",["p"],!0,!1,l.parseLength,function(h,p,E,v,M){return v.unit==="c"?v.value/h.cellResolution.h:null}),new u(o.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(h){return h},null),new u(o.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(h){return h},null),new u(o.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(h){return h==="true"},null),new u(o.ns_itts,"fillLineGap","false",["p"],!0,!0,function(h){return h==="true"},null)],i.byQName={};for(var c in i.all)i.byQName[i.all[c].qname]=i.all[c];i.byName={};for(var f in i.all)i.byName[i.all[f].name]=i.all[f]})(r,typeof imscNames=="undefined"?n("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscUtils=="undefined"?n("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":function(t,r,n){(function(i){var o=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,l=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,u=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,c={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};i.parseColor=function(h){var p,E=null,v=c[h.toLowerCase()];return v!==void 0?E=v:(p=o.exec(h))!==null?E=[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16),p[4]!==void 0?parseInt(p[4],16):255]:(p=l.exec(h))!==null?E=[parseInt(p[1]),parseInt(p[2]),parseInt(p[3]),255]:(p=u.exec(h))!==null&&(E=[parseInt(p[1]),parseInt(p[2]),parseInt(p[3]),parseInt(p[4])]),E};var f=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;i.parseLength=function(h){var p,E=null;return(p=f.exec(h))!==null&&(E={value:parseFloat(p[1]),unit:p[2]}),E}})(r)},"./node_modules/inherits/inherits_browser.js":function(t,r){typeof Object.create=="function"?t.exports=function(i,o){i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(i,o){i.super_=o;var l=function(){};l.prototype=o.prototype,i.prototype=new l,i.prototype.constructor=i}},"./node_modules/isarray/index.js":function(t,r){var n={}.toString;t.exports=Array.isArray||function(i){return n.call(i)=="[object Array]"}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(t,r,n){(function(i){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <http://feross.org>
* @license  MIT
*/var o=n("./node_modules/base64-js/index.js"),l=n("./node_modules/ieee754/index.js"),u=n("./node_modules/isarray/index.js");r.Buffer=p,r.SlowBuffer=w,r.INSPECT_MAX_BYTES=50,p.TYPED_ARRAY_SUPPORT=i.TYPED_ARRAY_SUPPORT!==void 0?i.TYPED_ARRAY_SUPPORT:c(),r.kMaxLength=f();function c(){try{var ee=new Uint8Array(1);return ee.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ee.foo()===42&&typeof ee.subarray=="function"&&ee.subarray(1,1).byteLength===0}catch{return!1}}function f(){return p.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function h(ee,j){if(f()<j)throw new RangeError("Invalid typed array length");return p.TYPED_ARRAY_SUPPORT?(ee=new Uint8Array(j),ee.__proto__=p.prototype):(ee===null&&(ee=new p(j)),ee.length=j),ee}function p(ee,j,X){if(!p.TYPED_ARRAY_SUPPORT&&!(this instanceof p))return new p(ee,j,X);if(typeof ee=="number"){if(typeof j=="string")throw new Error("If encoding is specified then the first argument must be a string");return y(this,ee)}return E(this,ee,j,X)}p.poolSize=8192,p._augment=function(ee){return ee.__proto__=p.prototype,ee};function E(ee,j,X,z){if(typeof j=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&j instanceof ArrayBuffer?R(ee,j,X,z):typeof j=="string"?_(ee,j,X):S(ee,j)}p.from=function(ee,j,X){return E(null,ee,j,X)},p.TYPED_ARRAY_SUPPORT&&(p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0}));function v(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be a number');if(ee<0)throw new RangeError('"size" argument must not be negative')}function M(ee,j,X,z){return v(j),j<=0?h(ee,j):X!==void 0?typeof z=="string"?h(ee,j).fill(X,z):h(ee,j).fill(X):h(ee,j)}p.alloc=function(ee,j,X){return M(null,ee,j,X)};function y(ee,j){if(v(j),ee=h(ee,j<0?0:x(j)|0),!p.TYPED_ARRAY_SUPPORT)for(var X=0;X<j;++X)ee[X]=0;return ee}p.allocUnsafe=function(ee){return y(null,ee)},p.allocUnsafeSlow=function(ee){return y(null,ee)};function _(ee,j,X){if((typeof X!="string"||X==="")&&(X="utf8"),!p.isEncoding(X))throw new TypeError('"encoding" must be a valid string encoding');var z=C(j,X)|0;ee=h(ee,z);var oe=ee.write(j,X);return oe!==z&&(ee=ee.slice(0,oe)),ee}function g(ee,j){var X=j.length<0?0:x(j.length)|0;ee=h(ee,X);for(var z=0;z<X;z+=1)ee[z]=j[z]&255;return ee}function R(ee,j,X,z){if(j.byteLength,X<0||j.byteLength<X)throw new RangeError("'offset' is out of bounds");if(j.byteLength<X+(z||0))throw new RangeError("'length' is out of bounds");return X===void 0&&z===void 0?j=new Uint8Array(j):z===void 0?j=new Uint8Array(j,X):j=new Uint8Array(j,X,z),p.TYPED_ARRAY_SUPPORT?(ee=j,ee.__proto__=p.prototype):ee=g(ee,j),ee}function S(ee,j){if(p.isBuffer(j)){var X=x(j.length)|0;return ee=h(ee,X),ee.length===0||j.copy(ee,0,0,X),ee}if(j){if(typeof ArrayBuffer!="undefined"&&j.buffer instanceof ArrayBuffer||"length"in j)return typeof j.length!="number"||_e(j.length)?h(ee,0):g(ee,j);if(j.type==="Buffer"&&u(j.data))return g(ee,j.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function x(ee){if(ee>=f())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f().toString(16)+" bytes");return ee|0}function w(ee){return+ee!=ee&&(ee=0),p.alloc(+ee)}p.isBuffer=function(j){return!!(j!=null&&j._isBuffer)},p.compare=function(j,X){if(!p.isBuffer(j)||!p.isBuffer(X))throw new TypeError("Arguments must be Buffers");if(j===X)return 0;for(var z=j.length,oe=X.length,se=0,ce=Math.min(z,oe);se<ce;++se)if(j[se]!==X[se]){z=j[se],oe=X[se];break}return z<oe?-1:oe<z?1:0},p.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(j,X){if(!u(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return p.alloc(0);var z;if(X===void 0)for(X=0,z=0;z<j.length;++z)X+=j[z].length;var oe=p.allocUnsafe(X),se=0;for(z=0;z<j.length;++z){var ce=j[z];if(!p.isBuffer(ce))throw new TypeError('"list" argument must be an Array of Buffers');ce.copy(oe,se),se+=ce.length}return oe};function C(ee,j){if(p.isBuffer(ee))return ee.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ee)||ee instanceof ArrayBuffer))return ee.byteLength;typeof ee!="string"&&(ee=""+ee);var X=ee.length;if(X===0)return 0;for(var z=!1;;)switch(j){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":case void 0:return D(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return fe(ee).length;default:if(z)return D(ee).length;j=(""+j).toLowerCase(),z=!0}}p.byteLength=C;function b(ee,j,X){var z=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,j>>>=0,X<=j))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return te(this,j,X);case"utf8":case"utf-8":return ae(this,j,X);case"ascii":return me(this,j,X);case"latin1":case"binary":return de(this,j,X);case"base64":return K(this,j,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,j,X);default:if(z)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),z=!0}}p.prototype._isBuffer=!0;function P(ee,j,X){var z=ee[j];ee[j]=ee[X],ee[X]=z}p.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var X=0;X<j;X+=2)P(this,X,X+1);return this},p.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var X=0;X<j;X+=4)P(this,X,X+3),P(this,X+1,X+2);return this},p.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var X=0;X<j;X+=8)P(this,X,X+7),P(this,X+1,X+6),P(this,X+2,X+5),P(this,X+3,X+4);return this},p.prototype.toString=function(){var j=this.length|0;return j===0?"":arguments.length===0?ae(this,0,j):b.apply(this,arguments)},p.prototype.equals=function(j){if(!p.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:p.compare(this,j)===0},p.prototype.inspect=function(){var j="",X=r.INSPECT_MAX_BYTES;return this.length>0&&(j=this.toString("hex",0,X).match(/.{2}/g).join(" "),this.length>X&&(j+=" ... ")),"<Buffer "+j+">"},p.prototype.compare=function(j,X,z,oe,se){if(!p.isBuffer(j))throw new TypeError("Argument must be a Buffer");if(X===void 0&&(X=0),z===void 0&&(z=j?j.length:0),oe===void 0&&(oe=0),se===void 0&&(se=this.length),X<0||z>j.length||oe<0||se>this.length)throw new RangeError("out of range index");if(oe>=se&&X>=z)return 0;if(oe>=se)return-1;if(X>=z)return 1;if(X>>>=0,z>>>=0,oe>>>=0,se>>>=0,this===j)return 0;for(var ce=se-oe,Se=z-X,Me=Math.min(ce,Se),ve=this.slice(oe,se),be=j.slice(X,z),Ne=0;Ne<Me;++Ne)if(ve[Ne]!==be[Ne]){ce=ve[Ne],Se=be[Ne];break}return ce<Se?-1:Se<ce?1:0};function A(ee,j,X,z,oe){if(ee.length===0)return-1;if(typeof X=="string"?(z=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,isNaN(X)&&(X=oe?0:ee.length-1),X<0&&(X=ee.length+X),X>=ee.length){if(oe)return-1;X=ee.length-1}else if(X<0)if(oe)X=0;else return-1;if(typeof j=="string"&&(j=p.from(j,z)),p.isBuffer(j))return j.length===0?-1:I(ee,j,X,z,oe);if(typeof j=="number")return j=j&255,p.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(ee,j,X):Uint8Array.prototype.lastIndexOf.call(ee,j,X):I(ee,[j],X,z,oe);throw new TypeError("val must be string, number or Buffer")}function I(ee,j,X,z,oe){var se=1,ce=ee.length,Se=j.length;if(z!==void 0&&(z=String(z).toLowerCase(),z==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(ee.length<2||j.length<2)return-1;se=2,ce/=2,Se/=2,X/=2}function Me(Xe,ot){return se===1?Xe[ot]:Xe.readUInt16BE(ot*se)}var ve;if(oe){var be=-1;for(ve=X;ve<ce;ve++)if(Me(ee,ve)===Me(j,be===-1?0:ve-be)){if(be===-1&&(be=ve),ve-be+1===Se)return be*se}else be!==-1&&(ve-=ve-be),be=-1}else for(X+Se>ce&&(X=ce-Se),ve=X;ve>=0;ve--){for(var Ne=!0,Ue=0;Ue<Se;Ue++)if(Me(ee,ve+Ue)!==Me(j,Ue)){Ne=!1;break}if(Ne)return ve}return-1}p.prototype.includes=function(j,X,z){return this.indexOf(j,X,z)!==-1},p.prototype.indexOf=function(j,X,z){return A(this,j,X,z,!0)},p.prototype.lastIndexOf=function(j,X,z){return A(this,j,X,z,!1)};function F(ee,j,X,z){X=Number(X)||0;var oe=ee.length-X;z?(z=Number(z),z>oe&&(z=oe)):z=oe;var se=j.length;if(se%2!=0)throw new TypeError("Invalid hex string");z>se/2&&(z=se/2);for(var ce=0;ce<z;++ce){var Se=parseInt(j.substr(ce*2,2),16);if(isNaN(Se))return ce;ee[X+ce]=Se}return ce}function G(ee,j,X,z){return ye(D(j,ee.length-X),ee,X,z)}function V(ee,j,X,z){return ye(O(j),ee,X,z)}function k(ee,j,X,z){return V(ee,j,X,z)}function H(ee,j,X,z){return ye(fe(j),ee,X,z)}function J(ee,j,X,z){return ye(U(j,ee.length-X),ee,X,z)}p.prototype.write=function(j,X,z,oe){if(X===void 0)oe="utf8",z=this.length,X=0;else if(z===void 0&&typeof X=="string")oe=X,z=this.length,X=0;else if(isFinite(X))X=X|0,isFinite(z)?(z=z|0,oe===void 0&&(oe="utf8")):(oe=z,z=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var se=this.length-X;if((z===void 0||z>se)&&(z=se),j.length>0&&(z<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");oe||(oe="utf8");for(var ce=!1;;)switch(oe){case"hex":return F(this,j,X,z);case"utf8":case"utf-8":return G(this,j,X,z);case"ascii":return V(this,j,X,z);case"latin1":case"binary":return k(this,j,X,z);case"base64":return H(this,j,X,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,j,X,z);default:if(ce)throw new TypeError("Unknown encoding: "+oe);oe=(""+oe).toLowerCase(),ce=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(ee,j,X){return j===0&&X===ee.length?o.fromByteArray(ee):o.fromByteArray(ee.slice(j,X))}function ae(ee,j,X){X=Math.min(ee.length,X);for(var z=[],oe=j;oe<X;){var se=ee[oe],ce=null,Se=se>239?4:se>223?3:se>191?2:1;if(oe+Se<=X){var Me,ve,be,Ne;switch(Se){case 1:se<128&&(ce=se);break;case 2:Me=ee[oe+1],(Me&192)==128&&(Ne=(se&31)<<6|Me&63,Ne>127&&(ce=Ne));break;case 3:Me=ee[oe+1],ve=ee[oe+2],(Me&192)==128&&(ve&192)==128&&(Ne=(se&15)<<12|(Me&63)<<6|ve&63,Ne>2047&&(Ne<55296||Ne>57343)&&(ce=Ne));break;case 4:Me=ee[oe+1],ve=ee[oe+2],be=ee[oe+3],(Me&192)==128&&(ve&192)==128&&(be&192)==128&&(Ne=(se&15)<<18|(Me&63)<<12|(ve&63)<<6|be&63,Ne>65535&&Ne<1114112&&(ce=Ne))}}ce===null?(ce=65533,Se=1):ce>65535&&(ce-=65536,z.push(ce>>>10&1023|55296),ce=56320|ce&1023),z.push(ce),oe+=Se}return le(z)}var re=4096;function le(ee){var j=ee.length;if(j<=re)return String.fromCharCode.apply(String,ee);for(var X="",z=0;z<j;)X+=String.fromCharCode.apply(String,ee.slice(z,z+=re));return X}function me(ee,j,X){var z="";X=Math.min(ee.length,X);for(var oe=j;oe<X;++oe)z+=String.fromCharCode(ee[oe]&127);return z}function de(ee,j,X){var z="";X=Math.min(ee.length,X);for(var oe=j;oe<X;++oe)z+=String.fromCharCode(ee[oe]);return z}function te(ee,j,X){var z=ee.length;(!j||j<0)&&(j=0),(!X||X<0||X>z)&&(X=z);for(var oe="",se=j;se<X;++se)oe+=L(ee[se]);return oe}function q(ee,j,X){for(var z=ee.slice(j,X),oe="",se=0;se<z.length;se+=2)oe+=String.fromCharCode(z[se]+z[se+1]*256);return oe}p.prototype.slice=function(j,X){var z=this.length;j=~~j,X=X===void 0?z:~~X,j<0?(j+=z,j<0&&(j=0)):j>z&&(j=z),X<0?(X+=z,X<0&&(X=0)):X>z&&(X=z),X<j&&(X=j);var oe;if(p.TYPED_ARRAY_SUPPORT)oe=this.subarray(j,X),oe.__proto__=p.prototype;else{var se=X-j;oe=new p(se,void 0);for(var ce=0;ce<se;++ce)oe[ce]=this[ce+j]}return oe};function Z(ee,j,X){if(ee%1!=0||ee<0)throw new RangeError("offset is not uint");if(ee+j>X)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUIntLE=function(j,X,z){j=j|0,X=X|0,z||Z(j,X,this.length);for(var oe=this[j],se=1,ce=0;++ce<X&&(se*=256);)oe+=this[j+ce]*se;return oe},p.prototype.readUIntBE=function(j,X,z){j=j|0,X=X|0,z||Z(j,X,this.length);for(var oe=this[j+--X],se=1;X>0&&(se*=256);)oe+=this[j+--X]*se;return oe},p.prototype.readUInt8=function(j,X){return X||Z(j,1,this.length),this[j]},p.prototype.readUInt16LE=function(j,X){return X||Z(j,2,this.length),this[j]|this[j+1]<<8},p.prototype.readUInt16BE=function(j,X){return X||Z(j,2,this.length),this[j]<<8|this[j+1]},p.prototype.readUInt32LE=function(j,X){return X||Z(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},p.prototype.readUInt32BE=function(j,X){return X||Z(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},p.prototype.readIntLE=function(j,X,z){j=j|0,X=X|0,z||Z(j,X,this.length);for(var oe=this[j],se=1,ce=0;++ce<X&&(se*=256);)oe+=this[j+ce]*se;return se*=128,oe>=se&&(oe-=Math.pow(2,8*X)),oe},p.prototype.readIntBE=function(j,X,z){j=j|0,X=X|0,z||Z(j,X,this.length);for(var oe=X,se=1,ce=this[j+--oe];oe>0&&(se*=256);)ce+=this[j+--oe]*se;return se*=128,ce>=se&&(ce-=Math.pow(2,8*X)),ce},p.prototype.readInt8=function(j,X){return X||Z(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},p.prototype.readInt16LE=function(j,X){X||Z(j,2,this.length);var z=this[j]|this[j+1]<<8;return z&32768?z|4294901760:z},p.prototype.readInt16BE=function(j,X){X||Z(j,2,this.length);var z=this[j+1]|this[j]<<8;return z&32768?z|4294901760:z},p.prototype.readInt32LE=function(j,X){return X||Z(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},p.prototype.readInt32BE=function(j,X){return X||Z(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},p.prototype.readFloatLE=function(j,X){return X||Z(j,4,this.length),l.read(this,j,!0,23,4)},p.prototype.readFloatBE=function(j,X){return X||Z(j,4,this.length),l.read(this,j,!1,23,4)},p.prototype.readDoubleLE=function(j,X){return X||Z(j,8,this.length),l.read(this,j,!0,52,8)},p.prototype.readDoubleBE=function(j,X){return X||Z(j,8,this.length),l.read(this,j,!1,52,8)};function pe(ee,j,X,z,oe,se){if(!p.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>oe||j<se)throw new RangeError('"value" argument is out of bounds');if(X+z>ee.length)throw new RangeError("Index out of range")}p.prototype.writeUIntLE=function(j,X,z,oe){if(j=+j,X=X|0,z=z|0,!oe){var se=Math.pow(2,8*z)-1;pe(this,j,X,z,se,0)}var ce=1,Se=0;for(this[X]=j&255;++Se<z&&(ce*=256);)this[X+Se]=j/ce&255;return X+z},p.prototype.writeUIntBE=function(j,X,z,oe){if(j=+j,X=X|0,z=z|0,!oe){var se=Math.pow(2,8*z)-1;pe(this,j,X,z,se,0)}var ce=z-1,Se=1;for(this[X+ce]=j&255;--ce>=0&&(Se*=256);)this[X+ce]=j/Se&255;return X+z},p.prototype.writeUInt8=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,1,255,0),p.TYPED_ARRAY_SUPPORT||(j=Math.floor(j)),this[X]=j&255,X+1};function he(ee,j,X,z){j<0&&(j=65535+j+1);for(var oe=0,se=Math.min(ee.length-X,2);oe<se;++oe)ee[X+oe]=(j&255<<8*(z?oe:1-oe))>>>(z?oe:1-oe)*8}p.prototype.writeUInt16LE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[X]=j&255,this[X+1]=j>>>8):he(this,j,X,!0),X+2},p.prototype.writeUInt16BE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[X]=j>>>8,this[X+1]=j&255):he(this,j,X,!1),X+2};function Q(ee,j,X,z){j<0&&(j=4294967295+j+1);for(var oe=0,se=Math.min(ee.length-X,4);oe<se;++oe)ee[X+oe]=j>>>(z?oe:3-oe)*8&255}p.prototype.writeUInt32LE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[X+3]=j>>>24,this[X+2]=j>>>16,this[X+1]=j>>>8,this[X]=j&255):Q(this,j,X,!0),X+4},p.prototype.writeUInt32BE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[X]=j>>>24,this[X+1]=j>>>16,this[X+2]=j>>>8,this[X+3]=j&255):Q(this,j,X,!1),X+4},p.prototype.writeIntLE=function(j,X,z,oe){if(j=+j,X=X|0,!oe){var se=Math.pow(2,8*z-1);pe(this,j,X,z,se-1,-se)}var ce=0,Se=1,Me=0;for(this[X]=j&255;++ce<z&&(Se*=256);)j<0&&Me===0&&this[X+ce-1]!==0&&(Me=1),this[X+ce]=(j/Se>>0)-Me&255;return X+z},p.prototype.writeIntBE=function(j,X,z,oe){if(j=+j,X=X|0,!oe){var se=Math.pow(2,8*z-1);pe(this,j,X,z,se-1,-se)}var ce=z-1,Se=1,Me=0;for(this[X+ce]=j&255;--ce>=0&&(Se*=256);)j<0&&Me===0&&this[X+ce+1]!==0&&(Me=1),this[X+ce]=(j/Se>>0)-Me&255;return X+z},p.prototype.writeInt8=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,1,127,-128),p.TYPED_ARRAY_SUPPORT||(j=Math.floor(j)),j<0&&(j=255+j+1),this[X]=j&255,X+1},p.prototype.writeInt16LE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[X]=j&255,this[X+1]=j>>>8):he(this,j,X,!0),X+2},p.prototype.writeInt16BE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[X]=j>>>8,this[X+1]=j&255):he(this,j,X,!1),X+2},p.prototype.writeInt32LE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,4,2147483647,-2147483648),p.TYPED_ARRAY_SUPPORT?(this[X]=j&255,this[X+1]=j>>>8,this[X+2]=j>>>16,this[X+3]=j>>>24):Q(this,j,X,!0),X+4},p.prototype.writeInt32BE=function(j,X,z){return j=+j,X=X|0,z||pe(this,j,X,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),p.TYPED_ARRAY_SUPPORT?(this[X]=j>>>24,this[X+1]=j>>>16,this[X+2]=j>>>8,this[X+3]=j&255):Q(this,j,X,!1),X+4};function Y(ee,j,X,z,oe,se){if(X+z>ee.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function ie(ee,j,X,z,oe){return oe||Y(ee,j,X,4),l.write(ee,j,X,z,23,4),X+4}p.prototype.writeFloatLE=function(j,X,z){return ie(this,j,X,!0,z)},p.prototype.writeFloatBE=function(j,X,z){return ie(this,j,X,!1,z)};function ue(ee,j,X,z,oe){return oe||Y(ee,j,X,8),l.write(ee,j,X,z,52,8),X+8}p.prototype.writeDoubleLE=function(j,X,z){return ue(this,j,X,!0,z)},p.prototype.writeDoubleBE=function(j,X,z){return ue(this,j,X,!1,z)},p.prototype.copy=function(j,X,z,oe){if(z||(z=0),!oe&&oe!==0&&(oe=this.length),X>=j.length&&(X=j.length),X||(X=0),oe>0&&oe<z&&(oe=z),oe===z||j.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("sourceStart out of bounds");if(oe<0)throw new RangeError("sourceEnd out of bounds");oe>this.length&&(oe=this.length),j.length-X<oe-z&&(oe=j.length-X+z);var se=oe-z,ce;if(this===j&&z<X&&X<oe)for(ce=se-1;ce>=0;--ce)j[ce+X]=this[ce+z];else if(se<1e3||!p.TYPED_ARRAY_SUPPORT)for(ce=0;ce<se;++ce)j[ce+X]=this[ce+z];else Uint8Array.prototype.set.call(j,this.subarray(z,z+se),X);return se},p.prototype.fill=function(j,X,z,oe){if(typeof j=="string"){if(typeof X=="string"?(oe=X,X=0,z=this.length):typeof z=="string"&&(oe=z,z=this.length),j.length===1){var se=j.charCodeAt(0);se<256&&(j=se)}if(oe!==void 0&&typeof oe!="string")throw new TypeError("encoding must be a string");if(typeof oe=="string"&&!p.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe)}else typeof j=="number"&&(j=j&255);if(X<0||this.length<X||this.length<z)throw new RangeError("Out of range index");if(z<=X)return this;X=X>>>0,z=z===void 0?this.length:z>>>0,j||(j=0);var ce;if(typeof j=="number")for(ce=X;ce<z;++ce)this[ce]=j;else{var Se=p.isBuffer(j)?j:D(new p(j,oe).toString()),Me=Se.length;for(ce=0;ce<z-X;++ce)this[ce+X]=Se[ce%Me]}return this};var $=/[^+\/0-9A-Za-z-_]/g;function W(ee){if(ee=B(ee).replace($,""),ee.length<2)return"";for(;ee.length%4!=0;)ee=ee+"=";return ee}function B(ee){return ee.trim?ee.trim():ee.replace(/^\s+|\s+$/g,"")}function L(ee){return ee<16?"0"+ee.toString(16):ee.toString(16)}function D(ee,j){j=j||1/0;for(var X,z=ee.length,oe=null,se=[],ce=0;ce<z;++ce){if(X=ee.charCodeAt(ce),X>55295&&X<57344){if(!oe){if(X>56319){(j-=3)>-1&&se.push(239,191,189);continue}else if(ce+1===z){(j-=3)>-1&&se.push(239,191,189);continue}oe=X;continue}if(X<56320){(j-=3)>-1&&se.push(239,191,189),oe=X;continue}X=(oe-55296<<10|X-56320)+65536}else oe&&(j-=3)>-1&&se.push(239,191,189);if(oe=null,X<128){if((j-=1)<0)break;se.push(X)}else if(X<2048){if((j-=2)<0)break;se.push(X>>6|192,X&63|128)}else if(X<65536){if((j-=3)<0)break;se.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((j-=4)<0)break;se.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return se}function O(ee){for(var j=[],X=0;X<ee.length;++X)j.push(ee.charCodeAt(X)&255);return j}function U(ee,j){for(var X,z,oe,se=[],ce=0;ce<ee.length&&!((j-=2)<0);++ce)X=ee.charCodeAt(ce),z=X>>8,oe=X%256,se.push(oe),se.push(z);return se}function fe(ee){return o.toByteArray(W(ee))}function ye(ee,j,X,z){for(var oe=0;oe<z&&!(oe+X>=j.length||oe>=ee.length);++oe)j[oe+X]=ee[oe];return oe}function _e(ee){return ee!==ee}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/node-libs-browser/node_modules/events/events.js":function(t,r,n){var i=typeof Reflect=="object"?Reflect:null,o=i&&typeof i.apply=="function"?i.apply:function(A,I,F){return Function.prototype.apply.call(A,I,F)},l;i&&typeof i.ownKeys=="function"?l=i.ownKeys:Object.getOwnPropertySymbols?l=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:l=function(A){return Object.getOwnPropertyNames(A)};function u(P){console&&console.warn&&console.warn(P)}var c=Number.isNaN||function(A){return A!==A};function f(){f.init.call(this)}t.exports=f,t.exports.once=w,f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var h=10;function p(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(P){if(typeof P!="number"||P<0||c(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");h=P}}),f.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||c(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function E(P){return P._maxListeners===void 0?f.defaultMaxListeners:P._maxListeners}f.prototype.getMaxListeners=function(){return E(this)},f.prototype.emit=function(A){for(var I=[],F=1;F<arguments.length;F++)I.push(arguments[F]);var G=A==="error",V=this._events;if(V!==void 0)G=G&&V.error===void 0;else if(!G)return!1;if(G){var k;if(I.length>0&&(k=I[0]),k instanceof Error)throw k;var H=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw H.context=k,H}var J=V[A];if(J===void 0)return!1;if(typeof J=="function")o(J,this,I);else for(var K=J.length,ae=R(J,K),F=0;F<K;++F)o(ae[F],this,I);return!0};function v(P,A,I,F){var G,V,k;if(p(I),V=P._events,V===void 0?(V=P._events=Object.create(null),P._eventsCount=0):(V.newListener!==void 0&&(P.emit("newListener",A,I.listener?I.listener:I),V=P._events),k=V[A]),k===void 0)k=V[A]=I,++P._eventsCount;else if(typeof k=="function"?k=V[A]=F?[I,k]:[k,I]:F?k.unshift(I):k.push(I),G=E(P),G>0&&k.length>G&&!k.warned){k.warned=!0;var H=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");H.name="MaxListenersExceededWarning",H.emitter=P,H.type=A,H.count=k.length,u(H)}return P}f.prototype.addListener=function(A,I){return v(this,A,I,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(A,I){return v(this,A,I,!0)};function M(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(P,A,I){var F={fired:!1,wrapFn:void 0,target:P,type:A,listener:I},G=M.bind(F);return G.listener=I,F.wrapFn=G,G}f.prototype.once=function(A,I){return p(I),this.on(A,y(this,A,I)),this},f.prototype.prependOnceListener=function(A,I){return p(I),this.prependListener(A,y(this,A,I)),this},f.prototype.removeListener=function(A,I){var F,G,V,k,H;if(p(I),G=this._events,G===void 0)return this;if(F=G[A],F===void 0)return this;if(F===I||F.listener===I)--this._eventsCount==0?this._events=Object.create(null):(delete G[A],G.removeListener&&this.emit("removeListener",A,F.listener||I));else if(typeof F!="function"){for(V=-1,k=F.length-1;k>=0;k--)if(F[k]===I||F[k].listener===I){H=F[k].listener,V=k;break}if(V<0)return this;V===0?F.shift():S(F,V),F.length===1&&(G[A]=F[0]),G.removeListener!==void 0&&this.emit("removeListener",A,H||I)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(A){var I,F,G;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[A]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete F[A]),this;if(arguments.length===0){var V=Object.keys(F),k;for(G=0;G<V.length;++G)k=V[G],k!=="removeListener"&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=F[A],typeof I=="function")this.removeListener(A,I);else if(I!==void 0)for(G=I.length-1;G>=0;G--)this.removeListener(A,I[G]);return this};function _(P,A,I){var F=P._events;if(F===void 0)return[];var G=F[A];return G===void 0?[]:typeof G=="function"?I?[G.listener||G]:[G]:I?x(G):R(G,G.length)}f.prototype.listeners=function(A){return _(this,A,!0)},f.prototype.rawListeners=function(A){return _(this,A,!1)},f.listenerCount=function(P,A){return typeof P.listenerCount=="function"?P.listenerCount(A):g.call(P,A)},f.prototype.listenerCount=g;function g(P){var A=this._events;if(A!==void 0){var I=A[P];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}f.prototype.eventNames=function(){return this._eventsCount>0?l(this._events):[]};function R(P,A){for(var I=new Array(A),F=0;F<A;++F)I[F]=P[F];return I}function S(P,A){for(;A+1<P.length;A++)P[A]=P[A+1];P.pop()}function x(P){for(var A=new Array(P.length),I=0;I<A.length;++I)A[I]=P[I].listener||P[I];return A}function w(P,A){return new Promise(function(I,F){function G(k){P.removeListener(A,V),F(k)}function V(){typeof P.removeListener=="function"&&P.removeListener("error",G),I([].slice.call(arguments))}b(P,A,V,{once:!0}),A!=="error"&&C(P,G,{once:!0})})}function C(P,A,I){typeof P.on=="function"&&b(P,"error",A,I)}function b(P,A,I,F){if(typeof P.on=="function")F.once?P.once(A,I):P.on(A,I);else if(typeof P.addEventListener=="function")P.addEventListener(A,function G(V){F.once&&P.removeEventListener(A,G),I(V)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}},"./node_modules/node-libs-browser/node_modules/timers-browserify/main.js":function(t,r,n){(function(i){var o=typeof i!="undefined"&&i||typeof self!="undefined"&&self||window,l=Function.prototype.apply;r.setTimeout=function(){return new u(l.call(setTimeout,o,arguments),clearTimeout)},r.setInterval=function(){return new u(l.call(setInterval,o,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(c){c&&c.close()};function u(c,f){this._id=c,this._clearFn=f}u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(o,this._id)},r.enroll=function(c,f){clearTimeout(c._idleTimeoutId),c._idleTimeout=f},r.unenroll=function(c){clearTimeout(c._idleTimeoutId),c._idleTimeout=-1},r._unrefActive=r.active=function(c){clearTimeout(c._idleTimeoutId);var f=c._idleTimeout;f>=0&&(c._idleTimeoutId=setTimeout(function(){c._onTimeout&&c._onTimeout()},f))},n("./node_modules/setimmediate/setImmediate.js"),r.setImmediate=typeof self!="undefined"&&self.setImmediate||typeof i!="undefined"&&i.setImmediate||this&&this.setImmediate,r.clearImmediate=typeof self!="undefined"&&self.clearImmediate||typeof i!="undefined"&&i.clearImmediate||this&&this.clearImmediate}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/path-browserify/index.js":function(t,r,n){(function(i){function o(f,h){for(var p=0,E=f.length-1;E>=0;E--){var v=f[E];v==="."?f.splice(E,1):v===".."?(f.splice(E,1),p++):p&&(f.splice(E,1),p--)}if(h)for(;p--;p)f.unshift("..");return f}r.resolve=function(){for(var f="",h=!1,p=arguments.length-1;p>=-1&&!h;p--){var E=p>=0?arguments[p]:i.cwd();if(typeof E!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!E)continue;f=E+"/"+f,h=E.charAt(0)==="/"}return f=o(u(f.split("/"),function(v){return!!v}),!h).join("/"),(h?"/":"")+f||"."},r.normalize=function(f){var h=r.isAbsolute(f),p=c(f,-1)==="/";return f=o(u(f.split("/"),function(E){return!!E}),!h).join("/"),!f&&!h&&(f="."),f&&p&&(f+="/"),(h?"/":"")+f},r.isAbsolute=function(f){return f.charAt(0)==="/"},r.join=function(){var f=Array.prototype.slice.call(arguments,0);return r.normalize(u(f,function(h,p){if(typeof h!="string")throw new TypeError("Arguments to path.join must be strings");return h}).join("/"))},r.relative=function(f,h){f=r.resolve(f).substr(1),h=r.resolve(h).substr(1);function p(R){for(var S=0;S<R.length&&R[S]==="";S++);for(var x=R.length-1;x>=0&&R[x]==="";x--);return S>x?[]:R.slice(S,x-S+1)}for(var E=p(f.split("/")),v=p(h.split("/")),M=Math.min(E.length,v.length),y=M,_=0;_<M;_++)if(E[_]!==v[_]){y=_;break}for(var g=[],_=y;_<E.length;_++)g.push("..");return g=g.concat(v.slice(y)),g.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(f){if(typeof f!="string"&&(f=f+""),f.length===0)return".";for(var h=f.charCodeAt(0),p=h===47,E=-1,v=!0,M=f.length-1;M>=1;--M)if(h=f.charCodeAt(M),h===47){if(!v){E=M;break}}else v=!1;return E===-1?p?"/":".":p&&E===1?"/":f.slice(0,E)};function l(f){typeof f!="string"&&(f=f+"");var h=0,p=-1,E=!0,v;for(v=f.length-1;v>=0;--v)if(f.charCodeAt(v)===47){if(!E){h=v+1;break}}else p===-1&&(E=!1,p=v+1);return p===-1?"":f.slice(h,p)}r.basename=function(f,h){var p=l(f);return h&&p.substr(-1*h.length)===h&&(p=p.substr(0,p.length-h.length)),p},r.extname=function(f){typeof f!="string"&&(f=f+"");for(var h=-1,p=0,E=-1,v=!0,M=0,y=f.length-1;y>=0;--y){var _=f.charCodeAt(y);if(_===47){if(!v){p=y+1;break}continue}E===-1&&(v=!1,E=y+1),_===46?h===-1?h=y:M!==1&&(M=1):h!==-1&&(M=-1)}return h===-1||E===-1||M===0||M===1&&h===E-1&&h===p+1?"":f.slice(h,E)};function u(f,h){if(f.filter)return f.filter(h);for(var p=[],E=0;E<f.length;E++)h(f[E],E,f)&&p.push(f[E]);return p}var c="ab".substr(-1)==="b"?function(f,h,p){return f.substr(h,p)}:function(f,h,p){return h<0&&(h=f.length+h),f.substr(h,p)}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/process-nextick-args/index.js":function(t,r,n){(function(i){!i.version||i.version.indexOf("v0.")===0||i.version.indexOf("v1.")===0&&i.version.indexOf("v1.8.")!==0?t.exports={nextTick:o}:t.exports=i;function o(l,u,c,f){if(typeof l!="function")throw new TypeError('"callback" argument must be a function');var h=arguments.length,p,E;switch(h){case 0:case 1:return i.nextTick(l);case 2:return i.nextTick(function(){l.call(null,u)});case 3:return i.nextTick(function(){l.call(null,u,c)});case 4:return i.nextTick(function(){l.call(null,u,c,f)});default:for(p=new Array(h-1),E=0;E<p.length;)p[E++]=arguments[E];return i.nextTick(function(){l.apply(null,p)})}}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/process/browser.js":function(t,r){var n=t.exports={},i,o;function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=l}catch{i=l}try{typeof clearTimeout=="function"?o=clearTimeout:o=u}catch{o=u}})();function c(R){if(i===setTimeout)return setTimeout(R,0);if((i===l||!i)&&setTimeout)return i=setTimeout,setTimeout(R,0);try{return i(R,0)}catch{try{return i.call(null,R,0)}catch{return i.call(this,R,0)}}}function f(R){if(o===clearTimeout)return clearTimeout(R);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(R);try{return o(R)}catch{try{return o.call(null,R)}catch{return o.call(this,R)}}}var h=[],p=!1,E,v=-1;function M(){!p||!E||(p=!1,E.length?h=E.concat(h):v=-1,h.length&&y())}function y(){if(!p){var R=c(M);p=!0;for(var S=h.length;S;){for(E=h,h=[];++v<S;)E&&E[v].run();v=-1,S=h.length}E=null,p=!1,f(R)}}n.nextTick=function(R){var S=new Array(arguments.length-1);if(arguments.length>1)for(var x=1;x<arguments.length;x++)S[x-1]=arguments[x];h.push(new _(R,S)),h.length===1&&!p&&c(y)};function _(R,S){this.fun=R,this.array=S}_.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={};function g(){}n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(R){return[]},n.binding=function(R){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(R){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},"./node_modules/readable-stream/duplex-browser.js":function(t,r,n){t.exports=n("./node_modules/readable-stream/lib/_stream_duplex.js")},"./node_modules/readable-stream/lib/_stream_duplex.js":function(t,r,n){var i=n("./node_modules/process-nextick-args/index.js"),o=Object.keys||function(y){var _=[];for(var g in y)_.push(g);return _};t.exports=E;var l=n("./node_modules/core-util-is/lib/util.js");l.inherits=n("./node_modules/inherits/inherits_browser.js");var u=n("./node_modules/readable-stream/lib/_stream_readable.js"),c=n("./node_modules/readable-stream/lib/_stream_writable.js");l.inherits(E,u);for(var f=o(c.prototype),h=0;h<f.length;h++){var p=f[h];E.prototype[p]||(E.prototype[p]=c.prototype[p])}function E(y){if(!(this instanceof E))return new E(y);u.call(this,y),c.call(this,y),y&&y.readable===!1&&(this.readable=!1),y&&y.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,y&&y.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",v)}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function v(){this.allowHalfOpen||this._writableState.ended||i.nextTick(M,this)}function M(y){y.end()}Object.defineProperty(E.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),E.prototype._destroy=function(y,_){this.push(null),this.end(),i.nextTick(_,y)}},"./node_modules/readable-stream/lib/_stream_passthrough.js":function(t,r,n){t.exports=l;var i=n("./node_modules/readable-stream/lib/_stream_transform.js"),o=n("./node_modules/core-util-is/lib/util.js");o.inherits=n("./node_modules/inherits/inherits_browser.js"),o.inherits(l,i);function l(u){if(!(this instanceof l))return new l(u);i.call(this,u)}l.prototype._transform=function(u,c,f){f(null,u)}},"./node_modules/readable-stream/lib/_stream_readable.js":function(t,r,n){(function(i,o){var l=n("./node_modules/process-nextick-args/index.js");t.exports=P;var u=n("./node_modules/isarray/index.js"),c;P.ReadableState=b,n("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter;var f=function(W,B){return W.listeners(B).length},h=n("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),p=n("./node_modules/safe-buffer/index.js").Buffer,E=i.Uint8Array||function(){};function v(W){return p.from(W)}function M(W){return p.isBuffer(W)||W instanceof E}var y=n("./node_modules/core-util-is/lib/util.js");y.inherits=n("./node_modules/inherits/inherits_browser.js");var _=n(0),g=void 0;_&&_.debuglog?g=_.debuglog("stream"):g=function(){};var R=n("./node_modules/readable-stream/lib/internal/streams/BufferList.js"),S=n("./node_modules/readable-stream/lib/internal/streams/destroy.js"),x;y.inherits(P,h);var w=["error","close","destroy","pause","resume"];function C(W,B,L){if(typeof W.prependListener=="function")return W.prependListener(B,L);!W._events||!W._events[B]?W.on(B,L):u(W._events[B])?W._events[B].unshift(L):W._events[B]=[L,W._events[B]]}function b(W,B){c=c||n("./node_modules/readable-stream/lib/_stream_duplex.js"),W=W||{};var L=B instanceof c;this.objectMode=!!W.objectMode,L&&(this.objectMode=this.objectMode||!!W.readableObjectMode);var D=W.highWaterMark,O=W.readableHighWaterMark,U=this.objectMode?16:16*1024;D||D===0?this.highWaterMark=D:L&&(O||O===0)?this.highWaterMark=O:this.highWaterMark=U,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=W.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,W.encoding&&(x||(x=n("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new x(W.encoding),this.encoding=W.encoding)}function P(W){if(c=c||n("./node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof P))return new P(W);this._readableState=new b(W,this),this.readable=!0,W&&(typeof W.read=="function"&&(this._read=W.read),typeof W.destroy=="function"&&(this._destroy=W.destroy)),h.call(this)}Object.defineProperty(P.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(W){!this._readableState||(this._readableState.destroyed=W)}}),P.prototype.destroy=S.destroy,P.prototype._undestroy=S.undestroy,P.prototype._destroy=function(W,B){this.push(null),B(W)},P.prototype.push=function(W,B){var L=this._readableState,D;return L.objectMode?D=!0:typeof W=="string"&&(B=B||L.defaultEncoding,B!==L.encoding&&(W=p.from(W,B),B=""),D=!0),A(this,W,B,!1,D)},P.prototype.unshift=function(W){return A(this,W,null,!0,!1)};function A(W,B,L,D,O){var U=W._readableState;if(B===null)U.reading=!1,J(W,U);else{var fe;O||(fe=F(U,B)),fe?W.emit("error",fe):U.objectMode||B&&B.length>0?(typeof B!="string"&&!U.objectMode&&Object.getPrototypeOf(B)!==p.prototype&&(B=v(B)),D?U.endEmitted?W.emit("error",new Error("stream.unshift() after end event")):I(W,U,B,!0):U.ended?W.emit("error",new Error("stream.push() after EOF")):(U.reading=!1,U.decoder&&!L?(B=U.decoder.write(B),U.objectMode||B.length!==0?I(W,U,B,!1):re(W,U)):I(W,U,B,!1))):D||(U.reading=!1)}return G(U)}function I(W,B,L,D){B.flowing&&B.length===0&&!B.sync?(W.emit("data",L),W.read(0)):(B.length+=B.objectMode?1:L.length,D?B.buffer.unshift(L):B.buffer.push(L),B.needReadable&&K(W)),re(W,B)}function F(W,B){var L;return!M(B)&&typeof B!="string"&&B!==void 0&&!W.objectMode&&(L=new TypeError("Invalid non-string/buffer chunk")),L}function G(W){return!W.ended&&(W.needReadable||W.length<W.highWaterMark||W.length===0)}P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(W){return x||(x=n("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this._readableState.decoder=new x(W),this._readableState.encoding=W,this};var V=8388608;function k(W){return W>=V?W=V:(W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++),W}function H(W,B){return W<=0||B.length===0&&B.ended?0:B.objectMode?1:W!==W?B.flowing&&B.length?B.buffer.head.data.length:B.length:(W>B.highWaterMark&&(B.highWaterMark=k(W)),W<=B.length?W:B.ended?B.length:(B.needReadable=!0,0))}P.prototype.read=function(W){g("read",W),W=parseInt(W,10);var B=this._readableState,L=W;if(W!==0&&(B.emittedReadable=!1),W===0&&B.needReadable&&(B.length>=B.highWaterMark||B.ended))return g("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?ie(this):K(this),null;if(W=H(W,B),W===0&&B.ended)return B.length===0&&ie(this),null;var D=B.needReadable;g("need readable",D),(B.length===0||B.length-W<B.highWaterMark)&&(D=!0,g("length less than watermark",D)),B.ended||B.reading?(D=!1,g("reading or ended",D)):D&&(g("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(W=H(L,B)));var O;return W>0?O=pe(W,B):O=null,O===null?(B.needReadable=!0,W=0):B.length-=W,B.length===0&&(B.ended||(B.needReadable=!0),L!==W&&B.ended&&ie(this)),O!==null&&this.emit("data",O),O};function J(W,B){if(!B.ended){if(B.decoder){var L=B.decoder.end();L&&L.length&&(B.buffer.push(L),B.length+=B.objectMode?1:L.length)}B.ended=!0,K(W)}}function K(W){var B=W._readableState;B.needReadable=!1,B.emittedReadable||(g("emitReadable",B.flowing),B.emittedReadable=!0,B.sync?l.nextTick(ae,W):ae(W))}function ae(W){g("emit readable"),W.emit("readable"),Z(W)}function re(W,B){B.readingMore||(B.readingMore=!0,l.nextTick(le,W,B))}function le(W,B){for(var L=B.length;!B.reading&&!B.flowing&&!B.ended&&B.length<B.highWaterMark&&(g("maybeReadMore read 0"),W.read(0),L!==B.length);)L=B.length;B.readingMore=!1}P.prototype._read=function(W){this.emit("error",new Error("_read() is not implemented"))},P.prototype.pipe=function(W,B){var L=this,D=this._readableState;switch(D.pipesCount){case 0:D.pipes=W;break;case 1:D.pipes=[D.pipes,W];break;default:D.pipes.push(W);break}D.pipesCount+=1,g("pipe count=%d opts=%j",D.pipesCount,B);var O=(!B||B.end!==!1)&&W!==o.stdout&&W!==o.stderr,U=O?ye:Se;D.endEmitted?l.nextTick(U):L.once("end",U),W.on("unpipe",fe);function fe(Me,ve){g("onunpipe"),Me===L&&ve&&ve.hasUnpiped===!1&&(ve.hasUnpiped=!0,j())}function ye(){g("onend"),W.end()}var _e=me(L);W.on("drain",_e);var ee=!1;function j(){g("cleanup"),W.removeListener("close",se),W.removeListener("finish",ce),W.removeListener("drain",_e),W.removeListener("error",oe),W.removeListener("unpipe",fe),L.removeListener("end",ye),L.removeListener("end",Se),L.removeListener("data",z),ee=!0,D.awaitDrain&&(!W._writableState||W._writableState.needDrain)&&_e()}var X=!1;L.on("data",z);function z(Me){g("ondata"),X=!1;var ve=W.write(Me);ve===!1&&!X&&((D.pipesCount===1&&D.pipes===W||D.pipesCount>1&&$(D.pipes,W)!==-1)&&!ee&&(g("false write response, pause",L._readableState.awaitDrain),L._readableState.awaitDrain++,X=!0),L.pause())}function oe(Me){g("onerror",Me),Se(),W.removeListener("error",oe),f(W,"error")===0&&W.emit("error",Me)}C(W,"error",oe);function se(){W.removeListener("finish",ce),Se()}W.once("close",se);function ce(){g("onfinish"),W.removeListener("close",se),Se()}W.once("finish",ce);function Se(){g("unpipe"),L.unpipe(W)}return W.emit("pipe",L),D.flowing||(g("pipe resume"),L.resume()),W};function me(W){return function(){var B=W._readableState;g("pipeOnDrain",B.awaitDrain),B.awaitDrain&&B.awaitDrain--,B.awaitDrain===0&&f(W,"data")&&(B.flowing=!0,Z(W))}}P.prototype.unpipe=function(W){var B=this._readableState,L={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return W&&W!==B.pipes?this:(W||(W=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,W&&W.emit("unpipe",this,L),this);if(!W){var D=B.pipes,O=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var U=0;U<O;U++)D[U].emit("unpipe",this,L);return this}var fe=$(B.pipes,W);return fe===-1?this:(B.pipes.splice(fe,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),W.emit("unpipe",this,L),this)},P.prototype.on=function(W,B){var L=h.prototype.on.call(this,W,B);if(W==="data")this._readableState.flowing!==!1&&this.resume();else if(W==="readable"){var D=this._readableState;!D.endEmitted&&!D.readableListening&&(D.readableListening=D.needReadable=!0,D.emittedReadable=!1,D.reading?D.length&&K(this):l.nextTick(de,this))}return L},P.prototype.addListener=P.prototype.on;function de(W){g("readable nexttick read 0"),W.read(0)}P.prototype.resume=function(){var W=this._readableState;return W.flowing||(g("resume"),W.flowing=!0,te(this,W)),this};function te(W,B){B.resumeScheduled||(B.resumeScheduled=!0,l.nextTick(q,W,B))}function q(W,B){B.reading||(g("resume read 0"),W.read(0)),B.resumeScheduled=!1,B.awaitDrain=0,W.emit("resume"),Z(W),B.flowing&&!B.reading&&W.read(0)}P.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function Z(W){var B=W._readableState;for(g("flow",B.flowing);B.flowing&&W.read()!==null;);}P.prototype.wrap=function(W){var B=this,L=this._readableState,D=!1;W.on("end",function(){if(g("wrapped end"),L.decoder&&!L.ended){var fe=L.decoder.end();fe&&fe.length&&B.push(fe)}B.push(null)}),W.on("data",function(fe){if(g("wrapped data"),L.decoder&&(fe=L.decoder.write(fe)),!(L.objectMode&&fe==null)&&!(!L.objectMode&&(!fe||!fe.length))){var ye=B.push(fe);ye||(D=!0,W.pause())}});for(var O in W)this[O]===void 0&&typeof W[O]=="function"&&(this[O]=function(fe){return function(){return W[fe].apply(W,arguments)}}(O));for(var U=0;U<w.length;U++)W.on(w[U],this.emit.bind(this,w[U]));return this._read=function(fe){g("wrapped _read",fe),D&&(D=!1,W.resume())},this},Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),P._fromList=pe;function pe(W,B){if(B.length===0)return null;var L;return B.objectMode?L=B.buffer.shift():!W||W>=B.length?(B.decoder?L=B.buffer.join(""):B.buffer.length===1?L=B.buffer.head.data:L=B.buffer.concat(B.length),B.buffer.clear()):L=he(W,B.buffer,B.decoder),L}function he(W,B,L){var D;return W<B.head.data.length?(D=B.head.data.slice(0,W),B.head.data=B.head.data.slice(W)):W===B.head.data.length?D=B.shift():D=L?Q(W,B):Y(W,B),D}function Q(W,B){var L=B.head,D=1,O=L.data;for(W-=O.length;L=L.next;){var U=L.data,fe=W>U.length?U.length:W;if(fe===U.length?O+=U:O+=U.slice(0,W),W-=fe,W===0){fe===U.length?(++D,L.next?B.head=L.next:B.head=B.tail=null):(B.head=L,L.data=U.slice(fe));break}++D}return B.length-=D,O}function Y(W,B){var L=p.allocUnsafe(W),D=B.head,O=1;for(D.data.copy(L),W-=D.data.length;D=D.next;){var U=D.data,fe=W>U.length?U.length:W;if(U.copy(L,L.length-W,0,fe),W-=fe,W===0){fe===U.length?(++O,D.next?B.head=D.next:B.head=B.tail=null):(B.head=D,D.data=U.slice(fe));break}++O}return B.length-=O,L}function ie(W){var B=W._readableState;if(B.length>0)throw new Error('"endReadable()" called on non-empty stream');B.endEmitted||(B.ended=!0,l.nextTick(ue,B,W))}function ue(W,B){!W.endEmitted&&W.length===0&&(W.endEmitted=!0,B.readable=!1,B.emit("end"))}function $(W,B){for(var L=0,D=W.length;L<D;L++)if(W[L]===B)return L;return-1}}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/readable-stream/lib/_stream_transform.js":function(t,r,n){t.exports=u;var i=n("./node_modules/readable-stream/lib/_stream_duplex.js"),o=n("./node_modules/core-util-is/lib/util.js");o.inherits=n("./node_modules/inherits/inherits_browser.js"),o.inherits(u,i);function l(h,p){var E=this._transformState;E.transforming=!1;var v=E.writecb;if(!v)return this.emit("error",new Error("write callback called multiple times"));E.writechunk=null,E.writecb=null,p!=null&&this.push(p),v(h);var M=this._readableState;M.reading=!1,(M.needReadable||M.length<M.highWaterMark)&&this._read(M.highWaterMark)}function u(h){if(!(this instanceof u))return new u(h);i.call(this,h),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",c)}function c(){var h=this;typeof this._flush=="function"?this._flush(function(p,E){f(h,p,E)}):f(this,null,null)}u.prototype.push=function(h,p){return this._transformState.needTransform=!1,i.prototype.push.call(this,h,p)},u.prototype._transform=function(h,p,E){throw new Error("_transform() is not implemented")},u.prototype._write=function(h,p,E){var v=this._transformState;if(v.writecb=E,v.writechunk=h,v.writeencoding=p,!v.transforming){var M=this._readableState;(v.needTransform||M.needReadable||M.length<M.highWaterMark)&&this._read(M.highWaterMark)}},u.prototype._read=function(h){var p=this._transformState;p.writechunk!==null&&p.writecb&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},u.prototype._destroy=function(h,p){var E=this;i.prototype._destroy.call(this,h,function(v){p(v),E.emit("close")})};function f(h,p,E){if(p)return h.emit("error",p);if(E!=null&&h.push(E),h._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(h._transformState.transforming)throw new Error("Calling transform done when still transforming");return h.push(null)}},"./node_modules/readable-stream/lib/_stream_writable.js":function(t,r,n){(function(i,o,l){var u=n("./node_modules/process-nextick-args/index.js");t.exports=C;function c(q){var Z=this;this.next=null,this.entry=null,this.finish=function(){te(Z,q)}}var f=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?o:u.nextTick,h;C.WritableState=x;var p=n("./node_modules/core-util-is/lib/util.js");p.inherits=n("./node_modules/inherits/inherits_browser.js");var E={deprecate:n("./node_modules/util-deprecate/browser.js")},v=n("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),M=n("./node_modules/safe-buffer/index.js").Buffer,y=l.Uint8Array||function(){};function _(q){return M.from(q)}function g(q){return M.isBuffer(q)||q instanceof y}var R=n("./node_modules/readable-stream/lib/internal/streams/destroy.js");p.inherits(C,v);function S(){}function x(q,Z){h=h||n("./node_modules/readable-stream/lib/_stream_duplex.js"),q=q||{};var pe=Z instanceof h;this.objectMode=!!q.objectMode,pe&&(this.objectMode=this.objectMode||!!q.writableObjectMode);var he=q.highWaterMark,Q=q.writableHighWaterMark,Y=this.objectMode?16:16*1024;he||he===0?this.highWaterMark=he:pe&&(Q||Q===0)?this.highWaterMark=Q:this.highWaterMark=Y,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ie=q.decodeStrings===!1;this.decodeStrings=!ie,this.defaultEncoding=q.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ue){k(Z,ue)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}x.prototype.getBuffer=function(){for(var Z=this.bufferedRequest,pe=[];Z;)pe.push(Z),Z=Z.next;return pe},function(){try{Object.defineProperty(x.prototype,"buffer",{get:E.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var w;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(w=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(q){return w.call(this,q)?!0:this!==C?!1:q&&q._writableState instanceof x}})):w=function(q){return q instanceof this};function C(q){if(h=h||n("./node_modules/readable-stream/lib/_stream_duplex.js"),!w.call(C,this)&&!(this instanceof h))return new C(q);this._writableState=new x(q,this),this.writable=!0,q&&(typeof q.write=="function"&&(this._write=q.write),typeof q.writev=="function"&&(this._writev=q.writev),typeof q.destroy=="function"&&(this._destroy=q.destroy),typeof q.final=="function"&&(this._final=q.final)),v.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function b(q,Z){var pe=new Error("write after end");q.emit("error",pe),u.nextTick(Z,pe)}function P(q,Z,pe,he){var Q=!0,Y=!1;return pe===null?Y=new TypeError("May not write null values to stream"):typeof pe!="string"&&pe!==void 0&&!Z.objectMode&&(Y=new TypeError("Invalid non-string/buffer chunk")),Y&&(q.emit("error",Y),u.nextTick(he,Y),Q=!1),Q}C.prototype.write=function(q,Z,pe){var he=this._writableState,Q=!1,Y=!he.objectMode&&g(q);return Y&&!M.isBuffer(q)&&(q=_(q)),typeof Z=="function"&&(pe=Z,Z=null),Y?Z="buffer":Z||(Z=he.defaultEncoding),typeof pe!="function"&&(pe=S),he.ended?b(this,pe):(Y||P(this,he,q,pe))&&(he.pendingcb++,Q=I(this,he,Y,q,Z,pe)),Q},C.prototype.cork=function(){var q=this._writableState;q.corked++},C.prototype.uncork=function(){var q=this._writableState;q.corked&&(q.corked--,!q.writing&&!q.corked&&!q.finished&&!q.bufferProcessing&&q.bufferedRequest&&K(this,q))},C.prototype.setDefaultEncoding=function(Z){if(typeof Z=="string"&&(Z=Z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+Z);return this._writableState.defaultEncoding=Z,this};function A(q,Z,pe){return!q.objectMode&&q.decodeStrings!==!1&&typeof Z=="string"&&(Z=M.from(Z,pe)),Z}Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(q,Z,pe,he,Q,Y){if(!pe){var ie=A(Z,he,Q);he!==ie&&(pe=!0,Q="buffer",he=ie)}var ue=Z.objectMode?1:he.length;Z.length+=ue;var $=Z.length<Z.highWaterMark;if($||(Z.needDrain=!0),Z.writing||Z.corked){var W=Z.lastBufferedRequest;Z.lastBufferedRequest={chunk:he,encoding:Q,isBuf:pe,callback:Y,next:null},W?W.next=Z.lastBufferedRequest:Z.bufferedRequest=Z.lastBufferedRequest,Z.bufferedRequestCount+=1}else F(q,Z,!1,ue,he,Q,Y);return $}function F(q,Z,pe,he,Q,Y,ie){Z.writelen=he,Z.writecb=ie,Z.writing=!0,Z.sync=!0,pe?q._writev(Q,Z.onwrite):q._write(Q,Y,Z.onwrite),Z.sync=!1}function G(q,Z,pe,he,Q){--Z.pendingcb,pe?(u.nextTick(Q,he),u.nextTick(me,q,Z),q._writableState.errorEmitted=!0,q.emit("error",he)):(Q(he),q._writableState.errorEmitted=!0,q.emit("error",he),me(q,Z))}function V(q){q.writing=!1,q.writecb=null,q.length-=q.writelen,q.writelen=0}function k(q,Z){var pe=q._writableState,he=pe.sync,Q=pe.writecb;if(V(pe),Z)G(q,pe,he,Z,Q);else{var Y=ae(pe);!Y&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&K(q,pe),he?f(H,q,pe,Y,Q):H(q,pe,Y,Q)}}function H(q,Z,pe,he){pe||J(q,Z),Z.pendingcb--,he(),me(q,Z)}function J(q,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,q.emit("drain"))}function K(q,Z){Z.bufferProcessing=!0;var pe=Z.bufferedRequest;if(q._writev&&pe&&pe.next){var he=Z.bufferedRequestCount,Q=new Array(he),Y=Z.corkedRequestsFree;Y.entry=pe;for(var ie=0,ue=!0;pe;)Q[ie]=pe,pe.isBuf||(ue=!1),pe=pe.next,ie+=1;Q.allBuffers=ue,F(q,Z,!0,Z.length,Q,"",Y.finish),Z.pendingcb++,Z.lastBufferedRequest=null,Y.next?(Z.corkedRequestsFree=Y.next,Y.next=null):Z.corkedRequestsFree=new c(Z),Z.bufferedRequestCount=0}else{for(;pe;){var $=pe.chunk,W=pe.encoding,B=pe.callback,L=Z.objectMode?1:$.length;if(F(q,Z,!1,L,$,W,B),pe=pe.next,Z.bufferedRequestCount--,Z.writing)break}pe===null&&(Z.lastBufferedRequest=null)}Z.bufferedRequest=pe,Z.bufferProcessing=!1}C.prototype._write=function(q,Z,pe){pe(new Error("_write() is not implemented"))},C.prototype._writev=null,C.prototype.end=function(q,Z,pe){var he=this._writableState;typeof q=="function"?(pe=q,q=null,Z=null):typeof Z=="function"&&(pe=Z,Z=null),q!=null&&this.write(q,Z),he.corked&&(he.corked=1,this.uncork()),!he.ending&&!he.finished&&de(this,he,pe)};function ae(q){return q.ending&&q.length===0&&q.bufferedRequest===null&&!q.finished&&!q.writing}function re(q,Z){q._final(function(pe){Z.pendingcb--,pe&&q.emit("error",pe),Z.prefinished=!0,q.emit("prefinish"),me(q,Z)})}function le(q,Z){!Z.prefinished&&!Z.finalCalled&&(typeof q._final=="function"?(Z.pendingcb++,Z.finalCalled=!0,u.nextTick(re,q,Z)):(Z.prefinished=!0,q.emit("prefinish")))}function me(q,Z){var pe=ae(Z);return pe&&(le(q,Z),Z.pendingcb===0&&(Z.finished=!0,q.emit("finish"))),pe}function de(q,Z,pe){Z.ending=!0,me(q,Z),pe&&(Z.finished?u.nextTick(pe):q.once("finish",pe)),Z.ended=!0,q.writable=!1}function te(q,Z,pe){var he=q.entry;for(q.entry=null;he;){var Q=he.callback;Z.pendingcb--,Q(pe),he=he.next}Z.corkedRequestsFree?Z.corkedRequestsFree.next=q:Z.corkedRequestsFree=q}Object.defineProperty(C.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(q){!this._writableState||(this._writableState.destroyed=q)}}),C.prototype.destroy=R.destroy,C.prototype._undestroy=R.undestroy,C.prototype._destroy=function(q,Z){this.end(),Z(q)}}).call(this,n("./node_modules/process/browser.js"),n("./node_modules/node-libs-browser/node_modules/timers-browserify/main.js").setImmediate,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/readable-stream/lib/internal/streams/BufferList.js":function(t,r,n){function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}var o=n("./node_modules/safe-buffer/index.js").Buffer,l=n(1);function u(c,f,h){c.copy(f,h)}t.exports=function(){function c(){i(this,c),this.head=null,this.tail=null,this.length=0}return c.prototype.push=function(h){var p={data:h,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length},c.prototype.unshift=function(h){var p={data:h,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length},c.prototype.shift=function(){if(this.length!==0){var h=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,h}},c.prototype.clear=function(){this.head=this.tail=null,this.length=0},c.prototype.join=function(h){if(this.length===0)return"";for(var p=this.head,E=""+p.data;p=p.next;)E+=h+p.data;return E},c.prototype.concat=function(h){if(this.length===0)return o.alloc(0);if(this.length===1)return this.head.data;for(var p=o.allocUnsafe(h>>>0),E=this.head,v=0;E;)u(E.data,p,v),v+=E.data.length,E=E.next;return p},c}(),l&&l.inspect&&l.inspect.custom&&(t.exports.prototype[l.inspect.custom]=function(){var c=l.inspect({length:this.length});return this.constructor.name+" "+c})},"./node_modules/readable-stream/lib/internal/streams/destroy.js":function(t,r,n){var i=n("./node_modules/process-nextick-args/index.js");function o(c,f){var h=this,p=this._readableState&&this._readableState.destroyed,E=this._writableState&&this._writableState.destroyed;return p||E?(f?f(c):c&&(!this._writableState||!this._writableState.errorEmitted)&&i.nextTick(u,this,c),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(v){!f&&v?(i.nextTick(u,h,v),h._writableState&&(h._writableState.errorEmitted=!0)):f&&f(v)}),this)}function l(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function u(c,f){c.emit("error",f)}t.exports={destroy:o,undestroy:l}},"./node_modules/readable-stream/lib/internal/streams/stream-browser.js":function(t,r,n){t.exports=n("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter},"./node_modules/readable-stream/passthrough.js":function(t,r,n){t.exports=n("./node_modules/readable-stream/readable-browser.js").PassThrough},"./node_modules/readable-stream/readable-browser.js":function(t,r,n){r=t.exports=n("./node_modules/readable-stream/lib/_stream_readable.js"),r.Stream=r,r.Readable=r,r.Writable=n("./node_modules/readable-stream/lib/_stream_writable.js"),r.Duplex=n("./node_modules/readable-stream/lib/_stream_duplex.js"),r.Transform=n("./node_modules/readable-stream/lib/_stream_transform.js"),r.PassThrough=n("./node_modules/readable-stream/lib/_stream_passthrough.js")},"./node_modules/readable-stream/transform.js":function(t,r,n){t.exports=n("./node_modules/readable-stream/readable-browser.js").Transform},"./node_modules/readable-stream/writable-browser.js":function(t,r,n){t.exports=n("./node_modules/readable-stream/lib/_stream_writable.js")},"./node_modules/safe-buffer/index.js":function(t,r,n){var i=n("./node_modules/node-libs-browser/node_modules/buffer/index.js"),o=i.Buffer;function l(c,f){for(var h in c)f[h]=c[h]}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=i:(l(i,r),r.Buffer=u);function u(c,f,h){return o(c,f,h)}l(o,u),u.from=function(c,f,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return o(c,f,h)},u.alloc=function(c,f,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var p=o(c);return f!==void 0?typeof h=="string"?p.fill(f,h):p.fill(f):p.fill(0),p},u.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return o(c)},u.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(c)}},"./node_modules/sax/lib/sax.js":function(t,r,n){(function(i){(function(o){o.parser=function(L,D){return new u(L,D)},o.SAXParser=u,o.SAXStream=M,o.createStream=v,o.MAX_BUFFER_LENGTH=64*1024;var l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];o.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function u(L,D){if(!(this instanceof u))return new u(L,D);var O=this;f(O),O.q=O.c="",O.bufferCheckPosition=o.MAX_BUFFER_LENGTH,O.opt=D||{},O.opt.lowercase=O.opt.lowercase||O.opt.lowercasetags,O.looseCase=O.opt.lowercase?"toLowerCase":"toUpperCase",O.tags=[],O.closed=O.closedRoot=O.sawRoot=!1,O.tag=O.error=null,O.strict=!!L,O.noscript=!!(L||O.opt.noscript),O.state=K.BEGIN,O.strictEntities=O.opt.strictEntities,O.ENTITIES=O.strictEntities?Object.create(o.XML_ENTITIES):Object.create(o.ENTITIES),O.attribList=[],O.opt.xmlns&&(O.ns=Object.create(P)),O.trackPosition=O.opt.position!==!1,O.trackPosition&&(O.position=O.line=O.column=0),re(O,"onready")}Object.create||(Object.create=function(L){function D(){}D.prototype=L;var O=new D;return O}),Object.keys||(Object.keys=function(L){var D=[];for(var O in L)L.hasOwnProperty(O)&&D.push(O);return D});function c(L){for(var D=Math.max(o.MAX_BUFFER_LENGTH,10),O=0,U=0,fe=l.length;U<fe;U++){var ye=L[l[U]].length;if(ye>D)switch(l[U]){case"textNode":me(L);break;case"cdata":le(L,"oncdata",L.cdata),L.cdata="";break;case"script":le(L,"onscript",L.script),L.script="";break;default:te(L,"Max buffer length exceeded: "+l[U])}O=Math.max(O,ye)}var _e=o.MAX_BUFFER_LENGTH-O;L.bufferCheckPosition=_e+L.position}function f(L){for(var D=0,O=l.length;D<O;D++)L[l[D]]=""}function h(L){me(L),L.cdata!==""&&(le(L,"oncdata",L.cdata),L.cdata=""),L.script!==""&&(le(L,"onscript",L.script),L.script="")}u.prototype={end:function(){q(this)},write:B,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){h(this)}};var p;try{p=n("./node_modules/stream-browserify/index.js").Stream}catch{p=function(){}}var E=o.EVENTS.filter(function(L){return L!=="error"&&L!=="end"});function v(L,D){return new M(L,D)}function M(L,D){if(!(this instanceof M))return new M(L,D);p.apply(this),this._parser=new u(L,D),this.writable=!0,this.readable=!0;var O=this;this._parser.onend=function(){O.emit("end")},this._parser.onerror=function(U){O.emit("error",U),O._parser.error=null},this._decoder=null,E.forEach(function(U){Object.defineProperty(O,"on"+U,{get:function(){return O._parser["on"+U]},set:function(fe){if(!fe)return O.removeAllListeners(U),O._parser["on"+U]=fe,fe;O.on(U,fe)},enumerable:!0,configurable:!1})})}M.prototype=Object.create(p.prototype,{constructor:{value:M}}),M.prototype.write=function(L){if(typeof i=="function"&&typeof i.isBuffer=="function"&&i.isBuffer(L)){if(!this._decoder){var D=n("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder;this._decoder=new D("utf8")}L=this._decoder.write(L)}return this._parser.write(L.toString()),this.emit("data",L),!0},M.prototype.end=function(L){return L&&L.length&&this.write(L),this._parser.end(),!0},M.prototype.on=function(L,D){var O=this;return!O._parser["on"+L]&&E.indexOf(L)!==-1&&(O._parser["on"+L]=function(){var U=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);U.splice(0,0,L),O.emit.apply(O,U)}),p.prototype.on.call(O,L,D)};var y=`\r
	 `,_="0124356789",g="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",R=`'"`,S=y+">",x="[CDATA[",w="DOCTYPE",C="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",P={xml:C,xmlns:b};y=V(y),_=V(_),g=V(g);var A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,F=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,G=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;R=V(R),S=V(S);function V(L){return L.split("").reduce(function(D,O){return D[O]=!0,D},{})}function k(L){return Object.prototype.toString.call(L)==="[object RegExp]"}function H(L,D){return k(L)?!!D.match(L):L[D]}function J(L,D){return!H(L,D)}var K=0;o.STATE={BEGIN:K++,BEGIN_WHITESPACE:K++,TEXT:K++,TEXT_ENTITY:K++,OPEN_WAKA:K++,SGML_DECL:K++,SGML_DECL_QUOTED:K++,DOCTYPE:K++,DOCTYPE_QUOTED:K++,DOCTYPE_DTD:K++,DOCTYPE_DTD_QUOTED:K++,COMMENT_STARTING:K++,COMMENT:K++,COMMENT_ENDING:K++,COMMENT_ENDED:K++,CDATA:K++,CDATA_ENDING:K++,CDATA_ENDING_2:K++,PROC_INST:K++,PROC_INST_BODY:K++,PROC_INST_ENDING:K++,OPEN_TAG:K++,OPEN_TAG_SLASH:K++,ATTRIB:K++,ATTRIB_NAME:K++,ATTRIB_NAME_SAW_WHITE:K++,ATTRIB_VALUE:K++,ATTRIB_VALUE_QUOTED:K++,ATTRIB_VALUE_CLOSED:K++,ATTRIB_VALUE_UNQUOTED:K++,ATTRIB_VALUE_ENTITY_Q:K++,ATTRIB_VALUE_ENTITY_U:K++,CLOSE_TAG:K++,CLOSE_TAG_SAW_WHITE:K++,SCRIPT:K++,SCRIPT_ENDING:K++},o.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},o.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(o.ENTITIES).forEach(function(L){var D=o.ENTITIES[L],O=typeof D=="number"?String.fromCharCode(D):D;o.ENTITIES[L]=O});for(var ae in o.STATE)o.STATE[o.STATE[ae]]=ae;K=o.STATE;function re(L,D,O){L[D]&&L[D](O)}function le(L,D,O){L.textNode&&me(L),re(L,D,O)}function me(L){L.textNode=de(L.opt,L.textNode),L.textNode&&re(L,"ontext",L.textNode),L.textNode=""}function de(L,D){return L.trim&&(D=D.trim()),L.normalize&&(D=D.replace(/\s+/g," ")),D}function te(L,D){return me(L),L.trackPosition&&(D+=`
Line: `+L.line+`
Column: `+L.column+`
Char: `+L.c),D=new Error(D),L.error=D,re(L,"onerror",D),L}function q(L){return L.sawRoot&&!L.closedRoot&&Z(L,"Unclosed root tag"),L.state!==K.BEGIN&&L.state!==K.BEGIN_WHITESPACE&&L.state!==K.TEXT&&te(L,"Unexpected end"),me(L),L.c="",L.closed=!0,re(L,"onend"),u.call(L,L.strict,L.opt),L}function Z(L,D){if(typeof L!="object"||!(L instanceof u))throw new Error("bad call to strictFail");L.strict&&te(L,D)}function pe(L){L.strict||(L.tagName=L.tagName[L.looseCase]());var D=L.tags[L.tags.length-1]||L,O=L.tag={name:L.tagName,attributes:{}};L.opt.xmlns&&(O.ns=D.ns),L.attribList.length=0,le(L,"onopentagstart",O)}function he(L,D){var O=L.indexOf(":"),U=O<0?["",L]:L.split(":"),fe=U[0],ye=U[1];return D&&L==="xmlns"&&(fe="xmlns",ye=""),{prefix:fe,local:ye}}function Q(L){if(L.strict||(L.attribName=L.attribName[L.looseCase]()),L.attribList.indexOf(L.attribName)!==-1||L.tag.attributes.hasOwnProperty(L.attribName)){L.attribName=L.attribValue="";return}if(L.opt.xmlns){var D=he(L.attribName,!0),O=D.prefix,U=D.local;if(O==="xmlns")if(U==="xml"&&L.attribValue!==C)Z(L,"xml: prefix must be bound to "+C+`
Actual: `+L.attribValue);else if(U==="xmlns"&&L.attribValue!==b)Z(L,"xmlns: prefix must be bound to "+b+`
Actual: `+L.attribValue);else{var fe=L.tag,ye=L.tags[L.tags.length-1]||L;fe.ns===ye.ns&&(fe.ns=Object.create(ye.ns)),fe.ns[U]=L.attribValue}L.attribList.push([L.attribName,L.attribValue])}else L.tag.attributes[L.attribName]=L.attribValue,le(L,"onattribute",{name:L.attribName,value:L.attribValue});L.attribName=L.attribValue=""}function Y(L,D){if(L.opt.xmlns){var O=L.tag,U=he(L.tagName);O.prefix=U.prefix,O.local=U.local,O.uri=O.ns[U.prefix]||"",O.prefix&&!O.uri&&(Z(L,"Unbound namespace prefix: "+JSON.stringify(L.tagName)),O.uri=U.prefix);var fe=L.tags[L.tags.length-1]||L;O.ns&&fe.ns!==O.ns&&Object.keys(O.ns).forEach(function(Me){le(L,"onopennamespace",{prefix:Me,uri:O.ns[Me]})});for(var ye=0,_e=L.attribList.length;ye<_e;ye++){var ee=L.attribList[ye],j=ee[0],X=ee[1],z=he(j,!0),oe=z.prefix,se=z.local,ce=oe===""?"":O.ns[oe]||"",Se={name:j,value:X,prefix:oe,local:se,uri:ce};oe&&oe!=="xmlns"&&!ce&&(Z(L,"Unbound namespace prefix: "+JSON.stringify(oe)),Se.uri=oe),L.tag.attributes[j]=Se,le(L,"onattribute",Se)}L.attribList.length=0}L.tag.isSelfClosing=!!D,L.sawRoot=!0,L.tags.push(L.tag),le(L,"onopentag",L.tag),D||(!L.noscript&&L.tagName.toLowerCase()==="script"?L.state=K.SCRIPT:L.state=K.TEXT,L.tag=null,L.tagName=""),L.attribName=L.attribValue="",L.attribList.length=0}function ie(L){if(!L.tagName){Z(L,"Weird empty close tag."),L.textNode+="</>",L.state=K.TEXT;return}if(L.script){if(L.tagName!=="script"){L.script+="</"+L.tagName+">",L.tagName="",L.state=K.SCRIPT;return}le(L,"onscript",L.script),L.script=""}var D=L.tags.length,O=L.tagName;L.strict||(O=O[L.looseCase]());for(var U=O;D--;){var fe=L.tags[D];if(fe.name!==U)Z(L,"Unexpected close tag");else break}if(D<0){Z(L,"Unmatched closing tag: "+L.tagName),L.textNode+="</"+L.tagName+">",L.state=K.TEXT;return}L.tagName=O;for(var ye=L.tags.length;ye-- >D;){var _e=L.tag=L.tags.pop();L.tagName=L.tag.name,le(L,"onclosetag",L.tagName);var ee={};for(var j in _e.ns)ee[j]=_e.ns[j];var X=L.tags[L.tags.length-1]||L;L.opt.xmlns&&_e.ns!==X.ns&&Object.keys(_e.ns).forEach(function(z){var oe=_e.ns[z];le(L,"onclosenamespace",{prefix:z,uri:oe})})}D===0&&(L.closedRoot=!0),L.tagName=L.attribValue=L.attribName="",L.attribList.length=0,L.state=K.TEXT}function ue(L){var D=L.entity,O=D.toLowerCase(),U,fe="";return L.ENTITIES[D]?L.ENTITIES[D]:L.ENTITIES[O]?L.ENTITIES[O]:(D=O,D.charAt(0)==="#"&&(D.charAt(1)==="x"?(D=D.slice(2),U=parseInt(D,16),fe=U.toString(16)):(D=D.slice(1),U=parseInt(D,10),fe=U.toString(10))),D=D.replace(/^0+/,""),fe.toLowerCase()!==D?(Z(L,"Invalid character entity"),"&"+L.entity+";"):String.fromCodePoint(U))}function $(L,D){D==="<"?(L.state=K.OPEN_WAKA,L.startTagPosition=L.position):J(y,D)&&(Z(L,"Non-whitespace before first tag."),L.textNode=D,L.state=K.TEXT)}function W(L,D){var O="";return D<L.length&&(O=L.charAt(D)),O}function B(L){var D=this;if(this.error)throw this.error;if(D.closed)return te(D,"Cannot write after close. Assign an onready handler.");if(L===null)return q(D);typeof L=="object"&&(L=L.toString());for(var O=0,U="";U=W(L,O++),D.c=U,!!U;)switch(D.trackPosition&&(D.position++,U===`
`?(D.line++,D.column=0):D.column++),D.state){case K.BEGIN:if(D.state=K.BEGIN_WHITESPACE,U==="\uFEFF")continue;$(D,U);continue;case K.BEGIN_WHITESPACE:$(D,U);continue;case K.TEXT:if(D.sawRoot&&!D.closedRoot){for(var fe=O-1;U&&U!=="<"&&U!=="&";)U=W(L,O++),U&&D.trackPosition&&(D.position++,U===`
`?(D.line++,D.column=0):D.column++);D.textNode+=L.substring(fe,O-1)}U==="<"&&!(D.sawRoot&&D.closedRoot&&!D.strict)?(D.state=K.OPEN_WAKA,D.startTagPosition=D.position):(J(y,U)&&(!D.sawRoot||D.closedRoot)&&Z(D,"Text data outside of root node."),U==="&"?D.state=K.TEXT_ENTITY:D.textNode+=U);continue;case K.SCRIPT:U==="<"?D.state=K.SCRIPT_ENDING:D.script+=U;continue;case K.SCRIPT_ENDING:U==="/"?D.state=K.CLOSE_TAG:(D.script+="<"+U,D.state=K.SCRIPT);continue;case K.OPEN_WAKA:if(U==="!")D.state=K.SGML_DECL,D.sgmlDecl="";else if(!H(y,U))if(H(A,U))D.state=K.OPEN_TAG,D.tagName=U;else if(U==="/")D.state=K.CLOSE_TAG,D.tagName="";else if(U==="?")D.state=K.PROC_INST,D.procInstName=D.procInstBody="";else{if(Z(D,"Unencoded <"),D.startTagPosition+1<D.position){var ye=D.position-D.startTagPosition;U=new Array(ye).join(" ")+U}D.textNode+="<"+U,D.state=K.TEXT}continue;case K.SGML_DECL:(D.sgmlDecl+U).toUpperCase()===x?(le(D,"onopencdata"),D.state=K.CDATA,D.sgmlDecl="",D.cdata=""):D.sgmlDecl+U==="--"?(D.state=K.COMMENT,D.comment="",D.sgmlDecl=""):(D.sgmlDecl+U).toUpperCase()===w?(D.state=K.DOCTYPE,(D.doctype||D.sawRoot)&&Z(D,"Inappropriately located doctype declaration"),D.doctype="",D.sgmlDecl=""):U===">"?(le(D,"onsgmldeclaration",D.sgmlDecl),D.sgmlDecl="",D.state=K.TEXT):(H(R,U)&&(D.state=K.SGML_DECL_QUOTED),D.sgmlDecl+=U);continue;case K.SGML_DECL_QUOTED:U===D.q&&(D.state=K.SGML_DECL,D.q=""),D.sgmlDecl+=U;continue;case K.DOCTYPE:U===">"?(D.state=K.TEXT,le(D,"ondoctype",D.doctype),D.doctype=!0):(D.doctype+=U,U==="["?D.state=K.DOCTYPE_DTD:H(R,U)&&(D.state=K.DOCTYPE_QUOTED,D.q=U));continue;case K.DOCTYPE_QUOTED:D.doctype+=U,U===D.q&&(D.q="",D.state=K.DOCTYPE);continue;case K.DOCTYPE_DTD:D.doctype+=U,U==="]"?D.state=K.DOCTYPE:H(R,U)&&(D.state=K.DOCTYPE_DTD_QUOTED,D.q=U);continue;case K.DOCTYPE_DTD_QUOTED:D.doctype+=U,U===D.q&&(D.state=K.DOCTYPE_DTD,D.q="");continue;case K.COMMENT:U==="-"?D.state=K.COMMENT_ENDING:D.comment+=U;continue;case K.COMMENT_ENDING:U==="-"?(D.state=K.COMMENT_ENDED,D.comment=de(D.opt,D.comment),D.comment&&le(D,"oncomment",D.comment),D.comment=""):(D.comment+="-"+U,D.state=K.COMMENT);continue;case K.COMMENT_ENDED:U!==">"?(Z(D,"Malformed comment"),D.comment+="--"+U,D.state=K.COMMENT):D.state=K.TEXT;continue;case K.CDATA:U==="]"?D.state=K.CDATA_ENDING:D.cdata+=U;continue;case K.CDATA_ENDING:U==="]"?D.state=K.CDATA_ENDING_2:(D.cdata+="]"+U,D.state=K.CDATA);continue;case K.CDATA_ENDING_2:U===">"?(D.cdata&&le(D,"oncdata",D.cdata),le(D,"onclosecdata"),D.cdata="",D.state=K.TEXT):U==="]"?D.cdata+="]":(D.cdata+="]]"+U,D.state=K.CDATA);continue;case K.PROC_INST:U==="?"?D.state=K.PROC_INST_ENDING:H(y,U)?D.state=K.PROC_INST_BODY:D.procInstName+=U;continue;case K.PROC_INST_BODY:if(!D.procInstBody&&H(y,U))continue;U==="?"?D.state=K.PROC_INST_ENDING:D.procInstBody+=U;continue;case K.PROC_INST_ENDING:U===">"?(le(D,"onprocessinginstruction",{name:D.procInstName,body:D.procInstBody}),D.procInstName=D.procInstBody="",D.state=K.TEXT):(D.procInstBody+="?"+U,D.state=K.PROC_INST_BODY);continue;case K.OPEN_TAG:H(I,U)?D.tagName+=U:(pe(D),U===">"?Y(D):U==="/"?D.state=K.OPEN_TAG_SLASH:(J(y,U)&&Z(D,"Invalid character in tag name"),D.state=K.ATTRIB));continue;case K.OPEN_TAG_SLASH:U===">"?(Y(D,!0),ie(D)):(Z(D,"Forward-slash in opening tag not followed by >"),D.state=K.ATTRIB);continue;case K.ATTRIB:if(H(y,U))continue;U===">"?Y(D):U==="/"?D.state=K.OPEN_TAG_SLASH:H(A,U)?(D.attribName=U,D.attribValue="",D.state=K.ATTRIB_NAME):Z(D,"Invalid attribute name");continue;case K.ATTRIB_NAME:U==="="?D.state=K.ATTRIB_VALUE:U===">"?(Z(D,"Attribute without value"),D.attribValue=D.attribName,Q(D),Y(D)):H(y,U)?D.state=K.ATTRIB_NAME_SAW_WHITE:H(I,U)?D.attribName+=U:Z(D,"Invalid attribute name");continue;case K.ATTRIB_NAME_SAW_WHITE:if(U==="=")D.state=K.ATTRIB_VALUE;else{if(H(y,U))continue;Z(D,"Attribute without value"),D.tag.attributes[D.attribName]="",D.attribValue="",le(D,"onattribute",{name:D.attribName,value:""}),D.attribName="",U===">"?Y(D):H(A,U)?(D.attribName=U,D.state=K.ATTRIB_NAME):(Z(D,"Invalid attribute name"),D.state=K.ATTRIB)}continue;case K.ATTRIB_VALUE:if(H(y,U))continue;H(R,U)?(D.q=U,D.state=K.ATTRIB_VALUE_QUOTED):(Z(D,"Unquoted attribute value"),D.state=K.ATTRIB_VALUE_UNQUOTED,D.attribValue=U);continue;case K.ATTRIB_VALUE_QUOTED:if(U!==D.q){U==="&"?D.state=K.ATTRIB_VALUE_ENTITY_Q:D.attribValue+=U;continue}Q(D),D.q="",D.state=K.ATTRIB_VALUE_CLOSED;continue;case K.ATTRIB_VALUE_CLOSED:H(y,U)?D.state=K.ATTRIB:U===">"?Y(D):U==="/"?D.state=K.OPEN_TAG_SLASH:H(A,U)?(Z(D,"No whitespace between attributes"),D.attribName=U,D.attribValue="",D.state=K.ATTRIB_NAME):Z(D,"Invalid attribute name");continue;case K.ATTRIB_VALUE_UNQUOTED:if(J(S,U)){U==="&"?D.state=K.ATTRIB_VALUE_ENTITY_U:D.attribValue+=U;continue}Q(D),U===">"?Y(D):D.state=K.ATTRIB;continue;case K.CLOSE_TAG:if(D.tagName)U===">"?ie(D):H(I,U)?D.tagName+=U:D.script?(D.script+="</"+D.tagName,D.tagName="",D.state=K.SCRIPT):(J(y,U)&&Z(D,"Invalid tagname in closing tag"),D.state=K.CLOSE_TAG_SAW_WHITE);else{if(H(y,U))continue;J(A,U)?D.script?(D.script+="</"+U,D.state=K.SCRIPT):Z(D,"Invalid tagname in closing tag."):D.tagName=U}continue;case K.CLOSE_TAG_SAW_WHITE:if(H(y,U))continue;U===">"?ie(D):Z(D,"Invalid characters in closing tag");continue;case K.TEXT_ENTITY:case K.ATTRIB_VALUE_ENTITY_Q:case K.ATTRIB_VALUE_ENTITY_U:var _e,ee;switch(D.state){case K.TEXT_ENTITY:_e=K.TEXT,ee="textNode";break;case K.ATTRIB_VALUE_ENTITY_Q:_e=K.ATTRIB_VALUE_QUOTED,ee="attribValue";break;case K.ATTRIB_VALUE_ENTITY_U:_e=K.ATTRIB_VALUE_UNQUOTED,ee="attribValue";break}U===";"?(D[ee]+=ue(D),D.entity="",D.state=_e):H(D.entity.length?G:F,U)?D.entity+=U:(Z(D,"Invalid character in entity name"),D[ee]+="&"+D.entity+U,D.entity="",D.state=_e);continue;default:throw new Error(D,"Unknown state: "+D.state)}return D.position>=D.bufferCheckPosition&&c(D),D}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var L=String.fromCharCode,D=Math.floor,O=function(){var U=16384,fe=[],ye,_e,ee=-1,j=arguments.length;if(!j)return"";for(var X="";++ee<j;){var z=Number(arguments[ee]);if(!isFinite(z)||z<0||z>1114111||D(z)!==z)throw RangeError("Invalid code point: "+z);z<=65535?fe.push(z):(z-=65536,ye=(z>>10)+55296,_e=z%1024+56320,fe.push(ye,_e)),(ee+1===j||fe.length>U)&&(X+=L.apply(null,fe),fe.length=0)}return X};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:O,configurable:!0,writable:!0}):String.fromCodePoint=O}()})(r)}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/setimmediate/setImmediate.js":function(t,r,n){(function(i,o){(function(l,u){if(l.setImmediate)return;var c=1,f={},h=!1,p=l.document,E;function v(P){typeof P!="function"&&(P=new Function(""+P));for(var A=new Array(arguments.length-1),I=0;I<A.length;I++)A[I]=arguments[I+1];var F={callback:P,args:A};return f[c]=F,E(c),c++}function M(P){delete f[P]}function y(P){var A=P.callback,I=P.args;switch(I.length){case 0:A();break;case 1:A(I[0]);break;case 2:A(I[0],I[1]);break;case 3:A(I[0],I[1],I[2]);break;default:A.apply(u,I);break}}function _(P){if(h)setTimeout(_,0,P);else{var A=f[P];if(A){h=!0;try{y(A)}finally{M(P),h=!1}}}}function g(){E=function(P){o.nextTick(function(){_(P)})}}function R(){if(l.postMessage&&!l.importScripts){var P=!0,A=l.onmessage;return l.onmessage=function(){P=!1},l.postMessage("","*"),l.onmessage=A,P}}function S(){var P="setImmediate$"+Math.random()+"$",A=function(I){I.source===l&&typeof I.data=="string"&&I.data.indexOf(P)===0&&_(+I.data.slice(P.length))};l.addEventListener?l.addEventListener("message",A,!1):l.attachEvent("onmessage",A),E=function(I){l.postMessage(P+I,"*")}}function x(){var P=new MessageChannel;P.port1.onmessage=function(A){var I=A.data;_(I)},E=function(A){P.port2.postMessage(A)}}function w(){var P=p.documentElement;E=function(A){var I=p.createElement("script");I.onreadystatechange=function(){_(A),I.onreadystatechange=null,P.removeChild(I),I=null},P.appendChild(I)}}function C(){E=function(P){setTimeout(_,0,P)}}var b=Object.getPrototypeOf&&Object.getPrototypeOf(l);b=b&&b.setTimeout?b:l,{}.toString.call(l.process)==="[object process]"?g():R()?S():l.MessageChannel?x():p&&"onreadystatechange"in p.createElement("script")?w():C(),b.setImmediate=v,b.clearImmediate=M})(typeof self=="undefined"?typeof i=="undefined"?this:i:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/stream-browserify/index.js":function(t,r,n){t.exports=l;var i=n("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter,o=n("./node_modules/inherits/inherits_browser.js");o(l,i),l.Readable=n("./node_modules/readable-stream/readable-browser.js"),l.Writable=n("./node_modules/readable-stream/writable-browser.js"),l.Duplex=n("./node_modules/readable-stream/duplex-browser.js"),l.Transform=n("./node_modules/readable-stream/transform.js"),l.PassThrough=n("./node_modules/readable-stream/passthrough.js"),l.Stream=l;function l(){i.call(this)}l.prototype.pipe=function(u,c){var f=this;function h(g){u.writable&&u.write(g)===!1&&f.pause&&f.pause()}f.on("data",h);function p(){f.readable&&f.resume&&f.resume()}u.on("drain",p),!u._isStdio&&(!c||c.end!==!1)&&(f.on("end",v),f.on("close",M));var E=!1;function v(){E||(E=!0,u.end())}function M(){E||(E=!0,typeof u.destroy=="function"&&u.destroy())}function y(g){if(_(),i.listenerCount(this,"error")===0)throw g}f.on("error",y),u.on("error",y);function _(){f.removeListener("data",h),u.removeListener("drain",p),f.removeListener("end",v),f.removeListener("close",M),f.removeListener("error",y),u.removeListener("error",y),f.removeListener("end",_),f.removeListener("close",_),u.removeListener("close",_)}return f.on("end",_),f.on("close",_),u.on("close",_),u.emit("pipe",f),u}},"./node_modules/string_decoder/lib/string_decoder.js":function(t,r,n){var i=n("./node_modules/safe-buffer/index.js").Buffer,o=i.isEncoding||function(w){switch(w=""+w,w&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(w){if(!w)return"utf8";for(var C;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(C)return;w=(""+w).toLowerCase(),C=!0}}function u(w){var C=l(w);if(typeof C!="string"&&(i.isEncoding===o||!o(w)))throw new Error("Unknown encoding: "+w);return C||w}r.StringDecoder=c;function c(w){this.encoding=u(w);var C;switch(this.encoding){case"utf16le":this.text=y,this.end=_,C=4;break;case"utf8":this.fillLast=E,C=4;break;case"base64":this.text=g,this.end=R,C=3;break;default:this.write=S,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(C)}c.prototype.write=function(w){if(w.length===0)return"";var C,b;if(this.lastNeed){if(C=this.fillLast(w),C===void 0)return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<w.length?C?C+this.text(w,b):this.text(w,b):C||""},c.prototype.end=M,c.prototype.text=v,c.prototype.fillLast=function(w){if(this.lastNeed<=w.length)return w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),this.lastNeed-=w.length};function f(w){return w<=127?0:w>>5==6?2:w>>4==14?3:w>>3==30?4:w>>6==2?-1:-2}function h(w,C,b){var P=C.length-1;if(P<b)return 0;var A=f(C[P]);return A>=0?(A>0&&(w.lastNeed=A-1),A):--P<b||A===-2?0:(A=f(C[P]),A>=0?(A>0&&(w.lastNeed=A-2),A):--P<b||A===-2?0:(A=f(C[P]),A>=0?(A>0&&(A===2?A=0:w.lastNeed=A-3),A):0))}function p(w,C,b){if((C[0]&192)!=128)return w.lastNeed=0,"\uFFFD";if(w.lastNeed>1&&C.length>1){if((C[1]&192)!=128)return w.lastNeed=1,"\uFFFD";if(w.lastNeed>2&&C.length>2&&(C[2]&192)!=128)return w.lastNeed=2,"\uFFFD"}}function E(w){var C=this.lastTotal-this.lastNeed,b=p(this,w);if(b!==void 0)return b;if(this.lastNeed<=w.length)return w.copy(this.lastChar,C,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,C,0,w.length),this.lastNeed-=w.length}function v(w,C){var b=h(this,w,C);if(!this.lastNeed)return w.toString("utf8",C);this.lastTotal=b;var P=w.length-(b-this.lastNeed);return w.copy(this.lastChar,0,P),w.toString("utf8",C,P)}function M(w){var C=w&&w.length?this.write(w):"";return this.lastNeed?C+"\uFFFD":C}function y(w,C){if((w.length-C)%2==0){var b=w.toString("utf16le",C);if(b){var P=b.charCodeAt(b.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",C,w.length-1)}function _(w){var C=w&&w.length?this.write(w):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return C+this.lastChar.toString("utf16le",0,b)}return C}function g(w,C){var b=(w.length-C)%3;return b===0?w.toString("base64",C):(this.lastNeed=3-b,this.lastTotal=3,b===1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",C,w.length-b))}function R(w){var C=w&&w.length?this.write(w):"";return this.lastNeed?C+this.lastChar.toString("base64",0,3-this.lastNeed):C}function S(w){return w.toString(this.encoding)}function x(w){return w&&w.length?this.write(w):""}},"./node_modules/util-deprecate/browser.js":function(t,r,n){(function(i){t.exports=o;function o(u,c){if(l("noDeprecation"))return u;var f=!1;function h(){if(!f){if(l("throwDeprecation"))throw new Error(c);l("traceDeprecation")?console.trace(c):console.warn(c),f=!0}return u.apply(this,arguments)}return h}function l(u){try{if(!i.localStorage)return!1}catch{return!1}var c=i.localStorage[u];return c==null?!1:String(c).toLowerCase()==="true"}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(t,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}t.exports=n},"./src/core/Debug.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js"),u=0,c=1,f=2,h=3,p=4,E=5;function v(y){y=y||{};var _=this.context,g=Object(i.default)(_).getInstance(),R=y.settings,S=[],x,w,C,b;function P(){w=!0,C=!0,b=new Date().getTime(),typeof window!="undefined"&&window.console&&(S[c]=A(window.console.error),S[f]=A(window.console.error),S[h]=A(window.console.warn),S[p]=A(window.console.info),S[E]=A(window.console.debug))}function A(re){return re&&re.bind?re.bind(window.console):window.console.log.bind(window.console)}function I(re){return{fatal:V.bind(re),error:k.bind(re),warn:H.bind(re),info:J.bind(re),debug:K.bind(re)}}function F(re){w=re}function G(re){C=re}function V(){for(var re=arguments.length,le=new Array(re),me=0;me<re;me++)le[me]=arguments[me];ae.apply(void 0,[c,this].concat(le))}function k(){for(var re=arguments.length,le=new Array(re),me=0;me<re;me++)le[me]=arguments[me];ae.apply(void 0,[f,this].concat(le))}function H(){for(var re=arguments.length,le=new Array(re),me=0;me<re;me++)le[me]=arguments[me];ae.apply(void 0,[h,this].concat(le))}function J(){for(var re=arguments.length,le=new Array(re),me=0;me<re;me++)le[me]=arguments[me];ae.apply(void 0,[p,this].concat(le))}function K(){for(var re=arguments.length,le=new Array(re),me=0;me<re;me++)le[me]=arguments[me];ae.apply(void 0,[E,this].concat(le))}function ae(re,le){var me="",de=null;w&&(de=new Date().getTime(),me+="["+(de-b)+"]"),C&&le&&le.getClassName&&(me+="["+le.getClassName()+"]",le.getType&&(me+="["+le.getType()+"]")),me.length>0&&(me+=" ");for(var te=arguments.length,q=new Array(te>2?te-2:0),Z=2;Z<te;Z++)q[Z-2]=arguments[Z];Array.apply(null,q).forEach(function(pe){me+=pe+" "}),S[re]&&R.get().debug.logLevel>=re&&S[re](me),R&&R.get().debug.dispatchEvent&&g.trigger(o.default.LOG,{message:me,level:re})}return x={getLogger:I,setLogTimestampVisible:F,setCalleeNameVisible:G},P(),x}v.__dashjs_factory_name="Debug";var M=l.default.getSingletonFactory(v);M.LOG_LEVEL_NONE=u,M.LOG_LEVEL_FATAL=c,M.LOG_LEVEL_ERROR=f,M.LOG_LEVEL_WARNING=h,M.LOG_LEVEL_INFO=p,M.LOG_LEVEL_DEBUG=E,l.default.updateSingletonFactory(v.__dashjs_factory_name,M),r.default=M},"./src/core/EventBus.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/MediaPlayerEvents.js"),l=0,u=5e3;function c(){var h={};function p(g,R,S){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!g)throw new Error("event type cannot be null or undefined");if(!R||typeof R!="function")throw new Error("listener must be a function: "+R);var w=x.priority||l;if(!(M(g,R,S)>=0)){h[g]=h[g]||[];var C={callback:R,scope:S,priority:w};S&&S.getStreamId&&(C.streamId=S.getStreamId()),S&&S.getType&&(C.mediaType=S.getType()),x&&x.mode&&(C.mode=x.mode);var b=h[g].some(function(P,A){if(P&&w>P.priority)return h[g].splice(A,0,C),!0});b||h[g].push(C)}}function E(g,R,S){if(!(!g||!R||!h[g])){var x=M(g,R,S);x<0||(h[g][x]=null)}}function v(g){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!g||!h[g])){if(R=R||{},R.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");R.type=g,S.streamId&&(R.streamId=S.streamId),S.mediaType&&(R.mediaType=S.mediaType),h[g].filter(function(x){return!(!x||S.streamId&&x.streamId&&x.streamId!==S.streamId||S.mediaType&&x.mediaType&&x.mediaType!==S.mediaType||S.mode&&x.mode&&x.mode!==S.mode||!x.mode&&S.mode&&S.mode===o.default.EVENT_MODE_ON_RECEIVE)}).forEach(function(x){return x&&x.callback.call(x.scope,R)})}}function M(g,R,S){var x=-1;return h[g]&&h[g].some(function(w,C){if(w&&w.callback===R&&(!S||S===w.scope))return x=C,!0}),x}function y(){h={}}var _={on:p,off:E,trigger:v,reset:y};return _}c.__dashjs_factory_name="EventBus";var f=i.default.getSingletonFactory(c);f.EVENT_PRIORITY_LOW=l,f.EVENT_PRIORITY_HIGH=u,i.default.updateSingletonFactory(c.__dashjs_factory_name,f),r.default=f},"./src/core/FactoryMaker.js":function(t,r,n){n.r(r);var i=function(){var o,l=[],u={},c={};function f(C,b,P,A){!A[C]&&b&&(A[C]={instance:b,override:P})}function h(C,b){for(var P in l){var A=l[P];if(A.context===C&&A.name===b)return A.instance}return null}function p(C,b,P){for(var A in l){var I=l[A];if(I.context===C&&I.name===b){l[A].instance=P;return}}l.push({name:b,context:C,instance:P})}function E(C){l=l.filter(function(b){return b.context!==C})}function v(C,b){return b[C]}function M(C,b,P){C in P&&(P[C]=b)}function y(C,b){M(C,b,c)}function _(C){return v(C,c)}function g(C){var b=v(C.__dashjs_factory_name,c);return b||(b=function(A){return A===void 0&&(A={}),{create:function(){return w(C,A,arguments)}}},c[C.__dashjs_factory_name]=b),b}function R(C,b){M(C,b,u)}function S(C){return v(C,u)}function x(C){var b=v(C.__dashjs_factory_name,u);return b||(b=function(A){var I;return A===void 0&&(A={}),{getInstance:function(){return I||(I=h(A,C.__dashjs_factory_name)),I||(I=w(C,A,arguments),l.push({name:C.__dashjs_factory_name,context:A,instance:I})),I}}},u[C.__dashjs_factory_name]=b),b}function w(C,b,P){var A,I=C.__dashjs_factory_name,F=b[I];if(F){var G=F.instance;if(F.override){A=C.apply({context:b},P),G=G.apply({context:b,factory:o,parent:A},P);for(var V in G)A.hasOwnProperty(V)&&(A[V]=G[V])}else return G.apply({context:b,factory:o},P)}else A=C.apply({context:b},P);return A.getClassName=function(){return I},A}return o={extend:f,getSingletonInstance:h,setSingletonInstance:p,deleteSingletonInstances:E,getSingletonFactory:x,getSingletonFactoryByName:S,updateSingletonFactory:R,getClassFactory:g,getClassFactoryByName:_,updateClassFactory:y},o}();r.default=i},"./src/core/Settings.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Utils.js"),l=n("./src/core/Debug.js"),u=n("./src/streaming/constants/Constants.js"),c=n("./src/streaming/vo/metrics/HTTPRequest.js");function f(v){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?f=function(y){return typeof y}:f=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},f(v)}function h(v,M,y){return M in v?Object.defineProperty(v,M,{value:y,enumerable:!0,configurable:!0,writable:!0}):v[M]=y,v}function p(){var v,M,y,_={debug:{logLevel:l.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,lowLatencyEnabled:!1,lowLatencyEnabledByManifest:!0,manifestUpdateRetryInterval:100,cacheInitSegments:!1,eventControllerRefreshDelay:150,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0,applyServiceDescription:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0},liveCatchup:{minDrift:.02,maxDrift:12,playbackRate:.5,latencyThreshold:60,playbackBufferMin:.5,enabled:!1,mode:u.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:u.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:u.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:u.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:0,retryIntervals:(v={},h(v,c.HTTPRequest.MPD_TYPE,500),h(v,c.HTTPRequest.XLINK_EXPANSION_TYPE,500),h(v,c.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),h(v,c.HTTPRequest.INIT_SEGMENT_TYPE,1e3),h(v,c.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),h(v,c.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),h(v,c.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),h(v,c.HTTPRequest.LICENSE,1e3),h(v,c.HTTPRequest.OTHER_TYPE,1e3),h(v,"lowLatencyReductionFactor",10),v),retryAttempts:(M={},h(M,c.HTTPRequest.MPD_TYPE,3),h(M,c.HTTPRequest.XLINK_EXPANSION_TYPE,1),h(M,c.HTTPRequest.MEDIA_SEGMENT_TYPE,3),h(M,c.HTTPRequest.INIT_SEGMENT_TYPE,3),h(M,c.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),h(M,c.HTTPRequest.INDEX_SEGMENT_TYPE,3),h(M,c.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),h(M,c.HTTPRequest.LICENSE,3),h(M,c.HTTPRequest.OTHER_TYPE,3),h(M,"lowLatencyMultiplyFactor",5),M),abr:{movingAverageMethod:u.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:u.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!1},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:u.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:u.default.CMCD_MODE_QUERY}},errors:{recoverAttempts:{mediaErrorDecode:5}}},g=o.default.clone(_);function R(C,b,P){for(var A in C)C.hasOwnProperty(A)&&b.hasOwnProperty(A)&&(f(C[A])==="object"&&C[A]!==null?R(C[A],b[A],P.slice()+A+"."):b[A]=o.default.clone(C[A]))}function S(){return g}function x(C){f(C)==="object"&&R(C,g,"")}function w(){g=o.default.clone(_)}return y={get:S,update:x,reset:w},y}p.__dashjs_factory_name="Settings";var E=i.default.getSingletonFactory(p);r.default=E},"./src/core/Utils.js":function(t,r,n){n.r(r);var i=n("./node_modules/path-browserify/index.js"),o=n.n(i);function l(p){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(v){return typeof v}:l=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},l(p)}function u(p,E){if(!(p instanceof E))throw new TypeError("Cannot call a class as a function")}function c(p,E){for(var v=0;v<E.length;v++){var M=E[v];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(p,M.key,M)}}function f(p,E,v){return E&&c(p.prototype,E),v&&c(p,v),p}var h=function(){function p(){u(this,p)}return f(p,null,[{key:"mixin",value:function(v,M,y){var _,g={};if(v)for(var R in M)M.hasOwnProperty(R)&&(_=M[R],(!(R in v)||v[R]!==_&&(!(R in g)||g[R]!==_))&&(l(v[R])==="object"&&v[R]!==null?v[R]=p.mixin(v[R],_,y):v[R]=y(_)));return v}},{key:"clone",value:function(v){if(!v||l(v)!=="object")return v;var M;if(v instanceof Array){M=[];for(var y=0,_=v.length;y<_;++y)y in v&&M.push(p.clone(v[y]))}else M={};return p.mixin(M,v,p.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(v,M){try{if(!M||M.length===0)return v;var y=new URL(v);return M.forEach(function(_){_.key&&_.value&&y.searchParams.set(_.key,_.value)}),y.href}catch{return v}}},{key:"parseHttpHeaders",value:function(v){var M={};if(!v)return M;for(var y=v.trim().split(`\r
`),_=0,g=y.length;_<g;_++){var R=y[_],S=R.indexOf(": ");S>0&&(M[R.substring(0,S)]=R.substring(S+2))}return M}},{key:"generateUuid",value:function(){var v=new Date().getTime(),M="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(y){var _=(v+Math.random()*16)%16|0;return v=Math.floor(v/16),(y=="x"?_:_&3|8).toString(16)});return M}},{key:"generateHashCode",value:function(v){var M=0;if(v.length===0)return M;for(var y=0;y<v.length;y++){var _=v.charCodeAt(y);M=(M<<5)-M+_,M|=0}return M}},{key:"getRelativeUrl",value:function(v,M){try{var y=new URL(v),_=new URL(M);if(y.protocol=_.protocol,y.origin!==_.origin)return M;var g=o.a.relative(y.pathname.substr(0,y.pathname.lastIndexOf("/")),_.pathname.substr(0,_.pathname.lastIndexOf("/"))),R=g.length===0?1:0;return g+=_.pathname.substr(_.pathname.lastIndexOf("/")+R,_.pathname.length-1),_.pathname.length<g.length?_.pathname:g}catch{return M}}}]),p}();r.default=h},"./src/core/Version.js":function(t,r,n){n.r(r),n.d(r,"getVersionString",function(){return o});var i="4.2.1";function o(){return i}},"./src/core/errors/Errors.js":function(t,r,n){n.r(r);var i=n("./src/core/errors/ErrorsBase.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){var S;return l(this,R),S=g.call(this),S.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,S.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,S.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,S.SEGMENT_BASE_LOADER_ERROR_CODE=15,S.TIME_SYNC_FAILED_ERROR_CODE=16,S.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,S.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,S.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,S.APPEND_ERROR_CODE=20,S.REMOVE_ERROR_CODE=21,S.DATA_UPDATE_FAILED_ERROR_CODE=22,S.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,S.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,S.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,S.DOWNLOAD_ERROR_ID_SIDX_CODE=26,S.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,S.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,S.DOWNLOAD_ERROR_ID_XLINK_CODE=29,S.MANIFEST_ERROR_ID_PARSE_CODE=31,S.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,S.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,S.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,S.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,S.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",S.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",S.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",S.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",S.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",S.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",S.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",S.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",S.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",S.APPEND_ERROR_MESSAGE="chunk is not defined",S.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",S.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",S.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",S.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",S.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",S.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",S}return R}(i.default),y=new M;r.default=y},"./src/core/errors/ErrorsBase.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(){i(this,c)}return l(c,[{key:"extend",value:function(h,p){if(!!h){var E=p?p.override:!1,v=p?p.publicOnly:!1;for(var M in h)!h.hasOwnProperty(M)||this[M]&&!E||v&&h[M].indexOf("public_")===-1||(this[M]=h[M])}}}]),c}();r.default=u},"./src/core/events/CoreEvents.js":function(t,r,n){n.r(r);var i=n("./src/core/events/EventsBase.js");function o(y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(g){return typeof g}:o=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},o(y)}function l(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}function u(y,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(_&&_.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),_&&c(y,_)}function c(y,_){return c=Object.setPrototypeOf||function(R,S){return R.__proto__=S,R},c(y,_)}function f(y){var _=E();return function(){var R=v(y),S;if(_){var x=v(this).constructor;S=Reflect.construct(R,arguments,x)}else S=R.apply(this,arguments);return h(this,S)}}function h(y,_){return _&&(o(_)==="object"||typeof _=="function")?_:p(y)}function p(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(y){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},v(y)}var M=function(y){u(g,y);var _=f(g);function g(){var R;return l(this,g),R=_.call(this),R.ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",R.BUFFERING_COMPLETED="bufferingCompleted",R.BUFFER_CLEARED="bufferCleared",R.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",R.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",R.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",R.CURRENT_TRACK_CHANGED="currentTrackChanged",R.DATA_UPDATE_COMPLETED="dataUpdateCompleted",R.INBAND_EVENTS="inbandEvents",R.INITIAL_STREAM_SWITCH="initialStreamSwitch",R.INIT_FRAGMENT_LOADED="initFragmentLoaded",R.INIT_FRAGMENT_NEEDED="initFragmentNeeded",R.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",R.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",R.LOADING_COMPLETED="loadingCompleted",R.LOADING_PROGRESS="loadingProgress",R.LOADING_DATA_PROGRESS="loadingDataProgress",R.LOADING_ABANDONED="loadingAborted",R.MANIFEST_UPDATED="manifestUpdated",R.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",R.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",R.QUOTA_EXCEEDED="quotaExceeded",R.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",R.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",R.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",R.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",R.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",R.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",R.SOURCE_BUFFER_ERROR="sourceBufferError",R.STREAMS_COMPOSED="streamsComposed",R.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",R.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",R.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",R.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",R.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",R.URL_RESOLUTION_FAILED="urlResolutionFailed",R.VIDEO_CHUNK_RECEIVED="videoChunkReceived",R.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",R.XLINK_ELEMENT_LOADED="xlinkElementLoaded",R.XLINK_READY="xlinkReady",R.SEEK_TARGET="seekTarget",R}return g}(i.default);r.default=M},"./src/core/events/Events.js":function(t,r,n){n.r(r);var i=n("./src/core/events/CoreEvents.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){return l(this,R),g.apply(this,arguments)}return R}(i.default),y=new M;r.default=y},"./src/core/events/EventsBase.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(){i(this,c)}return l(c,[{key:"extend",value:function(h,p){if(!!h){var E=p?p.override:!1,v=p?p.publicOnly:!1;for(var M in h)!h.hasOwnProperty(M)||this[M]&&!E||v&&h[M].indexOf("public_")===-1||(this[M]=h[M])}}}]),c}();r.default=u},"./src/dash/DashAdapter.js":function(t,r,n){n.r(r);var i=n("./src/dash/constants/DashConstants.js"),o=n("./src/dash/vo/RepresentationInfo.js"),l=n("./src/dash/vo/MediaInfo.js"),u=n("./src/dash/vo/StreamInfo.js"),c=n("./src/dash/vo/ManifestInfo.js"),f=n("./src/dash/vo/Event.js"),h=n("./src/core/FactoryMaker.js"),p=n("./src/dash/models/DashManifestModel.js"),E=n("./src/dash/models/PatchManifestModel.js");function v(){var M,y,_,g,R,S,x,w=this.context,C="urn:dvb:dash:profile:dvb-dash:2014";function b(){y=Object(p.default)(w).getInstance(),_=Object(E.default)(w).getInstance(),se()}function P(Oe){!Oe||(Oe.constants&&(S=Oe.constants),Oe.cea608parser&&(x=Oe.cea608parser),Oe.errHandler&&y.setConfig({errHandler:Oe.errHandler}),Oe.BASE64&&y.setConfig({BASE64:Oe.BASE64}))}function A(Oe){if(Oe){var ze=new o.default,Fe=Oe.adaptation.period.mpd.manifest.Period_asArray[Oe.adaptation.period.index].AdaptationSet_asArray[Oe.adaptation.index],Ce=y.getRepresentationFor(Oe.index,Fe);return ze.id=Oe.id,ze.quality=Oe.index,ze.bandwidth=y.getBandwidth(Ce),ze.fragmentDuration=Oe.segmentDuration||(Oe.segments&&Oe.segments.length>0?Oe.segments[0].duration:NaN),ze.MSETimeOffset=Oe.MSETimeOffset,ze.mediaInfo=Ne(Oe.adaptation),ze}else return null}function I(Oe,ze){if(g.length===0||!Oe)return null;var Fe=be(Oe,g);if(!Fe)return null;var Ce=y.getAdaptationsForPeriod(Fe),we=G(Oe.index,ze,Oe);if(!we)return null;var Qe=y.getIndexForAdaptation(we,g[0].mpd.manifest,Oe.index);return Ne(Ce[Qe])}function F(Oe){return y.getRolesForAdaptation(Oe).filter(function(ze){return ze.value===i.default.MAIN})[0]}function G(Oe,ze,Fe){var Ce=y.getAdaptationsForType(g[0].mpd.manifest,Oe,ze);if(!Ce||Ce.length===0)return null;if(Ce.length>1&&Fe){var we=H(Fe,ze);if(R[Fe.id]&&R[Fe.id][ze]){for(var Qe=0,it=Ce.length;Qe<it;Qe++)if(V(R[Fe.id][ze],we[Qe]))return Ce[Qe]}for(var st=0,at=Ce.length;st<at;st++)if(F(Ce[st]))return Ce[st]}return Ce[0]}function V(Oe,ze){if(!Oe||!ze)return!1;var Fe=Oe.id===ze.id,Ce=Oe.codec===ze.codec,we=Oe.viewpoint===ze.viewpoint,Qe=Oe.lang===ze.lang,it=Oe.roles.toString()===ze.roles.toString(),st=Oe.accessibility.toString()===ze.accessibility.toString(),at=Oe.audioChannelConfiguration.toString()===ze.audioChannelConfiguration.toString();return Fe&&Ce&&we&&Qe&&it&&st&&at}function k(Oe,ze,Fe,Ce,we,Qe){var it=[],st,at,Ae,Be,We,Te;if(!Ce||Ce.length===0)return[];var De=y.getAdaptationsForPeriod(ze);for(Be=0,Te=Ce.length;Be<Te;Be++)if(st=Ce[Be],Ae=y.getIndexForAdaptation(st,Oe,Fe.index),at=Ne(De[Ae]),Qe){var Ze=at.accessibility.length;for(We=0;We<Ze;We++)if(!!at){var nt=at.accessibility[We];if(nt.indexOf("cea-608:")===0){var ge=nt.substring(8),Pe=ge.split(";");if(Pe[0].substring(0,2)==="CC")for(We=0;We<Pe.length;We++)at||(at=Ne.call(this,De[Ae])),Ue(at,Pe[We].substring(0,3),Pe[We].substring(4)),it.push(at),at=null;else for(We=0;We<Pe.length;We++)at||(at=Ne.call(this,De[Ae])),Ue(at,"CC"+(We+1),Pe[We]),it.push(at),at=null}else nt.indexOf("cea-608")===0&&(Ue(at,S.CC1,"eng"),it.push(at),at=null)}}else we===S.IMAGE?(Xe(at),it.push(at),at=null):at&&it.push(at);return it}function H(Oe,ze,Fe){var Ce=g,we=Fe,Qe=[];if(we)xt(),Ce=ue(we);else if(g.length>0)we=g[0].mpd.manifest;else return Qe;var it=be(Oe,Ce),st=y.getAdaptationsForType(we,Oe?Oe.index:null,ze);return Qe=k(we,it,Oe,st,ze),ze===S.TEXT&&(st=y.getAdaptationsForType(we,Oe?Oe.index:null,S.VIDEO),Qe=Qe.concat(k(we,it,Oe,st,ze,!0))),Qe}function J(Oe){if(!Oe)return null;xt(),g=ue(Oe)}function K(Oe,ze){var Fe=[],Ce=g;if(Oe&&(xt(),Ce=ue(Oe)),Ce.length>0){(!ze||ze>Ce.length)&&(ze=Ce.length);for(var we=0;we<ze;we++)Fe.push(ot(Ce[we]))}return Fe}function ae(Oe,ze){var Fe,Ce,we=be(Oe,g);return Fe=ze?ze.id:null,g.length>0&&we&&(Ce=Fe?y.getAdaptationForId(Fe,g[0].mpd.manifest,we.index):y.getAdaptationForIndex(ze?ze.index:null,g[0].mpd.manifest,we.index)),Ce}function re(Oe){try{return y.getEssentialPropertiesForRepresentation(Oe)}catch{return[]}}function le(Oe){return y.getRealPeriodForIndex(Oe,g[0].mpd.manifest)}function me(Oe){var ze,Fe=ve(Oe);return ze=y.getRepresentationsForAdaptation(Fe),ze}function de(Oe,ze,Fe,Ce){try{if(!Oe||!ze||isNaN(Fe)||!Ce)return null;var we=Oe.scheme_id_uri,Qe=Oe.value;if(!ze[we+"/"+Qe])return null;var it=new f.default,st=Oe.timescale||1,at=Ce.adaptation.period.start,Ae=ze[we+"/"+Qe],Be=isNaN(Ce.presentationTimeOffset)?isNaN(Ae.presentationTimeOffset)?0:Ae.presentationTimeOffset:Ce.presentationTimeOffset,We=Oe.presentation_time_delta/st,Te;Oe.version===0?Te=at+Fe-Be+We:Te=at-Be+We;var De=Oe.event_duration,Ze=Oe.id,nt=Oe.message_data;return it.eventStream=Ae,it.eventStream.value=Qe,it.eventStream.timescale=st,it.duration=De,it.id=Ze,it.calculatedPresentationTime=Te,it.messageData=nt,it.presentationTimeDelta=We,it}catch{return null}}function te(Oe,ze){var Fe=[];if(g.length>0){var Ce=g[0].mpd.manifest;Oe instanceof u.default?Fe=y.getEventsForPeriod(be(Oe,g)):Oe instanceof l.default?Fe=y.getEventStreamForAdaptationSet(Ce,ve(Oe)):Oe instanceof o.default&&(Fe=y.getEventStreamForRepresentation(Ce,ze))}return Fe}function q(Oe,ze,Fe){R[Oe]=R[Oe]||{},R[Oe][ze]=R[Oe][ze]||{},R[Oe][ze]=Fe}function Z(Oe){return y.getIsText(Oe)}function pe(){var Oe=Me();return y.getUTCTimingSources(Oe)}function he(){var Oe=g.length>0?g[0].mpd:null;return y.getSuggestedPresentationDelay(Oe)}function Q(Oe){var ze=$(Oe);return y.getAvailabilityStartTime(ze)}function Y(Oe){var ze=Me(Oe);return y.getIsDynamic(ze)}function ie(Oe){var ze=Me(Oe);return y.getDuration(ze)}function ue(Oe){var ze=$(Oe);return y.getRegularPeriods(ze)}function $(Oe){var ze=Me(Oe);return y.getMpd(ze)}function W(Oe){return y.getLocation(Oe)}function B(Oe){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return y.getManifestUpdatePeriod(Oe,ze)}function L(Oe){return y.getPublishTime(Oe)}function D(Oe){var ze=y.getPatchLocation(Oe),Fe=y.getPublishTime(Oe);if(!ze||!Fe)return null;if(ze.hasOwnProperty("ttl")&&Fe){var Ce=parseFloat(ze.ttl)*1e3;if(Fe.getTime()+Ce<=new Date().getTime())return null}return ze.__text}function O(Oe){return y.hasProfile(Oe,C)}function U(Oe){return _.getIsPatch(Oe)}function fe(Oe){return y.getBaseURLsFromElement(Oe)}function ye(){return y.getRepresentationSortFunction()}function _e(Oe,ze,Fe){return y.getCodec(Oe,ze,Fe)}function ee(Oe,ze){var Fe,Ce=Bt(ze);return Fe=Pt(Ce,Oe),Fe?Fe.bandwidth:null}function j(Oe,ze){var Fe=Bt(ze);return Lt(Fe,Oe)}function X(Oe,ze){var Fe=Bt(ze);return Ht(Fe,Oe)}function z(Oe){if(!Oe||g.length===0)return null;var ze=g.filter(function(Fe){return Fe.id===Oe});return ze&&ze.length>0?ze[0]:null}function oe(Oe,ze){return y.getIsTypeOf(Oe,ze)}function se(){g=[],R={}}function ce(Oe,ze){var Fe=y.getId(Oe),Ce=_.getMpdId(ze),we=y.getPublishTime(Oe),Qe=_.getPublishTime(ze),it=_.getOriginalPublishTime(ze);return!!(Fe&&Ce&&Fe==Ce&&we&&it&&we.getTime()==it.getTime()&&Qe&&we.getTime()<Qe.getTime())}function Se(Oe,ze){_.getPatchOperations(ze).forEach(function(Fe){var Ce=Fe.getMpdTarget(Oe);if(Ce!==null){var we=Ce.name,Qe=Ce.target,it=Ce.leaf;if(Fe.xpath.findsAttribute()){switch(Fe.action){case"add":case"replace":Qe[we]=Fe.value;break;case"remove":delete Qe[we];break}return}var st=(Qe[we+"_asArray"]||[]).indexOf(it),at=Fe.position==="prepend"||Fe.position==="before";if((Fe.action==="remove"||Fe.action==="replace")&&(delete Qe[we],st!=-1)){var Ae=Qe[we+"_asArray"];Ae.splice(st,1),Ae.length>1?Qe[we]=Ae:Ae.length==1?Qe[we]=Ae[0]:delete Qe[we+"_asArray"]}(Fe.action==="add"||Fe.action==="replace")&&Object.keys(Fe.value).forEach(function(Be){var We=Fe.value[Be],Te=Qe[Be+"_asArray"]||[];if(Te.length===0&&Qe[Be]&&Te.push(Qe[Be]),Te.length===0)Te=We;else{var De=Te.length;Be==we&&st!=-1?De=st+(at?0:1)+(Fe.action=="replace"?-1:0):De=at?0:Te.length,Te.splice.apply(Te,[De,0].concat(We))}Qe[Be+"_asArray"]=Te,Qe[Be]=Te.length==1?Te[0]:Te})}})}function Me(Oe){return Oe||(g.length>0?g[0].mpd.manifest:null)}function ve(Oe){try{var ze=be(Oe.streamInfo,g),Fe=y.getAdaptationsForPeriod(ze);return!Oe||!Oe.streamInfo||Oe.streamInfo.id===void 0||!Fe?null:Fe[Oe.index]}catch{return null}}function be(Oe,ze){for(var Fe=ze.length,Ce=0;Ce<Fe;Ce++){var we=ze[Ce];if(Oe&&Oe.id===we.id)return we}return null}function Ne(Oe){if(!Oe)return null;var ze=new l.default,Fe=Oe.period.mpd.manifest.Period_asArray[Oe.period.index].AdaptationSet_asArray[Oe.index],Ce;if(ze.id=Oe.id,ze.index=Oe.index,ze.type=Oe.type,ze.streamInfo=ot(Oe.period),ze.representationCount=y.getRepresentationCount(Fe),ze.labels=y.getLabelsForAdaptation(Fe),ze.lang=y.getLanguageForAdaptation(Fe),Ce=y.getViewpointForAdaptation(Fe),ze.viewpoint=Ce?Ce.value:void 0,ze.accessibility=y.getAccessibilityForAdaptation(Fe).map(function(it){var st=it.value,at=st;return it.schemeIdUri&&it.schemeIdUri.search("cea-608")>=0&&typeof x!="undefined"&&(st?at="cea-608:"+st:at="cea-608",ze.embeddedCaptions=!0),at}),ze.audioChannelConfiguration=y.getAudioChannelConfigurationForAdaptation(Fe).map(function(it){return it.value}),ze.audioChannelConfiguration.length===0&&Array.isArray(Fe.Representation_asArray)&&Fe.Representation_asArray.length>0&&(ze.audioChannelConfiguration=y.getAudioChannelConfigurationForRepresentation(Fe.Representation_asArray[0]).map(function(it){return it.value})),ze.roles=y.getRolesForAdaptation(Fe).map(function(it){return it.value}),ze.codec=y.getCodec(Fe),ze.mimeType=y.getMimeType(Fe),ze.contentProtection=y.getContentProtectionData(Fe),ze.bitrateList=y.getBitrateListForAdaptation(Fe),ze.selectionPriority=y.getSelectionPriority(Fe),ze.contentProtection){var we=ze.contentProtection.map(function(it){return y.getKID(it)}).filter(function(it){return it!==null});if(we.length){var Qe=we[0];ze.contentProtection.forEach(function(it){it.keyId=Qe})}}return ze.isText=y.getIsText(Fe),ze.supplementalProperties=y.getSupplementalProperties(Fe),ze.isFragmented=y.getIsFragmented(Fe),ze.isEmbedded=!1,ze}function Ue(Oe,ze,Fe){Oe.id=ze,Oe.index=100+parseInt(ze.substring(2,3)),Oe.type=S.TEXT,Oe.codec="cea-608-in-SEI",Oe.isEmbedded=!0,Oe.isFragmented=!1,Oe.lang=Fe,Oe.roles=["caption"]}function Xe(Oe){Oe.type=S.IMAGE}function ot(Oe){var ze=new u.default,Fe=1;return ze.id=Oe.id,ze.index=Oe.index,ze.start=Oe.start,ze.duration=Oe.duration,ze.manifestInfo=ct(Oe.mpd),ze.isLast=Oe.mpd.manifest.Period_asArray.length===1||Math.abs(ze.start+ze.duration-ze.manifestInfo.duration)<Fe,ze}function ct(Oe){var ze=new c.default;return ze.dvrWindowSize=Oe.timeShiftBufferDepth,ze.loadedTime=Oe.manifest.loadedTime,ze.availableFrom=Oe.availabilityStartTime,ze.minBufferTime=Oe.manifest.minBufferTime,ze.maxFragmentDuration=Oe.maxSegmentDuration,ze.duration=y.getDuration(Oe.manifest),ze.isDynamic=y.getIsDynamic(Oe.manifest),ze.serviceDescriptions=y.getServiceDescriptions(Oe.manifest),ze.protocol=Oe.manifest.protocol,ze}function xt(){if(!S)throw new Error("setConfig function has to be called previously")}function Bt(Oe){return g.length>0?g[0].mpd.manifest.Period_asArray[Oe]:null}function Lt(Oe,ze){var Fe=Pt(Oe,ze,!0);return Fe!==null?Fe:-1}function Pt(Oe,ze,Fe){var Ce,we,Qe,it,st,at;if(Oe){for(we=Oe.AdaptationSet_asArray,st=0;st<we.length;st=st+1)for(Ce=we[st],it=Ce.Representation_asArray,at=0;at<it.length;at=at+1)if(Qe=it[at],ze===Qe.id)return Fe?at:Qe}return null}function Ht(Oe,ze){var Fe,Ce,we,Qe;if(!Oe||!ze)return-1;for(Ce=Oe.AdaptationSet_asArray,Qe=0;Qe<Ce.length;Qe=Qe+1)if(Fe=Ce[Qe],we=Fe.Representation_asArray,y.getIsTypeOf(Fe,ze))return we.length;return-1}return M={getBandwidthForRepresentation:ee,getIndexForRepresentation:j,getMaxIndexForBufferType:X,convertRepresentationToRepresentationInfo:A,getStreamsInfo:K,getMediaInfoForType:I,getAllMediaInfoForType:H,getAdaptationForType:G,getRealAdaptation:ae,getRealPeriodByIndex:le,getEssentialPropertiesForRepresentation:re,getVoRepresentations:me,getEventsFor:te,getEvent:de,getMpd:$,setConfig:P,updatePeriods:J,getIsTextTrack:Z,getUTCTimingSources:pe,getSuggestedPresentationDelay:he,getAvailabilityStartTime:Q,getIsTypeOf:oe,getIsDynamic:Y,getDuration:ie,getRegularPeriods:ue,getLocation:W,getPatchLocation:D,getManifestUpdatePeriod:B,getPublishTime:L,getIsDVB:O,getIsPatch:U,getBaseURLsFromElement:fe,getRepresentationSortFunction:ye,getCodec:_e,getPeriodById:z,setCurrentMediaInfo:q,isPatchValid:ce,applyPatchToManifest:Se,areMediaInfosEqual:V,reset:se},b(),M}v.__dashjs_factory_name="DashAdapter",r.default=h.default.getSingletonFactory(v)},"./src/dash/DashHandler.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/FragmentRequest.js"),o=n("./src/streaming/vo/metrics/HTTPRequest.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/MediaPlayerEvents.js"),c=n("./src/dash/utils/SegmentsUtils.js"),f=n("./src/dash/constants/DashConstants.js"),h=.5;function p(E){E=E||{};var v=E.eventBus,M=E.debug,y=E.urlUtils,_=E.type,g=E.streamInfo,R=E.segmentsController,S=E.timelineConverter,x=E.baseURLController,w,C,b,P,A;function I(){C=M.getLogger(w),H(),v.on(u.default.DYNAMIC_TO_STATIC,he,w)}function F(Q){P=Q,A=!1,R.initialize(Q)}function G(){return g.id}function V(){return _}function k(){return g}function H(){b=null}function J(){H(),v.off(u.default.DYNAMIC_TO_STATIC,he,w)}function K(Q,Y,ie){var ue=x.resolve(ie.path),$,W;return!ue||Y===ue.url||!y.isRelative(Y)?$=Y:($=ue.url,W=ue.serviceLocation,Y&&($=y.resolve(Y,$))),y.isRelative($)?!1:(Q.url=$,Q.serviceLocation=W,!0)}function ae(Q,Y){return Y?re(Q,Y,V()):null}function re(Q,Y,ie){var ue=new i.default,$=Y.adaptation.period,W=$.start;if(ue.mediaType=ie,ue.type=o.HTTPRequest.INIT_SEGMENT_TYPE,ue.range=Y.range,ue.availabilityStartTime=S.calcAvailabilityStartTimeFromPresentationTime(W,Y,P),ue.availabilityEndTime=S.calcAvailabilityEndTimeFromPresentationTime(W+$.duration,Y,P),ue.quality=Y.index,ue.mediaInfo=Q,ue.representationId=Y.id,K(ue,Y.initialization,Y))return ue.url=Object(c.replaceTokenForTemplate)(ue.url,"Bandwidth",Y.bandwidth),ue}function le(Q,Y){if(Y==null)return null;var ie=new i.default,ue=Y.representation,$=ue.adaptation.period.mpd.manifest.Period_asArray[ue.adaptation.period.index].AdaptationSet_asArray[ue.adaptation.index].Representation_asArray[ue.index].bandwidth,W=Y.media;if(W=Object(c.replaceTokenForTemplate)(W,"Number",Y.replacementNumber),W=Object(c.replaceTokenForTemplate)(W,"Time",Y.replacementTime),W=Object(c.replaceTokenForTemplate)(W,"Bandwidth",$),W=Object(c.replaceIDForTemplate)(W,ue.id),W=Object(c.unescapeDollarsInTemplate)(W),ie.mediaType=V(),ie.type=o.HTTPRequest.MEDIA_SEGMENT_TYPE,ie.range=Y.mediaRange,ie.startTime=Y.presentationStartTime,ie.mediaStartTime=Y.mediaStartTime,ie.duration=Y.duration,ie.timescale=ue.timescale,ie.availabilityStartTime=Y.availabilityStartTime,ie.availabilityEndTime=Y.availabilityEndTime,ie.wallStartTime=Y.wallStartTime,ie.quality=ue.index,ie.index=Y.index,ie.mediaInfo=Q,ie.adaptationIndex=ue.adaptation.index,ie.representationId=ue.id,K(ie,W,ue))return ie}function me(Q,Y){if(!Q||!b)return!1;if(A)return!0;if(!isFinite(Q.adaptation.period.duration)||b.presentationStartTime+b.duration>Y)return!1;if(Q.mediaFinishedInformation&&!isNaN(Q.mediaFinishedInformation.numberOfSegments)&&!isNaN(b.index)&&b.index>=Q.mediaFinishedInformation.numberOfSegments-1){if(!P||Q.segmentInfoType===f.default.SEGMENT_TEMPLATE)return!0;if(P&&Q.segmentInfoType===f.default.SEGMENT_LIST&&Q.adaptation.period.nextPeriodId)return!0}return!!(P&&Q.adaptation.period.nextPeriodId&&Q.segmentInfoType===f.default.SEGMENT_TIMELINE&&Q.mediaFinishedInformation&&!isNaN(Q.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&b&&!isNaN(b.mediaStartTime)&&!isNaN(b.duration)&&b.mediaStartTime+b.duration>=Q.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)}function de(Q,Y,ie){var ue=null;if(!Y||!Y.segmentInfoType)return ue;var $=R.getSegmentByTime(Y,ie);return $&&(b=$,C.debug("Index for time "+ie+" is "+$.index),ue=le(Q,$)),ue}function te(Q,Y){var ie=null,ue=b?b.index+1:0,$=R.getSegmentByIndex(Y,ue,b?b.mediaStartTime:-1);return $?(ie=le(Q,$),ie):null}function q(Q,Y){var ie=null;if(!Y||!Y.segmentInfoType)return null;var ue=b?b.index+1:0,$=R.getSegmentByIndex(Y,ue,b?b.mediaStartTime:-1);if($)ie=le(Q,$),b=$;else{if(P&&!A)return C.debug(V()+" No segment found at index: "+ue+". Wait for next loop"),null;A=!0}return ie}function Z(Q,Y,ie,ue){try{if(isNaN(Q)||!Y||!ie)return NaN;if(Q<0&&(Q=0),isNaN(ue)&&(ue=h),de(Y,ie,Q))return Q;for(var $=ie.adaptation.period.start,W=ie.adaptation.period.start+ie.adaptation.period.duration,B=Math.min(Q+ue,W),L=Math.max(Q-ue,$),D=NaN,O=null;B<=W||L>=$;){var U=null,fe=null;if(B<=W&&(U=de(Y,ie,B)),L>=$&&(fe=de(Y,ie,L)),fe){D=L,O=fe;break}else if(U){D=B,O=U;break}B+=ue,L-=ue}if(O){var ye=O.startTime+O.duration;return Q>=O.startTime&&ye-Q>ue?Q:Q<O.startTime?O.startTime:Math.min(ye-ue,D)}return D}catch{return NaN}}function pe(){return b?b.index:-1}function he(){C.debug("Dynamic stream complete"),A=!0}return w={initialize:F,getStreamId:G,getType:V,getStreamInfo:k,getInitRequest:ae,getSegmentRequestForTime:de,getCurrentIndex:pe,getNextSegmentRequest:q,isLastSegmentRequested:me,reset:J,getNextSegmentRequestIdempotent:te,getValidSeekTimeCloseToTargetTime:Z},I(),w}p.__dashjs_factory_name="DashHandler",r.default=l.default.getClassFactory(p)},"./src/dash/DashMetrics.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/vo/metrics/HTTPRequest.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/constants/MetricsConstants.js"),c=n("./src/dash/utils/Round10.js"),f=n("./src/streaming/models/MetricsModel.js"),h=n("./src/core/Utils.js"),p=n("./src/streaming/vo/metrics/PlayList.js");function E(v){v=v||{};var M=this.context,y,_,g,R,S=v.metricsModel;function x(){S=S||Object(f.default)(M).getInstance({settings:v.settings}),w()}function w(){_=!0,g=null,R=null}function C(O){var U=S.getMetricsFor(O,!0);return J(U,u.default.TRACK_SWITCH)}function b(O,U,fe,ye,_e){S.addRepresentationSwitch(O,U,fe,ye,_e)}function P(O){var U=S.getMetricsFor(O,!0);return J(U,u.default.BUFFER_STATE)}function A(O){var U=S.getMetricsFor(O,!0),fe=J(U,u.default.BUFFER_LEVEL);return fe?c.default.round10(fe.level/1e3,-3):0}function I(O,U,fe){S.addBufferLevel(O,U,fe)}function F(O,U,fe){S.addBufferState(O,U,fe)}function G(){S.clearAllCurrentMetrics()}function V(O){var U=S.getMetricsFor(O,!0);if(!U)return null;var fe=U.HttpList,ye=null,_e;if(!fe||fe.length<=0)return null;for(_e=fe.length-1;_e>=0;){if(fe[_e].responsecode){ye=fe[_e];break}_e--}return ye}function k(O){var U=S.getMetricsFor(O,!0);return U?U.HttpList?U.HttpList:[]:[]}function H(O,U,fe){S.addRequestsQueue(O,U,fe)}function J(O,U){if(!O)return null;var fe=O[U];return!fe||fe.length===0?null:fe[fe.length-1]}function K(){var O=S.getMetricsFor(i.default.VIDEO,!0);return J(O,u.default.DROPPED_FRAMES)}function ae(O){S.addDroppedFrames(i.default.VIDEO,O)}function re(O){var U=S.getMetricsFor(O,!0);return J(U,u.default.SCHEDULING_INFO)}function le(O,U){S.addSchedulingInfo(O.mediaType,new Date,O.type,O.startTime,O.availabilityStartTime,O.duration,O.quality,O.range,U)}function me(){var O=S.getMetricsFor(i.default.STREAM);return J(O,u.default.MANIFEST_UPDATE)}function de(O){var U=this.getCurrentManifestUpdate();S.updateManifestUpdateInfo(U,O)}function te(O){if(O){var U=this.getCurrentManifestUpdate();S.addManifestUpdateStreamInfo(U,O.id,O.index,O.start,O.duration)}}function q(O){S.addManifestUpdate(i.default.STREAM,O.type,O.requestStartDate,O.requestEndDate)}function Z(O,U,fe,ye,_e){S.addHttpRequest(O.mediaType,null,O.type,O.url,O.quality,U,O.serviceLocation||null,O.range||null,O.requestStartDate,O.firstByteDate,O.requestEndDate,fe,O.duration,ye,_e)}function pe(O,U){if(O){var fe=this.getCurrentManifestUpdate();S.addManifestUpdateRepresentationInfo(fe,O.id,O.index,O.streamIndex,U,O.presentationTimeOffset,O.startNumber,O.fragmentInfoType)}}function he(O){var U=O?S.getMetricsFor(O,!0):S.getMetricsFor(i.default.VIDEO,!0)||S.getMetricsFor(i.default.AUDIO,!0);return J(U,u.default.DVR_INFO)}function Q(O,U,fe,ye){S.addDVRInfo(O,U,fe,ye)}function Y(O){if(!O)return null;var U={},fe,ye,_e;for(fe=k(i.default.STREAM),_e=fe.length-1;_e>=0;_e--)if(ye=fe[_e],ye.type===o.HTTPRequest.MPD_TYPE){U=h.default.parseHttpHeaders(ye._responseHeaders);break}var ee=U[O.toLowerCase()];return ee===void 0?null:ee}function ie(O,U){if(!U)return null;var fe={},ye=V(O);ye&&(fe=h.default.parseHttpHeaders(ye._responseHeaders));var _e=fe[U.toLowerCase()];return _e===void 0?null:_e}function ue(){R&&(S.addPlayList(R),R=null)}function $(O,U){R=new p.PlayList,R.start=new Date,R.mstart=O,R.starttype=U}function W(O,U,fe){_===!0&&(_=!1,g=new p.PlayListTrace,g.representationid=O,g.start=new Date,g.mstart=U,g.playbackspeed=fe!==null?fe.toString():null)}function B(O){if(g)for(var U in g)g[U]=O[U]}function L(O,U){if(_===!1&&R&&g&&g.start){var fe=g.start,ye=O.getTime()-fe.getTime();g.duration=ye,g.stopreason=U,R.trace.push(g),_=!0}}function D(O){S.addDVBErrors(O)}return y={getCurrentRepresentationSwitch:C,getCurrentBufferState:P,getCurrentBufferLevel:A,getCurrentHttpRequest:V,getHttpRequests:k,getCurrentDroppedFrames:K,getCurrentSchedulingInfo:re,getCurrentDVRInfo:he,getCurrentManifestUpdate:me,getLatestFragmentRequestHeaderValueByID:ie,getLatestMPDRequestHeaderValueByID:Y,addRepresentationSwitch:b,addDVRInfo:Q,updateManifestUpdateInfo:de,addManifestUpdateStreamInfo:te,addManifestUpdateRepresentationInfo:pe,addManifestUpdate:q,addHttpRequest:Z,addSchedulingInfo:le,addRequestsQueue:H,addBufferLevel:I,addBufferState:F,addDroppedFrames:ae,addPlayList:ue,addDVBErrors:D,createPlaylistMetrics:$,createPlaylistTraceMetrics:W,updatePlayListTraceMetrics:B,pushPlayListTraceMetrics:L,clearAllCurrentMetrics:G},x(),y}E.__dashjs_factory_name="DashMetrics",r.default=l.default.getSingletonFactory(E)},"./src/dash/SegmentBaseLoader.js":function(t,r,n){n.r(r);var i=n("./src/dash/vo/Segment.js"),o=n("./src/streaming/vo/DashJSError.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/vo/FragmentRequest.js"),c=n("./src/streaming/net/URLLoader.js");function f(){var h=this.context,p,E,v,M,y,_,g,R,S,x,w,C,b;function P(){R=Object(c.default)(h).create({errHandler:v,dashMetrics:_,mediaPlayerModel:g,requestModifier:y,boxParser:M,errors:S,urlUtils:C,constants:x,dashConstants:w})}function A(ae){ae.baseURLController&&(b=ae.baseURLController),ae.dashMetrics&&(_=ae.dashMetrics),ae.mediaPlayerModel&&(g=ae.mediaPlayerModel),ae.errHandler&&(v=ae.errHandler),ae.boxParser&&(M=ae.boxParser),ae.debug&&(E=ae.debug.getLogger(p)),ae.requestModifier&&(y=ae.requestModifier),ae.errors&&(S=ae.errors),ae.urlUtils&&(C=ae.urlUtils),ae.constants&&(x=ae.constants),ae.dashConstants&&(w=ae.dashConstants)}function I(ae,re){return new Promise(function(le){F(ae,re,le)})}function F(ae,re,le,me){var de=null,te=ae?b.resolve(ae.path):null,q=me||{init:!0,url:te?te.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:re};E.debug("Start searching for initialization.");var Z=K(q),pe=function(Y){if(q.bytesLoaded=q.range.end,de=M.findInitRange(Y),de)ae.range=de,le(ae);else return q.range.end=q.bytesLoaded+q.bytesToLoad,F(ae,re,le,q)},he=function(){le(ae)};R.load({request:Z,success:pe,error:he}),E.debug("Perform init search: "+q.url)}function G(ae,re,le){return new Promise(function(me){V(ae,re,le,me)})}function V(ae,re,le,me,de,te){if(le&&(le.start===void 0||le.end===void 0)){var q=le?le.toString().split("-"):null;le=q?{start:parseFloat(q[0]),end:parseFloat(q[1])}:null}de=de||k;var Z=null,pe=null,he=!!le,Q=ae?b.resolve(ae.path):null,Y={init:!1,url:Q?Q.url:void 0,range:he?le:{start:0,end:1500},searching:!he,bytesLoaded:te?te.bytesLoaded:0,bytesToLoad:1500,mediaType:re},ie=K(Y),ue=function(B){var L=Y.bytesToLoad,D=B.byteLength;if(Y.bytesLoaded=Y.range.end-Y.range.start,Z=M.parse(B),pe=Z.getBox("sidx"),!pe||!pe.isComplete){if(pe)Y.range.start=pe.offset||Y.range.start,Y.range.end=Y.range.start+(pe.size||L);else if(D<Y.bytesLoaded){de(null,ae,me);return}else{var O=Z.getLastBox();O&&O.size?(Y.range.start=O.offset+O.size,Y.range.end=Y.range.start+L):Y.range.end+=L}V(ae,re,Y.range,me,null,Y)}else{var U=pe.references,fe,ye;if(U!=null&&U.length>0&&(fe=U[0].reference_type===1),fe){E.debug("Initiate multiple SIDX load."),Y.range.end=Y.range.start+pe.size;var _e,ee,j,X,z,oe=[],se=0,ce=(pe.offset||Y.range.start)+pe.size,Se=function(ve){ve?(oe=oe.concat(ve),se++,se>=ee&&(oe.sort(function(be,Ne){return be.startTime-Ne.startTime<0?-1:0}),de(oe,ae,me))):de(null,ae,me)};for(_e=0,ee=U.length;_e<ee;_e++)j=ce,X=ce+U[_e].referenced_size-1,ce=ce+U[_e].referenced_size,z={start:j,end:X},V(ae,re,z,me,Se,Y)}else E.debug("Parsing segments from SIDX. representation "+re+" - id: "+ae.id+" for range : "+Y.range.start+" - "+Y.range.end),ye=J(pe,Y),de(ye,ae,me)}},$=function(){de(null,ae,me)};R.load({request:ie,success:ue,error:$}),E.debug("Perform SIDX load for type ".concat(re," : ").concat(Y.url," with range ").concat(Y.range.start," - ").concat(Y.range.end))}function k(ae,re,le){le({segments:ae,representation:re,error:ae?void 0:new o.default(S.SEGMENT_BASE_LOADER_ERROR_CODE,S.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function H(){R&&(R.abort(),R=null)}function J(ae,re){for(var le=ae.references,me=le.length,de=ae.timescale,te=ae.earliest_presentation_time,q=re.range.start+ae.offset+ae.first_offset+ae.size,Z=[],pe,he,Q,Y,ie=0;ie<me;ie++)Q=le[ie].subsegment_duration,Y=le[ie].referenced_size,pe=new i.default,pe.duration=Q,pe.startTime=te,pe.timescale=de,he=q+Y-1,pe.mediaRange=q+"-"+he,Z.push(pe),te+=Q,q+=Y;return Z}function K(ae){if(!!ae.url){var re=new u.default;return re.setInfo(ae),re}}return p={setConfig:A,initialize:P,loadInitialization:I,loadSegments:G,reset:H},p}f.__dashjs_factory_name="SegmentBaseLoader",r.default=l.default.getSingletonFactory(f)},"./src/dash/WebmSegmentBaseLoader.js":function(t,r,n){n.r(r);var i=n("./src/streaming/utils/EBMLParser.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/dash/vo/Segment.js"),c=n("./src/streaming/vo/FragmentRequest.js"),f=n("./src/streaming/net/URLLoader.js"),h=n("./src/streaming/vo/DashJSError.js");function p(){var E=this.context,v,M,y,_,g,R,S,x,w,C;function b(){y={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}}}function P(){x=Object(f.default)(E).create({errHandler:_,dashMetrics:R,mediaPlayerModel:S,requestModifier:g,errors:w})}function A(K){if(!K.baseURLController||!K.dashMetrics||!K.mediaPlayerModel||!K.errHandler)throw new Error(o.default.MISSING_CONFIG_ERROR);C=K.baseURLController,R=K.dashMetrics,S=K.mediaPlayerModel,_=K.errHandler,w=K.errors,M=K.debug.getLogger(v),g=K.requestModifier}function I(K){var ae=[],re=Object(i.default)(E).create({data:K}),le,me;for(re.consumeTagAndSize(y.Segment.Cues);re.moreData()&&re.consumeTagAndSize(y.Segment.Cues.CuePoint,!0);){for(le={},le.CueTime=re.parseTag(y.Segment.Cues.CuePoint.CueTime),le.CueTracks=[];re.moreData()&&re.consumeTag(y.Segment.Cues.CuePoint.CueTrackPositions,!0);){var de=re.getMatroskaCodedNum(),te=re.getPos();if(me={},me.Track=re.parseTag(y.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),me.Track===0)throw new Error("Cue track cannot be 0");me.ClusterPosition=re.parseTag(y.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),le.CueTracks.push(me),re.setPos(te+de)}if(le.CueTracks.length===0)throw new Error("Mandatory cuetrack not found");ae.push(le)}if(ae.length===0)throw new Error("mandatory cuepoint not found");return ae}function F(K,ae,re,le){var me,de,te,q,Z,pe,he,Q;for(de=I(K),te=[],Z=0,pe=de.length;Z<pe;Z+=1)q=new u.default,me=0,Z<de.length-1?me=de[Z+1].CueTime-de[Z].CueTime:me=le-de[Z].CueTime,q.duration=me,q.startTime=de[Z].CueTime,q.timescale=1e3,he=de[Z].CueTracks[0].ClusterPosition+ae,Z<de.length-1?Q=de[Z+1].CueTracks[0].ClusterPosition+ae-1:Q=re-1,q.mediaRange=he+"-"+Q,te.push(q);return M.debug("Parsed cues: "+te.length+" cues."),te}function G(K,ae,re,le){if(!K||K.byteLength===0){le(null);return}var me=Object(i.default)(E).create({data:K}),de,te,q,Z,pe=re?re.split("-"):null,he=null,Q={url:ae,range:{start:pe?parseFloat(pe[0]):null,end:pe?parseFloat(pe[1]):null},request:he};for(M.debug("Parse EBML header: "+Q.url),me.skipOverElement(y.EBML),me.consumeTag(y.Segment),q=me.getMatroskaCodedNum(),q+=me.getPos(),Z=me.getPos();me.moreData()&&!me.consumeTagAndSize(y.Segment.Info,!0);)if(!(me.skipOverElement(y.Segment.SeekHead,!0)||me.skipOverElement(y.Segment.Tracks,!0)||me.skipOverElement(y.Segment.Cues,!0)||me.skipOverElement(y.Void,!0)))throw new Error("no valid top level element found");for(;de===void 0;){var Y=me.getMatroskaCodedNum(!0),ie=me.getMatroskaCodedNum();switch(Y){case y.Segment.Info.Duration.tag:de=me[y.Segment.Info.Duration.parse](ie);break;default:me.setPos(me.getPos()+ie);break}}he=H(Q);var ue=function(B){te=F(B,Z,q,de),le(te)},$=function(){M.error("Download Error: Cues "+Q.url),le(null)};x.load({request:he,success:ue,error:$}),M.debug("Perform cues load: "+Q.url+" bytes="+Q.range.start+"-"+Q.range.end)}function V(K,ae){return new Promise(function(re){var le=null,me=K?C.resolve(K.path):null,de=K?K.range.split("-"):null,te={range:{start:de?parseFloat(de[0]):null,end:de?parseFloat(de[1]):null},request:le,url:me?me.url:void 0,init:!0,mediaType:ae};M.info("Start loading initialization."),le=H(te);var q=function(){re(K)},Z=function(){re(K)};x.load({request:le,success:q,error:Z}),M.debug("Perform init load: "+te.url)})}function k(K,ae,re){return new Promise(function(le){var me=null,de=K?C.resolve(K.path):null,te=de?de.url:void 0,q=8192,Z={bytesLoaded:0,bytesToLoad:q,range:{start:0,end:q},request:me,url:te,init:!1,mediaType:ae};me=H(Z),M.debug("Parsing ebml header");var pe=function(Y){G(Y,te,re,function(ie){le({segments:ie,representation:K,error:ie?void 0:new h.default(w.SEGMENT_BASE_LOADER_ERROR_CODE,w.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},he=function(){le({representation:K,error:new h.default(w.SEGMENT_BASE_LOADER_ERROR_CODE,w.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})};x.load({request:me,success:pe,error:he})})}function H(K){var ae=new c.default;return ae.setInfo(K),ae}function J(){x&&(x.abort(),x=null)}return v={setConfig:A,initialize:P,loadInitialization:V,loadSegments:k,reset:J},b(),v}p.__dashjs_factory_name="WebmSegmentBaseLoader",r.default=l.default.getSingletonFactory(p)},"./src/dash/constants/DashConstants.js":function(t,r,n){n.r(r);function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u=function(){function f(){i(this,f),this.init()}return l(f,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId"}}]),f}(),c=new u;r.default=c},"./src/dash/controllers/RepresentationController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/MediaPlayerEvents.js"),u=n("./src/dash/utils/SegmentsUtils.js");function c(f){f=f||{};var h=f.eventBus,p=f.events,E=f.abrController,v=f.dashMetrics,M=f.playbackController,y=f.timelineConverter,_=f.type,g=f.streamInfo,R=f.dashConstants,S=f.segmentsController,x=f.isDynamic,w,C,b,P,A;function I(){K(),h.on(l.default.MANIFEST_VALIDITY_CHANGED,$,w)}function F(){return g.id}function G(){return _}function V(){if(!E||!v||!M||!y)throw new Error(i.default.MISSING_CONFIG_ERROR)}function k(){return C}function H(){return b}function J(){return A}function K(){C=null,b=!0,P=[]}function ae(){h.off(l.default.MANIFEST_VALIDITY_CHANGED,$,w),K()}function re(W,B,L,D,O){V(),b=!0,P=B;var U=Z(O);if(ue(U),C=W,L!==i.default.VIDEO&&L!==i.default.AUDIO&&(L!==i.default.TEXT||!D))return Q(),Promise.resolve();for(var fe=[],ye=0,_e=P.length;ye<_e;ye++){var ee=P[ye];fe.push(le(ee))}return Promise.all(fe)}function le(W){return new Promise(function(B,L){var D=W.hasInitialization(),O=W.hasSegments(),U=[];U.push(S.updateInitData(W,D)),U.push(S.updateSegmentData(W,O)),Promise.all(U).then(function(fe){fe[0]&&!fe[0].error&&(W=de(W,fe[0])),fe[1]&&!fe[1].error&&(W=te(W,fe[1])),me(W),Y(W),B()}).catch(function(fe){L(fe)})})}function me(W){W.mediaFinishedInformation=S.getMediaFinishedInformation(W)}function de(W,B){return!B||B.error||!B.representation?W:B.representation}function te(W,B){if(!(!B||B.error)){var L=B.segments,D=[],O=0,U,fe,ye,_e;for(U=0,fe=L?L.length:0;U<fe;U++)ye=L[U],_e=Object(u.getTimeBasedSegment)(y,x,W,ye.startTime,ye.duration,ye.timescale,ye.media,ye.mediaRange,O),_e&&(D.push(_e),_e=null,O++);return D.length>0&&(W.segments=D),W}}function q(){V();var W=new Date,B=J(),L=M.getTime()*1e3;B&&v.addRepresentationSwitch(B.adaptation.type,W,L,B.id),h.trigger(l.default.REPRESENTATION_SWITCH,{mediaType:_,streamId:g.id,currentRepresentation:B,numberOfRepresentations:P.length},{streamId:g.id,mediaType:_})}function Z(W){return W==null||W>=P.length?null:P[W]}function pe(W){return P.indexOf(W)}function he(){for(var W=0,B=P.length;W<B;W++){var L=P[W].segmentInfoType;if(!P[W].hasInitialization()||(L===R.SEGMENT_BASE||L===R.BASE_URL)&&!P[W].segments)return!1}return!0}function Q(W){b=!1,h.trigger(p.DATA_UPDATE_COMPLETED,{data:C,currentRepresentation:A,error:W},{streamId:g.id,mediaType:_})}function Y(W){if(!!H()){var B=v.getCurrentManifestUpdate(),L=!1,D,O;if(B){for(var U=0;U<B.representationInfo.length;U++)if(D=B.representationInfo[U],D.index===W.index&&D.mediaType===G()){L=!0;break}L||v.addManifestUpdateRepresentationInfo(W,G())}if(he()){E.setPlaybackQuality(_,g,pe(A));var fe=v.getCurrentDVRInfo(_);fe&&v.updateManifestUpdateInfo({latency:fe.range.end-M.getTime()}),O=v.getCurrentRepresentationSwitch(J().adaptation.type),O||q(),Q()}}}function ie(W){var B=Z(W);ue(B),q()}function ue(W){A=W}function $(W){if(W.newDuration){var B=J();if(B&&B.adaptation.period){var L=B.adaptation.period;L.duration=W.newDuration}}}return w={getStreamId:F,getType:G,getData:k,isUpdating:H,updateData:re,getCurrentRepresentation:J,getRepresentationForQuality:Z,prepareQualityChange:ie,reset:ae},I(),w}c.__dashjs_factory_name="RepresentationController",r.default=o.default.getClassFactory(c)},"./src/dash/controllers/SegmentBaseController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/dash/SegmentBaseLoader.js"),l=n("./src/dash/WebmSegmentBaseLoader.js");function u(f){f=f||{};var h=this.context,p=f.eventBus,E=f.events,v=f.dashMetrics,M=f.mediaPlayerModel,y=f.errHandler,_=f.baseURLController,g=f.debug,R=f.boxParser,S=f.requestModifier,x=f.errors,w,C,b;function P(){C=Object(o.default)(h).getInstance(),b=Object(l.default)(h).getInstance(),C.setConfig({baseURLController:_,dashMetrics:v,mediaPlayerModel:M,errHandler:y,eventBus:p,events:E,errors:x,debug:g,boxParser:R,requestModifier:S}),b.setConfig({baseURLController:_,dashMetrics:v,mediaPlayerModel:M,errHandler:y,eventBus:p,events:E,errors:x,debug:g,requestModifier:S})}function A(k){var H=k?k.split("/")[1]:"";return H.toLowerCase()==="webm"}function I(){C.initialize(),b.initialize()}function F(k){return A(k.representation.mimeType)?b.loadInitialization(k.representation,k.mediaType):C.loadInitialization(k.representation,k.mediaType)}function G(k){return A(k.mimeType)?b.loadSegments(k.representation,k.mediaType,k.representation?k.representation.indexRange:null):C.loadSegments(k.representation,k.mediaType,k.representation?k.representation.indexRange:null)}function V(){C.reset(),b.reset()}return w={initialize:I,getSegmentBaseInitSegment:F,getSegmentList:G,reset:V},P(),w}u.__dashjs_factory_name="SegmentBaseController";var c=i.default.getSingletonFactory(u);r.default=c},"./src/dash/controllers/SegmentsController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/dash/utils/TimelineSegmentsGetter.js"),l=n("./src/dash/utils/TemplateSegmentsGetter.js"),u=n("./src/dash/utils/ListSegmentsGetter.js"),c=n("./src/dash/utils/SegmentBaseGetter.js");function f(p){p=p||{};var E=this.context,v=p.dashConstants,M=p.type,y=p.segmentBaseController,_,g;function R(){g={}}function S(I){g[v.SEGMENT_TIMELINE]=Object(o.default)(E).create(p,I),g[v.SEGMENT_TEMPLATE]=Object(l.default)(E).create(p,I),g[v.SEGMENT_LIST]=Object(u.default)(E).create(p,I),g[v.SEGMENT_BASE]=Object(c.default)(E).create(p,I)}function x(I,F){return F?Promise.resolve():y.getSegmentBaseInitSegment({representation:I,mediaType:M})}function w(I,F){return F?Promise.resolve():y.getSegmentList({mimeType:I.mimeType,representation:I,mediaType:M})}function C(I){return I?I.segments?g[v.SEGMENT_BASE]:g[I.segmentInfoType]:null}function b(I,F,G){var V=C(I);return V?V.getSegmentByIndex(I,F,G):null}function P(I,F){var G=C(I);return G?G.getSegmentByTime(I,F):null}function A(I){var F=C(I);return F?F.getMediaFinishedInformation(I):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}return _={initialize:S,updateInitData:x,updateSegmentData:w,getSegmentByIndex:b,getSegmentByTime:P,getMediaFinishedInformation:A},R(),_}f.__dashjs_factory_name="SegmentsController";var h=i.default.getClassFactory(f);r.default=h},"./src/dash/models/DashManifestModel.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/dash/constants/DashConstants.js"),l=n("./src/dash/vo/Representation.js"),u=n("./src/dash/vo/AdaptationSet.js"),c=n("./src/dash/vo/Period.js"),f=n("./src/dash/vo/Mpd.js"),h=n("./src/dash/vo/UTCTiming.js"),p=n("./src/dash/vo/Event.js"),E=n("./src/dash/vo/BaseURL.js"),v=n("./src/dash/vo/EventStream.js"),M=n("./src/streaming/utils/ObjectUtils.js"),y=n("./src/streaming/utils/URLUtils.js"),_=n("./src/core/FactoryMaker.js"),g=n("./src/core/Debug.js"),R=n("./src/streaming/vo/DashJSError.js"),S=n("./src/core/errors/Errors.js"),x=n("./src/streaming/thumbnail/ThumbnailTracks.js");function w(A,I){var F;if(typeof Symbol=="undefined"||A[Symbol.iterator]==null){if(Array.isArray(A)||(F=C(A))||I&&A&&typeof A.length=="number"){F&&(A=F);var G=0,V=function(){};return{s:V,n:function(){return G>=A.length?{done:!0}:{done:!1,value:A[G++]}},e:function(ae){throw ae},f:V}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var k=!0,H=!1,J;return{s:function(){F=A[Symbol.iterator]()},n:function(){var ae=F.next();return k=ae.done,ae},e:function(ae){H=!0,J=ae},f:function(){try{!k&&F.return!=null&&F.return()}finally{if(H)throw J}}}}function C(A,I){if(!!A){if(typeof A=="string")return b(A,I);var F=Object.prototype.toString.call(A).slice(8,-1);if(F==="Object"&&A.constructor&&(F=A.constructor.name),F==="Map"||F==="Set")return Array.from(A);if(F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return b(A,I)}}function b(A,I){(I==null||I>A.length)&&(I=A.length);for(var F=0,G=new Array(I);F<I;F++)G[F]=A[F];return G}function P(){var A,I,F,G,V=this.context,k=Object(y.default)(V).getInstance(),H=Number.isInteger||function(ge){return typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge};function J(){I=Object(g.default)(V).getInstance().getLogger(A)}function K(ge,Pe){if(!ge)throw new Error("adaptation is not defined");if(!Pe)throw new Error("type is not defined");if(ge.Representation_asArray&&ge.Representation_asArray.length){var qe=Ue(ge.Representation_asArray[0]);if(qe&&qe.length>0&&x.THUMBNAILS_SCHEME_ID_URIS.indexOf(qe[0].schemeIdUri)>=0)return Pe===i.default.IMAGE}if(ge.ContentComponent_asArray&&ge.ContentComponent_asArray.length>0){if(ge.ContentComponent_asArray.length>1)return Pe===i.default.MUXED;if(ge.ContentComponent_asArray[0].contentType===Pe)return!0}var Ye=Pe===i.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(Pe);if(ge.Representation_asArray&&ge.Representation_asArray.length){var $e=ge.Representation_asArray[0].codecs;if(Ye.test($e))return!0}if(ge.hasOwnProperty(o.default.MIME_TYPE))return Ye.test(ge.mimeType);if(ge.Representation_asArray){for(var ht,bt=0;bt<ge.Representation_asArray.length;bt++)if(ht=ge.Representation_asArray[bt],ht.hasOwnProperty(o.default.MIME_TYPE))return Ye.test(ht.mimeType)}return!1}function ae(ge){if(!ge)throw new Error("adaptation is not defined");if(ge.hasOwnProperty(o.default.SEGMENT_TEMPLATE)||ge.hasOwnProperty(o.default.SEGMENT_TIMELINE)||ge.hasOwnProperty(o.default.SEGMENT_LIST)||ge.hasOwnProperty(o.default.SEGMENT_BASE))return!0;if(ge.Representation_asArray&&ge.Representation_asArray.length>0){var Pe=ge.Representation_asArray[0];if(Pe.hasOwnProperty(o.default.SEGMENT_TEMPLATE)||Pe.hasOwnProperty(o.default.SEGMENT_TIMELINE)||Pe.hasOwnProperty(o.default.SEGMENT_LIST)||Pe.hasOwnProperty(o.default.SEGMENT_BASE))return!0}return!1}function re(ge){return K(ge,i.default.AUDIO)}function le(ge){return K(ge,i.default.VIDEO)}function me(ge){return K(ge,i.default.TEXT)}function de(ge){return K(ge,i.default.MUXED)}function te(ge){return K(ge,i.default.IMAGE)}function q(ge){var Pe="";return ge&&ge.hasOwnProperty(o.default.LANG)&&(Pe=ge.lang.replace(/[^A-Za-z0-9-]/g,"")),Pe}function Z(ge){return ge&&ge.hasOwnProperty(o.default.VIEWPOINT)?ge.Viewpoint:null}function pe(ge){return ge&&ge.hasOwnProperty(o.default.ROLE_ASARRAY)?ge.Role_asArray:[]}function he(ge){return ge&&ge.hasOwnProperty(o.default.ACCESSIBILITY_ASARRAY)?ge.Accessibility_asArray:[]}function Q(ge){return ge&&ge.hasOwnProperty(o.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?ge.AudioChannelConfiguration_asArray:[]}function Y(ge){return ge&&ge.hasOwnProperty(o.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?ge.AudioChannelConfiguration_asArray:[]}function ie(){return function(ge,Pe){return ge.bandwidth-Pe.bandwidth}}function ue(ge){return ge&&Array.isArray(ge.Representation_asArray)&&ge.Representation_asArray.sort(ie()),ge}function $(ge,Pe){return ge&&ge.Period_asArray&&H(Pe)?ge.Period_asArray[Pe]?ge.Period_asArray[Pe].AdaptationSet_asArray:[]:[]}function W(ge){return ge&&ge.Period_asArray?ge.Period_asArray:[]}function B(ge,Pe){var qe=W(Pe);return qe.length>0&&H(ge)?qe[ge]:null}function L(ge,Pe,qe){var Ye=$(Pe,qe),$e,ht;for($e=0,ht=Ye.length;$e<ht;$e++)if(Ye[$e].hasOwnProperty(o.default.ID)&&Ye[$e].id===ge)return Ye[$e];return null}function D(ge,Pe,qe){var Ye=$(Pe,qe);return Ye.length>0&&H(ge)?Ye[ge]:null}function O(ge,Pe,qe){if(!ge)return-1;for(var Ye=$(Pe,qe),$e=0;$e<Ye.length;$e++){var ht=Object(M.default)(V).getInstance();if(ht.areEqual(Ye[$e],ge))return $e}return-1}function U(ge,Pe,qe){var Ye=$(ge,Pe),$e,ht,bt=[];for($e=0,ht=Ye.length;$e<ht;$e++)K(Ye[$e],qe)&&bt.push(ue(Ye[$e]));return bt}function fe(ge,Pe,qe){var Ye=null;if(ge&&ge.Representation_asArray&&ge.Representation_asArray.length>0){var $e=H(Pe)&&Pe>=0&&Pe<ge.Representation_asArray.length?ge.Representation_asArray[Pe]:ge.Representation_asArray[0];$e&&(Ye=$e.mimeType+';codecs="'+$e.codecs+'"',qe&&$e.width!==void 0&&(Ye+=';width="'+$e.width+'";height="'+$e.height+'"'))}return Ye&&(Ye=Ye.replace(/\sprofiles=[^;]*/g,"")),Ye}function ye(ge){return ge&&ge.Representation_asArray&&ge.Representation_asArray.length>0?ge.Representation_asArray[0].mimeType:null}function _e(ge){return!ge||!ge.hasOwnProperty(o.default.CENC_DEFAULT_KID)?null:ge[o.default.CENC_DEFAULT_KID]}function ee(ge){if(!ge||!Array.isArray(ge.Label_asArray))return[];for(var Pe=[],qe=0;qe<ge.Label_asArray.length;qe++)Pe.push({lang:ge.Label_asArray[qe].lang,text:ge.Label_asArray[qe].__text||ge.Label_asArray[qe]});return Pe}function j(ge){return!ge||!ge.hasOwnProperty(o.default.CONTENTPROTECTION_ASARRAY)||ge.ContentProtection_asArray.length===0?null:ge.ContentProtection_asArray}function X(ge){var Pe=!1;return ge&&ge.hasOwnProperty("type")&&(Pe=ge.type===o.default.DYNAMIC),Pe}function z(ge){return ge&&ge[o.default.ID]||null}function oe(ge,Pe){var qe=!1;return ge&&ge.profiles&&ge.profiles.length>0&&(qe=ge.profiles.indexOf(Pe)!==-1),qe}function se(ge){var Pe;return ge&&ge.hasOwnProperty(o.default.MEDIA_PRESENTATION_DURATION)?Pe=ge.mediaPresentationDuration:ge&&ge.type=="dynamic"?Pe=Number.POSITIVE_INFINITY:Pe=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,Pe}function ce(ge){return ge&&ge.bandwidth?ge.bandwidth:NaN}function Se(ge){var Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,qe=NaN;return ge&&ge.hasOwnProperty(o.default.MINIMUM_UPDATE_PERIOD)&&(qe=ge.minimumUpdatePeriod),isNaN(qe)?qe:Math.max(qe-Pe,1)}function Me(ge){return ge&&ge.hasOwnProperty(o.default.PUBLISH_TIME)?new Date(ge[o.default.PUBLISH_TIME]):null}function ve(ge){return ge&&Array.isArray(ge.Representation_asArray)?ge.Representation_asArray.length:0}function be(ge){var Pe=ue(ge),qe=Pe&&Array.isArray(Pe.Representation_asArray)?Pe.Representation_asArray:[];return qe.map(function(Ye){return{bandwidth:Ye.bandwidth,width:Ye.width||0,height:Ye.height||0,scanType:Ye.scanType||null,id:Ye.id||null}})}function Ne(ge){try{var Pe=ge&&typeof ge.selectionPriority!="undefined"?parseInt(ge.selectionPriority):1;return isNaN(Pe)?1:Pe}catch{return 1}}function Ue(ge){return!ge||!ge.EssentialProperty_asArray||!ge.EssentialProperty_asArray.length?null:ge.EssentialProperty_asArray.map(function(Pe){return{schemeIdUri:Pe.schemeIdUri,value:Pe.value}})}function Xe(ge,Pe){return Pe&&Pe.Representation_asArray&&Pe.Representation_asArray.length>0&&H(ge)?Pe.Representation_asArray[ge]:null}function ot(ge){if(ge&&ge.period&&H(ge.period.index)){var Pe=ge.period.mpd.manifest.Period_asArray[ge.period.index];if(Pe&&Pe.AdaptationSet_asArray&&H(ge.index))return ue(Pe.AdaptationSet_asArray[ge.index])}}function ct(ge){var Pe=[],qe=ot(ge),Ye,$e;if(qe&&qe.Representation_asArray){if(ge&&ge.period&&H(ge.period.index)){var ht=at(ge.period.mpd.manifest);ht&&($e=ht[0])}for(var bt=0,It=qe.Representation_asArray.length;bt<It;++bt){var Dt=qe.Representation_asArray[bt],gt=new l.default;if(gt.index=bt,gt.adaptation=ge,Dt.hasOwnProperty(o.default.ID)&&(gt.id=Dt.id),Dt.hasOwnProperty(o.default.CODECS)&&(gt.codecs=Dt.codecs),Dt.hasOwnProperty(o.default.MIME_TYPE)&&(gt.mimeType=Dt[o.default.MIME_TYPE]),Dt.hasOwnProperty(o.default.CODEC_PRIVATE_DATA)&&(gt.codecPrivateData=Dt.codecPrivateData),Dt.hasOwnProperty(o.default.BANDWITH)&&(gt.bandwidth=Dt.bandwidth),Dt.hasOwnProperty(o.default.WIDTH)&&(gt.width=Dt.width),Dt.hasOwnProperty(o.default.HEIGHT)&&(gt.height=Dt.height),Dt.hasOwnProperty(o.default.SCAN_TYPE)&&(gt.scanType=Dt.scanType),Dt.hasOwnProperty(o.default.MAX_PLAYOUT_RATE)&&(gt.maxPlayoutRate=Dt.maxPlayoutRate),Dt.hasOwnProperty(o.default.SEGMENT_BASE)?(Ye=Dt.SegmentBase,gt.segmentInfoType=o.default.SEGMENT_BASE):Dt.hasOwnProperty(o.default.SEGMENT_LIST)?(Ye=Dt.SegmentList,Ye.hasOwnProperty(o.default.SEGMENT_TIMELINE)?gt.segmentInfoType=o.default.SEGMENT_TIMELINE:gt.segmentInfoType=o.default.SEGMENT_LIST):Dt.hasOwnProperty(o.default.SEGMENT_TEMPLATE)?(Ye=Dt.SegmentTemplate,Ye.hasOwnProperty(o.default.SEGMENT_TIMELINE)?gt.segmentInfoType=o.default.SEGMENT_TIMELINE:gt.segmentInfoType=o.default.SEGMENT_TEMPLATE,Ye.hasOwnProperty(o.default.INITIALIZATION_MINUS)&&(gt.initialization=Ye.initialization.split("$Bandwidth$").join(Dt.bandwidth).split("$RepresentationID$").join(Dt.id))):gt.segmentInfoType=o.default.BASE_URL,gt.essentialProperties=Ue(Dt),Ye){if(Ye.hasOwnProperty(o.default.INITIALIZATION)){var Yt=Ye.Initialization;Yt.hasOwnProperty(o.default.SOURCE_URL)&&(gt.initialization=Yt.sourceURL),Yt.hasOwnProperty(o.default.RANGE)&&(gt.range=Yt.range)}else me(qe)&&ae(qe)&&qe.mimeType&&qe.mimeType.indexOf("application/mp4")===-1&&(gt.range=0);Ye.hasOwnProperty(o.default.TIMESCALE)&&(gt.timescale=Ye.timescale),Ye.hasOwnProperty(o.default.DURATION)?gt.segmentDuration=Ye.duration/gt.timescale:Dt.hasOwnProperty(o.default.SEGMENT_TEMPLATE)&&(Ye=Dt.SegmentTemplate,Ye.hasOwnProperty(o.default.SEGMENT_TIMELINE)&&(gt.segmentDuration=xt(Ye.SegmentTimeline)/gt.timescale)),Ye.hasOwnProperty(o.default.MEDIA)&&(gt.media=Ye.media),Ye.hasOwnProperty(o.default.START_NUMBER)&&(gt.startNumber=Ye.startNumber),Ye.hasOwnProperty(o.default.INDEX_RANGE)&&(gt.indexRange=Ye.indexRange),Ye.hasOwnProperty(o.default.PRESENTATION_TIME_OFFSET)&&(gt.presentationTimeOffset=Ye.presentationTimeOffset/gt.timescale),Ye.hasOwnProperty(o.default.AVAILABILITY_TIME_OFFSET)?gt.availabilityTimeOffset=Ye.availabilityTimeOffset:$e&&$e.availabilityTimeOffset!==void 0&&(gt.availabilityTimeOffset=$e.availabilityTimeOffset),Ye.hasOwnProperty(o.default.AVAILABILITY_TIME_COMPLETE)?gt.availabilityTimeComplete=Ye.availabilityTimeComplete!=="false":$e&&$e.availabilityTimeComplete!==void 0&&(gt.availabilityTimeComplete=$e.availabilityTimeComplete)}gt.MSETimeOffset=Bt(gt),gt.path=[ge.period.index,ge.index,bt],Pe.push(gt)}}return Pe}function xt(ge){if(!ge||!ge.S_asArray)return NaN;var Pe=ge.S_asArray[0],qe=ge.S_asArray[1];return Pe.hasOwnProperty("d")?Pe.d:qe.t-Pe.t}function Bt(ge){var Pe=ge.presentationTimeOffset,qe=ge.adaptation.period.start;return qe-Pe}function Lt(ge){var Pe=ge&&H(ge.index)?ge.mpd.manifest.Period_asArray[ge.index]:null,qe=[],Ye,$e,ht;if(Pe&&Pe.AdaptationSet_asArray)for(ht=0;ht<Pe.AdaptationSet_asArray.length;ht++)$e=Pe.AdaptationSet_asArray[ht],Ye=new u.default,$e.hasOwnProperty(o.default.ID)&&(Ye.id=$e.id),Ye.index=ht,Ye.period=ge,de($e)?Ye.type=i.default.MUXED:re($e)?Ye.type=i.default.AUDIO:le($e)?Ye.type=i.default.VIDEO:me($e)?Ye.type=i.default.TEXT:te($e)?Ye.type=i.default.IMAGE:I.warn("Unknown Adaptation stream type"),qe.push(Ye);return qe}function Pt(ge){var Pe=ge?X(ge.manifest):!1,qe=[],Ye=null,$e=null,ht=null,bt=null,It,Dt;for(Dt=0,It=ge&&ge.manifest&&ge.manifest.Period_asArray?ge.manifest.Period_asArray.length:0;Dt<It;Dt++)$e=ge.manifest.Period_asArray[Dt],$e.hasOwnProperty(o.default.START)?(bt=new c.default,bt.start=$e.start):Ye!==null&&Ye.hasOwnProperty(o.default.DURATION)&&ht!==null?(bt=new c.default,bt.start=parseFloat((ht.start+ht.duration).toFixed(5))):Dt===0&&!Pe&&(bt=new c.default,bt.start=0),ht!==null&&isNaN(ht.duration)&&(bt!==null?ht.duration=parseFloat((bt.start-ht.start).toFixed(5)):I.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),bt!==null&&(bt.id=Ht($e,Dt),bt.index=Dt,bt.mpd=ge,$e.hasOwnProperty(o.default.DURATION)&&(bt.duration=$e.duration),ht&&(ht.nextPeriodId=bt.id),qe.push(bt),Ye=$e,ht=bt),$e=null,bt=null;return qe.length===0||ht!==null&&isNaN(ht.duration)&&(ht.duration=parseFloat((Fe(ht)-ht.start).toFixed(5))),qe}function Ht(ge,Pe){if(!ge)throw new Error("Period cannot be null or undefined");var qe=c.default.DEFAULT_ID+"_"+Pe;return ge.hasOwnProperty(o.default.ID)&&ge.id.length>0&&ge.id!=="__proto__"&&(qe=ge.id),qe}function Oe(ge){var Pe=new f.default;return ge&&(Pe.manifest=ge,ge.hasOwnProperty(o.default.AVAILABILITY_START_TIME)?Pe.availabilityStartTime=new Date(ge.availabilityStartTime.getTime()):ge.loadedTime&&(Pe.availabilityStartTime=new Date(ge.loadedTime.getTime())),ge.hasOwnProperty(o.default.AVAILABILITY_END_TIME)&&(Pe.availabilityEndTime=new Date(ge.availabilityEndTime.getTime())),ge.hasOwnProperty(o.default.MINIMUM_UPDATE_PERIOD)&&(Pe.minimumUpdatePeriod=ge.minimumUpdatePeriod),ge.hasOwnProperty(o.default.MEDIA_PRESENTATION_DURATION)&&(Pe.mediaPresentationDuration=ge.mediaPresentationDuration),ge.hasOwnProperty(o.default.SUGGESTED_PRESENTATION_DELAY)&&(Pe.suggestedPresentationDelay=ge.suggestedPresentationDelay),ge.hasOwnProperty(o.default.TIMESHIFT_BUFFER_DEPTH)&&(Pe.timeShiftBufferDepth=ge.timeShiftBufferDepth),ge.hasOwnProperty(o.default.MAX_SEGMENT_DURATION)&&(Pe.maxSegmentDuration=ge.maxSegmentDuration),ge.hasOwnProperty(o.default.PUBLISH_TIME)&&(Pe.publishTime=new Date(ge.publishTime))),Pe}function ze(){if(!F||!F.hasOwnProperty("error"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function Fe(ge){ze();var Pe=X(ge.mpd.manifest),qe;return ge.mpd.manifest.mediaPresentationDuration?qe=ge.mpd.manifest.mediaPresentationDuration:ge.duration?qe=ge.duration:Pe?qe=Number.POSITIVE_INFINITY:F.error(new R.default(S.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",ge)),qe}function Ce(ge){var Pe=ge&&ge.mpd&&ge.mpd.manifest?ge.mpd.manifest:null,qe=Pe?Pe.Period_asArray:null,Ye=qe&&ge&&H(ge.index)?qe[ge.index].EventStream_asArray:null,$e=[],ht,bt;if(Ye)for(ht=0;ht<Ye.length;ht++){var It=new v.default;if(It.period=ge,It.timescale=1,Ye[ht].hasOwnProperty(i.default.SCHEME_ID_URI))It.schemeIdUri=Ye[ht][i.default.SCHEME_ID_URI];else throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(Ye[ht].hasOwnProperty(o.default.TIMESCALE)&&(It.timescale=Ye[ht][o.default.TIMESCALE]),Ye[ht].hasOwnProperty(o.default.VALUE)&&(It.value=Ye[ht][o.default.VALUE]),Ye[ht].hasOwnProperty(o.default.PRESENTATION_TIME_OFFSET)&&(It.presentationTimeOffset=Ye[ht][o.default.PRESENTATION_TIME_OFFSET]),bt=0;Ye[ht].Event_asArray&&bt<Ye[ht].Event_asArray.length;bt++){var Dt=Ye[ht].Event_asArray[bt],gt=new p.default;if(gt.presentationTime=0,gt.eventStream=It,Dt.hasOwnProperty(o.default.PRESENTATION_TIME)){gt.presentationTime=Dt.presentationTime;var Yt=It.presentationTimeOffset?It.presentationTimeOffset/It.timescale:0;gt.calculatedPresentationTime=gt.presentationTime/It.timescale+ge.start-Yt}Dt.hasOwnProperty(o.default.DURATION)&&(gt.duration=Dt.duration/It.timescale),Dt.hasOwnProperty(o.default.ID)&&(gt.id=Dt.id),Dt.Signal&&Dt.Signal.Binary?gt.messageData=G.decodeArray(Dt.Signal.Binary.toString()):gt.messageData=Dt.messageData||Dt.__cdata||Dt.__text,$e.push(gt)}}return $e}function we(ge,Pe){var qe=[],Ye;if(!ge)return qe;for(Ye=0;Ye<ge.length;Ye++){var $e=new v.default;if($e.timescale=1,$e.representation=Pe,ge[Ye].hasOwnProperty(i.default.SCHEME_ID_URI))$e.schemeIdUri=ge[Ye].schemeIdUri;else throw new Error("Invalid EventStream. SchemeIdUri has to be set");ge[Ye].hasOwnProperty(o.default.TIMESCALE)&&($e.timescale=ge[Ye].timescale),ge[Ye].hasOwnProperty(o.default.VALUE)&&($e.value=ge[Ye].value),qe.push($e)}return qe}function Qe(ge,Pe){var qe,Ye,$e;return ge&&ge.Period_asArray&&Pe&&Pe.period&&H(Pe.period.index)&&(Ye=ge.Period_asArray[Pe.period.index],Ye&&Ye.AdaptationSet_asArray&&H(Pe.index)&&($e=Ye.AdaptationSet_asArray[Pe.index],$e&&(qe=$e.InbandEventStream_asArray))),we(qe,null)}function it(ge,Pe){var qe,Ye,$e,ht;return ge&&ge.Period_asArray&&Pe&&Pe.adaptation&&Pe.adaptation.period&&H(Pe.adaptation.period.index)&&(Ye=ge.Period_asArray[Pe.adaptation.period.index],Ye&&Ye.AdaptationSet_asArray&&H(Pe.adaptation.index)&&($e=Ye.AdaptationSet_asArray[Pe.adaptation.index],$e&&$e.Representation_asArray&&H(Pe.index)&&(ht=$e.Representation_asArray[Pe.index],ht&&(qe=ht.InbandEventStream_asArray)))),we(qe,Pe)}function st(ge){var Pe=X(ge),qe=ge?ge.hasOwnProperty(o.default.AVAILABILITY_START_TIME):!1,Ye=ge?ge.UTCTiming_asArray:null,$e=[];return(Pe||qe)&&Ye&&Ye.forEach(function(ht){var bt=new h.default;if(ht.hasOwnProperty(i.default.SCHEME_ID_URI))bt.schemeIdUri=ht.schemeIdUri;else return;if(ht.hasOwnProperty(o.default.VALUE))bt.value=ht.value.toString();else return;$e.push(bt)}),$e}function at(ge){var Pe=[],qe=ge.BaseURL_asArray||[ge.baseUri],Ye=!1;return qe.some(function($e){if($e){var ht=new E.default,bt=$e.__text||$e;return k.isRelative(bt)&&(Ye=!0,ge.baseUri&&(bt=k.resolve(bt,ge.baseUri))),ht.url=bt,$e.hasOwnProperty(o.default.SERVICE_LOCATION)&&$e.serviceLocation.length?ht.serviceLocation=$e.serviceLocation:ht.serviceLocation=bt,$e.hasOwnProperty(o.default.DVB_PRIORITY)&&(ht.dvb_priority=$e[o.default.DVB_PRIORITY]),$e.hasOwnProperty(o.default.DVB_WEIGHT)&&(ht.dvb_weight=$e[o.default.DVB_WEIGHT]),$e.hasOwnProperty(o.default.AVAILABILITY_TIME_OFFSET)&&(ht.availabilityTimeOffset=$e[o.default.AVAILABILITY_TIME_OFFSET]),$e.hasOwnProperty(o.default.AVAILABILITY_TIME_COMPLETE)&&(ht.availabilityTimeComplete=$e[o.default.AVAILABILITY_TIME_COMPLETE]!=="false"),Pe.push(ht),Ye}}),Pe}function Ae(ge){if(ge&&ge.hasOwnProperty(i.default.LOCATION))return ge.Location=ge.Location_asArray[0],ge.Location}function Be(ge){if(ge&&ge.hasOwnProperty(o.default.PATCH_LOCATION))return ge.PatchLocation=ge.PatchLocation_asArray[0],ge.PatchLocation}function We(ge){return ge&&ge.hasOwnProperty(o.default.SUGGESTED_PRESENTATION_DELAY)?ge.suggestedPresentationDelay:null}function Te(ge){return ge&&ge.hasOwnProperty(o.default.AVAILABILITY_START_TIME)&&ge.availabilityStartTime!==null?ge.availabilityStartTime.getTime():null}function De(ge){var Pe=[];if(ge&&ge.hasOwnProperty(o.default.SERVICE_DESCRIPTION)){var qe=w(ge.ServiceDescription_asArray),Ye;try{for(qe.s();!(Ye=qe.n()).done;){var $e=Ye.value,ht=void 0,bt=void 0,It=void 0,Dt=void 0;for(var gt in $e)$e.hasOwnProperty(gt)&&(gt===o.default.ID?ht=$e[gt]:gt===o.default.SERVICE_DESCRIPTION_SCOPE?bt=$e[gt].schemeIdUri:gt===o.default.SERVICE_DESCRIPTION_LATENCY?It={target:$e[gt].target,max:$e[gt].max,min:$e[gt].min}:gt===o.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(Dt={max:$e[gt].max,min:$e[gt].min}));bt===i.default.SERVICE_DESCRIPTION_LL_SCHEME&&(It||Dt)&&Pe.push({id:ht,schemeIdUri:bt,latency:It,playbackRate:Dt})}}catch(Yt){qe.e(Yt)}finally{qe.f()}}return Pe}function Ze(ge){var Pe={};if(ge&&ge.hasOwnProperty(o.default.SUPPLEMENTAL_PROPERTY)){var qe=w(ge.SupplementalProperty_asArray),Ye;try{for(qe.s();!(Ye=qe.n()).done;){var $e=Ye.value;$e.hasOwnProperty(i.default.SCHEME_ID_URI)&&$e.hasOwnProperty(o.default.VALUE)&&(Pe[$e[i.default.SCHEME_ID_URI]]=$e[o.default.VALUE])}}catch(ht){qe.e(ht)}finally{qe.f()}}return Pe}function nt(ge){!ge||(ge.errHandler&&(F=ge.errHandler),ge.BASE64&&(G=ge.BASE64))}return A={getIsTypeOf:K,getIsText:me,getIsFragmented:ae,getLanguageForAdaptation:q,getViewpointForAdaptation:Z,getRolesForAdaptation:pe,getAccessibilityForAdaptation:he,getAudioChannelConfigurationForAdaptation:Q,getAudioChannelConfigurationForRepresentation:Y,getAdaptationForIndex:D,getIndexForAdaptation:O,getAdaptationForId:L,getAdaptationsForType:U,getRealPeriods:W,getRealPeriodForIndex:B,getCodec:fe,getSelectionPriority:Ne,getMimeType:ye,getKID:_e,getLabelsForAdaptation:ee,getContentProtectionData:j,getIsDynamic:X,getId:z,hasProfile:oe,getDuration:se,getBandwidth:ce,getManifestUpdatePeriod:Se,getPublishTime:Me,getRepresentationCount:ve,getBitrateListForAdaptation:be,getRepresentationFor:Xe,getRepresentationsForAdaptation:ct,getAdaptationsForPeriod:Lt,getRegularPeriods:Pt,getMpd:Oe,getEventsForPeriod:Ce,getEssentialPropertiesForRepresentation:Ue,getEventStreamForAdaptationSet:Qe,getEventStreamForRepresentation:it,getUTCTimingSources:st,getBaseURLsFromElement:at,getRepresentationSortFunction:ie,getLocation:Ae,getPatchLocation:Be,getSuggestedPresentationDelay:We,getAvailabilityStartTime:Te,getServiceDescriptions:De,getSupplementalProperties:Ze,setConfig:nt},J(),A}P.__dashjs_factory_name="DashManifestModel",r.default=_.default.getSingletonFactory(P)},"./src/dash/models/PatchManifestModel.js":function(t,r,n){n.r(r);var i=n("./src/dash/constants/DashConstants.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/core/Debug.js"),u=n("./src/dash/vo/SimpleXPath.js"),c=n("./src/dash/vo/PatchOperation.js");function f(){var h,p,E=this.context;function v(){p=Object(l.default)(E).getInstance().getLogger(h)}function M(S){return S&&S.hasOwnProperty(i.default.ORIGINAL_MPD_ID)||!1}function y(S){return S&&S.hasOwnProperty(i.default.PUBLISH_TIME)?new Date(S[i.default.PUBLISH_TIME]):null}function _(S){return S&&S.hasOwnProperty(i.default.ORIGINAL_PUBLISH_TIME)?new Date(S[i.default.ORIGINAL_PUBLISH_TIME]):null}function g(S){return S&&S[i.default.ORIGINAL_MPD_ID]||null}function R(S){return S?(S.__children||[]).map(function(x){var w=Object.keys(x)[0];if(w!=="add"&&w!=="remove"&&w!=="replace")return p.warn("Ignoring node of invalid action: ".concat(w)),null;var C=x[w],b=C.sel;if(w==="add"&&C.type){if(!C.type.startsWith("@"))return p.warn("Ignoring add action for prefixed namespace declaration: ".concat(C.type,"=").concat(C.__text)),null;b="".concat(b,"/").concat(C.type)}var P=new u.default(b);if(!P.isValid())return p.warn("Ignoring action with invalid selector: ".concat(w," - ").concat(b)),null;var A=null;P.findsAttribute()?A=C.__text||"":w!=="remove"&&(A=C.__children.reduce(function(F,G){var V=Object.keys(G)[0];return V!=="#text"&&(F[V]=F[V]||[],F[V].push(G[V])),F},{}));var I=new c.default(w,P,A);return w==="add"&&(I.position=C.pos),I}).filter(function(x){return!!x}):[]}return h={getIsPatch:M,getPublishTime:y,getOriginalPublishTime:_,getMpdId:g,getPatchOperations:R},v(),h}f.__dashjs_factory_name="PatchManifestModel",r.default=o.default.getSingletonFactory(f)},"./src/dash/parser/DashParser.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/dash/parser/objectiron.js"),l=n("./externals/xml2json.js"),u=n("./src/dash/parser/matchers/StringMatcher.js"),c=n("./src/dash/parser/matchers/DurationMatcher.js"),f=n("./src/dash/parser/matchers/DateTimeMatcher.js"),h=n("./src/dash/parser/matchers/NumericMatcher.js"),p=n("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),E=n("./src/dash/parser/maps/SegmentValuesMap.js");function v(M){M=M||{};var y=this.context,_=M.debug,g,R,S,x,w;function C(){R=_.getLogger(g),S=[new c.default,new f.default,new h.default,new u.default],x=new l.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:S}),w=Object(o.default)(y).create({adaptationset:new p.default,period:new E.default})}function b(){return S}function P(){return w}function A(I){var F,G=window.performance.now();if(F=x.xml_str2json(I),!F)throw new Error("parsing the manifest failed");var V=window.performance.now();F.Patch?(F=F.Patch,F.add_asArray&&F.add_asArray.forEach(function(H){return w.run(H)}),F.replace_asArray&&F.replace_asArray.forEach(function(H){return w.run(H)})):(F=F.MPD,w.run(F));var k=window.performance.now();return R.info("Parsing complete: ( xml2json: "+(V-G).toPrecision(3)+"ms, objectiron: "+(k-V).toPrecision(3)+"ms, total: "+((k-G)/1e3).toPrecision(3)+"s)"),F.protocol="DASH",F}return g={parse:A,getMatchers:b,getIron:P},C(),g}v.__dashjs_factory_name="DashParser",r.default=i.default.getClassFactory(v)},"./src/dash/parser/maps/CommonProperty.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f){i(this,c);var h=function(E){return E&&E.length&&E.charAt(0)===E.charAt(0).toUpperCase()};this._name=f,this._merge=h(f)}return l(c,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),c}();r.default=u},"./src/dash/parser/maps/MapNode.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/maps/CommonProperty.js");function o(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function l(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function u(f,h,p){return h&&l(f.prototype,h),p&&l(f,p),f}var c=function(){function f(h,p,E){var v=this;o(this,f),this._name=h||"",this._properties=[],this._children=E||[],Array.isArray(p)&&p.forEach(function(M){v._properties.push(new i.default(M))})}return u(f,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),f}();r.default=c},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/maps/MapNode.js"),o=n("./src/dash/constants/DashConstants.js");function l(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(R){return typeof R}:l=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},l(_)}function u(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function c(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&f(_,g)}function f(_,g){return f=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},f(_,g)}function h(_){var g=v();return function(){var S=M(_),x;if(g){var w=M(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return p(this,x)}}function p(_,g){return g&&(l(g)==="object"||typeof g=="function")?g:E(_)}function E(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M(_){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},M(_)}var y=function(_){c(R,_);var g=h(R);function R(){u(this,R);var S=[o.default.PROFILES,o.default.WIDTH,o.default.HEIGHT,o.default.SAR,o.default.FRAMERATE,o.default.AUDIO_SAMPLING_RATE,o.default.MIME_TYPE,o.default.SEGMENT_PROFILES,o.default.CODECS,o.default.MAXIMUM_SAP_PERIOD,o.default.START_WITH_SAP,o.default.MAX_PLAYOUT_RATE,o.default.CODING_DEPENDENCY,o.default.SCAN_TYPE,o.default.FRAME_PACKING,o.default.AUDIO_CHANNEL_CONFIGURATION,o.default.CONTENT_PROTECTION,o.default.ESSENTIAL_PROPERTY,o.default.SUPPLEMENTAL_PROPERTY,o.default.INBAND_EVENT_STREAM];return g.call(this,o.default.ADAPTATION_SET,S,[new i.default(o.default.REPRESENTATION,S,[new i.default(o.default.SUB_REPRESENTATION,S)])])}return R}(i.default);r.default=y},"./src/dash/parser/maps/SegmentValuesMap.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/maps/MapNode.js"),o=n("./src/dash/constants/DashConstants.js");function l(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(R){return typeof R}:l=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},l(_)}function u(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function c(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&f(_,g)}function f(_,g){return f=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},f(_,g)}function h(_){var g=v();return function(){var S=M(_),x;if(g){var w=M(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return p(this,x)}}function p(_,g){return g&&(l(g)==="object"||typeof g=="function")?g:E(_)}function E(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M(_){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},M(_)}var y=function(_){c(R,_);var g=h(R);function R(){u(this,R);var S=[o.default.SEGMENT_BASE,o.default.SEGMENT_TEMPLATE,o.default.SEGMENT_LIST];return g.call(this,o.default.PERIOD,S,[new i.default(o.default.ADAPTATION_SET,S,[new i.default(o.default.REPRESENTATION,S)])])}return R}(i.default);r.default=y},"./src/dash/parser/matchers/BaseMatcher.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f,h){i(this,c),this._test=f,this._converter=h}return l(c,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),c}();r.default=u},"./src/dash/parser/matchers/DateTimeMatcher.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/matchers/BaseMatcher.js");function o(S){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(w){return typeof w}:o=function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},o(S)}function l(S,x){if(!(S instanceof x))throw new TypeError("Cannot call a class as a function")}function u(S,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(x&&x.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),x&&c(S,x)}function c(S,x){return c=Object.setPrototypeOf||function(C,b){return C.__proto__=b,C},c(S,x)}function f(S){var x=E();return function(){var C=v(S),b;if(x){var P=v(this).constructor;b=Reflect.construct(C,arguments,P)}else b=C.apply(this,arguments);return h(this,b)}}function h(S,x){return x&&(o(x)==="object"||typeof x=="function")?x:p(S)}function p(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(S){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)},v(S)}var M=60,y=60,_=1e3,g=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,R=function(S){u(w,S);var x=f(w);function w(){return l(this,w),x.call(this,function(C){return g.test(C.value)},function(C){var b=g.exec(C),P;if(P=Date.UTC(parseInt(b[1],10),parseInt(b[2],10)-1,parseInt(b[3],10),parseInt(b[4],10),parseInt(b[5],10),b[6]&&parseInt(b[6],10)||0,b[7]&&parseFloat(b[7])*_||0),b[9]&&b[10]){var A=parseInt(b[9],10)*y+parseInt(b[10],10);P+=(b[8]==="+"?-1:1)*A*M*_}return new Date(P)})}return w}(i.default);r.default=R},"./src/dash/parser/matchers/DurationMatcher.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/matchers/BaseMatcher.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/dash/constants/DashConstants.js");function u(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(A){return typeof A}:u=function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},u(b)}function c(b,P){if(!(b instanceof P))throw new TypeError("Cannot call a class as a function")}function f(b,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(P&&P.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),P&&h(b,P)}function h(b,P){return h=Object.setPrototypeOf||function(I,F){return I.__proto__=F,I},h(b,P)}function p(b){var P=M();return function(){var I=y(b),F;if(P){var G=y(this).constructor;F=Reflect.construct(I,arguments,G)}else F=I.apply(this,arguments);return E(this,F)}}function E(b,P){return P&&(u(P)==="object"||typeof P=="function")?P:v(b)}function v(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(b){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(A){return A.__proto__||Object.getPrototypeOf(A)},y(b)}var _=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,g=365*24*60*60,R=30*24*60*60,S=24*60*60,x=60*60,w=60,C=function(b){f(A,b);var P=p(A);function A(){return c(this,A),P.call(this,function(I){for(var F=[l.default.MIN_BUFFER_TIME,l.default.MEDIA_PRESENTATION_DURATION,l.default.MINIMUM_UPDATE_PERIOD,l.default.TIMESHIFT_BUFFER_DEPTH,l.default.MAX_SEGMENT_DURATION,l.default.MAX_SUBSEGMENT_DURATION,l.default.SUGGESTED_PRESENTATION_DELAY,l.default.START,o.default.START_TIME,l.default.DURATION],G=F.length,V=0;V<G;V++)if(I.nodeName===F[V])return _.test(I.value);return!1},function(I){var F=_.exec(I),G=parseFloat(F[3]||0)*g+parseFloat(F[5]||0)*R+parseFloat(F[7]||0)*S+parseFloat(F[9]||0)*x+parseFloat(F[11]||0)*w+parseFloat(F[13]||0);return F[1]!==void 0&&(G=-G),G})}return A}(i.default);r.default=C},"./src/dash/parser/matchers/NumericMatcher.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/matchers/BaseMatcher.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,y=function(_){u(R,_);var g=f(R);function R(){return l(this,R),g.call(this,function(S){return M.test(S.value)},function(S){return parseFloat(S)})}return R}(i.default);r.default=y},"./src/dash/parser/matchers/StringMatcher.js":function(t,r,n){n.r(r);var i=n("./src/dash/parser/matchers/BaseMatcher.js"),o=n("./src/dash/constants/DashConstants.js");function l(g){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(S){return typeof S}:l=function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},l(g)}function u(g,R,S){return R in g?Object.defineProperty(g,R,{value:S,enumerable:!0,configurable:!0,writable:!0}):g[R]=S,g}function c(g,R){if(!(g instanceof R))throw new TypeError("Cannot call a class as a function")}function f(g,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(R&&R.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),R&&h(g,R)}function h(g,R){return h=Object.setPrototypeOf||function(x,w){return x.__proto__=w,x},h(g,R)}function p(g){var R=M();return function(){var x=y(g),w;if(R){var C=y(this).constructor;w=Reflect.construct(x,arguments,C)}else w=x.apply(this,arguments);return E(this,w)}}function E(g,R){return R&&(l(R)==="object"||typeof R=="function")?R:v(g)}function v(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(g){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)},y(g)}var _=function(g){f(S,g);var R=p(S);function S(){return c(this,S),R.call(this,function(x,w){var C,b=(C={},u(C,o.default.MPD,[o.default.ID,o.default.PROFILES]),u(C,o.default.PERIOD,[o.default.ID]),u(C,o.default.BASE_URL,[o.default.SERVICE_LOCATION,o.default.BYTE_RANGE]),u(C,o.default.SEGMENT_BASE,[o.default.INDEX_RANGE]),u(C,o.default.INITIALIZATION,[o.default.RANGE]),u(C,o.default.REPRESENTATION_INDEX,[o.default.RANGE]),u(C,o.default.SEGMENT_LIST,[o.default.INDEX_RANGE]),u(C,o.default.BITSTREAM_SWITCHING,[o.default.RANGE]),u(C,o.default.SEGMENT_URL,[o.default.MEDIA_RANGE,o.default.INDEX_RANGE]),u(C,o.default.SEGMENT_TEMPLATE,[o.default.INDEX_RANGE,o.default.MEDIA,o.default.INDEX,o.default.INITIALIZATION_MINUS,o.default.BITSTREAM_SWITCHING_MINUS]),u(C,o.default.ASSET_IDENTIFIER,[o.default.VALUE,o.default.ID]),u(C,o.default.EVENT_STREAM,[o.default.VALUE]),u(C,o.default.ADAPTATION_SET,[o.default.PROFILES,o.default.MIME_TYPE,o.default.SEGMENT_PROFILES,o.default.CODECS,o.default.CONTENT_TYPE]),u(C,o.default.FRAME_PACKING,[o.default.VALUE,o.default.ID]),u(C,o.default.AUDIO_CHANNEL_CONFIGURATION,[o.default.VALUE,o.default.ID]),u(C,o.default.CONTENT_PROTECTION,[o.default.VALUE,o.default.ID]),u(C,o.default.ESSENTIAL_PROPERTY,[o.default.VALUE,o.default.ID]),u(C,o.default.SUPPLEMENTAL_PROPERTY,[o.default.VALUE,o.default.ID]),u(C,o.default.INBAND_EVENT_STREAM,[o.default.VALUE,o.default.ID]),u(C,o.default.ACCESSIBILITY,[o.default.VALUE,o.default.ID]),u(C,o.default.ROLE,[o.default.VALUE,o.default.ID]),u(C,o.default.RATING,[o.default.VALUE,o.default.ID]),u(C,o.default.VIEWPOINT,[o.default.VALUE,o.default.ID]),u(C,o.default.CONTENT_COMPONENT,[o.default.CONTENT_TYPE]),u(C,o.default.REPRESENTATION,[o.default.ID,o.default.DEPENDENCY_ID,o.default.MEDIA_STREAM_STRUCTURE_ID]),u(C,o.default.SUBSET,[o.default.ID]),u(C,o.default.METRICS,[o.default.METRICS_MINUS]),u(C,o.default.REPORTING,[o.default.VALUE,o.default.ID]),C);if(b.hasOwnProperty(w)){var P=b[w];return P!==void 0?P.indexOf(x.name)>=0:!1}return!1},function(x){return String(x)})}return S}(i.default);r.default=_},"./src/dash/parser/objectiron.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(h){return typeof h}:o=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},o(c)}function l(c){function f(v,M){for(var y in v)M.hasOwnProperty(y)||(M[y]=v[y])}function h(v,M,y){for(var _=0,g=v.length;_<g;++_){var R=v[_];if(M[R.name])if(y[R.name]){if(R.merge){var S=M[R.name],x=y[R.name];o(S)==="object"&&o(x)==="object"?f(S,x):y[R.name]=S+x}}else y[R.name]=M[R.name]}}function p(v,M){for(var y=0,_=v.children.length;y<_;++y){var g=v.children[y],R=M[g.name+"_asArray"];if(R)for(var S=0,x=R.length;S<x;++S){var w=R[S];h(v.properties,M,w),p(g,w)}}}function E(v){if(v===null||o(v)!=="object")return v;if(v.Period_asArray&&"period"in c)for(var M=c.period,y=v.Period_asArray,_=0,g=y.length;_<g;++_){var R=y[_];if(p(M,R),"adaptationset"in c){var S=R.AdaptationSet_asArray;if(S)for(var x=c.adaptationset,w=0,C=S.length;w<C;++w)p(x,S[w])}}return v}return{run:E}}l.__dashjs_factory_name="ObjectIron";var u=i.default.getClassFactory(l);r.default=u},"./src/dash/utils/ListSegmentsGetter.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/dash/utils/SegmentsUtils.js");function u(f,h){f=f||{};var p=f.timelineConverter,E;function v(){if(!p||!p.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function M(g){var R={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!g)return R;var S=g.adaptation.period.mpd.manifest.Period_asArray[g.adaptation.period.index].AdaptationSet_asArray[g.adaptation.index].Representation_asArray[g.index].SegmentList,x=g&&!isNaN(g.startNumber)?g.startNumber:1,w=Math.max(x-1,0);return R.numberOfSegments=w+S.SegmentURL_asArray.length,R}function y(g,R){if(v(),!g)return null;var S=g.adaptation.period.mpd.manifest.Period_asArray[g.adaptation.period.index].AdaptationSet_asArray[g.adaptation.index].Representation_asArray[g.index].SegmentList,x=S.SegmentURL_asArray.length,w=g&&!isNaN(g.startNumber)?g.startNumber:1,C=Math.max(w-1,0),b=Math.max(R-C,0),P=null;if(b<x){var A=S.SegmentURL_asArray[b];P=Object(l.getIndexBasedSegment)(p,h,g,R),P&&(P.replacementTime=(w+R-1)*g.segmentDuration,P.media=A.media?A.media:"",P.mediaRange=A.mediaRange,P.indexRange=A.indexRange)}return P}function _(g,R){if(v(),!g)return null;var S=g.segmentDuration;if(isNaN(S))return null;var x=p.calcPeriodRelativeTimeFromMpdRelativeTime(g,R),w=Math.floor(x/S);return y(g,w)}return E={getSegmentByIndex:y,getSegmentByTime:_,getMediaFinishedInformation:M},E}u.__dashjs_factory_name="ListSegmentsGetter";var c=i.default.getClassFactory(u);r.default=c},"./src/dash/utils/Round10.js":function(t,r,n){n.r(r),n.d(r,"default",function(){return u});function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u=function(){function f(){i(this,f)}return l(f,null,[{key:"round10",value:function(p,E){return c("round",p,E)}}]),f}();function c(f,h,p){return typeof p=="undefined"||+p==0?Math[f](h):(h=+h,p=+p,h===null||isNaN(h)||!(typeof p=="number"&&p%1==0)?NaN:(h=h.toString().split("e"),h=Math[f](+(h[0]+"e"+(h[1]?+h[1]-p:-p))),h=h.toString().split("e"),+(h[0]+"e"+(h[1]?+h[1]+p:p))))}},"./src/dash/utils/SegmentBaseGetter.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js");function l(c){c=c||{};var f=c.timelineConverter,h;function p(){if(!f||!f.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function E(_){var g={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return!_||!_.segments||(g.numberOfSegments=_.segments.length),g}function v(_,g){if(p(),!_)return null;var R=_.segments?_.segments.length:-1,S;if(g<R&&(S=_.segments[g],S&&S.index===g))return S;for(var x=0;x<R;x++)if(S=_.segments[x],S&&S.index===g)return S;return null}function M(_,g){p();var R=y(_,g);return v(_,R)}function y(_,g){if(!_)return-1;var R=_.segments,S=R?R.length:null,x=-1,w,C,b,P,A;if(R&&S>0){for(A=0;A<S;A++)if(C=R[A],b=C.presentationStartTime,P=C.duration,w=P/2,g+w>=b&&g-w<b+P){x=C.index;break}}return x}return h={getSegmentByIndex:v,getSegmentByTime:M,getMediaFinishedInformation:E},h}l.__dashjs_factory_name="SegmentBaseGetter";var u=i.default.getClassFactory(l);r.default=u},"./src/dash/utils/SegmentsUtils.js":function(t,r,n){n.r(r),n.d(r,"unescapeDollarsInTemplate",function(){return u}),n.d(r,"replaceIDForTemplate",function(){return c}),n.d(r,"replaceTokenForTemplate",function(){return f}),n.d(r,"getIndexBasedSegment",function(){return E}),n.d(r,"getTimeBasedSegment",function(){return v});var i=n("./src/dash/vo/Segment.js");function o(M,y){for(;M.length<y;)M="0"+M;return M}function l(M,y){return M.representation.startNumber+y}function u(M){return M&&M.split("$$").join("$")}function c(M,y){if(!y||!M||M.indexOf("$RepresentationID$")===-1)return M;var _=y.toString();return M.split("$RepresentationID$").join(_)}function f(M,y,_){var g="%0",R,S,x,w,C,b,P=y.length,A=g.length;if(!M)return M;for(;;){if(R=M.indexOf("$"+y),R<0||(S=M.indexOf("$",R+P),S<0))return M;if(x=M.indexOf(g,R+P),x>R&&x<S)switch(w=M.charAt(S-1),C=parseInt(M.substring(x+A,S-1),10),w){case"d":case"i":case"u":b=o(_.toString(),C);break;case"x":b=o(_.toString(16),C);break;case"X":b=o(_.toString(16),C).toUpperCase();break;case"o":b=o(_.toString(8),C);break;default:return M}else b=_;M=M.substring(0,R)+b+M.substring(S+1)}}function h(M,y,_,g,R,S,x,w){var C=new i.default;return C.representation=M,C.duration=y,C.presentationStartTime=_,C.mediaStartTime=g,C.availabilityStartTime=R.calcAvailabilityStartTimeFromPresentationTime(S,M,x),C.availabilityEndTime=R.calcAvailabilityEndTimeFromPresentationTime(S+y,M,x),C.wallStartTime=R.calcWallTimeForSegment(C,x),C.replacementNumber=l(C,w),C.index=w,C}function p(M,y,_,g){var R=y.adaptation.period;if(isFinite(R.duration)&&R.start+R.duration<=_.presentationStartTime)return!1;if(g){if(y.availabilityTimeOffset==="INF")return!0;var S=M.getClientReferenceTime();return _.availabilityStartTime.getTime()<=S&&(!isFinite(_.availabilityEndTime)||_.availabilityEndTime.getTime()>=S)}return!0}function E(M,y,_,g){var R,S,x;R=_.segmentDuration,isNaN(R)&&(R=_.adaptation.period.duration),S=parseFloat((_.adaptation.period.start+g*R).toFixed(5)),x=parseFloat((S+R).toFixed(5));var w=M.calcMediaTimeFromPresentationTime(S,_),C=h(_,R,S,w,M,x,y,g);return p(M,_,C,y)?C:null}function v(M,y,_,g,R,S,x,w,C,b){var P=g/S,A=R/S,I,F,G;return I=M.calcPresentationTimeFromMediaTime(P,_),F=I+A,G=h(_,A,I,P,M,F,y,C),p(M,_,G,y)?(G.replacementTime=b||g,x=f(x,"Number",G.replacementNumber),x=f(x,"Time",G.replacementTime),G.media=x,G.mediaRange=w,G):null}},"./src/dash/utils/TemplateSegmentsGetter.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/dash/utils/SegmentsUtils.js");function u(f,h){f=f||{};var p=f.timelineConverter,E;function v(){if(!p||!p.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function M(g){var R={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!g)return R;var S=g.segmentDuration;return isNaN(S)?R.numberOfSegments=1:R.numberOfSegments=Math.ceil(g.adaptation.period.duration/S),R}function y(g,R){if(v(),!g)return null;var S=g.adaptation.period.mpd.manifest.Period_asArray[g.adaptation.period.index].AdaptationSet_asArray[g.adaptation.index].Representation_asArray[g.index].SegmentTemplate;R=Math.max(R,0);var x=Object(l.getIndexBasedSegment)(p,h,g,R);if(x){x.replacementTime=Math.round((R-1)*g.segmentDuration*g.timescale,10);var w=S.media;w=Object(l.replaceTokenForTemplate)(w,"Number",x.replacementNumber),w=Object(l.replaceTokenForTemplate)(w,"Time",x.replacementTime),x.media=w}return x}function _(g,R){if(v(),!g)return null;var S=g.segmentDuration;if(isNaN(S))return null;var x=p.calcPeriodRelativeTimeFromMpdRelativeTime(g,R),w=Math.floor(x/S);return y(g,w)}return E={getSegmentByIndex:y,getSegmentByTime:_,getMediaFinishedInformation:M},E}u.__dashjs_factory_name="TemplateSegmentsGetter";var c=i.default.getClassFactory(u);r.default=c},"./src/dash/utils/TimelineConverter.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/dash/constants/DashConstants.js"),c=n("./src/dash/models/DashManifestModel.js"),f=n("./src/core/Settings.js"),h=n("./src/streaming/constants/Constants.js"),p=n("./src/streaming/MediaPlayerEvents.js"),E=n("./src/streaming/constants/ConformanceViolationConstants.js");function v(){var M=this.context,y=Object(i.default)(M).getInstance(),_=Object(f.default)(M).getInstance(),g,R,S,x;function w(){R=Object(c.default)(M).getInstance(),he()}function C(){pe(),y.on(o.default.UPDATE_TIME_SYNC_OFFSET,Z,this)}function b(){return x}function P(Q){x=Q}function A(){return Date.now()-S*1e3+x*1e3}function I(Q,Y,ie,ue){var $,W=Y.adaptation.period.mpd,B=W.availabilityStartTime;if(ue)ie&&W.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?$=new Date(B.getTime()+(Q+W.timeShiftBufferDepth)*1e3):$=W.availabilityEndTime;else if(ie){var L=Y.availabilityTimeOffset;$=new Date(B.getTime()+(Q-L)*1e3)}else $=B;return $}function F(Q,Y,ie){return I(Q,Y,ie)}function G(Q,Y,ie){return I(Q,Y,ie,!0)}function V(Q,Y){return(Q.getTime()-Y.mpd.availabilityStartTime.getTime()+x*1e3)/1e3}function k(Q,Y){var ie=Y.adaptation.period.start,ue=Y.presentationTimeOffset;return Q+(ie-ue)}function H(Q,Y){var ie=Y.adaptation.period.start,ue=Y.presentationTimeOffset;return Q-ie+ue}function J(Q,Y){var ie,ue,$;return Y&&(ie=Q.representation.adaptation.period.mpd.suggestedPresentationDelay,ue=Q.presentationStartTime+ie,$=new Date(Q.availabilityStartTime.getTime()+ue*1e3)),$}function K(Q,Y){if(!Y)return ae(Q);if(_.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var ie=le(Q);return me(ie.now,ie.range),ie.range}return re(Q)}function ae(Q){var Y={start:NaN,end:NaN},ie=0,ue=NaN;return Q.forEach(function($){var W=$.getStreamInfo();ie+=W.duration,(isNaN(ue)||W.start<ue)&&(ue=W.start)}),Y.start=ue,Y.end=ue+ie,Y}function re(Q){var Y={start:NaN,end:NaN};if(!Q||Q.length===0)return Y;var ie=Q[0].getAdapter().getRegularPeriods()[0],ue=V(new Date,ie),$=ie.mpd.timeShiftBufferDepth,W=isNaN($)?0:ue-$;if(Y.start=de(Q,W),Y.end=!isNaN(Y.start)&&ue<Y.start?ue:de(Q,ue,!0),!isNaN($)&&Y.end<ue-$&&(Y.end=NaN),_.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var B=le(Q);if(B.range.end<Y.start)return y.trigger(p.default.CONFORMANCE_VIOLATION,{level:E.default.LEVELS.WARNING,event:E.default.EVENTS.INVALID_DVR_WINDOW}),me(B.now,B.range),B.range}return Y}function le(Q){var Y={start:NaN,end:NaN},ie=Q[0].getAdapter().getRegularPeriods()[0],ue=V(new Date,ie);if(!Q||Q.length===0)return{range:Y,now:ue};Q.forEach(function(W){var B=W.getAdapter(),L=B.getMediaInfoForType(W.getStreamInfo(),h.default.VIDEO)||B.getMediaInfoForType(W.getStreamInfo(),h.default.AUDIO),D=B.getVoRepresentations(L),O=D[0],U={start:NaN,end:NaN};if(O)if(O.segmentInfoType===u.default.SEGMENT_TIMELINE)U=te(O);else{var fe=O.adaptation.period;U.start=fe.start,U.end=Math.max(ue,fe.start+fe.duration)}!isNaN(U.start)&&(isNaN(Y.start)||Y.start>U.start)&&(Y.start=U.start),!isNaN(U.end)&&(isNaN(Y.end)||Y.end<U.end)&&(Y.end=U.end)}),Y.end=Math.min(ue,Y.end);var $=de(Q,Y.end,!0);return Y.end=isNaN($)?Y.end:$,Y.start=ie&&ie.mpd&&ie.mpd.timeShiftBufferDepth&&!isNaN(ie.mpd.timeShiftBufferDepth)&&!isNaN(Y.end)?Math.max(Y.end-ie.mpd.timeShiftBufferDepth,Y.start):Y.start,Y.start=de(Q,Y.start),{range:Y,now:ue}}function me(Q,Y){S=Q-Y.end}function de(Q,Y){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{for(var ue=0,$=!1,W=NaN;!$&&ue<Q.length;){var B=Q[ue].getStreamInfo();B.start<=Y&&(!isFinite(B.duration)||B.start+B.duration>=Y)?(W=Y,$=!0):!ie&&B.start>Y&&(isNaN(W)||B.start<W)?W=B.start:ie&&B.start+B.duration<Y&&(isNaN(W)||B.start+B.duration>W)&&(W=B.start+B.duration),ue+=1}return W}catch{return Y}}function te(Q){var Y=Q.adaptation.period.mpd.manifest.Period_asArray[Q.adaptation.period.index].AdaptationSet_asArray[Q.adaptation.index],ie=R.getRepresentationFor(Q.index,Y),ue=ie.SegmentTemplate.SegmentTimeline,$=ie.SegmentTemplate.timescale,W=ue.S_asArray,B={start:0,end:0},L=0,D,O,U,fe;for(B.start=k(W[0].t/$,Q),U=0,fe=W.length;U<fe;U++)D=W[U],O=0,D.hasOwnProperty("r")&&(O=D.r),L+=D.d/$*(1+O);return B.end=B.start+L,B}function q(Q,Y){var ie=Q.adaptation.period.start;return Y-ie}function Z(Q){Q.offset!==void 0&&!isNaN(Q.offset)&&P(Q.offset/1e3)}function pe(){x=0,S=0}function he(){y.off(o.default.UPDATE_TIME_SYNC_OFFSET,Z,this),pe()}return g={initialize:C,getClientTimeOffset:b,setClientTimeOffset:P,getClientReferenceTime:A,calcAvailabilityStartTimeFromPresentationTime:F,calcAvailabilityEndTimeFromPresentationTime:G,calcPresentationTimeFromWallTime:V,calcPresentationTimeFromMediaTime:k,calcPeriodRelativeTimeFromMpdRelativeTime:q,calcMediaTimeFromPresentationTime:H,calcWallTimeForSegment:J,calcTimeShiftBufferWindow:K,reset:he},w(),g}v.__dashjs_factory_name="TimelineConverter",r.default=l.default.getSingletonFactory(v)},"./src/dash/utils/TimelineSegmentsGetter.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/dash/utils/SegmentsUtils.js");function u(f,h){f=f||{};var p=f.timelineConverter,E=f.dashMetrics,v;function M(){if(!p)throw new Error(o.default.MISSING_CONFIG_ERROR)}function y(x){if(!x)return 0;var w=x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentTemplate||x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentList,C=w.SegmentTimeline,b=0,P=0,A=0,I,F,G,V,k,H,J;for(J=x.timescale,I=C.S_asArray,V=I.length,G=0;G<V;G++){if(F=I[G],H=0,F.hasOwnProperty("r")&&(H=F.r),F.hasOwnProperty("t")&&(b=F.t,P=b/J),H<0){var K=I[G+1];H=g(x,K,F,J,P)}for(k=0;k<=H;k++)A++,b+=F.d,P=b/J}return{numberOfSegments:A,mediaTimeOfLastSignaledSegment:P}}function _(x,w){var C=x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentTemplate||x.adaptation.period.mpd.manifest.Period_asArray[x.adaptation.period.index].AdaptationSet_asArray[x.adaptation.index].Representation_asArray[x.index].SegmentList,b=C.SegmentTimeline,P=C.SegmentURL_asArray,A=0,I=0,F=-1,G,V,k,H,J,K,ae;ae=x.timescale,G=b.S_asArray;var re=!1;for(k=0,H=G.length;k<H&&!re;k++){if(V=G[k],K=0,V.hasOwnProperty("r")&&(K=V.r),V.hasOwnProperty("t")&&(A=V.t,I=A/ae),K<0){var le=G[k+1];K=g(x,le,V,ae,I)}for(J=0;J<=K&&!re;J++)F++,re=w(A,I,C,P,V,ae,F,k),re&&(x.segmentDuration=V.d/ae),A+=V.d,I=A/ae}}function g(x,w,C,b,P){var A;if(w&&w.hasOwnProperty("t"))A=w.t/b;else try{var I=0;if(!isNaN(x.adaptation.period.start)&&!isNaN(x.adaptation.period.duration)&&isFinite(x.adaptation.period.duration))I=x.adaptation.period.start+x.adaptation.period.duration;else{var F=E.getCurrentDVRInfo();I=isNaN(F.end)?0:F.end}A=p.calcMediaTimeFromPresentationTime(I,x),x.segmentDuration=C.d/b}catch{A=0}return Math.max(Math.ceil((A-P)/(C.d/b))-1,0)}function R(x,w,C){if(M(),!x)return null;var b=null,P=!1;return _(x,function(A,I,F,G,V,k,H,J){if(P||C<0){var K=F.media,ae=V.mediaRange;return G&&(K=G[J].media||"",ae=G[J].mediaRange),b=Object(l.getTimeBasedSegment)(p,h,x,A,V.d,k,K,ae,H,V.tManifest),!0}else I>=C-V.d*.5/k&&(P=!0);return!1}),b}function S(x,w){if(M(),!x)return null;w===void 0&&(w=null);var C=null,b=p.calcMediaTimeFromPresentationTime(w,x);return _(x,function(P,A,I,F,G,V,k,H){if(b<A+G.d/V&&b>=A){var J=I.media,K=G.mediaRange;return F&&(J=F[H].media||"",K=F[H].mediaRange),C=Object(l.getTimeBasedSegment)(p,h,x,P,G.d,V,J,K,k,G.tManifest),!0}return!1}),C}return v={getSegmentByIndex:R,getSegmentByTime:S,getMediaFinishedInformation:y},v}u.__dashjs_factory_name="TimelineSegmentsGetter";var c=i.default.getClassFactory(u);r.default=c},"./src/dash/vo/AdaptationSet.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.period=null,this.index=-1,this.type=null};r.default=o},"./src/dash/vo/BaseURL.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}var o=1,l=1,u=function c(f,h,p,E){i(this,c),this.url=f||"",this.serviceLocation=h||f||"",this.dvb_priority=p||o,this.dvb_weight=E||l,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};u.DEFAULT_DVB_PRIORITY=o,u.DEFAULT_DVB_WEIGHT=l,r.default=u},"./src/dash/vo/Event.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};r.default=o},"./src/dash/vo/EventStream.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0};r.default=o},"./src/dash/vo/ManifestInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};r.default=o},"./src/dash/vo/MediaInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1};r.default=o},"./src/dash/vo/Mpd.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};r.default=o},"./src/dash/vo/PatchOperation.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f,h,p){i(this,c),this.action=f,this.xpath=h,this.value=p,this.position=null}return l(c,[{key:"getMpdTarget",value:function(h){var p=this.action==="remove"||this.action==="replace"||this.position==="before"||this.position==="after";return this.xpath.getMpdTarget(h,p)}}]),c}();r.default=u},"./src/dash/vo/Period.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};o.DEFAULT_ID="defaultId",r.default=o},"./src/dash/vo/Representation.js":function(t,r,n){n.r(r);var i=n("./src/dash/constants/DashConstants.js");function o(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function l(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function u(f,h,p){return h&&l(f.prototype,h),p&&l(f,p),f}var c=function(){function f(){o(this,f),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return u(f,[{key:"hasInitialization",value:function(){return this.initialization!==null||this.range!==null}},{key:"hasSegments",value:function(){return this.segmentInfoType!==i.default.BASE_URL&&this.segmentInfoType!==i.default.SEGMENT_BASE&&!this.indexRange}}]),f}();r.default=c},"./src/dash/vo/RepresentationInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};r.default=o},"./src/dash/vo/Segment.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null};r.default=o},"./src/dash/vo/SimpleXPath.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f){var h=this;i(this,c),this.valid=f[0]=="/",this.path=f.split("/").filter(function(p){return p.length!==0}).map(function(p){var E={name:p},v=p.indexOf("[");if(v!=-1){E.name=p.substring(0,v);var M=p.substring(v+1,p.length-1);h.valid=h.valid&&M.indexOf("[")==-1;var y=M.indexOf("=");y!=-1?(E.attribute={name:M.substring(1,y),value:M.substring(y+1)},["'",'"'].indexOf(E.attribute.value[0])!=-1&&(E.attribute.value=E.attribute.value.substring(1,E.attribute.value.length-1))):E.position=parseInt(M,10)-1}return E})}return l(c,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(h,p){for(var E=null,v=h,M=1,y="MPD";M<this.path.length&&v!==null;){E=v;var _=this.path[M];if(y=_.name,M!==this.path.length-1||!y.startsWith("@")){var g=E[y+"_asArray"]||[];g.length===0&&E[y]&&g.push(E[y]),_.position?v=g[_.position]||null:_.attribute?function(){var R=_.attribute;v=g.filter(function(S){return S[R.name]==R.value})[0]||null}():v=g[0]||null}M++}return v===null?null:y.startsWith("@")?{name:y.substring(1),leaf:v,target:v}:{name:y,leaf:v,target:p?E:v}}}]),c}();r.default=u},"./src/dash/vo/StreamInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0};r.default=o},"./src/dash/vo/UTCTiming.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.schemeIdUri="",this.value=""};r.default=o},"./src/streaming/FragmentLoader.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/net/URLLoader.js"),l=n("./src/streaming/vo/HeadRequest.js"),u=n("./src/streaming/vo/DashJSError.js"),c=n("./src/core/FactoryMaker.js");function f(h){h=h||{};var p=this.context,E=h.eventBus,v=h.events,M=h.urlUtils,y=h.errors,_=h.streamId,g,R;function S(){R=Object(o.default)(p).create({errHandler:h.errHandler,errors:y,dashMetrics:h.dashMetrics,mediaPlayerModel:h.mediaPlayerModel,requestModifier:h.requestModifier,urlUtils:M,constants:i.default,boxParser:h.boxParser,dashConstants:h.dashConstants,requestTimeout:h.settings.get().streaming.fragmentRequestTimeout})}function x(P){var A=function(G){E.trigger(v.CHECK_FOR_EXISTENCE_COMPLETED,{request:P,exists:G})};if(P){var I=new l.default(P.url);R.load({request:I,success:function(){A(!0)},error:function(){A(!1)}})}else A(!1)}function w(P){var A=function(F,G){E.trigger(v.LOADING_COMPLETED,{request:P,response:F||null,error:G||null,sender:g})};P?R.load({request:P,progress:function(F){E.trigger(v.LOADING_PROGRESS,{request:P,stream:F.stream,streamId:_}),F.data&&E.trigger(v.LOADING_DATA_PROGRESS,{request:P,response:F.data||null,error:null,sender:g})},success:function(F){A(F)},error:function(F,G,V){A(void 0,new u.default(y.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,V,G))},abort:function(F){F&&E.trigger(v.LOADING_ABANDONED,{mediaType:F.mediaType,request:F,sender:g})}}):A(void 0,new u.default(y.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,y.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))}function C(){R&&R.abort()}function b(){R&&(R.abort(),R=null)}return g={checkForExistence:x,load:w,abort:C,reset:b},S(),g}f.__dashjs_factory_name="FragmentLoader",r.default=c.default.getClassFactory(f)},"./src/streaming/ManifestLoader.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/dash/constants/DashConstants.js"),l=n("./src/streaming/controllers/XlinkController.js"),u=n("./src/streaming/net/URLLoader.js"),c=n("./src/streaming/utils/URLUtils.js"),f=n("./src/streaming/vo/TextRequest.js"),h=n("./src/streaming/vo/DashJSError.js"),p=n("./src/streaming/vo/metrics/HTTPRequest.js"),E=n("./src/core/EventBus.js"),v=n("./src/core/events/Events.js"),M=n("./src/core/errors/Errors.js"),y=n("./src/core/FactoryMaker.js"),_=n("./src/dash/parser/DashParser.js");function g(S){S=S||{};var x=this.context,w=S.debug,C=Object(E.default)(x).getInstance(),b=Object(c.default)(x).getInstance(),P,A,I,F,G,V=S.mssHandler,k=S.errHandler;function H(){A=w.getLogger(P),C.on(v.default.XLINK_READY,J,P),I=Object(u.default)(x).create({errHandler:S.errHandler,dashMetrics:S.dashMetrics,mediaPlayerModel:S.mediaPlayerModel,requestModifier:S.requestModifier,urlUtils:b,constants:i.default,dashConstants:o.default,errors:M.default}),F=Object(l.default)(x).create({errHandler:k,dashMetrics:S.dashMetrics,mediaPlayerModel:S.mediaPlayerModel,requestModifier:S.requestModifier,settings:S.settings}),G=null}function J(le){C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:le.manifest})}function K(le){var me=null;return le.indexOf("SmoothStreamingMedia")>-1?(V&&(me=V.createMssParser(),V.registerEvents()),me):le.indexOf("MPD")>-1||le.indexOf("Patch")>-1?Object(_.default)(x).create({debug:w}):me}function ae(le){var me=new f.default(le,p.HTTPRequest.MPD_TYPE);I.load({request:me,success:function(te,q,Z){if(!!F){var pe,he,Q;if(Z&&Z!==le?(he=b.parseBaseUrl(Z),pe=Z):(b.isRelative(le)&&(le=b.resolve(le,window.location.href)),he=b.parseBaseUrl(le)),q=="No Content"){C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:null});return}if(G===null&&(G=K(te)),G===null){C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(le))});return}F.setMatchers(G.getMatchers()),F.setIron(G.getIron());try{Q=G.parse(te)}catch{C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(le))});return}Q?(Q.url=pe||le,Q.originalUrl||(Q.originalUrl=Q.url),Q.hasOwnProperty(i.default.LOCATION)&&(he=b.parseBaseUrl(Q.Location_asArray[0]),A.debug("BaseURI set by Location to: "+he)),Q.baseUri=he,Q.loadedTime=new Date,F.resolveManifestOnLoad(Q),C.trigger(v.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:te})):C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(le))})}},error:function(te,q,Z){C.trigger(v.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new h.default(M.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,M.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(le,", ").concat(Z))})}})}function re(){C.off(v.default.XLINK_READY,J,P),V&&V.reset(),F&&(F.reset(),F=null),I&&(I.abort(),I=null)}return P={load:ae,reset:re},H(),P}g.__dashjs_factory_name="ManifestLoader";var R=y.default.getClassFactory(g);r.default=R},"./src/streaming/ManifestUpdater.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/streaming/MediaPlayerEvents.js"),u=n("./src/core/FactoryMaker.js"),c=n("./src/core/Debug.js"),f=n("./src/core/errors/Errors.js"),h=n("./src/dash/constants/DashConstants.js"),p=n("./src/streaming/utils/URLUtils.js");function E(){var v=this.context,M=Object(i.default)(v).getInstance(),y=Object(p.default)(v).getInstance(),_,g,R,S,x,w,C,b,P,A,I,F;function G(){g=Object(c.default)(v).getInstance().getLogger(_)}function V(Q){!Q||(Q.manifestModel&&(P=Q.manifestModel),Q.adapter&&(A=Q.adapter),Q.manifestLoader&&(b=Q.manifestLoader),Q.errHandler&&(I=Q.errHandler),Q.settings&&(F=Q.settings))}function k(){J(),M.on(o.default.STREAMS_COMPOSED,pe,this),M.on(l.default.PLAYBACK_STARTED,q,this),M.on(l.default.PLAYBACK_PAUSED,Z,this),M.on(o.default.INTERNAL_MANIFEST_LOADED,te,this)}function H(Q){me(Q)}function J(){R=NaN,C=!1,x=!0,w=!1,ae()}function K(){M.off(l.default.PLAYBACK_STARTED,q,this),M.off(l.default.PLAYBACK_PAUSED,Z,this),M.off(o.default.STREAMS_COMPOSED,pe,this),M.off(o.default.INTERNAL_MANIFEST_LOADED,te,this),J()}function ae(){S!==null&&(clearTimeout(S),S=null)}function re(Q){ae(),!w&&(isNaN(Q)&&!isNaN(R)&&(Q=R*1e3),isNaN(Q)||(g.debug("Refresh manifest in "+Q+" milliseconds."),S=setTimeout(de,Q)))}function le(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;C=!0;var Y=P.getValue(),ie=Y.url,ue=A.getPatchLocation(Y),$=A.getLocation(Y);ue&&!Q?ie=ue:$&&(ie=$),y.isRelative(ie)&&(ie=y.resolve(ie,Y.url)),b.load(ie)}function me(Q){if(!Q)Q=P.getValue(),Q.loadedTime=new Date;else if(A.getIsPatch(Q)){var Y=Q;Q=P.getValue();var ie=A.isPatchValid(Q,Y),ue=ie;if(ie){var $=A.getPublishTime(Q);ue=A.applyPatchToManifest(Q,Y);var W=A.getPublishTime(Q);ue=$.getTime()!=W.getTime()}if(!ue){g.debug("Patch provided is invalid, performing full manifest refresh"),le(!0);return}Q.loadedTime=new Date}if(P.getValue()&&P.getValue().type===h.default.DYNAMIC&&Q.type===h.default.STATIC){M.trigger(o.default.DYNAMIC_TO_STATIC),C=!1,w=!0;return}P.setValue(Q);var B=new Date,L=(B.getTime()-Q.loadedTime.getTime())/1e3;R=A.getManifestUpdatePeriod(Q,L),R*1e3>2147483647&&(R=2147483647/1e3),M.trigger(o.default.MANIFEST_UPDATED,{manifest:Q}),g.info("Manifest has been refreshed at "+B+"["+B.getTime()/1e3+"] "),x||re()}function de(){if(!x){if(C){re(F.get().streaming.manifestUpdateRetryInterval);return}le()}}function te(Q){Q.error?Q.error.code===f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&I.error(Q.error):me(Q.manifest)}function q(){x=!1,re()}function Z(){x=!F.get().streaming.scheduling.scheduleWhilePaused,x&&ae()}function pe(){C=!1}function he(){return C}return _={initialize:k,setManifest:H,refreshManifest:le,getIsUpdating:he,setConfig:V,reset:K},G(),_}E.__dashjs_factory_name="ManifestUpdater",r.default=u.default.getClassFactory(E)},"./src/streaming/MediaPlayer.js":function(t,r,n){n.r(r);var i=n("./externals/cea608-parser.js"),o=n.n(i),l=n("./src/streaming/constants/Constants.js"),u=n("./src/dash/constants/DashConstants.js"),c=n("./src/streaming/constants/MetricsConstants.js"),f=n("./src/streaming/controllers/PlaybackController.js"),h=n("./src/streaming/controllers/StreamController.js"),p=n("./src/streaming/controllers/GapController.js"),E=n("./src/streaming/controllers/MediaController.js"),v=n("./src/streaming/controllers/BaseURLController.js"),M=n("./src/streaming/ManifestLoader.js"),y=n("./src/streaming/utils/ErrorHandler.js"),_=n("./src/streaming/utils/Capabilities.js"),g=n("./src/streaming/utils/CapabilitiesFilter.js"),R=n("./src/streaming/utils/RequestModifier.js"),S=n("./src/streaming/models/URIFragmentModel.js"),x=n("./src/streaming/models/ManifestModel.js"),w=n("./src/streaming/models/MediaPlayerModel.js"),C=n("./src/streaming/controllers/AbrController.js"),b=n("./src/streaming/net/SchemeLoaderFactory.js"),P=n("./src/streaming/models/VideoModel.js"),A=n("./src/streaming/models/CmcdModel.js"),I=n("./src/streaming/utils/DOMStorage.js"),F=n("./src/core/Debug.js"),G=n("./src/core/errors/Errors.js"),V=n("./src/core/EventBus.js"),k=n("./src/core/events/Events.js"),H=n("./src/streaming/MediaPlayerEvents.js"),J=n("./src/core/FactoryMaker.js"),K=n("./src/core/Settings.js"),ae=n("./src/core/Version.js"),re=n("./src/dash/controllers/SegmentBaseController.js"),le=n("./src/dash/DashAdapter.js"),me=n("./src/dash/DashMetrics.js"),de=n("./src/dash/utils/TimelineConverter.js"),te=n("./src/streaming/vo/metrics/HTTPRequest.js"),q=n("./externals/base64.js"),Z=n.n(q),pe=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),he=n.n(pe),Q=n("./src/streaming/vo/DashJSError.js"),Y=n("./src/streaming/utils/SupervisorTools.js"),ie=n("./src/streaming/ManifestUpdater.js"),ue=n("./src/streaming/utils/URLUtils.js"),$=n("./src/streaming/utils/BoxParser.js"),W=n("./src/streaming/text/TextController.js");function B(){var D="You must first call initialize() and set a source before calling this method",O="You must first call initialize() and set a valid source and view before calling this method",U="You must first call attachView() to set the video element before calling this method",fe="You must first call attachSource() with a valid source before calling this method",ye="MediaPlayer not initialized!",_e=this.context,ee=Object(V.default)(_e).getInstance(),j=Object(K.default)(_e).getInstance(),X=Object(F.default)(_e).getInstance({settings:j}),z,oe,se,ce,Se,Me,ve,be,Ne,Ue,Xe,ot,ct,xt,Bt,Lt,Pt,Ht,Oe,ze,Fe,Ce,we,Qe,it,st,at,Ae,Be,We,Te,De,Ze,nt,ge,Pe;function qe(){oe=X.getLogger(z),Se=!1,ve=!1,Me=!1,be=!0,ct=null,Lt=null,ce=null,Pt=null,Ze=null,k.default.extend(H.default),Ht=Object(w.default)(_e).getInstance(),We=Object(P.default)(_e).getInstance(),Te=Object(S.default)(_e).getInstance(),nt=[],ge=[],Pe=[]}function Ye(Ke){!Ke||(Ke.capabilities&&(Fe=Ke.capabilities),Ke.capabilitiesFilter&&(Ce=Ke.capabilitiesFilter),Ke.streamController&&(we=Ke.streamController),Ke.textController&&(Qe=Ke.textController),Ke.gapController&&(it=Ke.gapController),Ke.playbackController&&(st=Ke.playbackController),Ke.mediaPlayerModel&&(Ht=Ke.mediaPlayerModel),Ke.abrController&&(Ne=Ke.abrController),Ke.schemeLoaderFactory&&(Ue=Ke.schemeLoaderFactory),Ke.mediaController&&(ot=Ke.mediaController),Ke.settings&&(j=Ke.settings))}function $e(Ke,St,Gt){if(Fe||(Fe=Object(_.default)(_e).getInstance(),Fe.setConfig({settings:j})),Oe||(Oe=Object(y.default)(_e).getInstance()),!Fe.supportsMediaSource()){Oe.error(new Q.default(G.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,G.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));return}Se||(Se=!0,Xe=Object(de.default)(_e).getInstance(),Ne||(Ne=Object(C.default)(_e).getInstance(),Ne.setConfig({settings:j})),Ue||(Ue=Object(b.default)(_e).getInstance()),st||(st=Object(f.default)(_e).getInstance()),ot||(ot=Object(E.default)(_e).getInstance()),we||(we=Object(h.default)(_e).getInstance()),it||(it=Object(p.default)(_e).getInstance()),Ce||(Ce=Object(g.default)(_e).getInstance()),Pt=Object(le.default)(_e).getInstance(),Ae=Object(x.default)(_e).getInstance(),Be=Object(A.default)(_e).getInstance(),at=Object(me.default)(_e).getInstance({settings:j}),De=Object(I.default)(_e).getInstance({settings:j}),Pt.setConfig({constants:l.default,cea608parser:o.a,errHandler:Oe,BASE64:Z.a}),ze||(ze=Object(v.default)(_e).create()),ze.setConfig({adapter:Pt}),Ze||(Ze=Object(re.default)(_e).getInstance({dashMetrics:at,mediaPlayerModel:Ht,errHandler:Oe,baseURLController:ze,events:k.default,eventBus:ee,debug:X,boxParser:Object($.default)(_e).getInstance(),requestModifier:Object(R.default)(_e).getInstance(),errors:G.default})),ot.setConfig({domStorage:De,settings:j}),La(),Ii(Gt!==void 0?Gt:!0),du()),Ke&&sr(Ke),St&&or(St),oe.info("[dash.js "+Yt()+"] MediaPlayer has been initialized")}function ht(){or(null),sr(null),ce=null,ct&&(ct.reset(),ct=null),xt&&(xt.reset(),xt=null),j.reset(),Lt&&(Lt.reset(),Lt=null)}function bt(){ht(),nt=[],ge=[],Pe=[],J.default.deleteSingletonInstances(_e)}function It(){return!!se&&!!We.getElement()}function Dt(Ke,St,Gt,dn){ee.on(Ke,St,Gt,dn)}function gt(Ke,St,Gt){ee.off(Ke,St,Gt)}function Yt(){return Object(ae.getVersionString)()}function An(){return X}function bn(){if(!ve)throw O;(!be||mt()&&ve)&&st.play()}function tt(){if(!ve)throw O;st.pause()}function mt(){if(!ve)throw O;return st.isPaused()}function wt(Ke){if(!ve)throw O;if(Object(Y.checkParameterType)(Ke,"number"),isNaN(Ke))throw l.default.BAD_ARGUMENT_ERROR;var St=st.getIsDynamic()?kt(Ke):Ke;st.seek(St)}function Ve(){if(!ve)throw O;return st.isSeeking()}function ut(){if(!ve)throw O;return st.getIsDynamic()}function He(Ke){sn().playbackRate=Ke}function rt(){return sn().playbackRate}function dt(Ke){Object(Y.checkParameterType)(Ke,"boolean"),sn().muted=Ke}function yt(){return sn().muted}function At(Ke){if(typeof Ke!="number"||isNaN(Ke)||Ke<0||Ke>1)throw l.default.BAD_ARGUMENT_ERROR;sn().volume=Ke}function ke(){return sn().volume}function Mt(Ke){var St=[l.default.VIDEO,l.default.AUDIO,l.default.TEXT];if(Ke)if(St.indexOf(Ke)!==-1){var dn=Ge().getCurrentBufferLevel(Ke);return dn||NaN}else return oe.warn("getBufferLength requested for invalid type"),NaN;else{var Gt=St.map(function(xn){return yn(xn).length>0?Ge().getCurrentBufferLevel(xn):Number.MAX_VALUE}).reduce(function(xn,ni){return Math.min(xn,ni)});return Gt===Number.MAX_VALUE?NaN:Gt}}function Rt(){var Ke=we&&we.hasVideoTrack()?l.default.VIDEO:l.default.AUDIO,St=at.getCurrentDVRInfo(Ke);return St?St.manifestInfo.dvrWindowSize:0}function kt(Ke){var St=we&&we.hasVideoTrack()?l.default.VIDEO:l.default.AUDIO,Gt=at.getCurrentDVRInfo(St);if(!Gt)return 0;var dn=st.getLiveDelay(),xn=Gt.range.start+Ke;return xn>Gt.range.end-dn&&(xn=Gt.range.end-dn),xn}function rn(Ke){if(!ve)throw O;var St=sn().currentTime;if(Ke!==void 0)St=we.getTimeRelativeToStreamId(St,Ke);else if(st.getIsDynamic()){var Gt=we&&we.hasVideoTrack()?l.default.VIDEO:l.default.AUDIO,dn=at.getCurrentDVRInfo(Gt);St=dn===null||St===0?0:Math.max(0,St-dn.range.start)}return St}function _n(){if(!ve)throw O;var Ke=sn().duration;if(st.getIsDynamic()){var St=we&&we.hasVideoTrack()?l.default.VIDEO:l.default.AUDIO,Gt=at.getCurrentDVRInfo(St);Ke=Gt?Gt.range.end-Gt.range.start:0}return Ke}function En(){if(!ve)throw O;return rn()<0?NaN:Xo(rn())}function pn(){if(!ve)throw O;return Xo(_n())}function ar(Ke){if(!Me)throw D;return Ne.getTopBitrateInfoFor(Ke)}function zr(Ke){if(!Me)throw D;if(Ke===l.default.IMAGE){var St=sa();if(!St)return-1;var Gt=St.getThumbnailController();return Gt?Gt.getCurrentTrackIndex():-1}return Ne.getQualityFor(Ke)}function kr(Ke,St){var Gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!Me)throw D;if(Ke===l.default.IMAGE){var dn=sa();if(!dn)return;var xn=dn.getThumbnailController();xn&&xn.setTrackByIndex(St)}Ne.setPlaybackQuality(Ke,we.getActiveStreamInfo(),St,{forceReplace:Gt})}function mr(){Ne.setElementSize(),Ne.setWindowResizeEventCalled(!0)}function Ii(Ke){Object(Y.checkParameterType)(Ke,"boolean"),be=Ke}function Di(){return be}function ei(){if(!Se)throw ye;return ve?st.getCurrentLiveLatency():NaN}function gr(Ke,St,Gt){Ht.addABRCustomRule(Ke,St,Gt)}function ia(Ke){Ht.removeABRCustomRule(Ke)}function Pi(){Ht.removeABRCustomRule()}function Ds(Ke,St){Ht.addUTCTimingSource(Ke,St)}function Oa(Ke,St){Ht.removeUTCTimingSource(Ke,St)}function Ps(){Ht.clearDefaultUTCTimingSources()}function La(){Ht.restoreDefaultUTCTimingSources()}function Na(Ke){var St=Ne.getThroughputHistory(),Gt=st.getIsDynamic();return St?St.getAverageThroughput(Ke,Gt):0}function aa(Ke,St){Ht.setXHRWithCredentialsForType(Ke,St)}function ws(Ke){return Ht.getXHRWithCredentialsForType(Ke)}function Fa(){return du()}function Ge(){return at}function ft(Ke){var St=we.getActiveStreamInfo();return!St||!Qe?!1:Qe.enableText(St.id,Ke)}function Ct(Ke){var St=we.getActiveStreamInfo();return!St||!Qe?!1:Qe.enableForcedTextStreaming(Ke)}function Wt(){var Ke=we.getActiveStreamInfo();return!Ke||!Qe?!1:Qe.isTextEnabled(Ke)}function Zt(Ke){if(!ve)throw O;var St=we.getActiveStreamInfo();!St||!Qe||Qe.setTextTrack(St.id,Ke)}function $t(){var Ke=NaN,St=we.getActiveStreamInfo();if(!(!St||!Qe))return Ke=Qe.getCurrentTrackIdx(St.id),Ke}function sn(){if(!We.getElement())throw U;return We.getElement()}function sr(Ke){if(!Se)throw ye;We.setElement(Ke),Ke&&(Ba(),Of(),Lf(),we&&we.switchToVideoElement()),ve&&ti(),Ua()}function wn(){return We?We.getTTMLRenderingDiv():null}function mi(Ke){if(!We.getElement())throw U;We.setTTMLRenderingDiv(Ke)}function Sf(Ke){if(!Me)throw D;var St=sa();return St?St.getBitrateListFor(Ke):[]}function Rn(Ke){if(!Me)throw D;return Pt.getStreamsInfo(Ke)}function yn(Ke){if(!Me)throw D;var St=we.getActiveStreamInfo();return St?ot.getTracksFor(Ke,St.id):[]}function Af(Ke,St,Gt){if(!Me)throw D;return Gt=Gt||Pt.getStreamsInfo(St,1)[0],Gt?Pt.getAllMediaInfoForType(Gt,Ke,St):[]}function xf(Ke){if(!Me)throw D;var St=we.getActiveStreamInfo();return ot.getCurrentTrackFor(Ke,St.id)}function Rf(Ke,St){if(!Se)throw ye;ot.setInitialSettings(Ke,St)}function Cf(Ke){if(!Se)throw ye;return ot.getInitialSettings(Ke)}function bf(Ke){if(!Me)throw D;ot.setTrack(Ke)}function If(){return Ba()}function iu(Ke){ct=Ke}function Df(Ke){ce=Ke,we&&we.setProtectionData(ce)}function Yn(Ke){nt.push(Ke),ct&&ct.setLicenseRequestFilters(nt)}function zo(Ke){ge.push(Ke),ct&&ct.setLicenseResponseFilters(ge)}function wi(Ke){Os(nt,Ke),ct&&ct.setLicenseRequestFilters(nt)}function au(Ke){Os(ge,Ke),ct&&ct.setLicenseResponseFilters(ge)}function ko(Ke){Pe.push(Ke),Ce&&Ce.setCustomCapabilitiesFilters(Pe)}function Rr(Ke){Os(Pe,Ke),Ce&&Ce.setCustomCapabilitiesFilters(Pe)}function Os(Ke,St){var Gt=-1;Ke.some(function(dn,xn){if(dn===St)return Gt=xn,!0}),!(Gt<0)&&Ke.splice(Gt,1)}function su(Ke){ot&&ot.setCustomInitialTrackSelectionFunction(Ke)}function ou(){ot&&ot.setCustomInitialTrackSelectionFunction(null)}function lu(Ke,St){if(typeof St=="function"){if(Ke<0){St(null);return}var Gt=st.getIsDynamic()?kt(Ke):Ke,dn=we.getStreamForTime(Gt);if(dn===null){St(null);return}var xn=dn.getThumbnailController();if(!xn){St(null);return}var ni=we.getTimeRelativeToStreamId(Gt,dn.getId());return xn.provide(ni,St)}}function uu(Ke,St){var Gt=Yo(),dn=this,xn=function ni(Oi){Oi.error?St(null,Oi.error):St(Oi.manifest),ee.off(k.default.INTERNAL_MANIFEST_LOADED,ni,dn),Gt.reset()};ee.on(k.default.INTERNAL_MANIFEST_LOADED,xn,dn),Te.initialize(Ke),Gt.load(Ke)}function cu(){if(!se)throw fe;return se}function or(Ke){if(!Se)throw ye;typeof Ke=="string"&&Te.initialize(Ke),se=Ke,(Me||ve)&&ti(),It()&&Ua()}function Pf(){return j.get()}function Cr(Ke){j.update(Ke)}function wf(){j.reset()}function fu(Ke,St,Gt){var dn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,xn=new Date(Ke*1e3),ni=xn.toLocaleDateString(St),Oi=xn.toLocaleTimeString(St,{hour12:Gt});return dn?Oi+" "+ni:Oi}function gi(Ke){Ke=Math.max(Ke,0);var St=Math.floor(Ke/3600),Gt=Math.floor(Ke%3600/60),dn=Math.floor(Ke%3600%60);return(St===0?"":St<10?"0"+St.toString()+":":St.toString()+":")+(Gt<10?"0"+Gt.toString():Gt.toString())+":"+(dn<10?"0"+dn.toString():dn.toString())}function Ls(Ke,St,Gt){J.default.extend(Ke,St,Gt,_e)}function sa(){if(!Me)throw D;var Ke=we.getActiveStreamInfo();return Ke?we.getStreamById(Ke.id):null}function In(){return Pt}function ti(){ve=!1,Me=!1,Pt.reset(),we.reset(),it.reset(),st.reset(),Ne.reset(),ot.reset(),Ze.reset(),ct&&(j.get().streaming.protection.keepProtectionMediaKeys?ct.stop():(ct.reset(),ct=null,Ba())),Qe.reset(),Be.reset()}function Ko(){var Ke=Yo();we||(we=Object(h.default)(_e).getInstance()),Qe||(Qe=Object(W.default)(_e).create({errHandler:Oe,manifestModel:Ae,adapter:Pt,mediaController:ot,videoModel:We,settings:j})),Ce.setConfig({capabilities:Fe,adapter:Pt,settings:j,manifestModel:Ae,errHandler:Oe}),Ce.setCustomCapabilitiesFilters(Pe),we.setConfig({capabilities:Fe,capabilitiesFilter:Ce,manifestLoader:Ke,manifestModel:Ae,mediaPlayerModel:Ht,protectionController:ct,textController:Qe,adapter:Pt,dashMetrics:at,errHandler:Oe,timelineConverter:Xe,videoModel:We,playbackController:st,abrController:Ne,mediaController:ot,settings:j,baseURLController:ze,uriFragmentModel:Te,segmentBaseController:Ze}),it.setConfig({settings:j,playbackController:st,streamController:we,videoModel:We,timelineConverter:Xe,adapter:Pt}),st.setConfig({streamController:we,dashMetrics:at,mediaPlayerModel:Ht,adapter:Pt,videoModel:We,timelineConverter:Xe,settings:j}),Ne.setConfig({streamController:we,domStorage:De,mediaPlayerModel:Ht,dashMetrics:at,adapter:Pt,videoModel:We,settings:j}),Be.setConfig({abrController:Ne,dashMetrics:at,playbackController:st}),Ne.initialize(),we.initialize(be,ce),Qe.initialize(),it.initialize(),Be.initialize(),Ze.initialize()}function Yo(){return Object(M.default)(_e).create({debug:X,errHandler:Oe,dashMetrics:at,mediaPlayerModel:Ht,requestModifier:Object(R.default)(_e).getInstance(),mssHandler:Bt,settings:j})}function Ba(){if(ct)return ct;var Ke=dashjs.Protection;if(typeof Ke=="function"){var St=Ke(_e).create();return k.default.extend(Ke.events),H.default.extend(Ke.events,{publicOnly:!0}),G.default.extend(Ke.errors),Fe||(Fe=Object(_.default)(_e).getInstance()),ct=St.createProtectionSystem({debug:X,errHandler:Oe,videoModel:We,capabilities:Fe,eventBus:ee,events:k.default,BASE64:Z.a,constants:l.default,cmcdModel:Be,settings:j}),ct&&(ct.setLicenseRequestFilters(nt),ct.setLicenseResponseFilters(ge)),ct}return null}function Of(){if(!xt){var Ke=dashjs.MetricsReporting;if(typeof Ke=="function"){var St=Ke(_e).create();xt=St.createMetricsReporting({debug:X,eventBus:ee,mediaElement:sn(),adapter:Pt,dashMetrics:at,events:k.default,constants:l.default,metricsConstants:c.default})}}}function Lf(){if(!Bt){var Ke=dashjs.MssHandler;typeof Ke=="function"&&(G.default.extend(Ke.errors),Bt=Ke(_e).create({eventBus:ee,mediaPlayerModel:Ht,dashMetrics:at,manifestModel:Ae,playbackController:st,streamController:we,protectionController:ct,baseURLController:ze,errHandler:Oe,events:k.default,constants:l.default,debug:X,initSegmentType:te.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:Z.a,ISOBoxer:he.a,settings:j}))}}function du(){if(!Se)throw ye;if(Lt)return Lt;var Ke=dashjs.OfflineController;if(typeof Ke=="function"){k.default.extend(Ke.events),H.default.extend(Ke.events,{publicOnly:!0}),G.default.extend(Ke.errors);var St=Yo(),Gt=Object(ie.default)(_e).create();return Gt.setConfig({manifestModel:Ae,adapter:Pt,manifestLoader:St,errHandler:Oe}),Lt=Ke(_e).create({debug:X,manifestUpdater:Gt,baseURLController:ze,manifestLoader:St,manifestModel:Ae,mediaPlayerModel:Ht,abrController:Ne,playbackController:st,adapter:Pt,errHandler:Oe,dashMetrics:at,timelineConverter:Xe,segmentBaseController:Ze,schemeLoaderFactory:Ue,eventBus:ee,events:k.default,errors:G.default,constants:l.default,settings:j,dashConstants:u.default,urlUtils:Object(ue.default)(_e).getInstance()}),Lt}return null}function Xo(Ke){var St=we&&we.hasVideoTrack()?l.default.VIDEO:l.default.AUDIO,Gt=at.getCurrentDVRInfo(St),dn,xn;return Gt?(dn=Gt.manifestInfo.availableFrom.getTime()/1e3,xn=Ke+(dn+Gt.range.start),xn):0}function Ua(){Lt&&Lt.resetRecords(),!Me&&se&&(Me=!0,oe.info("Streaming Initialized"),Ko(),typeof se=="string"?we.load(se):we.loadWithManifest(se)),!ve&&It()&&(ve=!0,oe.info("Playback Initialized"))}return z={initialize:$e,setConfig:Ye,on:Dt,off:gt,extend:Ls,attachView:sr,attachSource:or,isReady:It,play:bn,isPaused:mt,pause:tt,isSeeking:Ve,isDynamic:ut,seek:wt,setPlaybackRate:He,getPlaybackRate:rt,setMute:dt,isMuted:yt,setVolume:At,getVolume:ke,time:rn,duration:_n,timeAsUTC:En,durationAsUTC:pn,getActiveStream:sa,getDVRWindowSize:Rt,getDVRSeekOffset:kt,convertToTimeCode:gi,formatUTC:fu,getVersion:Yt,getDebug:An,getBufferLength:Mt,getTTMLRenderingDiv:wn,getVideoElement:sn,getSource:cu,getCurrentLiveLatency:ei,getTopBitrateInfoFor:ar,setAutoPlay:Ii,getAutoPlay:Di,getDashMetrics:Ge,getQualityFor:zr,setQualityFor:kr,updatePortalSize:mr,enableText:ft,enableForcedTextStreaming:Ct,isTextEnabled:Wt,setTextTrack:Zt,getBitrateInfoListFor:Sf,getStreamsFromManifest:Rn,getTracksFor:yn,getTracksForTypeFromManifest:Af,getCurrentTrackFor:xf,setInitialMediaSettingsFor:Rf,getInitialMediaSettingsFor:Cf,setCurrentTrack:bf,addABRCustomRule:gr,removeABRCustomRule:ia,removeAllABRCustomRule:Pi,getAverageThroughput:Na,retrieveManifest:uu,addUTCTimingSource:Ds,removeUTCTimingSource:Oa,clearDefaultUTCTimingSources:Ps,restoreDefaultUTCTimingSources:La,setXHRWithCredentialsForType:aa,getXHRWithCredentialsForType:ws,getProtectionController:If,attachProtectionController:iu,setProtectionData:Df,registerLicenseRequestFilter:Yn,registerLicenseResponseFilter:zo,unregisterLicenseRequestFilter:wi,unregisterLicenseResponseFilter:au,registerCustomCapabilitiesFilter:ko,unregisterCustomCapabilitiesFilter:Rr,setCustomInitialTrackSelectionFunction:su,resetCustomInitialTrackSelectionFunction:ou,attachTTMLRenderingDiv:mi,getCurrentTextTrackIndex:$t,provideThumbnail:lu,getDashAdapter:In,getOfflineController:Fa,getSettings:Pf,updateSettings:Cr,resetSettings:wf,reset:ht,destroy:bt},qe(),z}B.__dashjs_factory_name="MediaPlayer";var L=J.default.getClassFactory(B);L.events=H.default,L.errors=G.default,J.default.updateClassFactory(B.__dashjs_factory_name,L),r.default=L},"./src/streaming/MediaPlayerEvents.js":function(t,r,n){n.r(r);var i=n("./src/core/events/EventsBase.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){var S;return l(this,R),S=g.call(this),S.AST_IN_FUTURE="astInFuture",S.BUFFER_EMPTY="bufferStalled",S.BUFFER_LOADED="bufferLoaded",S.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",S.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",S.DYNAMIC_TO_STATIC="dynamicToStatic",S.ERROR="error",S.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",S.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",S.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",S.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",S.LOG="log",S.MANIFEST_LOADED="manifestLoaded",S.METRICS_CHANGED="metricsChanged",S.METRIC_CHANGED="metricChanged",S.METRIC_ADDED="metricAdded",S.METRIC_UPDATED="metricUpdated",S.PERIOD_SWITCH_STARTED="periodSwitchStarted",S.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",S.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",S.QUALITY_CHANGE_RENDERED="qualityChangeRendered",S.TRACK_CHANGE_RENDERED="trackChangeRendered",S.STREAM_INITIALIZING="streamInitializing",S.STREAM_UPDATED="streamUpdated",S.STREAM_ACTIVATED="streamActivated",S.STREAM_DEACTIVATED="streamDeactivated",S.STREAM_INITIALIZED="streamInitialized",S.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",S.TEXT_TRACKS_ADDED="allTextTracksAdded",S.TEXT_TRACK_ADDED="textTrackAdded",S.TTML_PARSED="ttmlParsed",S.TTML_TO_PARSE="ttmlToParse",S.CAPTION_RENDERED="captionRendered",S.CAPTION_CONTAINER_RESIZE="captionContainerResize",S.CAN_PLAY="canPlay",S.CAN_PLAY_THROUGH="canPlayThrough",S.PLAYBACK_ENDED="playbackEnded",S.PLAYBACK_ERROR="playbackError",S.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",S.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",S.PLAYBACK_LOADED_DATA="playbackLoadedData",S.PLAYBACK_PAUSED="playbackPaused",S.PLAYBACK_PLAYING="playbackPlaying",S.PLAYBACK_PROGRESS="playbackProgress",S.PLAYBACK_RATE_CHANGED="playbackRateChanged",S.PLAYBACK_SEEKED="playbackSeeked",S.PLAYBACK_SEEKING="playbackSeeking",S.PLAYBACK_SEEK_ASKED="playbackSeekAsked",S.PLAYBACK_STALLED="playbackStalled",S.PLAYBACK_STARTED="playbackStarted",S.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",S.PLAYBACK_WAITING="playbackWaiting",S.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",S.EVENT_MODE_ON_START="eventModeOnStart",S.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",S.CONFORMANCE_VIOLATION="conformanceViolation",S.REPRESENTATION_SWITCH="representationSwitch",S}return R}(i.default),y=new M;r.default=y},"./src/streaming/MediaPlayerFactory.js":function(t,r,n){n.r(r);var i=n("./src/streaming/MediaPlayer.js");function o(){var p="application/dash+xml",E;function v(_,g,R){if(!_||!/^VIDEO$/i.test(_.nodeName))return null;if(_._dashjs_player)return _._dashjs_player;var S,x=_.id||_.name||"video element";if(g=g||[].slice.call(_.querySelectorAll("source")).filter(function(w){return w.type==p})[0],!g&&_.src)g=document.createElement("source"),g.src=_.src;else if(!g&&!_.src)return null;return R=R||{},S=Object(i.default)(R).create(),S.initialize(_,g.src,_.autoplay),E||(E=S.getDebug().getLogger()),E.debug("Converted "+x+" to dash.js player and added content: "+g.src),_._dashjs_player=S,S}function M(_,g){var R=[];_=_||"[data-dashjs-player]",g=g||document;for(var S=g.querySelectorAll(_),x=0;x<S.length;x++){var w=v(S[x],null);R.push(w)}for(var C=g.querySelectorAll('source[type="'+p+'"]'),b=0;b<C.length;b++){var P=y(C[b]),A=v(P,null);R.push(A)}return R}function y(_){return/^VIDEO$/i.test(_.nodeName)?_:y(_.parentNode)}return{create:v,createAll:M}}var l=o(),u;function c(){window.removeEventListener("load",c),l.createAll()}function f(){window.dashjs&&(window.clearInterval(u),l.createAll())}var h=typeof window!="undefined"&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!h&&typeof window!="undefined"&&window&&window.addEventListener&&(window.document.readyState==="complete"?window.dashjs?l.createAll():u=window.setInterval(f,500):window.addEventListener("load",c)),r.default=l},"./src/streaming/SourceBufferSink.js":function(t,r,n){n.r(r);var i=n("./src/core/Debug.js"),o=n("./src/streaming/vo/DashJSError.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/core/errors/Errors.js"),c=n("./src/core/Settings.js"),f=n("./src/streaming/constants/Constants.js"),h=n("./src/streaming/vo/metrics/HTTPRequest.js"),p=n("./src/core/events/Events.js"),E=.1,v=.01,M=50;function y(g){var R=this.context,S=Object(c.default)(R).getInstance(),x=g.textController,w=g.eventBus,C,b,P,A,I,F,G=[],V=[],k=!1,H=g.mediaSource,J=null;function K(){P=Object(i.default)(R).getInstance().getLogger(C)}function ae(_e,ee,j){I=_e,b=I.type;var X=I.codec;le(j),te();var z=[];return z.push($),z.push(pe(I.streamInfo)),z.push(re(X)),ee&&ee.MSETimeOffset!==void 0&&z.push(he(ee.MSETimeOffset)),Promise.all(z)}function re(_e){return new Promise(function(ee){ye(function(){A.changeType&&A.changeType(_e),ee()})})}function le(_e){A=_e.getBuffer()}function me(_e,ee,j){I=ee,b=I.type;var X=I.codec;try{if(X.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return de(_e);A=H.addSourceBuffer(X),te();var z=[];return z.push(pe(I.streamInfo)),j&&j.MSETimeOffset!==void 0&&z.push(he(j.MSETimeOffset)),Promise.all(z)}catch(oe){return I.type==f.default.TEXT&&!I.isFragmented||X.indexOf('codecs="stpp')!==-1||X.indexOf('codecs="vtt')!==-1?de(_e):Promise.reject(oe)}}function de(_e){return A=x.getTextSourceBuffer(_e),Promise.resolve()}function te(){if(typeof A.addEventListener=="function")try{A.addEventListener("updateend",O,!1),A.addEventListener("error",U,!1),A.addEventListener("abort",U,!1)}catch{F=setInterval(O,M)}else F=setInterval(O,M)}function q(){return b}function Z(){try{typeof A.removeEventListener=="function"&&(A.removeEventListener("updateend",O,!1),A.removeEventListener("error",U,!1),A.removeEventListener("abort",U,!1)),clearInterval(F)}catch(_e){P.error(_e)}}function pe(_e){return new Promise(function(ee){if(!A||!S.get().streaming.buffer.useAppendWindow){ee();return}ye(function(){try{if(!A){ee();return}var j=H.duration,X=0;_e&&!isNaN(_e.start)&&!isNaN(_e.duration)&&isFinite(_e.duration)&&(j=_e.start+_e.duration),_e&&!isNaN(_e.start)&&(X=_e.start),(A.appendWindowEnd!==j||A.appendWindowStart!==X)&&(A.appendWindowStart=0,A.appendWindowEnd=j+v,A.appendWindowStart=Math.max(X-E,0),P.debug("Updated append window for ".concat(I.type,". Set start to ").concat(A.appendWindowStart," and end to ").concat(A.appendWindowEnd))),ee()}catch{P.warn("Failed to set append window"),ee()}})})}function he(_e){return new Promise(function(ee){if(!A){ee();return}ye(function(){try{A.timestampOffset!==_e&&!isNaN(_e)&&(A.timestampOffset=_e,P.debug("Set MSE timestamp offset to ".concat(_e))),ee()}catch{ee()}})})}function Q(){if(A){try{G=[],Z(),k=!1,V=[],(!A.getClassName||A.getClassName()!=="TextSourceBuffer")&&(P.debug("Removing sourcebuffer from media source"),H.removeSourceBuffer(A))}catch{}A=null}J=null}function Y(){return A}function ie(){try{return A.buffered}catch(_e){return P.error("getAllBufferRanges exception: "+_e.message),null}}function ue(_e){var ee=this,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(X,z){if(!_e){z({chunk:_e,error:new o.default(u.default.APPEND_ERROR_CODE,u.default.APPEND_ERROR_MESSAGE)});return}V.push({data:_e,promise:{resolve:X,reject:z},request:j}),ye(B.bind(ee))})}function $(){return new Promise(function(_e){ye(function(){var ee=A.appendWindowStart,j=A.appendWindowEnd;A&&(A.abort(),A.appendWindowStart=ee,A.appendWindowEnd=j),_e()})})}function W(_e){return new Promise(function(ee,j){var X=_e.start,z=_e.end;if(!(X>=0&&z>X)){ee();return}ye(function(){try{A.remove(X,z),ye(function(){ee({from:X,to:z,unintended:!1}),_e.resolve&&_e.resolve()})}catch(oe){j({from:X,to:z,unintended:!1,error:new o.default(u.default.REMOVE_ERROR_CODE,u.default.REMOVE_ERROR_MESSAGE)}),_e.reject&&_e.reject(oe)}})})}function B(){if(!k&&V.length>0){k=!0;var _e=V[0];V.splice(0,1);var ee=function(){k=!1,V.length>0&&B.call(this),_e&&_e.data&&_e.data.segmentType&&_e.data.segmentType!==h.HTTPRequest.INIT_SEGMENT_TYPE&&delete _e.data.bytes,_e.promise.resolve({chunk:_e.data})};try{J=_e.request,_e.data.bytes.byteLength===0?ee.call(this):(A.appendBuffer?A.appendBuffer(_e.data.bytes):A.append(_e.data.bytes,_e.data),ye(ee.bind(this)))}catch(j){P.fatal('SourceBuffer append failed "'+j+'"'),V.length>0?B():k=!1,delete _e.data.bytes,_e.promise.reject({chunk:_e.data,error:new o.default(j.code,j.message)})}}}function L(){return new Promise(function(_e){try{V=[],H.readyState==="open"?ye(function(){try{A&&A.abort(),_e()}catch{_e()}}):(A&&A.setTextTrack&&H.readyState==="ended"&&A.abort(),_e())}catch{_e()}})}function D(){if(G.length>0&&!A.updating){var _e=G.shift();_e(),D()}}function O(){A.updating||D()}function U(_e){var ee=_e.target||{};fe(p.default.SOURCE_BUFFER_ERROR,{error:ee,lastRequestAppended:J})}function fe(_e,ee){var j=ee||{};w.trigger(_e,j,{streamId:I.streamInfo.id,mediaType:b})}function ye(_e){G.push(_e),A.updating||D()}return C={getType:q,getAllBufferRanges:ie,getBuffer:Y,append:ue,remove:W,abort:L,reset:Q,updateTimestampOffset:he,initializeForStreamSwitch:ae,initializeForFirstUse:me,updateAppendWindow:pe,changeType:re},K(),C}y.__dashjs_factory_name="SourceBufferSink";var _=l.default.getClassFactory(y);r.default=_},"./src/streaming/Stream.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/dash/constants/DashConstants.js"),l=n("./src/streaming/StreamProcessor.js"),u=n("./src/streaming/controllers/FragmentController.js"),c=n("./src/streaming/thumbnail/ThumbnailController.js"),f=n("./src/core/EventBus.js"),h=n("./src/core/events/Events.js"),p=n("./src/core/Debug.js"),E=n("./src/core/errors/Errors.js"),v=n("./src/core/FactoryMaker.js"),M=n("./src/streaming/vo/DashJSError.js"),y=n("./src/streaming/utils/BoxParser.js"),_=n("./src/streaming/utils/URLUtils.js"),g=n("./src/streaming/controllers/BlacklistController.js"),R=[i.default.VIDEO,i.default.AUDIO,i.default.TEXT,i.default.MUXED,i.default.IMAGE];function S(x){x=x||{};var w=this.context,C=Object(f.default)(w).getInstance(),b=Object(_.default)(w).getInstance(),P=x.manifestModel,A=x.mediaPlayerModel,I=x.dashMetrics,F=x.manifestUpdater,G=x.adapter,V=x.timelineConverter,k=x.capabilities,H=x.errHandler,J=x.abrController,K=x.playbackController,ae=x.eventController,re=x.mediaController,le=x.protectionController,me=x.textController,de=x.videoModel,te=x.streamInfo,q=x.settings,Z,pe,he,Q,Y,ie,ue,$,W,B,L,D,O,U,fe,ye,_e,ee;function j(){try{ye=Object(p.default)(w).getInstance(),pe=ye.getLogger(Z),Pt(),fe=Object(y.default)(w).getInstance(),O=Object(g.default)(w).create({updateEventName:h.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:h.default.SEGMENT_LOCATION_BLACKLIST_ADD}),L=Object(u.default)(w).create({streamInfo:te,mediaPlayerModel:A,dashMetrics:I,errHandler:H,settings:q,boxParser:fe,dashConstants:o.default,urlUtils:b})}catch(He){throw He}}function X(){z(),se(),me.initializeForStream(te),C.trigger(h.default.STREAM_UPDATED,{streamInfo:te})}function z(){C.on(h.default.BUFFERING_COMPLETED,Pe,Z),C.on(h.default.DATA_UPDATE_COMPLETED,qe,Z),C.on(h.default.INBAND_EVENTS,Ye,Z)}function oe(){C.off(h.default.DATA_UPDATE_COMPLETED,qe,Z),C.off(h.default.BUFFERING_COMPLETED,Pe,Z),C.off(h.default.INBAND_EVENTS,Ye,Z)}function se(){le&&(C.on(h.default.KEY_ERROR,We,Z),C.on(h.default.SERVER_CERTIFICATE_UPDATED,We,Z),C.on(h.default.LICENSE_REQUEST_COMPLETE,We,Z),C.on(h.default.KEY_SYSTEM_SELECTED,We,Z),C.on(h.default.KEY_SESSION_CREATED,We,Z),C.on(h.default.KEY_STATUSES_CHANGED,We,Z))}function ce(){le&&(C.off(h.default.KEY_ERROR,We,Z),C.off(h.default.SERVER_CERTIFICATE_UPDATED,We,Z),C.off(h.default.LICENSE_REQUEST_COMPLETE,We,Z),C.off(h.default.KEY_SYSTEM_SELECTED,We,Z),C.off(h.default.KEY_SESSION_CREATED,We,Z),C.off(h.default.KEY_STATUSES_CHANGED,We,Z))}function Se(){return te?te.id:null}function Me(He,rt){return new Promise(function(dt,yt){if(Y){dt(rt);return}if(wt()){Y=!0,C.trigger(h.default.STREAM_ACTIVATED,{streamInfo:te}),dt(rt);return}ve(He,rt).then(function(At){Y=!0,C.trigger(h.default.STREAM_ACTIVATED,{streamInfo:te}),dt(At)}).catch(function(At){yt(At)})})}function ve(He,rt){return Ne(He,rt)}function be(He,rt){return new Promise(function(dt,yt){if(wt()){yt();return}pe.info("[startPreloading] Preloading next stream with id ".concat(we())),mt(!0),Ne(He,rt).then(function(){for(var At=0;At<he.length&&he[At];At++)he[At].setExplicitBufferingTime(Ce()),he[At].getScheduleController().startScheduleTimer();dt()}).catch(function(){mt(!1),yt()})})}function Ne(He,rt){return new Promise(function(dt,yt){Ae(),B=!0,Ze();var At=de.getElement();R.forEach(function(ke){(ke!==i.default.VIDEO||!At||At&&/^VIDEO$/i.test(At.nodeName))&&Ue(ke,He)}),ct(rt).then(function(ke){if(B=!1,he.length===0){var Mt="No streams to play.";H.error(new M.default(E.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Mt,P.getValue())),pe.fatal(Mt)}else nt();me.createTracks(te),dt(ke)}).catch(function(ke){yt(ke)})})}function Ue(He,rt){var dt=G.getAllMediaInfoForType(te,He),yt=[],At=null,ke;if(!dt||dt.length===0){pe.info("No "+He+" data.");return}He===i.default.VIDEO&&(ue=!0),He===i.default.AUDIO&&($=!0);for(var Mt=0,Rt=dt.length;Mt<Rt;Mt++)At=dt[Mt],He===i.default.TEXT&&!!At.isEmbedded&&(me.addEmbeddedTrack(te,At),yt.push(At)),Xe(At)&&re.addTrack(At);if(yt.length>0&&(re.setInitialMediaSettingsForType(He,te),me.setInitialSettings(re.getInitialSettings(He)),me.addMediaInfosToBuffer(te,He,yt)),dt=dt.filter(function(rn){return!rn.isEmbedded}),dt.length!==0){if(He===i.default.IMAGE){D=Object(c.default)(w).create({streamInfo:te,adapter:G,baseURLController:x.baseURLController,timelineConverter:x.timelineConverter,debug:ye,eventBus:C,events:h.default,dashConstants:o.default,dashMetrics:x.dashMetrics,segmentBaseController:x.segmentBaseController}),D.initialize();return}C.trigger(h.default.STREAM_INITIALIZING,{streamInfo:te,mediaInfo:At}),re.setInitialMediaSettingsForType(He,te);var kt=ot(dt,rt);ke=re.getCurrentTrackFor(He,te.id),ke&&(J.updateTopQualityIndex(ke),kt.selectMediaInfo(He!==i.default.TEXT||!ke.isEmbedded?ke:dt[0]))}}function Xe(He){var rt=He?He.type:null,dt;return rt===i.default.MUXED?(dt="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",pe.fatal(dt),H.error(new M.default(E.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,dt,P.getValue())),!1):rt===i.default.TEXT||rt===i.default.IMAGE?!0:!!He.contentProtection&&!k.supportsEncryptedMedia()?(H.error(new M.default(E.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,E.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),!1):!0}function ot(He,rt){var dt=He&&He.length>0?He[0]:null,yt=L.getModel(dt?dt.type:null),At=dt?dt.type:null,ke=dt?dt.mimeType:null,Mt=dt?dt.isFragmented:null,Rt=Object(l.default)(w).create({streamInfo:te,type:At,mimeType:ke,timelineConverter:V,adapter:G,manifestModel:P,mediaPlayerModel:A,fragmentModel:yt,dashMetrics:x.dashMetrics,baseURLController:x.baseURLController,segmentBaseController:x.segmentBaseController,abrController:J,playbackController:K,mediaController:re,textController:me,errHandler:H,settings:q,boxParser:fe,segmentBlacklistController:O});Rt.initialize(rt,ue,Mt),he.push(Rt);for(var kt=0;kt<He.length;kt++)Rt.addMediaInfo(He[kt]);return At===i.default.TEXT&&me.addMediaInfosToBuffer(te,At,He,yt),Rt}function ct(He){return new Promise(function(rt){var dt={},yt=he.map(function(At){return At.createBufferSinks(He)});Promise.all(yt).then(function(At){At.forEach(function(ke){ke&&(dt[ke.getType()]=ke)}),rt(dt)}).catch(function(){rt(dt)})})}function xt(He){for(var rt=he?he.length:0,dt=!1,yt=0;yt<rt;yt++){var At=he[yt].getFragmentModel();At.abortRequests(),At.resetInitialSettings(),he[yt].reset(dt,He)}me&&me.deactivateStream(te),he=[],Y=!1,ie=!1,mt(!1),Fe(!1),C.trigger(h.default.STREAM_DEACTIVATED,{streamInfo:te})}function Bt(){return Y}function Lt(He){for(var rt=0;rt<he.length;)Xe(he[rt].getMediaInfo())?(he[rt].setMediaSource(He),rt++):(he[rt].reset(),he.splice(rt,1));if(he.length===0){var dt="No streams to play.";H.error(new M.default(E.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,dt+"nostreams",P.getValue())),pe.fatal(dt)}}function Pt(He){xt(He),Q=!1,ue=!1,$=!1,W={},B=!1,_e=!1,ee=[]}function Ht(He){L&&(L.reset(),L=null),J&&te&&J.clearDataForStream(te.id),O&&(O.reset(),O=null),Pt(He),te=null,oe(),ce()}function Oe(){return te?te.duration:NaN}function ze(){return _e}function Fe(He){_e=He}function Ce(){return te?te.start:NaN}function we(){return te?te.id:null}function Qe(){return te}function it(){return $}function st(){return ue}function at(){return D}function Ae(){if(!de||!J)throw new Error(i.default.MISSING_CONFIG_ERROR)}function Be(He){if(Ae(),He===i.default.IMAGE)return D?D.getBitrateList():[];var rt=ge(He);return J.getBitrateList(rt)}function We(He){He.error&&(H.error(He.error),pe.fatal(He.error.message))}function Te(He){if(!(!Y||!te)){ie=!1;var rt=He.newMediaInfo,dt=P.getValue();G.setCurrentMediaInfo(te.id,rt.type,rt);var yt=$e(rt);if(!!yt){var At=K.getTime();pe.info("Stream -  Process track changed at current time "+At),dt.refreshManifestOnSwitchTrack?(ee.push(He),F.getIsUpdating()||(pe.debug("Stream -  Refreshing manifest for switch track"),F.refreshManifest())):yt.selectMediaInfo(rt).then(function(){(rt.type===i.default.VIDEO||rt.type===i.default.AUDIO)&&J.updateTopQualityIndex(rt),yt.prepareTrackSwitch()})}}}function De(He){var rt=ht(He.mediaType);rt&&rt.prepareQualityChange(He)}function Ze(){if(ae){var He=G.getEventsFor(te);ae.addInlineEvents(He)}}function nt(){for(var He=he.length,rt=!!W.audio||!!W.video,dt=rt?new M.default(E.default.DATA_UPDATE_FAILED_ERROR_CODE,E.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,yt=0;yt<He;yt++)if(he[yt].isUpdating()||B)return;if(le){le.clearMediaInfoArray();for(var At=0;At<He&&he[At];At++){var ke=he[At].getType(),Mt=he[At].getMediaInfo();if(ke===i.default.AUDIO||ke===i.default.VIDEO||ke===i.default.TEXT&&Mt.isFragmented){var Rt=he[At].getMediaInfo();Rt&&le.initializeForMedia(Rt)}}}dt?H.error(dt):Q||(Q=!0,de.waitForReadyState(i.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){C.trigger(h.default.STREAM_INITIALIZED,{streamInfo:te})}))}function ge(He){for(var rt=null,dt=0;dt<he.length;dt++)if(rt=he[dt],rt.getType()===He)return rt.getMediaInfo();return null}function Pe(){var He=bt(),rt=He.length;if(rt===0){pe.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");return}for(var dt=0;dt<rt;dt++)if(!He[dt].isBufferingCompleted()&&(He[dt].getType()===i.default.AUDIO||He[dt].getType()===i.default.VIDEO)){pe.debug("onBufferingCompleted - One streamProcessor has finished but",He[dt].getType(),"one is not buffering completed");return}pe.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),ie=!0,C.trigger(h.default.STREAM_BUFFERING_COMPLETED,{streamInfo:te},{streamInfo:te})}function qe(He){W[He.mediaType]=He.error,nt()}function Ye(He){ae&&ae.addInbandEvents(He.events)}function $e(He){return!He||!He.type?null:ht(He.type)}function ht(He){if(!He)return null;var rt=bt();return rt.filter(function(dt){return dt.getType()===He})[0]}function bt(){for(var He=[],rt,dt,yt=0;yt<he.length;yt++)dt=he[yt],rt=dt.getType(),(rt===i.default.AUDIO||rt===i.default.VIDEO||rt===i.default.TEXT)&&He.push(dt);return He}function It(){for(var He=he.length,rt=0;rt<He&&he[rt];rt++)he[rt].getScheduleController().startScheduleTimer()}function Dt(He){return new Promise(function(rt){B=!0,te=He,ae&&Ze();for(var dt=[],yt=0,At=he.length;yt<At;yt++){var ke=he[yt],Mt=ke.getMediaInfo();dt.push(ke.updateStreamInfo(te));var Rt=G.getAllMediaInfoForType(te,ke.getType());if(Rt){ke.clearMediaInfoArray();for(var kt=0;kt<Rt.length;kt++){var rn=Rt[kt];ke.addMediaInfo(Rt[kt]),G.areMediaInfosEqual(Mt,rn)&&(J.updateTopQualityIndex(rn),dt.push(ke.selectMediaInfo(rn)))}}}Promise.all(dt).then(function(){for(dt=[];ee.length>0;){var _n=ee.pop(),En=_n.newMediaInfo,pn=$e(_n.oldMediaInfo);if(!pn)return;dt.push(pn.prepareTrackSwitch()),pn.selectMediaInfo(En)}return Promise.all(dt)}).then(function(){B=!1,nt(),C.trigger(h.default.STREAM_UPDATED,{streamInfo:te}),rt()})})}function gt(He){var rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return tt(He,i.default.VIDEO,rt)&&tt(He,i.default.AUDIO,rt)}function Yt(He){return He?An(i.default.VIDEO,He)&&An(i.default.AUDIO,He):!0}function An(He,rt){var dt=Qe(),yt=rt.getStreamInfo();if(!yt||!dt)return!0;var At=G.getAdaptationForType(yt.index,He,yt),ke=G.getAdaptationForType(dt.index,He,dt);return!At||!ke?!At&&!ke:!(!bn(ke)&&bn(At))}function bn(He){return He?!!(He.ContentProtection||He.Representation&&He.Representation.length>0&&He.Representation[0].ContentProtection):!1}function tt(He,rt){var dt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!He||!He.hasOwnProperty("getStreamInfo"))return!1;var yt=He.getStreamInfo(),At=dt?dt.getStreamInfo():Qe();if(!yt||!At)return!1;var ke=G.getAdaptationForType(yt.index,rt,yt),Mt=G.getAdaptationForType(At.index,rt,At);if(!ke||!Mt)return!ke&&!Mt;var Rt=ke&&Mt&&ke.mimeType===Mt.mimeType,kt=Mt.Representation_asArray.map(function(pn){return pn.codecs}),rn=ke.Representation_asArray.map(function(pn){return pn.codecs}),_n=rn.some(function(pn){return kt.indexOf(pn)>-1}),En=rn.some(function(pn){return kt.some(function(ar){return k.codecRootCompatibleWithCodec(ar,pn)})});return _n||En&&Rt}function mt(He){U=He}function wt(){return U}function Ve(){return ie}function ut(){return G}return Z={initialize:X,getStreamId:Se,activate:Me,deactivate:xt,getIsActive:Bt,getDuration:Oe,getStartTime:Ce,getId:we,getStreamInfo:Qe,getHasAudioTrack:it,getHasVideoTrack:st,startPreloading:be,getThumbnailController:at,getBitrateListFor:Be,updateData:Dt,reset:Ht,getProcessors:bt,setMediaSource:Lt,isMediaCodecCompatible:gt,isProtectionCompatible:Yt,getPreloaded:wt,getIsEndedEventSignaled:ze,setIsEndedEventSignaled:Fe,getAdapter:ut,getHasFinishedBuffering:Ve,setPreloaded:mt,startScheduleControllers:It,prepareTrackChange:Te,prepareQualityChange:De},j(),Z}S.__dashjs_factory_name="Stream",r.default=v.default.getClassFactory(S)},"./src/streaming/StreamProcessor.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/dash/constants/DashConstants.js"),l=n("./src/streaming/constants/MetricsConstants.js"),u=n("./src/streaming/models/FragmentModel.js"),c=n("./src/streaming/controllers/BufferController.js"),f=n("./src/streaming/text/NotFragmentedTextBufferController.js"),h=n("./src/streaming/controllers/ScheduleController.js"),p=n("./src/dash/controllers/RepresentationController.js"),E=n("./src/core/FactoryMaker.js"),v=n("./src/streaming/utils/SupervisorTools.js"),M=n("./src/core/EventBus.js"),y=n("./src/core/events/Events.js"),_=n("./src/dash/DashHandler.js"),g=n("./src/core/errors/Errors.js"),R=n("./src/streaming/vo/DashJSError.js"),S=n("./src/core/Debug.js"),x=n("./src/streaming/utils/RequestModifier.js"),w=n("./src/streaming/utils/URLUtils.js"),C=n("./src/streaming/utils/BoxParser.js"),b=n("./src/streaming/vo/metrics/PlayList.js"),P=n("./src/dash/controllers/SegmentsController.js"),A=n("./src/streaming/vo/metrics/HTTPRequest.js");function I(F){F=F||{};var G=this.context,V=Object(M.default)(G).getInstance(),k=F.streamInfo,H=F.type,J=F.errHandler,K=F.mimeType,ae=F.timelineConverter,re=F.adapter,le=F.manifestModel,me=F.mediaPlayerModel,de=F.fragmentModel,te=F.abrController,q=F.playbackController,Z=F.mediaController,pe=F.textController,he=F.dashMetrics,Q=F.settings,Y=F.boxParser,ie=F.segmentBlacklistController,ue,$,W,B,L,D,O,U,fe,ye,_e,ee,j;function X(){$=Object(S.default)(G).getInstance().getLogger(ue),Se(),V.on(y.default.DATA_UPDATE_COMPLETED,Pt,ue,{priority:M.default.EVENT_PRIORITY_HIGH}),V.on(y.default.INIT_FRAGMENT_NEEDED,Ue,ue),V.on(y.default.MEDIA_FRAGMENT_NEEDED,Xe,ue),V.on(y.default.MEDIA_FRAGMENT_LOADED,tt,ue),V.on(y.default.BUFFER_LEVEL_STATE_CHANGED,Ht,ue),V.on(y.default.BUFFER_CLEARED,Oe,ue),V.on(y.default.SEEK_TARGET,dt,ue),V.on(y.default.FRAGMENT_LOADING_ABANDONED,it,ue),V.on(y.default.FRAGMENT_LOADING_COMPLETED,st,ue),V.on(y.default.QUOTA_EXCEEDED,We,ue),V.on(y.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Ae,ue),V.on(y.default.SET_NON_FRAGMENTED_TEXT,Be,ue),V.on(y.default.SOURCE_BUFFER_ERROR,ze,ue)}function z(ke,Mt,Rt){ee=Object(P.default)(G).create({events:y.default,eventBus:V,streamInfo:k,timelineConverter:ae,dashConstants:o.default,segmentBaseController:F.segmentBaseController,type:H}),_e=Object(_.default)(G).create({streamInfo:k,type:H,timelineConverter:ae,dashMetrics:he,mediaPlayerModel:me,baseURLController:F.baseURLController,errHandler:J,segmentsController:ee,settings:Q,boxParser:Y,events:y.default,eventBus:V,errors:g.default,debug:Object(S.default)(G).getInstance(),requestModifier:Object(x.default)(G).getInstance(),dashConstants:o.default,constants:i.default,urlUtils:Object(w.default)(G).getInstance()}),W=k.manifestInfo.isDynamic,_e.initialize(W),te.registerStreamType(H,ue),U=Object(p.default)(G).create({streamInfo:k,type:H,abrController:te,dashMetrics:he,playbackController:q,timelineConverter:ae,dashConstants:o.default,events:y.default,eventBus:V,errors:g.default,isDynamic:W,segmentsController:ee}),D=rt(H,Rt),D&&D.initialize(ke),O=Object(h.default)(G).create({streamInfo:k,type:H,mimeType:K,adapter:re,dashMetrics:he,mediaPlayerModel:me,fragmentModel:de,abrController:te,playbackController:q,textController:pe,mediaController:Z,bufferController:D,settings:Q}),O.initialize(Mt),j=0,fe=!1}function oe(){return k.id}function se(){return H}function ce(){return re.getIsTextTrack(U.getData())}function Se(){L=[],B=null,j=0,fe=!1,ye=!1}function Me(ke,Mt){_e&&_e.reset(),D&&(D.reset(ke,Mt),D=null),O&&(O.reset(),O=null),U&&(U.reset(),U=null),ee&&(ee=null),te&&te.unRegisterStreamType(oe(),H),V.off(y.default.DATA_UPDATE_COMPLETED,Pt,ue),V.off(y.default.INIT_FRAGMENT_NEEDED,Ue,ue),V.off(y.default.MEDIA_FRAGMENT_NEEDED,Xe,ue),V.off(y.default.MEDIA_FRAGMENT_LOADED,tt,ue),V.off(y.default.BUFFER_LEVEL_STATE_CHANGED,Ht,ue),V.off(y.default.BUFFER_CLEARED,Oe,ue),V.off(y.default.SEEK_TARGET,dt,ue),V.off(y.default.FRAGMENT_LOADING_ABANDONED,it,ue),V.off(y.default.FRAGMENT_LOADING_COMPLETED,st,ue),V.off(y.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Ae,ue),V.off(y.default.SET_NON_FRAGMENTED_TEXT,Be,ue),V.off(y.default.QUOTA_EXCEEDED,We,ue),V.off(y.default.SOURCE_BUFFER_ERROR,ze,ue),Se(),H=null,k=null}function ve(){return U?U.isUpdating():!1}function be(ke){return new Promise(function(Mt){O.clearScheduleTimer(),de.abortRequests(),D.prepareForPlaybackSeek().then(function(){var Rt=D.getAllRangesWithSafetyFactor(ke.seekTime);return D.clearBuffers(Rt)}).then(function(){var Rt=D.getContinuousBufferTimeForTargetTime(ke.seekTime);if(!isNaN(k.duration)&&isFinite(k.duration)&&Rt>=k.start+k.duration)D.setIsBufferingCompleted(!0),Mt();else{yt(Rt),D.setSeekTarget(Rt);var kt=[];kt.push(D.updateAppendWindow());var rn=gt();kt.push(D.updateBufferTimestampOffset(rn)),Promise.all(kt).then(function(){O.setInitSegmentRequired(!0),O.setCheckPlaybackQuality(!1),O.startScheduleTimer(),Mt()})}}).catch(function(Rt){$.error(Rt)})})}function Ne(){return new Promise(function(ke,Mt){try{O.clearScheduleTimer(),de.abortRequests(),D.prepareForPlaybackSeek().then(function(){return D.pruneAllSafely()}).then(function(){ke()})}catch(Rt){Mt(Rt)}})}function Ue(ke){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!!ke.sender){if(q.getIsManifestUpdateInProgress()){Lt();return}if(!(ce()&&!pe.isTextEnabled())&&D&&ke.representationId&&!D.appendInitSegmentFromCache(ke.representationId)){var Rt=U.getCurrentRepresentation();if(Rt.range===0){Xe();return}var kt=_e?_e.getInitRequest(B,Rt):null;kt?de.executeRequest(kt):Mt&&(O.setInitSegmentRequired(!0),Lt())}}}function Xe(ke){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(q.getIsManifestUpdateInProgress()||D.getIsPruningInProgress()){Lt();return}var Rt=Bt();Rt?(fe=!1,ot(Rt)):ct(Mt)}function ot(ke){isNaN(ke.startTime+ke.duration)||(j=ke.startTime+ke.duration),ke.delayLoadingTime=new Date().getTime()+O.getTimeToLoadDelay(),O.setTimeToLoadDelay(0),xt(ke)?($.warn("Fragment request url ".concat(ke.url," for stream id ").concat(k.id," and media type ").concat(H," is on the ignore list and will be skipped")),Lt()):($.debug("Next fragment request url for stream id ".concat(k.id," and media type ").concat(H," is ").concat(ke.url)),de.executeRequest(ke))}function ct(ke){var Mt=U.getCurrentRepresentation();if(Q.get().streaming.gaps.enableSeekFix&&!W&&fe&&(q.isSeeking()||q.getTime()===0)){var Rt=_e.getValidSeekTimeCloseToTargetTime(j,B,Mt,Q.get().streaming.gaps.threshold);if(!isNaN(Rt)){q.seek(Rt,!1,!1);return}}var kt=_e.isLastSegmentRequested(Mt,j);if(kt){var rn=_e.getCurrentIndex();$.debug("Segment requesting for stream ".concat(k.id," has finished")),V.trigger(y.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:rn},{streamId:k.id,mediaType:H}),D.segmentRequestingCompleted(rn),O.clearScheduleTimer();return}ke&&Lt()}function xt(ke){var Mt=ke.url;return ke.range&&(Mt=Mt.concat("_",ke.range)),ie.contains(Mt)}function Bt(){var ke=gt(),Mt;if(isNaN(j)||se()===i.default.TEXT&&!pe.isTextEnabled())return null;var Rt=fe;if(_e){var kt=U&&ke?U.getRepresentationForQuality(ke.quality):null;Rt?Mt=_e.getSegmentRequestForTime(B,kt,j):Mt=_e.getNextSegmentRequest(B,kt)}return Mt}function Lt(){O.startScheduleTimer(Q.get().streaming.lowLatencyEnabled?Q.get().streaming.scheduling.lowLatencyTimeout:Q.get().streaming.scheduling.defaultTimeout)}function Pt(ke){ke.error||(O.setCurrentRepresentation(re.convertRepresentationToRepresentationInfo(ke.currentRepresentation)),D.getIsBufferingCompleted()||D.updateBufferTimestampOffset(ke.currentRepresentation))}function Ht(ke){he.addBufferState(H,ke.state,O.getBufferTarget()),ke.state===l.default.BUFFER_EMPTY&&!q.isSeeking()&&($.info("Buffer is empty! Stalling!"),he.pushPlayListTraceMetrics(new Date,b.PlayListTrace.REBUFFERING_REASON))}function Oe(ke){de.syncExecutedRequestsWithBufferedRange(D.getBuffer().getAllBufferRanges(),k.duration),ke.quotaExceeded&&ke.from>q.getTime()&&yt(ke.from),ke.hasEnoughSpaceToAppend&&ke.quotaExceeded&&O.startScheduleTimer()}function ze(ke){if(!(!ke||!ke.lastRequestAppended||!ke.lastRequestAppended.url)){var Mt=ke.lastRequestAppended.url;ke.lastRequestAppended.range&&(Mt=Mt.concat("_",ke.lastRequestAppended.range)),$.warn("Blacklisting segment with url ".concat(Mt)),ie.add(Mt)}}function Fe(ke){$.debug("Preparing quality switch for type ".concat(H));var Mt=ke.newQuality;ye=!0,O.clearScheduleTimer();var Rt=gt(Mt);O.setCurrentRepresentation(Rt),U.prepareQualityChange(Mt),de.abortRequests(),D.updateBufferTimestampOffset(Rt).then(function(){ke.reason&&ke.reason.forceReplace?Ce():Q.get().streaming.buffer.fastSwitchEnabled?we(Rt):Qe(),he.pushPlayListTraceMetrics(new Date,b.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),he.createPlaylistTraceMetrics(Rt.id,q.getTime()*1e3,q.getPlaybackRate())})}function Ce(){V.trigger(y.default.BUFFER_REPLACEMENT_STARTED,{mediaType:H,streamId:k.id},{mediaType:H,streamId:k.id}),D.prepareForReplacementQualitySwitch().then(function(){ut(),ye=!1}).catch(function(){ut(),ye=!1})}function we(ke){var Mt=q.getTime(),Rt=1.5,kt=de.getRequests({state:u.default.FRAGMENT_MODEL_EXECUTED,time:Mt+Rt,threshold:0})[0];if(kt&&!ce()){var rn=D.getBufferLevel(),_n=te.getAbandonmentStateFor(k.id,H);if(kt.quality<ke.quality&&rn>=Rt&&_n!==l.default.ABANDON_LOAD){var En=Mt+Rt;yt(En),O.setCheckPlaybackQuality(!1),O.startScheduleTimer()}else Qe()}else O.startScheduleTimer();ye=!1}function Qe(){He(),ye=!1}function it(ke){$.info("onFragmentLoadingAbandoned request: "+ke.request.url+" has been aborted"),!q.isSeeking()&&!O.getSwitchStrack()&&!ye&&($.info("onFragmentLoadingAbandoned request: "+ke.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),ke.request&&ke.request.isInitializationRequest()?O.setInitSegmentRequired(!0):yt(ke.request.startTime+ke.request.duration/2),O.startScheduleTimer(0))}function st(ke){$.info("OnFragmentLoadingCompleted for stream id "+k.id+" and media type "+H+" - Url:",ke.request?ke.request.url:"undefined",ke.request.range?", Range:"+ke.request.range:""),ce()&&O.startScheduleTimer(0),ke.error&&ke.request.serviceLocation&&at(ke)}function at(ke){$.info("Fragment loading completed with an error"),!(!ke||!ke.request||!ke.request.type)&&(ke.request.type===A.HTTPRequest.INIT_SEGMENT_TYPE?Ue({representationId:ke.request.representationId,sender:{}},!1):ke.request.type===A.HTTPRequest.MEDIA_SEGMENT_TYPE&&(yt(ke.request.startTime+ke.request.duration/2),Xe({},!1)))}function Ae(){yt(q.getTime()),Dt().startScheduleTimer()}function Be(ke){var Mt=ke.currentTrackInfo;if(!!Mt){var Rt=L.find(function(kt){return kt.index===Mt.index&&kt.lang===Mt.lang});Rt&&qe(Rt).then(function(){D.setIsBufferingCompleted(!1),yt(q.getTime()),O.setInitSegmentRequired(!0),O.startScheduleTimer()})}}function We(ke){yt(ke.quotaExceededTime),O.clearScheduleTimer()}function Te(){return U}function De(){return D?D.getBuffer():null}function Ze(){return D}function nt(){return de}function ge(ke){return k=ke,Yt()?Promise.resolve():D.updateAppendWindow()}function Pe(){return k}function qe(ke){ke!==B&&(!ke||!B||ke.type===B.type)&&(B=ke);var Mt=re.getRealAdaptation(k,B),Rt=re.getVoRepresentations(B);if(U){var kt=U.getData(),rn=te.getMaxAllowedIndexFor(H,k.id),_n=te.getMinAllowedIndexFor(H,k.id),En,pn,ar=null;return(kt===null||kt.id!==Mt.id)&&H!==i.default.TEXT?(pn=te.getThroughputHistory().getAverageThroughput(H,W),ar=pn||te.getInitialBitrateFor(H,k.id),En=te.getQualityForBitrate(B,ar,k.id)):En=te.getQualityFor(H,k.id),_n!==void 0&&En<_n&&(En=_n),En>rn&&(En=rn),U.updateData(Mt,Rt,H,B.isFragmented,En)}else return Promise.resolve()}function Ye(ke){L.indexOf(ke)===-1&&L.push(ke)}function $e(){L=[]}function ht(){return B}function bt(){return D.getMediaSource()}function It(ke){D.setMediaSource(ke)}function Dt(){return O}function gt(ke){var Mt;return ke!==void 0?(Object(v.checkInteger)(ke),Mt=U?U.getRepresentationForQuality(ke):null):Mt=U?U.getCurrentRepresentation():null,re.convertRepresentationToRepresentationInfo(Mt)}function Yt(){return D?D.getIsBufferingCompleted():!1}function An(){return D?D.getBufferLevel():0}function bn(){var ke=gt(),Mt=U&&ke?U.getRepresentationForQuality(ke.quality):null,Rt=_e.getNextSegmentRequestIdempotent(B,Mt);return Rt}function tt(ke){var Mt=ke.chunk,Rt=Mt.bytes,kt=Mt.quality,rn=gt(kt),_n=U&&rn?U.getRepresentationForQuality(rn.quality):null;if(rn&&_n){var En=re.getEventsFor(rn.mediaInfo),pn=re.getEventsFor(rn,_n);if(En&&En.length>0||pn&&pn.length>0){var ar=de.getRequests({state:u.default.FRAGMENT_MODEL_EXECUTED,quality:kt,index:Mt.index})[0],zr=mt(Rt,ar,En,pn);V.trigger(y.default.INBAND_EVENTS,{events:zr},{streamId:k.id})}}}function mt(ke,Mt,Rt,kt){try{for(var rn={},_n=[],En=Rt.concat(kt),pn=0,ar=En.length;pn<ar;pn++)rn[En[pn].schemeIdUri+"/"+En[pn].value]=En[pn];var zr=Object(C.default)(G).getInstance().parse(ke),kr=zr.getBoxes("emsg");if(!kr||kr.length===0)return _n;for(var mr=zr.getBox("sidx"),Ii=mr&&!isNaN(mr.earliest_presentation_time)&&!isNaN(mr.timescale)?mr.earliest_presentation_time/mr.timescale:Mt&&!isNaN(Mt.mediaStartTime)?Mt.mediaStartTime:0,Di=Math.max(Ii,0),ei=U.getCurrentRepresentation(),gr=0,ia=kr.length;gr<ia;gr++){var Pi=re.getEvent(kr[gr],rn,Di,ei);Pi&&_n.push(Pi)}return _n}catch{return[]}}function wt(ke){var Mt=De();return Mt?Promise.resolve(Mt):D?D.createBufferSink(B,ke):Promise.resolve(null)}function Ve(){return new Promise(function(ke){$.debug("Preparing track switch for type ".concat(H));var Mt=H===i.default.TEXT||Q.get().streaming.trackSwitchMode[H]===i.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&q.getTimeToStreamEnd(k)>Q.get().streaming.buffer.stallThreshold;if(D.getIsBufferingCompleted()&&!Mt){D.prepareForNonReplacementTrackSwitch(B.codec).then(function(){V.trigger(y.default.BUFFERING_COMPLETED,{},{streamId:k.id,mediaType:H})}).catch(function(){V.trigger(y.default.BUFFERING_COMPLETED,{},{streamId:k.id,mediaType:H})}),ke();return}O.clearScheduleTimer(),O.setSwitchTrack(!0),Mt?(V.trigger(y.default.BUFFER_REPLACEMENT_STARTED,{mediaType:H,streamId:k.id},{mediaType:H,streamId:k.id}),de.abortRequests(),D.prepareForReplacementTrackSwitch(B.codec).then(function(){var Rt=gt();return D.updateBufferTimestampOffset(Rt)}).then(function(){ut(),ke()}).catch(function(){ut(),ke()})):D.prepareForNonReplacementTrackSwitch(B.codec).then(function(){He(),ke()}).catch(function(){He(),ke()})})}function ut(){var ke=q.getTime();Q.get().streaming.buffer.flushBufferAtTrackSwitch&&q.seek(ke+.001,!1,!0),yt(ke),D.setSeekTarget(ke),O.startScheduleTimer()}function He(){var ke=q.getTime(),Mt=D.getContinuousBufferTimeForTargetTime(ke);yt(Mt),O.startScheduleTimer()}function rt(ke,Mt){var Rt=null;return ke?(ke===i.default.TEXT&&!Mt?Rt=Object(f.default)(G).create({streamInfo:k,type:ke,mimeType:K,fragmentModel:de,textController:pe,errHandler:J,settings:Q}):Rt=Object(c.default)(G).create({streamInfo:k,type:ke,mediaPlayerModel:me,manifestModel:le,fragmentModel:de,errHandler:J,mediaController:Z,representationController:U,adapter:re,textController:pe,abrController:te,playbackController:q,settings:Q}),Rt):(J.error(new R.default(g.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,g.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}function dt(ke){ke&&!isNaN(ke.time)&&(yt(ke.time),D.setSeekTarget(ke.time))}function yt(ke){j=ke,fe=!0}function At(ke,Mt){he.pushPlayListTraceMetrics(ke,Mt)}return ue={initialize:z,getStreamId:oe,getType:se,isUpdating:ve,getBufferController:Ze,getFragmentModel:nt,getScheduleController:Dt,getRepresentationController:Te,getRepresentationInfo:gt,getBufferLevel:An,isBufferingCompleted:Yt,createBufferSinks:wt,updateStreamInfo:ge,getStreamInfo:Pe,selectMediaInfo:qe,clearMediaInfoArray:$e,addMediaInfo:Ye,prepareTrackSwitch:Ve,prepareQualityChange:Fe,getMediaInfo:ht,getMediaSource:bt,setMediaSource:It,getBuffer:De,setExplicitBufferingTime:yt,finalisePlayList:At,probeNextRequest:bn,prepareInnerPeriodPlaybackSeeking:be,prepareOuterPeriodPlaybackSeeking:Ne,reset:Me},X(),ue}I.__dashjs_factory_name="StreamProcessor",r.default=E.default.getClassFactory(I)},"./src/streaming/XlinkLoader.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/DashJSError.js"),o=n("./src/streaming/net/URLLoader.js"),l=n("./src/streaming/vo/metrics/HTTPRequest.js"),u=n("./src/streaming/vo/TextRequest.js"),c=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),h=n("./src/core/FactoryMaker.js"),p=n("./src/core/errors/Errors.js");function E(v){v=v||{};var M="urn:mpeg:dash:resolve-to-zero:2013",y=this.context,_=Object(c.default)(y).getInstance(),g=Object(o.default)(y).create({errHandler:v.errHandler,dashMetrics:v.dashMetrics,mediaPlayerModel:v.mediaPlayerModel,requestModifier:v.requestModifier,errors:p.default}),R;function S(w,C,b){var P=function(F,G){C.resolved=!0,C.resolvedContent=F||null,_.trigger(f.default.XLINK_ELEMENT_LOADED,{element:C,resolveObject:b,error:F||G?null:new i.default(p.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,p.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+w)})};if(w===M)P(null,!0);else{var A=new u.default(w,l.HTTPRequest.XLINK_EXPANSION_TYPE);g.load({request:A,success:function(F){P(F)},error:function(){P(null)}})}}function x(){g&&(g.abort(),g=null)}return R={load:S,reset:x},R}E.__dashjs_factory_name="XlinkLoader",r.default=h.default.getClassFactory(E)},"./src/streaming/constants/ConformanceViolationConstants.js":function(t,r,n){n.r(r),r.default={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":function(t,r,n){n.r(r);function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u=function(){function f(){i(this,f),this.init()}return l(f,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4}}}]),f}(),c=new u;r.default=c},"./src/streaming/constants/MetricsConstants.js":function(t,r,n){n.r(r);function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u=function(){function f(){i(this,f),this.init()}return l(f,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),f}(),c=new u;r.default=c},"./src/streaming/constants/ProtectionConstants.js":function(t,r,n){n.r(r);function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u=function(){function f(){i(this,f),this.init()}return l(f,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}]),f}(),c=new u;r.default=c},"./src/streaming/controllers/AbrController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/rules/abr/ABRRulesCollection.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/streaming/constants/MetricsConstants.js"),u=n("./src/streaming/vo/BitrateInfo.js"),c=n("./src/streaming/models/FragmentModel.js"),f=n("./src/core/EventBus.js"),h=n("./src/core/events/Events.js"),p=n("./src/core/FactoryMaker.js"),E=n("./src/streaming/rules/RulesContext.js"),v=n("./src/streaming/rules/SwitchRequest.js"),M=n("./src/streaming/rules/SwitchRequestHistory.js"),y=n("./src/streaming/rules/DroppedFramesHistory.js"),_=n("./src/streaming/rules/ThroughputHistory.js"),g=n("./src/core/Debug.js"),R=n("./src/streaming/vo/metrics/HTTPRequest.js"),S=n("./src/streaming/utils/SupervisorTools.js"),x=n("./src/streaming/MediaPlayerEvents.js"),w=1e3,C=100,b=0;function P(){var I=this.context,F=Object(g.default)(I).getInstance(),G=Object(f.default)(I).getInstance(),V,k,H,J,K,ae,re,le,me,de,te,q,Z,pe,he,Q,Y,ie,ue,$,W,B,L,D,O;function U(){k=F.getLogger(V),j()}function fe(){ue=Object(y.default)(I).create(),$=Object(_.default)(I).create({settings:O}),H=Object(i.default)(I).create({dashMetrics:D,mediaPlayerModel:he,settings:O}),H.initialize(),G.on(x.default.QUALITY_CHANGE_RENDERED,ce,V),G.on(x.default.METRIC_ADDED,Se,V),G.on(h.default.LOADING_PROGRESS,se,V)}function ye(Te,De){var Ze=De.getStreamInfo().id;re[Ze]||(re[Ze]={}),ie[Ze]||(ie[Ze]={}),le[Ze]||(le[Ze]={}),ie[Ze][Te]=Object(M.default)(I).create(),re[Ze][Te]=De,le[Ze][Te]={},le[Ze][Te].state=l.default.ALLOW_LOAD,_e(Te),Te===o.default.VIDEO&&Be()}function _e(Te){var De=O.get().streaming.abr.ABRStrategy;De===o.default.ABR_STRATEGY_L2A?(W[Te]=!1,L[Te]=!1,B[Te]=!0):De===o.default.ABR_STRATEGY_LoLP?(W[Te]=!1,L[Te]=!0,B[Te]=!1):De===o.default.ABR_STRATEGY_BOLA?(W[Te]=!0,L[Te]=!1,B[Te]=!1):De===o.default.ABR_STRATEGY_THROUGHPUT?(W[Te]=!1,L[Te]=!1,B[Te]=!1):De===o.default.ABR_STRATEGY_DYNAMIC&&(W[Te]=W&&W[Te]?W[Te]:!1,L[Te]=!1,B[Te]=!1)}function ee(Te,De){try{re[Te]&&re[Te][De]&&delete re[Te][De],ie[Te]&&ie[Te][De]&&delete ie[Te][De],le[Te]&&le[Te][De]&&delete le[Te][De]}catch{}}function j(){K={},ae={},le={},re={},ie={},W={},B={},L={},de===void 0&&(de=!1),ue&&ue.reset(),Y=void 0,ue=void 0,$=void 0,clearTimeout(me),me=null}function X(){j(),G.off(h.default.LOADING_PROGRESS,se,V),G.off(x.default.QUALITY_CHANGE_RENDERED,ce,V),G.off(x.default.METRIC_ADDED,Se,V),H&&H.reset()}function z(Te){!Te||(Te.streamController&&(J=Te.streamController),Te.domStorage&&(Q=Te.domStorage),Te.mediaPlayerModel&&(he=Te.mediaPlayerModel),Te.dashMetrics&&(D=Te.dashMetrics),Te.adapter&&(Z=Te.adapter),Te.videoModel&&(pe=Te.videoModel),Te.settings&&(O=Te.settings))}function oe(){if(!Q||!Q.hasOwnProperty("getSavedBitrateSettings"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function se(Te){var De=Te.request.mediaType,Ze=Te.streamId;if(!(!De||!Ze||!re[Ze]||!O.get().streaming.abr.autoSwitchBitrate[De])){var nt=re[Ze][De];if(!!nt){var ge=Object(E.default)(I).create({abrController:V,streamProcessor:nt,currentRequest:Te.request,useBufferOccupancyABR:W[De],useL2AABR:B[De],useLoLPABR:L[De],videoModel:pe}),Pe=H.shouldAbandonFragment(ge,Ze);if(Pe.quality>v.default.NO_CHANGE){var qe=nt.getFragmentModel(),Ye=qe.getRequests({state:c.default.FRAGMENT_MODEL_LOADING,index:Te.request.index})[0];Ye&&(qe.abortRequests(),le[Ze][De].state=l.default.ABANDON_LOAD,ie[Ze][De].reset(),ie[Ze][De].push({oldValue:Lt(De,Ze),newValue:Pe.quality,confidence:1,reason:Pe.reason}),Pt(De,J.getActiveStreamInfo(),Pe.quality,Pe.reason),clearTimeout(me),me=setTimeout(function(){le[Ze][De].state=l.default.ALLOW_LOAD,me=null},O.get().streaming.abandonLoadTimeout))}}}}function ce(Te){Te.mediaType===o.default.VIDEO&&(Y!==void 0&&ue.push(Te.streamId,Y,pe.getPlaybackQuality()),Y=Te.newQuality)}function Se(Te){Te.metric===l.default.HTTP_REQUEST&&Te.value&&Te.value.type===R.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Te.mediaType===o.default.AUDIO||Te.mediaType===o.default.VIDEO)&&$.push(Te.mediaType,Te.value,O.get().streaming.abr.useDeadTimeLatency),Te.metric===l.default.BUFFER_LEVEL&&(Te.mediaType===o.default.AUDIO||Te.mediaType===o.default.VIDEO)&&we(Te.mediaType,.001*Te.value.level)}function Me(Te,De){try{var Ze;return K[De]=K[De]||{},K[De].hasOwnProperty(Te)||(K[De][Te]=0),Ze=Ue(Te,De),Ze=Xe(Ze,Te,De),Ze=ot(Ze,Te,De),Ze}catch{return}}function ve(Te,De){try{return Ne(Te,De)}catch{return}}function be(Te,De){try{var Ze=O.get().streaming.abr.maxBitrate[Te];return Ze>-1?Fe(re[De][Te].getMediaInfo(),Ze,De):void 0}catch{return}}function Ne(Te,De){try{var Ze=O.get().streaming.abr.minBitrate[Te];if(Ze>-1){var nt=re[De][Te].getMediaInfo(),ge=Ce(nt),Pe=Fe(nt,Ze,De);return ge[Pe]&&Pe<ge.length-1&&ge[Pe].bitrate<Ze*1e3&&Pe++,Pe}else return}catch{return}}function Ue(Te,De){var Ze=K[De][Te],nt=Ze;if(!re[De]||!re[De][Te])return nt;var ge=ve(Te,De);ge!==void 0&&(nt=Math.max(Ze,ge));var Pe=be(Te,De);return Pe!==void 0&&(nt=Math.min(nt,Pe)),nt}function Xe(Te,De,Ze){var nt=K[Ze][De],ge=O.get().streaming.abr.maxRepresentationRatio[De];return isNaN(ge)||ge>=1||ge<0?Te:Math.min(Te,Math.round(nt*ge))}function ot(Te,De,Ze){if(De!==o.default.VIDEO||!O.get().streaming.abr.limitBitrateByPortal||!re[Ze]||!re[Ze][De])return Te;de||Be();var nt=re[Ze][De].getStreamInfo(),ge=Z.getAdaptationForType(nt.index,De,nt).Representation,Pe=Te;if(te>0&&q>0){for(;Pe>0&&ge[Pe]&&te<ge[Pe].width&&te-ge[Pe-1].width<ge[Pe].width-te;)Pe=Pe-1;for(;Pe<ge.length-1&&ge[Pe].width===ge[Pe+1].width;)Pe=Pe+1}return Pe}function ct(Te){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(De||(De=J.getActiveStreamInfo().id),Te&&re&&re[De]&&re[De][Te]){var Ze=Me(Te,De),nt=Ce(re[De][Te].getMediaInfo());return nt[Ze]?nt[Ze]:null}return null}function xt(Te,De){if(oe(),Te===o.default.TEXT)return NaN;var Ze=Q.getSavedBitrateSettings(Te),nt=O.get().streaming.abr.initialBitrate[Te],ge=O.get().streaming.abr.initialRepresentationRatio[Te];if(nt===-1)if(ge>-1){var Pe=re[De][Te].getStreamInfo(),qe=Z.getAdaptationForType(Pe.index,Te,Pe).Representation;if(Array.isArray(qe)){var Ye=Math.max(Math.round(qe.length*ge)-1,0);nt=qe[Ye].bandwidth/1e3}else nt=0}else isNaN(Ze)?nt=Te===o.default.VIDEO?w:C:nt=Ze;return nt}function Bt(Te,De){try{if(!Te||!re||!re[De]||!re[De][Te])return!1;if(ue){var Ze=pe.getPlaybackQuality();Ze&&ue.push(De,Y,Ze)}if(!O.get().streaming.abr.autoSwitchBitrate[Te])return!1;var nt=Lt(Te,De),ge=Object(E.default)(I).create({abrController:V,switchHistory:ie[De][Te],droppedFramesHistory:ue,streamProcessor:re[De][Te],currentValue:nt,useBufferOccupancyABR:W[Te],useL2AABR:B[Te],useLoLPABR:L[Te],videoModel:pe}),Pe=ve(Te,De),qe=Me(Te,De),Ye=H.getMaxQuality(ge),$e=Ye.quality;return Pe!==void 0&&($e>v.default.NO_CHANGE?$e:nt)<Pe&&($e=Pe),$e>qe&&($e=qe),ie[De][Te].push({oldValue:nt,newValue:$e}),$e>v.default.NO_CHANGE&&$e!==nt&&(le[De][Te].state===l.default.ALLOW_LOAD||$e>nt)?(Oe(Te,nt,$e,qe,Ye.reason,De),!0):!1}catch{return!1}}function Lt(Te){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;try{if(De||(De=J.getActiveStreamInfo().id),Te&&re[De]&&re[De][Te]){var Ze;if(De)return ae[De]=ae[De]||{},ae[De].hasOwnProperty(Te)||(ae[De][Te]=b),Ze=ae[De][Te],Ze}return b}catch{return b}}function Pt(Te,De,Ze){var nt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!(!De||!De.id||!Te)){var ge=De.id,Pe=Lt(Te,ge);Object(S.checkInteger)(Ze);var qe=Me(Te,ge);Ze!==Pe&&Ze>=0&&Ze<=qe&&Oe(Te,Pe,Ze,qe,nt,ge)}}function Ht(Te,De){return le[Te]&&le[Te][De]?le[Te][De].state:null}function Oe(Te,De,Ze,nt,ge,Pe){if(Te&&re[Pe]&&re[Pe][Te]){var qe=re[Pe][Te].getStreamInfo(),Ye=qe&&qe.manifestInfo&&qe.manifestInfo.isDynamic,$e=D.getCurrentBufferLevel(Te);k.info("Stream ID: "+Pe+" ["+Te+"] switch from "+De+" to "+Ze+"/"+nt+" (buffer: "+$e+") "+(ge?JSON.stringify(ge):".")),ae[Pe]=ae[Pe]||{},ae[Pe][Te]=Ze;var ht=ze(Pe,Te,Ze);G.trigger(h.default.QUALITY_CHANGE_REQUESTED,{oldQuality:De,newQuality:Ze,reason:ge,streamInfo:qe,bitrateInfo:ht,maxIdx:nt,mediaType:Te},{streamId:qe.id,mediaType:Te});var bt=$.getAverageThroughput(Te,Ye);isNaN(bt)||Q.setSavedBitrateSettings(Te,bt)}}function ze(Te,De,Ze){if(De&&re&&re[Te]&&re[Te][De]){var nt=Ce(re[Te][De].getMediaInfo());return nt[Ze]?nt[Ze]:null}return null}function Fe(Te,De,Ze){var nt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,ge=Te&&Te.type?re[Ze][Te.type].getRepresentationInfo():null;if(O.get().streaming.abr.useDeadTimeLatency&&nt&&ge&&ge.fragmentDuration){nt=nt/1e3;var Pe=ge.fragmentDuration;if(nt>Pe)return 0;var qe=nt/Pe;De=De*(1-qe)}for(var Ye=Ce(Te),$e=Ye.length-1;$e>=0;$e--){var ht=Ye[$e];if(De*1e3>=ht.bitrate)return $e}return b}function Ce(Te){var De=[];if(!Te||!Te.bitrateList)return De;for(var Ze=Te.bitrateList,nt=Te.type,ge,Pe=0,qe=Ze.length;Pe<qe;Pe++)ge=new u.default,ge.mediaType=nt,ge.qualityIndex=Pe,ge.bitrate=Ze[Pe].bandwidth,ge.width=Ze[Pe].width,ge.height=Ze[Pe].height,ge.scanType=Ze[Pe].scanType,De.push(ge);return De}function we(Te,De){var Ze=O.get().streaming.abr.ABRStrategy;Ze===o.default.ABR_STRATEGY_DYNAMIC&&Qe(Te,De)}function Qe(Te,De){var Ze=he.getStableBufferTime(),nt=Ze,ge=.5*Ze,Pe=W[Te],qe=De>(Pe?ge:nt);W[Te]=qe,qe!==Pe&&(qe?k.info("["+Te+"] switching from throughput to buffer occupancy ABR rule (buffer: "+De.toFixed(3)+")."):k.info("["+Te+"] switching from buffer occupancy to throughput ABR rule (buffer: "+De.toFixed(3)+")."))}function it(){return $}function st(Te){var De=Te.type,Ze=Te.streamInfo.id,nt=Te.representationCount-1;return K[Ze]=K[Ze]||{},K[Ze][De]=nt,nt}function at(Te){var De=Te?Te.id:null,Ze=Lt(o.default.AUDIO,De),nt=Lt(o.default.VIDEO,De),ge=Ze===Me(o.default.AUDIO,De)&&nt===Me(o.default.VIDEO,De);return ge}function Ae(Te){de=Te}function Be(){if(pe){var Te=O.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio"),De=Te?window.devicePixelRatio:1;te=pe.getClientWidth()*De,q=pe.getClientHeight()*De}}function We(Te){ue&&ue.clearForStream(Te),re[Te]&&delete re[Te],ie[Te]&&delete ie[Te],le[Te]&&delete le[Te]}return V={initialize:fe,isPlayingAtTopQuality:at,updateTopQualityIndex:st,clearDataForStream:We,getThroughputHistory:it,getBitrateList:Ce,getQualityForBitrate:Fe,getTopBitrateInfoFor:ct,getMinAllowedIndexFor:ve,getMaxAllowedIndexFor:Me,getInitialBitrateFor:xt,getQualityFor:Lt,getAbandonmentStateFor:Ht,setPlaybackQuality:Pt,checkPlaybackQuality:Bt,setElementSize:Be,setWindowResizeEventCalled:Ae,registerStreamType:ye,unRegisterStreamType:ee,setConfig:z,reset:X},U(),V}P.__dashjs_factory_name="AbrController";var A=p.default.getSingletonFactory(P);A.QUALITY_DEFAULT=b,p.default.updateSingletonFactory(P.__dashjs_factory_name,A),r.default=A},"./src/streaming/controllers/BaseURLController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/models/BaseURLTreeModel.js"),o=n("./src/streaming/utils/BaseURLSelector.js"),l=n("./src/streaming/utils/URLUtils.js"),u=n("./src/dash/vo/BaseURL.js"),c=n("./src/core/FactoryMaker.js"),f=n("./src/core/EventBus.js"),h=n("./src/core/events/Events.js");function p(){var E,v,M=this.context,y=Object(f.default)(M).getInstance(),_=Object(l.default)(M).getInstance(),g,R;function S(I){g.invalidateSelectedIndexes(I.entry)}function x(){g=Object(i.default)(M).create(),R=Object(o.default)(M).create(),y.on(h.default.SERVICE_LOCATION_BLACKLIST_CHANGED,S,E)}function w(I){I.baseURLTreeModel&&(g=I.baseURLTreeModel),I.baseURLSelector&&(R=I.baseURLSelector),I.adapter&&(v=I.adapter)}function C(I){g.update(I),R.chooseSelector(v.getIsDVB(I))}function b(I){var F=g.getForPath(I),G=F.reduce(function(V,k){var H=R.select(k);if(H)_.isRelative(H.url)?V.url=_.resolve(H.url,V.url):(V.url=H.url,V.serviceLocation=H.serviceLocation),V.availabilityTimeOffset=H.availabilityTimeOffset,V.availabilityTimeComplete=H.availabilityTimeComplete;else return new u.default;return V},new u.default);if(!_.isRelative(G.url))return G}function P(){g.reset(),R.reset()}function A(I){g.setConfig({adapter:v}),C(I)}return E={reset:P,initialize:A,resolve:b,setConfig:w},x(),E}p.__dashjs_factory_name="BaseURLController",r.default=c.default.getClassFactory(p)},"./src/streaming/controllers/BlacklistController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/EventBus.js");function l(u){u=u||{};var c,f=[],h=Object(o.default)(this.context).getInstance(),p=u.updateEventName,E=u.addBlacklistEventName;function v(R){return!f.length||!R||!R.length?!1:f.indexOf(R)!==-1}function M(R){f.indexOf(R)===-1&&(f.push(R),h.trigger(p,{entry:R}))}function y(R){M(R.entry)}function _(){E&&h.on(E,y,c)}function g(){f=[]}return c={add:M,contains:v,reset:g},_(),c}l.__dashjs_factory_name="BlackListController",r.default=i.default.getClassFactory(l)},"./src/streaming/controllers/BufferController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/constants/MetricsConstants.js"),l=n("./src/streaming/models/FragmentModel.js"),u=n("./src/streaming/SourceBufferSink.js"),c=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),h=n("./src/core/FactoryMaker.js"),p=n("./src/core/Debug.js"),E=n("./src/streaming/utils/InitCache.js"),v=n("./src/streaming/vo/DashJSError.js"),M=n("./src/core/errors/Errors.js"),y=n("./src/streaming/vo/metrics/HTTPRequest.js"),_=n("./src/streaming/MediaPlayerEvents.js"),g=.5,R=.01,S=22,x="BufferController";function w(C){C=C||{};var b=this.context,P=Object(c.default)(b).getInstance(),A=C.errHandler,I=C.fragmentModel,F=C.representationController,G=C.adapter,V=C.textController,k=C.abrController,H=C.playbackController,J=C.streamInfo,K=C.type,ae=C.settings,re,le,me,de,te,q,Z,pe,he,Q,Y,ie,ue,$,W,B,L,D;function O(){le=Object(p.default)(b).getInstance().getLogger(re),W=Object(E.default)(b).getInstance(),mt()}function U(Ve){ee(Ve),P.on(f.default.INIT_FRAGMENT_LOADED,oe,re),P.on(f.default.MEDIA_FRAGMENT_LOADED,ce,re),P.on(f.default.WALLCLOCK_TIME_UPDATED,Pe,re),P.on(_.default.PLAYBACK_PLAYING,ze,re),P.on(_.default.PLAYBACK_PROGRESS,Ht,re),P.on(_.default.PLAYBACK_TIME_UPDATED,Ht,re),P.on(_.default.PLAYBACK_RATE_CHANGED,qe,re),P.on(_.default.PLAYBACK_STALLED,Oe,re)}function fe(){return J.id}function ye(){return K}function _e(){return x}function ee(Ve){q=Ve}function j(Ve){return G.convertRepresentationToRepresentationInfo(F.getRepresentationForQuality(Ve))}function X(Ve){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return new Promise(function(He,rt){if(!W||!Ve||!q){He(null);return}var dt=k.getQualityFor(K,J.id);he=Object(u.default)(b).create({mediaSource:q,textController:V,eventBus:P}),z(Ve,ut,dt).then(function(){return Ze(j(dt))}).then(function(){He(he)}).catch(function(yt){le.fatal("Caught error on create SourceBuffer: "+yt),A.error(new v.default(M.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,M.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+K)),rt(yt)})})}function z(Ve,ut,He){var rt=j(He);return ut&&ut[K]&&(K===i.default.VIDEO||K===i.default.AUDIO)?he.initializeForStreamSwitch(Ve,rt,ut[K]):he.initializeForFirstUse(J,Ve,rt)}function oe(Ve){ae.get().streaming.cacheInitSegments&&(le.info("Init fragment finished loading saving to",K+"'s init cache"),W.save(Ve.chunk)),le.debug("Append Init fragment",K," with representationId:",Ve.chunk.representationId," and quality:",Ve.chunk.quality,", data size:",Ve.chunk.bytes.byteLength),Se(Ve.chunk)}function se(Ve){var ut=W.extract(J.id,Ve);return ut?(le.info("Append Init fragment",K," with representationId:",ut.representationId," and quality:",ut.quality,", data size:",ut.bytes.byteLength),Se(ut),!0):!1}function ce(Ve){Se(Ve.chunk,Ve.request)}function Se(Ve){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;he.append(Ve,ut).then(function(He){ve(He)}).catch(function(He){ve(He)}),Ve.mediaInfo.type===i.default.VIDEO&&tt(f.default.VIDEO_CHUNK_RECEIVED,{chunk:Ve})}function Me(Ve){if(Ve&&Ve.length>0)for(var ut=0,He=Ve.length;ut<He;ut++)le.debug("Buffered range: "+Ve.start(ut)+" - "+Ve.end(ut)+", currentTime = ",H.getTime())}function ve(Ve){if(Ve.error){Ve.error.code===S&&Ne(),(Ve.error.code===S||!An())&&(le.warn("Clearing playback buffer to overcome quota exceed situation"),tt(f.default.QUOTA_EXCEEDED,{criticalBufferLevel:te,quotaExceededTime:Ve.chunk.start}),Be(Ae()));return}if(!!he&&(we(),$=!1,Y=Ve.chunk,!(!Y||!Y.endFragment))){Y&&!isNaN(Y.index)&&(Z=Math.max(Y.index,Z),Qe());var ut=he.getAllBufferRanges();Y.segmentType===y.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Me(ut),Ht(),be()),Y&&tt(f.default.BYTES_APPENDED_END_FRAGMENT,{quality:Y.quality,startTime:Y.start,index:Y.index,bufferedRanges:ut,segmentType:Y.segmentType,mediaType:K})}}function be(){if(!isNaN(D)){if(K!==i.default.AUDIO&&K!==i.default.VIDEO){D=NaN;return}var Ve=H.getTime(),ut=Fe(D,0);if(Ve===D&&ut){D=NaN;return}var He=F.getCurrentRepresentation().segmentDuration;ut=Fe(D,He),!!ut&&(ae.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(Ve-D)>He?D<=ut.end&&(H.seek(Math.max(D,ut.start),!1,!0),D=NaN):Ve<ut.start&&(H.seek(ut.start,!1,!0),D=NaN))}}function Ne(){if($=!0,te=gt()*.8,le.warn("Quota exceeded, Critical Buffer: "+te),te>0){var Ve=Math.max(.2*te,1),ut=te-Ve,He=Math.min(ae.get().streaming.buffer.bufferTimeAtTopQuality,ut*.9),rt=Math.min(ae.get().streaming.buffer.bufferTimeAtTopQualityLongForm,ut*.9),dt={streaming:{buffer:{bufferToKeep:parseFloat(Ve.toFixed(5)),bufferTimeAtTopQuality:parseFloat(He.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(rt.toFixed(5))}}};ae.update(dt)}}function Ue(){return me&&It(!1),he.abort()}function Xe(Ve){return new Promise(function(ut,He){he.abort().then(function(){return nt()}).then(function(){return he.changeType(Ve)}).then(function(){return xt()}).then(function(){It(!1),ut()}).catch(function(rt){He(rt)})})}function ot(){return new Promise(function(Ve,ut){he.abort().then(function(){return nt()}).then(function(){return xt()}).then(function(){It(!1),Ve()}).catch(function(He){ut(He)})})}function ct(Ve){return new Promise(function(ut,He){nt().then(function(){return he.changeType(Ve)}).then(function(){ut()}).catch(function(rt){He(rt)})})}function xt(){return new Promise(function(Ve,ut){var He=Bt();if(!He||He.length===0){Ht(),Ve();return}Be(He).then(function(){Ve()}).catch(function(rt){ut(rt)})})}function Bt(Ve){var ut=[],He=he.getAllBufferRanges();if(!He||He.length===0)return ut;if(!Ve&&Ve!==0||isNaN(Ve))ut.push({start:He.start(0),end:He.end(He.length-1)+g});else{var rt=Lt(Ve,He),dt=Pt(Ve,He);rt&&ut.push(rt),dt&&ut.push(dt)}return ut}function Lt(Ve,ut){var He=ae.get().streaming.buffer.bufferToKeep,rt=ut.start(0),dt=Ve-rt;if(dt>He){var yt=Math.max(0,Ve-He),At=I.getRequests({state:l.default.FRAGMENT_MODEL_EXECUTED,time:Ve,threshold:R})[0];if(At&&(yt=Math.min(At.startTime,yt)),yt>0)return{start:rt,end:yt}}return null}function Pt(Ve,ut){var He=ut.end(ut.length-1)+g,rt=J.manifestInfo.duration>=ae.get().streaming.buffer.longFormContentDurationThreshold,dt=rt?ae.get().streaming.buffer.bufferTimeAtTopQualityLongForm:ae.get().streaming.buffer.bufferTimeAtTopQuality,yt=He-Ve;if(yt>dt){var At=Ve+dt,ke=I.getRequests({state:l.default.FRAGMENT_MODEL_EXECUTED,time:Ve,threshold:R})[0];if(ke&&(At=Math.max(ke.startTime+ke.duration,At)),At<He)return{start:At,end:He}}return null}function Ht(){(!L||K===i.default.TEXT&&V.isTextEnabled())&&we()}function Oe(){it()}function ze(){it(),D=NaN}function Fe(Ve,ut){var He=he.getAllBufferRanges(),rt=0,dt=0,yt=null,At=null,ke=0,Mt,Rt,kt=isNaN(ut)?.15:ut;if(He!=null){for(Rt=0,Mt=He.length;Rt<Mt;Rt++)if(rt=He.start(Rt),dt=He.end(Rt),yt===null)ke=Math.abs(rt-Ve),(Ve>=rt&&Ve<dt||ke<=kt)&&(yt=rt,At=dt);else if(ke=rt-At,ke<=kt)At=dt;else break;if(yt!==null)return{start:yt,end:At}}return null}function Ce(Ve,ut){var He,rt;return ae.get().streaming.gaps.jumpGaps&&(ut=ae.get().streaming.gaps.smallGapLimit),He=Fe(Ve,ut),He===null?rt=0:rt=He.end-Ve,rt}function we(){if(H){var Ve=ae.get().streaming.gaps.jumpGaps&&!isNaN(ae.get().streaming.gaps.smallGapLimit)?ae.get().streaming.gaps.smallGapLimit:NaN;de=Math.max(Ce(H.getTime()||0,Ve),0),tt(f.default.BUFFER_LEVEL_UPDATED,{mediaType:K,bufferLevel:de}),it()}}function Qe(){var Ve=Z>=pe-1,ut=H.getTimeToStreamEnd(J)-de<=0;(Ve||ut)&&!me&&(It(!0),le.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(J.id," and type ").concat(K)))}function it(){K!==i.default.AUDIO&&K!==i.default.VIDEO||((!ae.get().streaming.lowLatencyEnabled&&de<ae.get().streaming.buffer.stallThreshold||de===0)&&!me?st(o.default.BUFFER_EMPTY):(me||de>=ae.get().streaming.buffer.stallThreshold||ae.get().streaming.lowLatencyEnabled&&de>0)&&st(o.default.BUFFER_LOADED))}function st(Ve){Q===Ve||Ve===o.default.BUFFER_EMPTY&&H.getTime()===0||K===i.default.TEXT&&!V.isTextEnabled()||(Q=Ve,tt(f.default.BUFFER_LEVEL_STATE_CHANGED,{state:Ve}),tt(Ve===o.default.BUFFER_LOADED?f.default.BUFFER_LOADED:f.default.BUFFER_EMPTY),le.debug(Ve===o.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function at(){!he||K===i.default.TEXT||me||Be(Ae())}function Ae(){var Ve=[],ut=he.getAllBufferRanges();if(!ut||ut.length===0)return Ve;var He=H.getTime(),rt=Math.max(0,He-ae.get().streaming.buffer.bufferToKeep),dt=I.getRequests({state:l.default.FRAGMENT_MODEL_EXECUTED,time:He,threshold:R})[0];if(dt)rt=Math.min(dt.startTime,rt);else if(He===0&&H.getIsDynamic())return[];if(ut.start(0)<=rt){for(var yt={start:0,end:rt},At=0;At<ut.length&&ut.end(At)<=rt;At++)yt.end=ut.end(At);yt.start<yt.end&&Ve.push(yt)}return Ve}function Be(Ve){return new Promise(function(ut,He){if(!Ve||!he||Ve.length===0){ut();return}var rt=[];Ve.forEach(function(dt){rt.push(We(dt))}),ue||Te(),Promise.all(rt).then(function(){ut()}).catch(function(dt){He(dt)})})}function We(Ve){return new Promise(function(ut,He){Ve.resolve=ut,Ve.reject=He,B.push(Ve)})}function Te(){try{if(B.length===0||!he){le.debug("Nothing to prune, halt pruning"),B=[],ue=!1;return}var Ve=he.getBuffer();if(!Ve||!Ve.buffered||Ve.buffered.length===0){le.debug("SourceBuffer is empty (or does not exist), halt pruning"),B=[],ue=!1;return}var ut=B.shift();le.debug("".concat(K,": Removing buffer from: ").concat(ut.start," to ").concat(ut.end)),ue=!0;var He=H.getTime();He<ut.end&&It(!1),he.remove(ut).then(function(rt){De(rt)}).catch(function(rt){De(rt)})}catch{ue=!1}}function De(Ve){le.debug("onRemoved buffer from:",Ve.from,"to",Ve.to);var ut=he.getAllBufferRanges();Me(ut),B.length===0&&(ue=!1,we()),Ve.unintended&&(le.warn("Detected unintended removal from:",Ve.from,"to",Ve.to,"setting streamprocessor time to",Ve.from),tt(f.default.SEEK_TARGET,{time:Ve.from})),ue?Te():(L?L=!1:we(),tt(f.default.BUFFER_CLEARED,{from:Ve.from,to:Ve.to,unintended:Ve.unintended,hasEnoughSpaceToAppend:An(),quotaExceeded:$}))}function Ze(Ve){return new Promise(function(ut){if(!Ve||Ve.MSETimeOffset===void 0||!he||!he.updateTimestampOffset){ut();return}he.updateTimestampOffset(Ve.MSETimeOffset).then(function(){ut()}).catch(function(){ut()})})}function nt(){return he&&!me?he.updateAppendWindow(J):Promise.resolve()}function ge(Ve){isNaN(Ve)||(pe=Ve,Qe())}function Pe(){ie++;var Ve=ie*(ae.get().streaming.wallclockTimeUpdateInterval/1e3);Ve>=ae.get().streaming.buffer.bufferPruningInterval&&(ie=0,at())}function qe(){it()}function Ye(){return he}function $e(){return de}function ht(){return q}function bt(){return me}function It(Ve){me!==Ve&&(me=Ve,me?tt(f.default.BUFFERING_COMPLETED):pe=Number.POSITIVE_INFINITY)}function Dt(){return ue}function gt(){try{var Ve=he.getAllBufferRanges(),ut=0,He,rt;if(!Ve)return ut;for(rt=0,He=Ve.length;rt<He;rt++)ut+=Ve.end(rt)-Ve.start(rt);return ut}catch{return 0}}function Yt(Ve){try{var ut=Ve,He=he.getAllBufferRanges();if(!He||He.length===0)return Ve;for(var rt=0;ut===Ve&&rt<He.length;){var dt=He.start(rt),yt=He.end(rt);ut>=dt&&ut<=yt&&(ut=yt),rt+=1}return ut}catch{}}function An(){var Ve=gt();return isNaN(Ve)||Ve<te}function bn(Ve){D=Ve}function tt(Ve,ut){var He=ut||{};P.trigger(Ve,He,{streamId:J.id,mediaType:K})}function mt(Ve,ut){te=Number.POSITIVE_INFINITY,Q=void 0,pe=Number.POSITIVE_INFINITY,Z=0,Y=null,me=!1,ue=!1,$=!1,de=0,ie=0,B=[],D=NaN,he&&(!Ve&&!ut?he.abort().then(function(){he.reset(ut),he=null}):he=null),L=!1}function wt(Ve,ut){P.off(f.default.INIT_FRAGMENT_LOADED,oe,this),P.off(f.default.MEDIA_FRAGMENT_LOADED,ce,this),P.off(f.default.WALLCLOCK_TIME_UPDATED,Pe,this),P.off(_.default.PLAYBACK_PLAYING,ze,this),P.off(_.default.PLAYBACK_PROGRESS,Ht,this),P.off(_.default.PLAYBACK_TIME_UPDATED,Ht,this),P.off(_.default.PLAYBACK_RATE_CHANGED,qe,this),P.off(_.default.PLAYBACK_STALLED,Oe,this),mt(Ve,ut)}return re={initialize:U,getStreamId:fe,getType:ye,getBufferControllerType:_e,createBufferSink:X,getBuffer:Ye,getBufferLevel:$e,getRangeAt:Fe,setMediaSource:ee,getMediaSource:ht,appendInitSegmentFromCache:se,getIsBufferingCompleted:bt,setIsBufferingCompleted:It,getIsPruningInProgress:Dt,reset:wt,prepareForPlaybackSeek:Ue,prepareForReplacementTrackSwitch:Xe,prepareForNonReplacementTrackSwitch:ct,prepareForReplacementQualitySwitch:ot,updateAppendWindow:nt,getAllRangesWithSafetyFactor:Bt,getContinuousBufferTimeForTargetTime:Yt,clearBuffers:Be,pruneAllSafely:xt,updateBufferTimestampOffset:Ze,setSeekTarget:bn,segmentRequestingCompleted:ge},O(),re}w.__dashjs_factory_name=x,r.default=h.default.getClassFactory(w)},"./src/streaming/controllers/EventController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/core/EventBus.js"),u=n("./src/streaming/MediaPlayerEvents.js"),c=n("./src/streaming/net/XHRLoader.js");function f(){var h="urn:mpeg:dash:event:2012",p=1,E="urn:mpeg:dash:event:callback:2015",v=1,M=300,y={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},_=this.context,g=Object(l.default)(_).getInstance(),R,S,x,w,C,b,P,A,I,F,G;function V(){S=Object(o.default)(_).getInstance().getLogger(R),H()}function k(){if(!P||!A)throw new Error("setConfig function has to be called previously")}function H(){G=!1,x={},w={},C=null,F=!1,b=Date.now()/1e3}function J(){try{C!==null&&G&&(clearInterval(C),C=null,G=!1,te())}catch(O){throw O}}function K(){try{k(),S.debug("Start Event Controller");var O=I.get().streaming.eventControllerRefreshDelay;!G&&!isNaN(O)&&(G=!0,C=setInterval(de,O))}catch(U){throw U}}function ae(O){try{if(k(),O)for(var U=0;U<O.length;U++){var fe=O[U],ye=le(fe,x,!0);ye===y.ADDED?(S.debug("Added inline event with id ".concat(fe.id)),Y(fe,O,u.default.EVENT_MODE_ON_RECEIVE)):ye===y.UPDATED&&S.debug("Updated inline event with id ".concat(fe.id))}}catch(_e){throw _e}}function re(O){try{k();for(var U=0;U<O.length;U++){var fe=O[U],ye=le(fe,w,!1);ye===y.ADDED?(fe.eventStream.schemeIdUri===h&&w[fe.id]===void 0&&me(fe),S.debug("Added inband event with id "+fe.id),Y(fe,O,u.default.EVENT_MODE_ON_RECEIVE)):S.debug("Inband event with scheme_id_uri ".concat(fe.eventStream.schemeIdUri,", value ").concat(fe.eventStream.value," and id ").concat(fe.id," was ignored because it has been added before."))}de()}catch(_e){throw _e}}function le(O,U){var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ye=O.eventStream.schemeIdUri,_e=O.eventStream.value,ee=O.id,j=y.DISCARDED;U[ye]||(U[ye]=[]);var X=U[ye].findIndex(function(z){return(!_e||z.eventStream.value&&z.eventStream.value===_e)&&z.id===ee});return X===-1?(U[ye].push(O),j=y.ADDED):fe&&(U[ye][X]=O,j=y.UPDATED),j}function me(O){try{if(O.eventStream.value==p){var U=O.calculatedPresentationTime,fe;O.calculatedPresentationTime==4294967295?fe=NaN:fe=O.calculatedPresentationTime+O.duration,g.trigger(u.default.MANIFEST_VALIDITY_CHANGED,{id:O.id,validUntil:U,newDuration:fe,newManifestValidAfter:NaN},{mode:u.default.EVENT_MODE_ON_START})}}catch{}}function de(){try{if(!F){F=!0;var O=A.getTime(),U=O-b;U=b>0?Math.max(0,U):0,q(w,U,O),q(x,U,O),b=O,F=!1}}catch{F=!1}}function te(){try{Z(w),Z(x)}catch{}}function q(O,U,fe){try{var ye=function(ee){if(ee!==void 0){var j=isNaN(ee.duration)?0:ee.duration;ee.calculatedPresentationTime<=fe&&ee.calculatedPresentationTime+U+j>=fe?Y(ee,O,u.default.EVENT_MODE_ON_START):(he(fe,j+U,ee.calculatedPresentationTime)||Q(ee))&&(S.debug("Deleting event ".concat(ee.id," as it is expired or invalid")),ie(O,ee))}};pe(O,ye)}catch{}}function Z(O){try{var U=A.getTime(),fe=function(_e){var ee=_e.eventStream&&_e.eventStream.period&&!isNaN(_e.eventStream.period.duration)?_e.eventStream.period.duration:NaN,j=_e.eventStream&&_e.eventStream.period&&!isNaN(_e.eventStream.period.start)?_e.eventStream.period.start:NaN;if(!(isNaN(ee)||isNaN(j))){var X=_e.calculatedPresentationTime;Math.abs(X-U)<M&&Y(_e,O,u.default.EVENT_MODE_ON_START)}};pe(O,fe)}catch{}}function pe(O,U){try{if(O)for(var fe=Object.keys(O),ye=0;ye<fe.length;ye++){var _e=O[fe[ye]];_e.forEach(function(ee){ee!==void 0&&U(ee)})}}catch{}}function he(O,U,fe){try{return O-U>fe}catch{return!1}}function Q(O){try{var U=O.eventStream.period.start+O.eventStream.period.duration;return O.calculatedPresentationTime>U}catch{return!1}}function Y(O,U,fe){try{var ye=A.getTime(),_e=O.id;if(fe===u.default.EVENT_MODE_ON_RECEIVE){S.debug("Received event ".concat(_e)),g.trigger(O.eventStream.schemeIdUri,{event:O},{mode:fe});return}O.eventStream.schemeIdUri===h&&O.eventStream.value==p?(O.duration!==0||O.presentationTimeDelta!==0)&&(S.debug("Starting manifest refresh event ".concat(_e," at ").concat(ye)),ie(U,O),ue()):O.eventStream.schemeIdUri===E&&O.eventStream.value==v?(S.debug("Starting callback event ".concat(_e," at ").concat(ye)),ie(U,O),$(O.messageData)):(S.debug("Starting event ".concat(_e," at ").concat(ye)),ie(U,O),g.trigger(O.eventStream.schemeIdUri,{event:O},{mode:fe}))}catch{}}function ie(O,U){var fe=U.eventStream.schemeIdUri,ye=U.eventStream.value,_e=U.id;O[fe]=O[fe].filter(function(ee){return ye&&ee.eventStream.value&&ee.eventStream.value!==ye||ee.id!==_e}),O[fe].length===0&&delete O[fe]}function ue(){try{k(),P.refreshManifest()}catch{}}function $(O){try{var U=Object(c.default)(_).create({});U.load({method:"get",url:O,request:{responseType:"arraybuffer"}})}catch(fe){throw fe}}function W(O){try{if(!O)return;O.manifestUpdater&&(P=O.manifestUpdater),O.playbackController&&(A=O.playbackController),O.settings&&(I=O.settings)}catch(U){throw U}}function B(){return x}function L(){return w}function D(){J(),H()}return R={addInlineEvents:ae,addInbandEvents:re,getInbandEvents:L,getInlineEvents:B,start:K,setConfig:W,reset:D},V(),R}f.__dashjs_factory_name="EventController",r.default=i.default.getSingletonFactory(f)},"./src/streaming/controllers/FragmentController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/vo/DataChunk.js"),l=n("./src/streaming/models/FragmentModel.js"),u=n("./src/streaming/FragmentLoader.js"),c=n("./src/streaming/utils/RequestModifier.js"),f=n("./src/core/EventBus.js"),h=n("./src/core/events/Events.js"),p=n("./src/streaming/MediaPlayerEvents.js"),E=n("./src/core/errors/Errors.js"),v=n("./src/core/FactoryMaker.js"),M=n("./src/core/Debug.js");function y(_){_=_||{};var g=this.context,R=Object(f.default)(g).getInstance(),S=_.errHandler,x=_.mediaPlayerModel,w=_.dashMetrics,C=Object(M.default)(g).getInstance(),b=_.streamInfo,P,A,I;function F(){A=C.getLogger(P),k(),R.on(p.default.FRAGMENT_LOADING_COMPLETED,K,P),R.on(p.default.FRAGMENT_LOADING_PROGRESS,K,P)}function G(){return b.id}function V(ae){var re=I[ae];return re||(re=Object(l.default)(g).create({streamInfo:b,type:ae,dashMetrics:w,fragmentLoader:Object(u.default)(g).create({dashMetrics:w,mediaPlayerModel:x,errHandler:S,requestModifier:Object(c.default)(g).getInstance(),settings:_.settings,boxParser:_.boxParser,eventBus:R,events:h.default,errors:E.default,dashConstants:_.dashConstants,urlUtils:_.urlUtils,streamId:G()}),debug:C,eventBus:R,events:h.default}),I[ae]=re),re}function k(){for(var ae in I)I[ae].reset();I={}}function H(){R.off(p.default.FRAGMENT_LOADING_COMPLETED,K,this),R.off(p.default.FRAGMENT_LOADING_PROGRESS,K,this),k()}function J(ae,re,le,me){var de=new o.default;return de.streamId=le,de.mediaInfo=re.mediaInfo,de.segmentType=re.type,de.start=re.startTime,de.duration=re.duration,de.end=de.start+de.duration,de.bytes=ae,de.index=re.index,de.quality=re.quality,de.representationId=re.representationId,de.endFragment=me,de}function K(ae){if(!!ae.sender){var re=ae.request,le=ae.response,me=re.isInitializationRequest(),de=re.mediaInfo.streamInfo;if(ae.error&&(re.mediaType===i.default.AUDIO||re.mediaType===i.default.VIDEO||re.mediaType===i.default.TEXT&&re.mediaInfo.isFragmented)&&R.trigger(h.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:ae.request.serviceLocation}),!le||!de){A.warn("No "+re.mediaType+" bytes to push or stream is inactive.");return}var te=J(le,re,b.id,ae.type!==h.default.FRAGMENT_LOADING_PROGRESS);R.trigger(me?h.default.INIT_FRAGMENT_LOADED:h.default.MEDIA_FRAGMENT_LOADED,{chunk:te,request:re},{streamId:de.id,mediaType:re.mediaType})}}return P={getStreamId:G,getModel:V,reset:H},F(),P}y.__dashjs_factory_name="FragmentController",r.default=v.default.getClassFactory(y)},"./src/streaming/controllers/GapController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/core/events/Events.js"),u=n("./src/core/EventBus.js"),c=100,f=10,h=.1;function p(){var E=this.context,v=Object(u.default)(E).getInstance(),M,y,_,g,R,S,x,w,C,b,P,A;function I(){H()}function F(){A=Object(o.default)(E).getInstance().getLogger(M),G()}function G(){pe(),J(),V()}function V(){R=null,S=NaN,g=0,b=null,P={}}function k(Q){!Q||(Q.settings&&(_=Q.settings),Q.playbackController&&(x=Q.playbackController),Q.streamController&&(w=Q.streamController),Q.videoModel&&(C=Q.videoModel))}function H(){v.on(l.default.WALLCLOCK_TIME_UPDATED,me,this),v.on(l.default.INITIAL_STREAM_SWITCH,le,this),v.on(l.default.PLAYBACK_SEEKING,K,this),v.on(l.default.BUFFER_REPLACEMENT_STARTED,ae,M),v.on(l.default.TRACK_CHANGE_RENDERED,re,M)}function J(){v.off(l.default.WALLCLOCK_TIME_UPDATED,me,this),v.off(l.default.INITIAL_STREAM_SWITCH,le,this),v.off(l.default.PLAYBACK_SEEKING,K,this),v.off(l.default.BUFFER_REPLACEMENT_STARTED,ae,M),v.off(l.default.TRACK_CHANGE_RENDERED,re,M)}function K(){b&&(clearTimeout(b),b=null)}function ae(Q){try{if(Q.streamId!==w.getActiveStreamInfo().id||!Q.mediaType)return;Q.streamId===w.getActiveStreamInfo().id&&(P[Q.mediaType]=!0)}catch(Y){A.error(Y)}}function re(Q){!Q||!Q.mediaType||(P[Q.mediaType]=!1)}function le(){R||Z()}function me(){if(!!de(_.get().streaming.gaps.enableSeekFix)&&(g++,g>=f)){var Q=x.getTime();y===Q?he(Q,!0):(y=Q,S=NaN),g=0}}function de(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Y=Object.keys(P).some(function(ue){return P[ue]}),ie=Q?te():!1;return!Y&&_.get().streaming.gaps.jumpGaps&&w.getActiveStreamProcessors().length>0&&(!x.isSeeking()||ie)&&!x.isPaused()&&!w.getIsStreamSwitchInProgress()&&!w.getHasMediaOrInitialisationError()}function te(){var Q=w.getActiveStream(),Y=parseFloat((Q.getStartTime()+Q.getDuration()).toFixed(5));return x.getTime()+_.get().streaming.gaps.threshold>=Y}function q(Q,Y){try{if(!Q||Q.length<=1&&Y>0)return NaN;for(var ie=NaN,ue=0;isNaN(ie)&&ue<Q.length;){var $=ue>0?Q.end(ue-1):0;Y<Q.start(ue)&&$-Y<_.get().streaming.gaps.threshold&&(ie=ue),ue+=1}return ie}catch{return null}}function Z(){try{R||(A.debug("Starting the gap controller"),R=setInterval(function(){if(!!de()){var Q=x.getTime();he(Q)}},c))}catch{}}function pe(){A.debug("Stopping the gap controller"),R&&(clearInterval(R),R=null)}function he(Q){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,ie=_.get().streaming.gaps.smallGapLimit,ue=_.get().streaming.gaps.jumpLargeGaps,$=C.getBufferRange(),W,B=NaN,L=!1;if(W=q($,Q),!isNaN(W)){var D=$.start(W),O=D-Q;O>0&&(O<=ie||ue)&&(B=D)}var U=x.getTimeToStreamEnd();if(isNaN(B)&&Y&&isFinite(U)&&!isNaN(U)&&U<ie&&(B=parseFloat(x.getStreamEndTime().toFixed(5)),L=!0),B>0&&S!==B&&B>Q&&!b){var fe=B-Q;if(L){var ye=w.getStreamForTime(B),_e=ye&&!!ye.getPreloaded();A.warn("Jumping to end of stream because of gap from ".concat(Q," to ").concat(B,". Gap duration: ").concat(fe)),x.seek(B,!0,_e)}else{var ee=x.getIsDynamic(),j=W>0?$.end(W-1):Q,X=ee?Math.max(0,fe-h)*1e3:0;b=window.setTimeout(function(){x.seek(B,!0,!0),A.warn("Jumping gap occuring in period ".concat(w.getActiveStream().getStreamId()," starting at ").concat(j," and ending at ").concat(B,". Jumping by: ").concat(fe-X/1e3)),b=null},X)}S=B}}return M={reset:G,setConfig:k,initialize:I},F(),M}p.__dashjs_factory_name="GapController",r.default=i.default.getSingletonFactory(p)},"./src/streaming/controllers/MediaController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/EventBus.js"),u=n("./src/core/FactoryMaker.js"),c=n("./src/core/Debug.js");function f(){var p=this.context,E=Object(l.default)(p).getInstance(),v,M,y,_,g,R,S,x;function w(){M=Object(c.default)(p).getInstance().getLogger(v),ae()}function C(B,L){var D=R[B]||V(B),O=P(B,L.id),U=[];D||(D=S.getSavedMediaSettings(B),G(B,D)),!(!O||O.length===0)&&(D&&O.forEach(function(fe){le(D,fe,!!R[B])&&U.push(fe)}),U.length===0?F(he(B,O),!0):U.length>1?F(he(B,U,!!R[B])):F(U[0]))}function b(B){if(!!B){var L=B.type;if(!!H(L)){var D=B.streamInfo.id;y[D]||(y[D]=W());for(var O=y[D][L].list,U=0,fe=O.length;U<fe;++U)if(J(O[U],B))return;O.push(B)}}}function P(B,L){return B?!y[L]||!y[L][B]?[]:y[L][B].list:[]}function A(B,L){return!B||!y[L]||!y[L][B]?null:y[L][B].current}function I(B){if(!B)return!1;var L=B.type,D=B.streamInfo.id;return y[D]&&y[D][L]&&J(y[D][L].current,B)}function F(B){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(!B||!B.streamInfo)){var D=B.type,O=B.streamInfo,U=O.id,fe=A(D,U);if(!(!y[U]||!y[U][D]||J(B,fe))&&(y[U][D].current=B,y[U][D].current&&(D!==i.default.TEXT||D===i.default.TEXT&&B.isFragmented)&&E.trigger(o.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:fe,newMediaInfo:B,switchMode:_.get().streaming.trackSwitchMode[D]},{streamId:U}),!L)){var ye=re(B);if(!ye||!y[U][D].storeLastSettings)return;ye.roles&&(ye.role=ye.roles[0],delete ye.roles),ye.accessibility&&(ye.accessibility=ye.accessibility[0]),ye.audioChannelConfiguration&&(ye.audioChannelConfiguration=ye.audioChannelConfiguration[0]),R[D]=ye,S.setSavedMediaSettings(D,ye)}}}function G(B,L){!B||!L||(g[B]=L)}function V(B){return B?g[B]:null}function k(){S.setSavedMediaSettings(i.default.TEXT,null)}function H(B){return B===i.default.AUDIO||B===i.default.VIDEO||B===i.default.TEXT||B===i.default.IMAGE}function J(B,L){if(!B&&!L)return!0;if(!B||!L)return!1;var D=B.id===L.id,O=B.viewpoint===L.viewpoint,U=B.lang===L.lang,fe=B.codec===L.codec,ye=B.roles.toString()===L.roles.toString(),_e=B.accessibility.toString()===L.accessibility.toString(),ee=B.audioChannelConfiguration.toString()===L.audioChannelConfiguration.toString();return D&&fe&&O&&U&&ye&&_e&&ee}function K(B){!B||(B.domStorage&&(S=B.domStorage),B.settings&&(_=B.settings))}function ae(){y={},R={},x=null,me()}function re(B){var L={lang:B.lang,viewpoint:B.viewpoint,roles:B.roles,accessibility:B.accessibility,audioChannelConfiguration:B.audioChannelConfiguration},D=L.lang||L.viewpoint||L.role&&L.role.length>0||L.accessibility&&L.accessibility.length>0||L.audioChannelConfiguration&&L.audioChannelConfiguration.length>0;return D?L:null}function le(B,L){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=!B.lang||L.lang.match(B.lang),U=B.index===void 0||B.index===null||L.index===B.index,fe=!B.viewpoint||B.viewpoint===L.viewpoint,ye=!B.role||!!L.roles.filter(function(j){return j===B.role})[0],_e=!B.accessibility||!!L.accessibility.filter(function(j){return j===B.accessibility})[0],ee=!B.audioChannelConfiguration||!!L.audioChannelConfiguration.filter(function(j){return j===B.audioChannelConfiguration})[0];return O&&U&&fe&&(ye||L.type===i.default.AUDIO&&D)&&_e&&ee}function me(){g={audio:null,video:null,text:null}}function de(B){var L=0,D=[];return B.forEach(function(O){isNaN(O.selectionPriority)||(O.selectionPriority>L?(L=O.selectionPriority,D=[O]):O.selectionPriority===L&&D.push(O))}),D}function te(B){var L=0,D=[],O;return B.forEach(function(U){O=Math.max.apply(Math,U.bitrateList.map(function(fe){return fe.bandwidth})),O>L?(L=O,D=[U]):O===L&&D.push(U)}),D}function q(B){var L=1/0,D=[],O;return B.forEach(function(U){var fe=U.bitrateList.reduce(function(ye,_e){var ee=Math.max(1,_e.width*_e.height),j=_e.bandwidth/ee;return ye+j},0);O=fe/U.bitrateList.length,O<L?(L=O,D=[U]):O===L&&D.push(U)}),D}function Z(B){var L=0,D=[],O;return B.forEach(function(U){O=U.representationCount,O>L?(L=O,D=[U]):O===L&&D.push(U)}),D}function pe(B){x=B}function he(B,L){if(B===i.default.TEXT)return L[0];var D=_.get().streaming.selectionModeForInitialTrack,O;if(x&&typeof x=="function")O=x(L);else switch(D){case i.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:O=Q(L);break;case i.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:O=Y(L);break;case i.default.TRACK_SELECTION_MODE_FIRST_TRACK:O=ie(L);break;case i.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:O=ue(L);break;case i.default.TRACK_SELECTION_MODE_WIDEST_RANGE:O=$(L);break;default:M.warn("Track selection mode ".concat(D," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),O=ie(L);break}return O.length>0?O[0]:L[0]}function Q(B){var L=de(B);return L.length>1&&(L=te(L)),L.length>1&&(L=Z(L)),L}function Y(B){var L=te(B);return L.length>1&&(L=Z(L)),L}function ie(B){return B[0]}function ue(B){var L=q(B);return L.length>1&&(L=te(L)),L}function $(B){var L=Z(B);return L.length>1&&(L=te(B)),L}function W(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}}}return v={setInitialMediaSettingsForType:C,addTrack:b,getTracksFor:P,getCurrentTrackFor:A,isCurrentTrack:I,setTrack:F,selectInitialTrack:he,setCustomInitialTrackSelectionFunction:pe,setInitialSettings:G,getInitialSettings:V,getTracksWithHighestBitrate:te,getTracksWithHighestEfficiency:q,getTracksWithWidestRange:Z,isTracksEqual:J,matchSettings:le,saveTextSettingsDisabled:k,setConfig:K,reset:ae},w(),v}f.__dashjs_factory_name="MediaController";var h=u.default.getSingletonFactory(f);u.default.updateSingletonFactory(f.__dashjs_factory_name,h),r.default=h},"./src/streaming/controllers/MediaSourceController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js");function l(){var u,c,f,h=this.context;function p(){f=Object(o.default)(h).getInstance().getLogger(u)}function E(){var S="WebKitMediaSource"in window,x="MediaSource"in window;return x?c=new MediaSource:S&&(c=new WebKitMediaSource),c}function v(S){var x=window.URL.createObjectURL(c);return S.setSource(x),x}function M(S){S.setSource(null)}function y(S){!c||c.readyState!=="open"||S===null&&isNaN(S)||c.duration!==S&&(R(c)?setTimeout(y.bind(null,S),50):(f.info("Set MediaSource duration:"+S),c.duration=S))}function _(S,x){c&&typeof c.setLiveSeekableRange=="function"&&typeof c.clearLiveSeekableRange=="function"&&c.readyState==="open"&&S>=0&&S<x&&(c.clearLiveSeekableRange(),c.setLiveSeekableRange(S,x))}function g(S){if(!(!S||S.readyState!=="open")){for(var x=S.sourceBuffers,w=0;w<x.length;w++)if(x[w].updating||x[w].buffered.length===0)return;f.info("call to mediaSource endOfStream"),S.endOfStream()}}function R(S){for(var x=S.sourceBuffers,w=0;w<x.length;w++)if(x[w].updating)return!0;return!1}return u={createMediaSource:E,attachMediaSource:v,detachMediaSource:M,setDuration:y,setSeekable:_,signalEndOfStream:g},p(),u}l.__dashjs_factory_name="MediaSourceController",r.default=i.default.getSingletonFactory(l)},"./src/streaming/controllers/PlaybackController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/constants/MetricsConstants.js"),l=n("./src/core/EventBus.js"),u=n("./src/core/events/Events.js"),c=n("./src/core/FactoryMaker.js"),f=n("./src/core/Debug.js"),h=n("./src/streaming/MediaPlayerEvents.js"),p=500;function E(){var v=this.context,M=Object(l.default)(v).getInstance(),y,_,g,R,S,x,w,C,b,P,A,I,F,G,V,k,H,J,K,ae,re,le;function me(){_=Object(f.default)(v).getInstance().getLogger(y),oe()}function de(tt,mt){P=tt,mt!==!0&&te()}function te(){An(),A=P.manifestInfo.isDynamic,J=!1,K=!1,H=!1;var tt=typeof navigator!="undefined"?navigator.userAgent.toLowerCase():"",mt=/safari/.test(tt)&&!/chrome/.test(tt);ae=mt?.25:.02,M.on(u.default.DATA_UPDATE_COMPLETED,be,y),M.on(u.default.LOADING_PROGRESS,Ye,y),M.on(u.default.MANIFEST_UPDATED,Dt,y),M.on(u.default.STREAMS_COMPOSED,gt,y),M.on(h.default.BUFFER_LEVEL_STATE_CHANGED,$e,y),M.on(h.default.PLAYBACK_PROGRESS,at,y),M.on(h.default.PLAYBACK_TIME_UPDATED,at,y),M.on(h.default.PLAYBACK_ENDED,we,y,{priority:l.default.EVENT_PRIORITY_HIGH}),M.on(h.default.STREAM_INITIALIZING,bt,y),M.on(h.default.REPRESENTATION_SWITCH,It,y),F&&(F=!1,pe())}function q(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return parseFloat((Z(tt)-W()).toFixed(5))}function Z(tt){var mt=tt||P;return mt.start+mt.duration}function pe(){P&&x&&x.getElement()?x.play():F=!0}function he(){return P&&x?x.isPaused():null}function Q(){P&&x&&x.pause()}function Y(){return P&&x?x.isSeeking():null}function ie(){return P&&x?x.isStalled():null}function ue(tt,mt,wt){if(!(!P||!x)){var Ve=isNaN(k)?x.getTime():k;tt!==Ve&&(H=wt===!0,H||(k=tt,M.trigger(u.default.PLAYBACK_SEEK_ASKED)),_.info("Requesting seek to time: "+tt+(H?" (internal)":"")),x.setCurrentTime(tt,mt))}}function $(){var tt=g&&g.hasVideoTrack()?i.default.VIDEO:i.default.AUDIO,mt=R.getCurrentDVRInfo(tt),wt=mt?mt.range:null;wt&&!isNaN(wt.end)&&ue(wt.end-I.getLiveDelay(),!0,!1)}function W(){return P&&x?x.getTime():null}function B(){var tt=W();if(A&&!isNaN(V)){var mt=V/1e3;tt>mt&&(tt-=mt)}return tt}function L(){return P&&x?x.getPlaybackRate():null}function D(){return P&&x?x.getPlayedRanges():null}function O(){return P&&x?x.getEnded():null}function U(){return A}function fe(){return g}function ye(){return re}function _e(tt,mt){var wt,Ve,ut,He=10,rt=4,dt=4,yt=!isNaN(tt)&&isFinite(tt)?tt:NaN,At=S.getSuggestedPresentationDelay();if(le.get().streaming.delay.applyServiceDescription&&isNaN(le.get().streaming.delay.liveDelay)&&isNaN(le.get().streaming.delay.liveDelayFragmentCount)&&ee(mt),I.getLiveDelay()?wt=I.getLiveDelay():le.get().streaming.delay.liveDelayFragmentCount!==null&&!isNaN(le.get().streaming.delay.liveDelayFragmentCount)&&!isNaN(yt)?wt=yt*le.get().streaming.delay.liveDelayFragmentCount:le.get().streaming.delay.useSuggestedPresentationDelay===!0&&At!==null&&!isNaN(At)&&At>0?wt=At:isNaN(yt)?wt=mt&&!isNaN(mt.minBufferTime)?mt.minBufferTime*rt:P.manifestInfo.minBufferTime*rt:wt=yt*dt,ut=S.getAvailabilityStartTime(),ut!==null&&(V=ut),mt&&mt.dvrWindowSize>0){var ke=Math.max(mt.dvrWindowSize-He,mt.dvrWindowSize/2);Ve=Math.min(wt,ke)}else Ve=wt;return b=Ve,Ve}function ee(tt){if(!(!tt||!tt.serviceDescriptions)){for(var mt=null,wt=0;wt<tt.serviceDescriptions.length;wt++){var Ve=tt.serviceDescriptions[wt];if(Ve.schemeIdUri===i.default.SERVICE_DESCRIPTION_LL_SCHEME){mt=Ve;break}}mt&&(mt.latency&&mt.latency.target>0&&(_.debug("Apply LL properties coming from service description. Target Latency (ms):",mt.latency.target),le.update({streaming:{delay:{liveDelay:mt.latency.target/1e3},liveCatchup:{minDrift:(mt.latency.target+500)/1e3,maxDrift:mt.latency.max>mt.latency.target?(mt.latency.max-mt.latency.target+500)/1e3:void 0}}})),mt.playbackRate&&mt.playbackRate.max>1&&(_.debug("Apply LL properties coming from service description. Max PlaybackRate:",mt.playbackRate.max),le.update({streaming:{liveCatchup:{playbackRate:mt.playbackRate.max-1}}})))}}function j(){return V}function X(){return b}function z(){if(!A||isNaN(V))return NaN;var tt=B();if(isNaN(tt)||tt===0)return 0;var mt=new Date().getTime()+w.getClientTimeOffset()*1e3;return Math.max(((mt-V-tt*1e3)/1e3).toFixed(3),0)}function oe(){Q(),F=!1,b=0,V=0,re=!1,k=NaN,x&&(M.off(u.default.DATA_UPDATE_COMPLETED,be,y),M.off(u.default.LOADING_PROGRESS,Ye,y),M.off(u.default.MANIFEST_UPDATED,Dt,y),M.off(u.default.STREAMS_COMPOSED,gt,y),M.off(h.default.BUFFER_LEVEL_STATE_CHANGED,$e,y),M.off(h.default.PLAYBACK_PROGRESS,at,y),M.off(h.default.PLAYBACK_TIME_UPDATED,at,y),M.off(h.default.PLAYBACK_ENDED,we,y),M.off(h.default.STREAM_INITIALIZING,bt,y),M.off(h.default.REPRESENTATION_SWITCH,It,y),x.setPlaybackRate(1,!0),Me(),bn()),C=null,x=null,P=null,A=null}function se(tt){!tt||(tt.streamController&&(g=tt.streamController),tt.dashMetrics&&(R=tt.dashMetrics),tt.mediaPlayerModel&&(I=tt.mediaPlayerModel),tt.adapter&&(S=tt.adapter),tt.videoModel&&(x=tt.videoModel),tt.timelineConverter&&(w=tt.timelineConverter),tt.settings&&(le=tt.settings))}function ce(tt,mt){var wt=R.getCurrentDVRInfo(mt),Ve=wt?wt.range:null,ut;return Ve?(tt>Ve.end?ut=Math.max(Ve.end-b,Ve.start):tt>0&&tt+.25<Ve.start&&Math.abs(tt-Ve.start)<31536e4?le.get().streaming.lowLatencyEnabled?ut=Math.max(Ve.end-b,Ve.start):ut=Ve.start:ut=tt,ut):NaN}function Se(){if(C===null){var tt=function(){it()};C=setInterval(tt,le.get().streaming.wallclockTimeUpdateInterval)}}function Me(){clearInterval(C),C=null}function ve(){var tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(he()||!A||x.getReadyState()===0||Y()||re)){tt||(tt=g.hasVideoTrack()?i.default.VIDEO:i.default.AUDIO);var mt=B(),wt=ce(mt,tt),Ve=!isNaN(wt)&&wt!==mt;Ve&&!Y()&&(ie()||K||x.getReadyState()===1)&&(_.debug("UpdateCurrentTime: Seek to actual time: ".concat(wt," from currentTime: ").concat(mt)),ue(wt))}}function be(tt){var mt=S.convertRepresentationToRepresentationInfo(tt.currentRepresentation),wt=mt?mt.mediaInfo.streamInfo:null;wt===null||P.id!==wt.id||(P=wt)}function Ne(){M.trigger(u.default.CAN_PLAY)}function Ue(){M.trigger(u.default.CAN_PLAY_THROUGH)}function Xe(){_.info("Native video element event: play"),ve(),Se(),M.trigger(u.default.PLAYBACK_STARTED,{startTime:W()})}function ot(){_.info("Native video element event: waiting"),M.trigger(u.default.PLAYBACK_WAITING,{playingTime:W()})}function ct(){_.info("Native video element event: playing"),M.trigger(u.default.PLAYBACK_PLAYING,{playingTime:W()})}function xt(){_.info("Native video element event: pause"),M.trigger(u.default.PLAYBACK_PAUSED,{ended:O()})}function Bt(){if(H){H=!1;return}var tt=W();!isNaN(k)&&k!==tt&&(tt=k),k=NaN,_.info("Seeking to: "+tt),Se(),M.trigger(u.default.PLAYBACK_SEEKING,{seekTime:tt,streamId:P.id})}function Lt(){_.info("Native video element event: seeked"),M.trigger(u.default.PLAYBACK_SEEKED)}function Pt(){P&&M.trigger(u.default.PLAYBACK_TIME_UPDATED,{timeToEnd:q(),time:W(),streamId:P.id})}function Ht(){M.trigger(u.default.PLAYBACK_PROGRESS,{streamId:P.id})}function Oe(){var tt=L();_.info("Native video element event: ratechange: ",tt),M.trigger(u.default.PLAYBACK_RATE_CHANGED,{playbackRate:tt})}function ze(){_.info("Native video element event: loadedmetadata"),M.trigger(u.default.PLAYBACK_METADATA_LOADED),Se()}function Fe(){_.info("Native video element event: loadeddata"),M.trigger(u.default.PLAYBACK_LOADED_DATA)}function Ce(){_.info("Native video element event: ended"),Q(),Me();var tt=g?g.getActiveStreamInfo():null;!tt||M.trigger(u.default.PLAYBACK_ENDED,{isLast:tt.isLast})}function we(tt){if(C&&tt.isLast){_.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var mt=tt.seekTime?tt.seekTime:Z();x.setCurrentTime(mt),Q(),Me()}}function Qe(tt){var mt=tt.target||tt.srcElement;M.trigger(u.default.PLAYBACK_ERROR,{error:mt.error})}function it(){M.trigger(u.default.WALLCLOCK_TIME_UPDATED,{isDynamic:A,time:new Date}),U()&&(g.addDVRMetric(),he()?st():ve())}function st(){var tt=Date.now();(!G||tt>G+p)&&(G=tt,Pt())}function at(){A&&Ae()&&le.get().streaming.liveCatchup.playbackRate>0&&!he()&&!Y()&&(Te()?nt():qe())}function Ae(){return le.get().streaming.liveCatchup.enabled||le.get().streaming.lowLatencyEnabled}function Be(){var tt=null;return g.getActiveStreamProcessors().forEach(function(mt){var wt=mt.getBufferLevel();tt===null?tt=wt:tt=Math.min(tt,wt)}),tt}function We(){var tt=le.get().streaming.liveCatchup.playbackBufferMin;return le.get().streaming.liveCatchup.mode===i.default.LIVE_CATCHUP_MODE_LOLP&&tt!==null&&!isNaN(tt)?i.default.LIVE_CATCHUP_MODE_LOLP:i.default.LIVE_CATCHUP_MODE_DEFAULT}function Te(){try{if(Ae()&&le.get().streaming.liveCatchup.playbackRate>0&&W()>0){var tt=We(),mt=z(),wt=I.getLiveDelay(),Ve=I.getLiveCatchupLatencyThreshold(),ut=le.get().streaming.liveCatchup.minDrift;if(tt===i.default.LIVE_CATCHUP_MODE_LOLP){var He=Be(),rt=le.get().streaming.liveCatchup.playbackBufferMin;return Ze(mt,wt,ut,He,rt,Ve)}else return De(mt,wt,Ve,ut)}}catch{return!1}}function De(tt,mt,wt,Ve){try{var ut=Math.abs(tt-mt);return ut>Ve&&(isNaN(wt)||tt<=wt)}catch{return!1}}function Ze(tt,mt,wt,Ve,ut,He){try{var rt=Math.abs(tt-mt);return(isNaN(He)||tt<=He)&&(rt>wt||Ve<ut)}catch{return!1}}function nt(){if(x){var tt,mt=x.getPlaybackRate(),wt=le.get().streaming.liveCatchup.playbackRate,Ve=z(),ut=I.getLiveDelay(),He=Be();if(We()===i.default.LIVE_CATCHUP_MODE_LOLP){var rt=le.get().streaming.liveCatchup.minDrift,dt=le.get().streaming.liveCatchup.playbackBufferMin;tt=Pe(wt,Ve,ut,rt,dt,He,mt)}else tt=ge(wt,Ve,ut,He,mt);var yt=tt.newRate;yt&&x.setPlaybackRate(yt);var At=Ve-ut;le.get().streaming.liveCatchup.maxDrift>0&&!J&&At>le.get().streaming.liveCatchup.maxDrift?(_.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),J=!0,$()):J=!1}}function ge(tt,mt,wt,Ve,ut){var He=tt,rt=mt-wt,dt=rt*5,yt=He*2/(1+Math.pow(Math.E,-dt)),At=1-He+yt;return K&&(Ve>wt/2?K=!1:rt>0&&(At=1)),Math.abs(ut-At)<=ae&&(At=null),{newRate:At}}function Pe(tt,mt,wt,Ve,ut,He,rt){var dt=tt,yt;if(He<ut){var At=He-ut,ke=At*5,Mt=dt*2/(1+Math.pow(Math.E,-ke));yt=1-dt+Mt,_.debug("[LoL+ playback control_buffer-based] bufferLevel: "+He+", newRate: "+yt)}else{var Rt=.02;if(Math.abs(mt-wt)<=Rt*wt)yt=1;else{var kt=mt-wt,rn=kt*5,_n=dt*2/(1+Math.pow(Math.E,-rn));yt=1-dt+_n}_.debug("[LoL+ playback control_latency-based] latency: "+mt+", newRate: "+yt)}return K&&He>wt/2&&(K=!1),Math.abs(rt-yt)<=ae&&(yt=null),{newRate:yt}}function qe(){x&&x.setPlaybackRate(1)}function Ye(tt){if(tt.stream===!1&&le.get().streaming.lowLatencyEnabled&&!isNaN(tt.request.duration)){var mt=1.2*tt.request.duration;mt>I.getLiveDelay()&&(_.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",mt.toFixed(2)),le.update({streaming:{delay:{liveDelay:mt}}}))}}function $e(tt){tt.streamId===P.id&&(Ae()?tt.state===o.default.BUFFER_EMPTY&&!Y()&&(K||(K=!0,qe())):le.get().streaming.buffer.setStallState&&x.setStallState(tt.mediaType,tt.state===o.default.BUFFER_EMPTY))}function ht(tt){M.trigger(u.default.PLAYBACK_STALLED,{e:tt})}function bt(tt){Yt(tt.mediaInfo)}function It(tt){var mt=g.getActiveStreamInfo();if(!(!le.get().streaming.lowLatencyEnabledByManifest||!tt||!mt||!tt.currentRepresentation||!tt.streamId||tt.streamId!==mt.id||!tt.mediaType||tt.mediaType!==i.default.VIDEO&&tt.mediaType!==i.default.AUDIO)){var wt=!tt.currentRepresentation.availabilityTimeComplete;wt&&le.update({streaming:{lowLatencyEnabled:wt}})}}function Dt(){re=!0}function gt(){re=!1}function Yt(tt){tt&&tt.supplementalProperties&&tt.supplementalProperties[i.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]==="true"&&(_.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),le.update({streaming:{lowLatencyEnabled:!0}}))}function An(){x.addEventListener("canplay",Ne),x.addEventListener("canplaythrough",Ue),x.addEventListener("play",Xe),x.addEventListener("waiting",ot),x.addEventListener("playing",ct),x.addEventListener("pause",xt),x.addEventListener("error",Qe),x.addEventListener("seeking",Bt),x.addEventListener("seeked",Lt),x.addEventListener("timeupdate",Pt),x.addEventListener("progress",Ht),x.addEventListener("ratechange",Oe),x.addEventListener("loadedmetadata",ze),x.addEventListener("loadeddata",Fe),x.addEventListener("stalled",ht),x.addEventListener("ended",Ce)}function bn(){x.removeEventListener("canplay",Ne),x.removeEventListener("canplaythrough",Ue),x.removeEventListener("play",Xe),x.removeEventListener("waiting",ot),x.removeEventListener("playing",ct),x.removeEventListener("pause",xt),x.removeEventListener("error",Qe),x.removeEventListener("seeking",Bt),x.removeEventListener("seeked",Lt),x.removeEventListener("timeupdate",Pt),x.removeEventListener("progress",Ht),x.removeEventListener("ratechange",Oe),x.removeEventListener("loadedmetadata",ze),x.removeEventListener("loadeddata",Fe),x.removeEventListener("stalled",ht),x.removeEventListener("ended",Ce)}return y={initialize:de,setConfig:se,getTimeToStreamEnd:q,getBufferLevel:Be,getTime:W,getNormalizedTime:B,getIsManifestUpdateInProgress:ye,getPlaybackRate:L,getPlayedRanges:D,getEnded:O,getIsDynamic:U,getStreamController:fe,computeAndSetLiveDelay:_e,getLiveDelay:X,getCurrentLiveLatency:z,play:pe,isPaused:he,pause:Q,isSeeking:Y,getStreamEndTime:Z,seek:ue,reset:oe,updateCurrentTime:ve,getAvailabilityStartTime:j},me(),y}E.__dashjs_factory_name="PlaybackController",r.default=c.default.getSingletonFactory(E)},"./src/streaming/controllers/ScheduleController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/models/FragmentModel.js"),l=n("./src/core/EventBus.js"),u=n("./src/core/events/Events.js"),c=n("./src/core/FactoryMaker.js"),f=n("./src/core/Debug.js"),h=n("./src/streaming/constants/MetricsConstants.js"),p=n("./src/streaming/MediaPlayerEvents.js");function E(v){v=v||{};var M=this.context,y=Object(l.default)(M).getInstance(),_=v.dashMetrics,g=v.mediaPlayerModel,R=v.fragmentModel,S=v.abrController,x=v.playbackController,w=v.textController,C=v.type,b=v.bufferController,P=v.settings,A,I,F,G,V,k,H,J,K,ae,re,le,me;function de(){F=Object(f.default)(M).getInstance().getLogger(A),ve(),I=v.streamInfo}function te(Ue){H=Ue,y.on(u.default.BYTES_APPENDED_END_FRAGMENT,j,A),y.on(u.default.URL_RESOLUTION_FAILED,X,A),y.on(p.default.PLAYBACK_STARTED,z,A),y.on(p.default.PLAYBACK_RATE_CHANGED,oe,A),y.on(p.default.PLAYBACK_TIME_UPDATED,_e,A)}function q(){return C}function Z(){return I.id}function pe(Ue){G=Ue}function he(Ue){if(!b.getIsBufferingCompleted()){Q();var Xe=isNaN(Ue)?0:Ue;k=setTimeout(ie,Xe)}}function Q(){k&&(clearTimeout(k),k=null)}function Y(){var Ue=I.id,Xe=S.getMaxAllowedIndexFor(C,Ue);return isNaN(K)||K!=Xe?(F.info("Top quality "+C+" index has changed from "+K+" to "+Xe),K=Xe,!0):!1}function ie(){try{if($()){Q();return}if(W()){var Ue=!1;me&&(Ue=S.checkPlaybackQuality(C,I.id)),Ue||ue()}else he(P.get().streaming.lowLatencyEnabled?P.get().streaming.scheduling.lowLatencyTimeout:P.get().streaming.scheduling.defaultTimeout)}catch{he(P.get().streaming.lowLatencyEnabled?P.get().streaming.scheduling.lowLatencyTimeout:P.get().streaming.scheduling.defaultTimeout)}}function ue(){le||G.quality!==ae||re?(re?(F.debug("Switch track for "+C+", representation id = "+G.id),re=!1):F.debug("Quality has changed, get init request for representationid = "+G.id),y.trigger(u.default.INIT_FRAGMENT_NEEDED,{representationId:G.id,sender:A},{streamId:I.id,mediaType:C}),me=!1,le=!1):(F.debug("Media segment needed for ".concat(C," and stream id ").concat(I.id)),y.trigger(u.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:I.id,mediaType:C}),me=!0)}function $(){try{return C===i.default.TEXT&&!w.isTextEnabled()||x.isPaused()&&(!x.getStreamController().getInitialPlayback()||!x.getStreamController().getAutoPlay())&&!P.get().streaming.scheduling.scheduleWhilePaused}catch{return!1}}function W(){try{return G&&(isNaN(ae)||re||Y()||B())}catch{return!1}}function B(){if(!C||!G)return!0;var Ue=_.getCurrentBufferLevel(C);return Ue<L()}function L(){var Ue=NaN;return!C||!G||(C===i.default.TEXT?Ue=D():C===i.default.AUDIO&&H?Ue=O():Ue=U()),Ue}function D(){try{if(w.isTextEnabled())if(isNaN(G.fragmentDuration)){var Ue=_.getCurrentSchedulingInfo(h.default.SCHEDULING_INFO);return Ue?Ue.duration:0}else return G.fragmentDuration;else return 0}catch{return 0}}function O(){try{var Ue=_.getCurrentBufferLevel(i.default.VIDEO);return isNaN(G.fragmentDuration)?Ue+1:Math.max(Ue+1,G.fragmentDuration)}catch{return 0}}function U(){try{var Ue=G.mediaInfo.streamInfo;if(S.isPlayingAtTopQuality(Ue)){var Xe=Ue.manifestInfo.duration>=P.get().streaming.buffer.longFormContentDurationThreshold;return Xe?P.get().streaming.buffer.bufferTimeAtTopQualityLongForm:P.get().streaming.buffer.bufferTimeAtTopQuality}else return g.getStableBufferTime()}catch{return g.getStableBufferTime()}}function fe(Ue){re=Ue}function ye(){return re}function _e(){ee(!0)}function ee(Ue){if(x&&R){var Xe=R.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:x.getTime(),threshold:0})[0];Xe&&x.getTime()>=Xe.startTime&&((!J.mediaInfo||Xe.mediaInfo.type===J.mediaInfo.type&&Xe.mediaInfo.id!==J.mediaInfo.id)&&Ue&&y.trigger(u.default.TRACK_CHANGE_RENDERED,{mediaType:C,oldMediaInfo:J.mediaInfo,newMediaInfo:Xe.mediaInfo,streamId:I.id}),(Xe.quality!==J.quality||Xe.adaptationIndex!==J.adaptationIndex)&&Ue&&(F.debug("Quality change rendered for streamId ".concat(I.id," and type ").concat(C)),y.trigger(u.default.QUALITY_CHANGE_RENDERED,{mediaType:C,oldQuality:J.quality,newQuality:Xe.quality,streamId:I.id})),J={mediaInfo:Xe.mediaInfo,quality:Xe.quality,adaptationIndex:Xe.adaptationIndex})}}function j(Ue){F.debug("Appended bytes for ".concat(Ue.mediaType," and stream id ").concat(I.id)),(isNaN(Ue.index)||isNaN(ae))&&(ae=Ue.quality,F.info("["+C+"] lastInitializedRepresentationInfo changed to "+Ue.quality)),he(0)}function X(){R.abortRequests(),Q()}function z(){P.get().streaming.scheduling.scheduleWhilePaused||he()}function oe(Ue){_.updatePlayListTraceMetrics({playbackspeed:Ue.playbackRate.toString()})}function se(Ue){V=Ue}function ce(){return V}function Se(Ue){me=Ue}function Me(Ue){le=Ue}function ve(){me=!0,V=0,ae=NaN,J={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},K=NaN,re=!1,le=!1}function be(){y.off(u.default.BYTES_APPENDED_END_FRAGMENT,j,A),y.off(u.default.URL_RESOLUTION_FAILED,X,A),y.off(p.default.PLAYBACK_STARTED,z,A),y.off(p.default.PLAYBACK_RATE_CHANGED,oe,A),y.off(p.default.PLAYBACK_TIME_UPDATED,_e,A),Q(),ee(!1),ve(),I=null}function Ne(){return x}return A={initialize:te,getType:q,getStreamId:Z,setCurrentRepresentation:pe,setTimeToLoadDelay:se,getTimeToLoadDelay:ce,setSwitchTrack:fe,getSwitchStrack:ye,startScheduleTimer:he,clearScheduleTimer:Q,reset:be,getBufferTarget:L,getPlaybackController:Ne,setCheckPlaybackQuality:Se,setInitSegmentRequired:Me},de(),A}E.__dashjs_factory_name="ScheduleController",r.default=c.default.getClassFactory(E)},"./src/streaming/controllers/StreamController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/constants/MetricsConstants.js"),l=n("./src/streaming/Stream.js"),u=n("./src/streaming/ManifestUpdater.js"),c=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),h=n("./src/core/FactoryMaker.js"),p=n("./src/streaming/vo/metrics/PlayList.js"),E=n("./src/core/Debug.js"),v=n("./src/streaming/utils/InitCache.js"),M=n("./src/streaming/utils/URLUtils.js"),y=n("./src/streaming/MediaPlayerEvents.js"),_=n("./src/streaming/controllers/TimeSyncController.js"),g=n("./src/streaming/controllers/MediaSourceController.js"),R=n("./src/streaming/vo/DashJSError.js"),S=n("./src/core/errors/Errors.js"),x=n("./src/streaming/controllers/EventController.js"),w=n("./src/streaming/constants/ConformanceViolationConstants.js");function C(H){return I(H)||A(H)||P(H)||b()}function b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P(H,J){if(!!H){if(typeof H=="string")return F(H,J);var K=Object.prototype.toString.call(H).slice(8,-1);if(K==="Object"&&H.constructor&&(K=H.constructor.name),K==="Map"||K==="Set")return Array.from(H);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return F(H,J)}}function A(H){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(H))return Array.from(H)}function I(H){if(Array.isArray(H))return F(H)}function F(H,J){(J==null||J>H.length)&&(J=H.length);for(var K=0,ae=new Array(J);K<J;K++)ae[K]=H[K];return ae}var G=200,V=2;function k(){var H=this.context,J=Object(c.default)(H).getInstance(),K,ae,re,le,me,de,te,q,Z,pe,he,Q,Y,ie,ue,$,W,B,L,D,O,U,fe,ye,_e,ee,j,X,z,oe,se,ce,Se,Me,ve,be,Ne,Ue,Xe,ot,ct,xt,Bt,Lt;function Pt(){ae=Object(E.default)(H).getInstance().getLogger(K),he=Object(_.default)(H).getInstance(),pe=Object(g.default)(H).getInstance(),B=Object(v.default)(H).getInstance(),L=Object(M.default)(H).getInstance(),Na()}function Ht(Ge,ft){gr(),j=Ge,ee=ft,O.initialize(),me=Object(u.default)(H).create(),me.setConfig({manifestModel:te,adapter:q,manifestLoader:de,errHandler:D,settings:ct}),me.initialize(),W=Object(x.default)(H).getInstance(),W.setConfig({manifestUpdater:me,playbackController:Se,settings:ct}),W.start(),he.setConfig({dashMetrics:Z,baseURLController:Q,errHandler:D,settings:ct}),he.initialize(),ye&&(J.trigger(f.default.PROTECTION_CREATED,{controller:ye}),ye.setMediaElement(ce.getElement()),ee&&ye.setProtectionData(ee)),Oe()}function Oe(){J.on(y.default.PLAYBACK_TIME_UPDATED,bt,K),J.on(y.default.PLAYBACK_SEEKING,Be,K),J.on(y.default.PLAYBACK_ERROR,zr,K),J.on(y.default.PLAYBACK_STARTED,It,K),J.on(y.default.PLAYBACK_PAUSED,Dt,K),J.on(y.default.PLAYBACK_ENDED,wt,K),J.on(y.default.METRIC_ADDED,ws,K),J.on(y.default.MANIFEST_VALIDITY_CHANGED,Oa,K),J.on(y.default.BUFFER_LEVEL_UPDATED,$e,K),J.on(y.default.QUALITY_CHANGE_REQUESTED,ht,K),f.default.KEY_SESSION_UPDATED&&J.on(f.default.KEY_SESSION_UPDATED,Ce,K),J.on(f.default.MANIFEST_UPDATED,kt,K),J.on(f.default.STREAM_BUFFERING_COMPLETED,gt,K),J.on(f.default.TIME_SYNCHRONIZATION_COMPLETED,Fe,K),J.on(f.default.CURRENT_TRACK_CHANGED,nt,K)}function ze(){J.off(y.default.PLAYBACK_TIME_UPDATED,bt,K),J.off(y.default.PLAYBACK_SEEKING,Be,K),J.off(y.default.PLAYBACK_ERROR,zr,K),J.off(y.default.PLAYBACK_STARTED,It,K),J.off(y.default.PLAYBACK_PAUSED,Dt,K),J.off(y.default.PLAYBACK_ENDED,wt,K),J.off(y.default.METRIC_ADDED,ws,K),J.off(y.default.MANIFEST_VALIDITY_CHANGED,Oa,K),J.off(y.default.BUFFER_LEVEL_UPDATED,$e,K),J.off(y.default.QUALITY_CHANGE_REQUESTED,ht,K),f.default.KEY_SESSION_UPDATED&&J.off(f.default.KEY_SESSION_UPDATED,Ce,K),J.off(f.default.MANIFEST_UPDATED,kt,K),J.off(f.default.STREAM_BUFFERING_COMPLETED,gt,K),J.off(f.default.TIME_SYNCHRONIZATION_COMPLETED,Fe,K),J.off(f.default.CURRENT_TRACK_CHANGED,nt,K)}function Fe(){we()}function Ce(){xt=!0}function we(){try{var Ge=q.getStreamsInfo();if(!fe&&Ge.length===0)throw new Error("There are no streams");fe&&Z.updateManifestUpdateInfo({currentTime:Se.getTime(),buffered:ce.getBufferRange(),presentationStartTime:Ge[0].start,clientTimeOffset:O.getClientTimeOffset()}),U.length>0&&Mt(Ge);for(var ft=[],Ct=0,Wt=Ge.length;Ct<Wt;Ct++){var Zt=Ge[Ct];ft.push(Qe(Zt)),Z.addManifestUpdateStreamInfo(Zt)}Promise.all(ft).then(function(){fe||it(Ge),J.trigger(f.default.STREAMS_COMPOSED),Yt()}).catch(function($t){throw $t})}catch($t){D.error(new R.default(S.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,$t.message+"nostreamscomposed",te.getValue())),oe=!0,aa()}}function Qe(Ge){var ft=ei(Ge.id);return ft?ft.updateData(Ge):(ft=Object(l.default)(H).create({manifestModel:te,mediaPlayerModel:Me,dashMetrics:Z,manifestUpdater:me,adapter:q,timelineConverter:O,capabilities:re,capabilitiesFilter:le,errHandler:D,baseURLController:Q,segmentBaseController:Y,textController:_e,abrController:ue,playbackController:Se,eventController:W,mediaController:$,protectionController:ye,videoModel:ce,streamInfo:Ge,settings:ct}),U.push(ft),ft.initialize(),Promise.resolve())}function it(Ge){Ye();var ft=Z.getCurrentDVRInfo().range;if(ft.end<ft.start){Bt&&clearTimeout(Bt);var Ct=Math.min(((ft.end-ft.start)*-1+V)*1e3,2147483647);ae.debug("Waiting for ".concat(Ct," ms before playback can start")),J.trigger(f.default.AST_IN_FUTURE,{delay:Ct}),Bt=setTimeout(function(){it(Ge)},Ct);return}if(q.getIsDynamic()&&U.length){var Wt=Ge[0].manifestInfo,Zt=Rt(Ge,Wt);Se.computeAndSetLiveDelay(Zt,Wt)}var $t=At(),sn=qe($t),sr=sn!==null?sn:U[0];J.trigger(f.default.INITIAL_STREAM_SWITCH,{startTime:$t}),st(sr,null,$t),An()}function st(Ge,ft,Ct){try{if(X||!Ge||ft===Ge&&Ge.getIsActive())return;X=!0,J.trigger(f.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:ft?ft.getStreamInfo():null,toStreamInfo:Ge.getStreamInfo()});var Wt=!1;fe=Ge,ft&&(Wt=ge(Ge,ft),ft.deactivate(Wt)),Ct=isNaN(Ct)?!Wt&&ft?Ge.getStreamInfo().start:NaN:Ct,ae.info("Switch to stream ".concat(Ge.getId(),". Seektime is ").concat(Ct,", current playback time is ").concat(Se.getTime(),". Seamless period switch is set to ").concat(Wt)),Xe=Xe.filter(function(Zt){return Zt.getId()!==fe.getId()}),Se.initialize(mr(),!!ft),ce.getElement()&&at(Ct,Wt)}catch{X=!1}}function at(Ge,ft){var Ct;function Wt(){if(!(!se||se.readyState!=="open")){ae.debug("MediaSource is open!"),window.URL.revokeObjectURL(Ct),se.removeEventListener("sourceopen",Wt),se.removeEventListener("webkitsourceopen",Wt),He();var $t=Z.getCurrentDVRInfo();pe.setSeekable($t.range.start,$t.range.end),Ae(Ge,ft)}}function Zt(){se.addEventListener("sourceopen",Wt,!1),se.addEventListener("webkitsourceopen",Wt,!1),Ct=pe.attachMediaSource(ce),ae.debug("MediaSource attached to element.  Waiting on open...")}se?ft?Ae(Ge,ft):(pe.detachMediaSource(ce),Zt()):(se=pe.createMediaSource(),Zt())}function Ae(Ge,ft){fe.activate(se,ft?Ue:void 0,Ge).then(function(Ct){if(Ct){var Wt=Object.keys(Ct);Wt.length>0&&Ct[Wt[0]].getBuffer().changeType&&(ot=!0),Ue=Ct}isNaN(Ge)||(J.trigger(f.default.SEEK_TARGET,{time:Ge},{streamId:fe.getId()}),Se.seek(Ge,!1,!0),fe.startScheduleControllers()),X=!1,J.trigger(f.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:mr()})})}function Be(Ge){var ft=Se.getTime(),Ct=Ge.seekTime,Wt=qe(Ct);!Wt||Wt===fe?(We(ft,Ct),De(Ge)):Wt&&Wt!==fe&&(We(ft,Ct,Wt),Ze(Ge,Wt)),ar(p.PlayList.SEEK_START_REASON)}function We(Ge,ft){var Ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Ge<=ft&&!Ct||Ge>ft&&!Ct,Te()}function Te(){Xe&&Xe.length>0&&(Xe.forEach(function(Ge){Ge.deactivate(!0)}),Xe=[])}function De(Ge){var ft=fe.getProcessors();ft.forEach(function(Ct){return Ct.prepareInnerPeriodPlaybackSeeking(Ge)}),pn(p.PlayListTrace.USER_REQUEST_STOP_REASON)}function Ze(Ge,ft){var Ct=Ge&&!isNaN(Ge.seekTime)?Ge.seekTime:NaN,Wt=fe.getProcessors(),Zt=Wt.map(function($t){return $t.prepareOuterPeriodPlaybackSeeking(Ge)});Promise.all(Zt).then(function(){st(ft,fe,Ct)}).catch(function($t){D.error($t)})}function nt(Ge){Ge.newMediaInfo.streamInfo.id===fe.getId()&&(Te(),fe.prepareTrackChange(Ge))}function ge(Ge,ft){try{return ct.get().streaming.buffer.reuseExistingSourceBuffers&&(ft.isProtectionCompatible(Ge)||xt)&&(ot||ft.isMediaCodecCompatible(Ge,ft))}catch{return!1}}function Pe(Ge){var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(se&&!Ge.getPreloaded()){var Ct=ge(Ge,ft);Ct&&Ge.startPreloading(se,Ue).then(function(){Xe.push(Ge)})}}function qe(Ge){if(isNaN(Ge))return null;for(var ft=U.length,Ct=0;Ct<ft;Ct++){var Wt=U[Ct],Zt=parseFloat((Wt.getStartTime()+Wt.getDuration()).toFixed(5));if(Ge<Zt)return Wt}return null}function Ye(){try{var Ge=q.getIsDynamic(),ft=q.getStreamsInfo(),Ct=ft[0].manifestInfo,Wt=Se.getTime(),Zt=O.calcTimeShiftBufferWindow(U,Ge),$t=mt();if(typeof Zt.start=="undefined"||typeof Zt.end=="undefined")return;!$t||$t.length===0?Z.addDVRInfo(i.default.VIDEO,Wt,Ct,Zt):$t.forEach(function(sn){Z.addDVRInfo(sn.getType(),Wt,Ct,Zt)})}catch{}}function $e(Ge){if(be&&j){var ft=Me.getInitialBufferLevel();(isNaN(ft)||ft<=Se.getBufferLevel()||q.getIsDynamic()&&ft>Se.getLiveDelay())&&(be=!1,ar(p.PlayList.INITIAL_PLAYOUT_START_REASON),Se.play())}Ge&&Ge.mediaType&&Z.addBufferLevel(Ge.mediaType,new Date,Ge.bufferLevel*1e3)}function ht(Ge){Ge.streamInfo.id===fe.getId()&&Ge.reason&&Ge.reason.forceReplace&&Te();var ft=ei(Ge.streamInfo.id);ft.prepareQualityChange(Ge)}function bt(){if(rn()){var Ge=ce.getPlaybackQuality();Ge&&Z.addDroppedFrames(Ge)}}function It(){ae.debug("[onPlaybackStarted]"),!be&&ve&&ar(p.PlayList.RESUME_FROM_PAUSE_START_REASON),be&&(be=!1),ve=!1}function Dt(Ge){ae.debug("[onPlaybackPaused]"),Ge.ended||(ve=!0,pn(p.PlayListTrace.USER_REQUEST_STOP_REASON))}function gt(Ge){ae.debug("Stream with id ".concat(Ge.streamInfo.id," finished buffering"));var ft=Ge.streamInfo.isLast;se&&ft?(ae.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),pe.signalEndOfStream(se)):Yt()}function Yt(){if(!(!fe||!fe.getHasFinishedBuffering()))for(var Ge=ut(fe),ft=0;ft<Ge.length;){var Ct=Ge[ft],Wt=ft===0?fe:Ge[ft-1];!Ct.getPreloaded()&&Wt.getHasFinishedBuffering()&&se&&Pe(Ct,Wt),ft+=1}}function An(){Ne||(Ne=setInterval(function(){!X&&Se.getTimeToStreamEnd()<=0&&!Se.isSeeking()&&J.trigger(f.default.PLAYBACK_ENDED,{isLast:mr().isLast})},G))}function bn(){Ne&&(clearInterval(Ne),Ne=null)}function tt(Ge,ft){for(var Ct=null,Wt=0,Zt=0,$t=null,sn=0;sn<U.length;sn++){if(Ct=U[sn],Zt=Ct.getStartTime(),$t=Ct.getDuration(),Number.isFinite(Zt)&&(Wt=Zt),Ct.getId()===ft)return Ge-Wt;Number.isFinite($t)&&(Wt+=$t)}return null}function mt(){return fe?fe.getProcessors():[]}function wt(Ge){if(fe&&!fe.getIsEndedEventSignaled()){fe.setIsEndedEventSignaled(!0);var ft=Ve();ft?(ae.debug("StreamController onEnded, found next stream with id ".concat(ft.getStreamInfo().id,". Switching from ").concat(fe.getStreamInfo().id," to ").concat(ft.getStreamInfo().id)),st(ft,fe,NaN)):(ae.debug("StreamController no next stream found"),fe.setIsEndedEventSignaled(!1)),pn(ft?p.PlayListTrace.END_OF_PERIOD_STOP_REASON:p.PlayListTrace.END_OF_CONTENT_STOP_REASON)}Ge&&Ge.isLast&&bn()}function Ve(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ft=Ge||fe||null;if(!ft)return null;for(var Ct=ft.getStreamInfo(),Wt=Ct.start,Zt=0,$t=-1,sn=NaN;Zt<U.length;){var sr=U[Zt],wn=sr.getStreamInfo(),mi=wn.start-Wt;mi>0&&(isNaN(sn)||mi<sn)&&Ct.id!==wn.id&&(sn=mi,$t=Zt),Zt+=1}return $t>=0?U[$t]:null}function ut(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var ft=Ge||fe||null;if(ft){var Ct=ft.getStreamInfo();return U.filter(function(Wt){var Zt=Wt.getStreamInfo();return Zt.start>Ct.start&&Ct.id!==Zt.id})}}catch{return[]}}function He(Ge){var ft=Ge||mr().manifestInfo.duration;pe.setDuration(ft)}function rt(){return fe}function dt(){return be}function yt(){return j}function At(){var Ge;if(q.getIsDynamic()){var ft=Z.getCurrentDVRInfo(),Ct=ft&&ft.range?ft.range.end:0;Ge=Ct-Se.getLiveDelay();var Wt=ft?ft.range:null;if(Wt){var Zt=ke(!0);if(!isNaN(Zt)){ae.info("Start time from URI parameters: "+Zt);var $t=ct.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;Ge=Math.max(Math.min(Ge,Zt),Wt.start+$t)}}}else{var sn=Fa(),sr=sn[0].getStreamInfo();Ge=sr.start;var wn=ke(!1);isNaN(wn)||(ae.info("Start time from URI parameters: "+wn),Ge=Math.max(Ge,wn))}return Ge}function ke(Ge){var ft=ie.getURIFragmentData();if(!ft||!ft.t)return NaN;var Ct=Fa()[0],Wt=Ct.getStreamInfo().start;ft.t=ft.t.split(",")[0];var Zt=ft.t.indexOf("posix:")!==-1?ft.t.substring(6)==="now"?Date.now()/1e3:parseInt(ft.t.substring(6)):NaN,$t=Ge&&!isNaN(Zt)?Zt-Se.getAvailabilityStartTime()/1e3:parseInt(ft.t)+Wt;return $t}function Mt(Ge){U=U.filter(function(ft){var Ct=Ge.filter(function(Zt){return Zt.id===ft.getId()}).length>0,Wt=Ct||ft.getId()===fe.getId();return Wt||(ae.debug("Removing stream ".concat(ft.getId())),ft.reset(!0)),Wt})}function Rt(Ge,ft){try{var Ct=NaN;if(ft&&!isNaN(ft.maxFragmentDuration)&&isFinite(ft.maxFragmentDuration))return ft.maxFragmentDuration;if(Ge&&Ge.length===1){var Wt=Ge[0],Zt=[i.default.VIDEO,i.default.AUDIO,i.default.TEXT],$t=Zt.reduce(function(sn,sr){var wn=q.getMediaInfoForType(Wt,sr);return wn&&wn.isFragmented!==!1&&sn.push(wn),sn},[]).reduce(function(sn,sr){var wn=q.getVoRepresentations(sr);return wn&&wn.length>0&&wn.forEach(function(mi){mi&&sn.push(mi)}),sn},[]).reduce(function(sn,sr){var wn=q.convertRepresentationToRepresentationInfo(sr);return wn&&wn.fragmentDuration&&!isNaN(wn.fragmentDuration)&&sn.push(wn.fragmentDuration),sn},[]);Ct=Math.max.apply(Math,C($t))}return isFinite(Ct)?Ct:NaN}catch{return NaN}}function kt(Ge){if(Ge.error)oe=!0,aa();else{ae.info("Manifest updated... updating data system wide.");var ft=Ge.manifest;q.updatePeriods(ft);var Ct=q.getUTCTimingSources();q.getIsDynamic()&&(!Ct||Ct.length===0)&&J.trigger(y.default.CONFORMANCE_VIOLATION,{level:w.default.LEVELS.WARNING,event:w.default.EVENTS.NO_UTC_TIMING_ELEMENT});var Wt=q.getIsDynamic()?Ct.concat(Me.getUTCTimingSources()):Ct,Zt=L.isHTTPS(Ge.manifest.url);Wt.forEach(function($t){$t.value.replace(/.*?:\/\//g,"")===Me.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&($t.value=$t.value.replace(Zt?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),Zt?"https://":"http://"),ae.debug("Matching default timing source protocol to manifest protocol: ",$t.value))}),le.filterUnsupportedFeatures(ft).then(function(){Q.initialize(ft),he.attemptSync(Wt,q.getIsDynamic())})}}function rn(){return fe?fe.getHasVideoTrack():!1}function _n(){return fe?fe.getHasAudioTrack():!1}function En(Ge){fe&&(Se.initialize(mr()),at(Ge,!1))}function pn(Ge,ft){ft=ft||new Date,mt().forEach(function(Ct){Ct.finalisePlayList(ft,Ge)}),Z.addPlayList()}function ar(Ge){Z.createPlaylistMetrics(Se.getTime()*1e3,Ge)}function zr(Ge){if(!!Ge.error){var ft="";switch(Ge.error.code){case 1:ft="MEDIA_ERR_ABORTED";break;case 2:ft="MEDIA_ERR_NETWORK";break;case 3:ft="MEDIA_ERR_DECODE",Lt.counts.mediaErrorDecode+=1;break;case 4:ft="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:ft="MEDIA_ERR_ENCRYPTED";break;default:ft="UNKNOWN";break}if(ft==="MEDIA_ERR_DECODE"&&ct.get().errors.recoverAttempts.mediaErrorDecode>=Lt.counts.mediaErrorDecode){kr();return}z=!0,Ge.error.message&&(ft+=" ("+Ge.error.message+")"),Ge.error.msExtendedCode&&(ft+=" (0x"+(Ge.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),ae.fatal("Video Element Error: "+ft),Ge.error&&ae.fatal(Ge.error),D.error(new R.default(Ge.error.code,ft)),aa()}}function kr(){ae.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var Ge=Se.getTime();fe.deactivate(!1),ae.warn("MediaSource has been resetted. Resuming playback from time ".concat(Ge)),at(Ge,!1)}function mr(){return fe?fe.getStreamInfo():null}function Ii(){return X}function Di(){return z||oe}function ei(Ge){for(var ft=0,Ct=U.length;ft<Ct;ft++)if(U[ft].getId()===Ge)return U[ft];return null}function gr(){if(!de||!de.hasOwnProperty("load")||!O||!O.hasOwnProperty("initialize")||!O.hasOwnProperty("reset")||!O.hasOwnProperty("getClientTimeOffset")||!te||!D||!Z||!Se)throw new Error(i.default.MISSING_CONFIG_ERROR)}function ia(){if(!me||!me.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function Pi(Ge){gr(),de.load(Ge)}function Ds(Ge){ia(),me.setManifest(Ge)}function Oa(Ge){isNaN(Ge.newDuration)||He(Ge.newDuration)}function Ps(Ge){!Ge||(Ge.capabilities&&(re=Ge.capabilities),Ge.capabilitiesFilter&&(le=Ge.capabilitiesFilter),Ge.manifestLoader&&(de=Ge.manifestLoader),Ge.manifestModel&&(te=Ge.manifestModel),Ge.mediaPlayerModel&&(Me=Ge.mediaPlayerModel),Ge.protectionController&&(ye=Ge.protectionController),Ge.adapter&&(q=Ge.adapter),Ge.dashMetrics&&(Z=Ge.dashMetrics),Ge.errHandler&&(D=Ge.errHandler),Ge.timelineConverter&&(O=Ge.timelineConverter),Ge.videoModel&&(ce=Ge.videoModel),Ge.playbackController&&(Se=Ge.playbackController),Ge.textController&&(_e=Ge.textController),Ge.abrController&&(ue=Ge.abrController),Ge.mediaController&&($=Ge.mediaController),Ge.settings&&(ct=Ge.settings),Ge.baseURLController&&(Q=Ge.baseURLController),Ge.uriFragmentModel&&(ie=Ge.uriFragmentModel),Ge.segmentBaseController&&(Y=Ge.segmentBaseController))}function La(Ge){ee=Ge,ye&&ye.setProtectionData(ee)}function Na(){U=[],ye=null,X=!1,fe=null,z=!1,oe=!1,be=!0,ve=!1,j=!0,Ne=null,xt=!1,ot=!1,Xe=[],Bt=null,Lt={counts:{mediaErrorDecode:0}}}function aa(){gr(),he.reset(),pn(z||oe?p.PlayListTrace.FAILURE_STOP_REASON:p.PlayListTrace.USER_REQUEST_STOP_REASON);for(var Ge=0,ft=U?U.length:0;Ge<ft;Ge++){var Ct=U[Ge];Ct.reset(z)}ze(),Q.reset(),me.reset(),W.reset(),Z.clearAllCurrentMetrics(),te.setValue(null),de.reset(),O.reset(),B.reset(),se&&(pe.detachMediaSource(ce),se=null),ce=null,ye&&(ye=null,ee=null,te.getValue()&&J.trigger(f.default.PROTECTION_DESTROYED,{data:te.getValue().url})),bn(),J.trigger(f.default.STREAM_TEARDOWN_COMPLETE),Na()}function ws(Ge){if(Ge.metric===o.default.DVR_INFO){var ft=_n()?i.default.AUDIO:i.default.VIDEO;Ge.mediaType===ft&&pe.setSeekable(Ge.value.range.start,Ge.value.range.end)}}function Fa(){return U}return K={initialize:Ht,getActiveStreamInfo:mr,addDVRMetric:Ye,hasVideoTrack:rn,hasAudioTrack:_n,getStreamById:ei,getStreamForTime:qe,getTimeRelativeToStreamId:tt,load:Pi,loadWithManifest:Ds,getActiveStreamProcessors:mt,setConfig:Ps,setProtectionData:La,getIsStreamSwitchInProgress:Ii,switchToVideoElement:En,getHasMediaOrInitialisationError:Di,getStreams:Fa,getActiveStream:rt,getInitialPlayback:dt,getAutoPlay:yt,reset:aa},Pt(),K}k.__dashjs_factory_name="StreamController",r.default=h.default.getSingletonFactory(k)},"./src/streaming/controllers/TimeSyncController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/DashJSError.js"),o=n("./src/streaming/vo/metrics/HTTPRequest.js"),l=n("./src/core/EventBus.js"),u=n("./src/core/events/Events.js"),c=n("./src/core/errors/Errors.js"),f=n("./src/core/FactoryMaker.js"),h=n("./src/core/Debug.js"),p=n("./src/streaming/utils/URLUtils.js"),E=5e3,v=100,M=2,y=2,_=30,g=30,R=600,S=2;function x(){var C=this.context,b=Object(l.default)(C).getInstance(),P=Object(p.default)(C).getInstance(),A,I,F,G,V,k,H,J,K,ae,re,le,me,de,te,q;function Z(){I=Object(h.default)(C).getInstance().getLogger(A),b.on(u.default.ATTEMPT_BACKGROUND_SYNC,ie,A)}function pe(Me){!Me||(Me.dashMetrics&&(H=Me.dashMetrics),Me.baseURLController&&(q=Me.baseURLController),Me.errHandler&&(te=Me.errHandler),Me.settings&&(V=Me.settings))}function he(){J=[],K=[],ae=null,re=null,me=null,le=NaN,F=!1,G=!1,de=V.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function Q(){he(),k={"urn:mpeg:dash:utc:http-head:2014":j,"urn:mpeg:dash:utc:http-xsdate:2014":ee.bind(null,O),"urn:mpeg:dash:utc:http-iso:2014":ee.bind(null,U),"urn:mpeg:dash:utc:direct:2014":_e,"urn:mpeg:dash:utc:http-head:2012":j,"urn:mpeg:dash:utc:http-xsdate:2012":ee.bind(null,O),"urn:mpeg:dash:utc:http-iso:2012":ee.bind(null,U),"urn:mpeg:dash:utc:direct:2012":_e,"urn:mpeg:dash:utc:http-ntp:2014":ye,"urn:mpeg:dash:utc:ntp:2014":ye,"urn:mpeg:dash:utc:sntp:2014":ye}}function Y(Me,ve){if(K=Me,!F){if(!B(ve)){b.trigger(u.default.TIME_SYNCHRONIZATION_COMPLETED);return}F=!0,$()}}function ie(){if(!(!V.get().streaming.utcSynchronization.enabled||F||G||!me||!me.value||!me.schemeIdUri||isNaN(le)||isNaN(V.get().streaming.utcSynchronization.backgroundAttempts))&&!(re&&(Date.now()-re)/1e3<g)){J=[],G=!0;var Me=isNaN(V.get().streaming.utcSynchronization.backgroundAttempts)?y:V.get().streaming.utcSynchronization.backgroundAttempts;ue(Me)}}function ue(Me){try{if(Me<=0){se();return}var ve=Date.now();k[me.schemeIdUri](me.value,function(be){var Ne=Date.now(),Ue=W(ve,Ne,be);J.push(Ue),ue(Me-1)},function(){se()})}catch{se()}}function $(){var Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ve=Me||0;if(!K||K.length===0||ve>=K.length){L();return}var be=K[ve];if(be)if(k.hasOwnProperty(be.schemeIdUri)){var Ne=new Date().getTime();k[be.schemeIdUri](be.value,function(Ue){var Xe=new Date().getTime(),ot=W(Ne,Xe,Ue);me=be,L(ot)},function(){$(ve+1)})}else $(ve+1);else L()}function W(Me,ve,be){var Ne=ve-(ve-Me)/2;return be-Ne}function B(Me){try{if(!Me||!V.get().streaming.utcSynchronization.enabled)return!1;var ve=isNaN(de)?_:de;return!ae||!ve||isNaN(ve)?!0:(Date.now()-ae)/1e3>=ve}catch{return!0}}function L(){var Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN,ve=isNaN(Me);ve&&V.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?X():z(ve,Me)}function D(Me){var ve=60,be=60,Ne=1e3,Ue=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,Xe,ot,ct=Ue.exec(Me);return Xe=Date.UTC(parseInt(ct[1],10),parseInt(ct[2],10)-1,parseInt(ct[3],10),parseInt(ct[4],10),parseInt(ct[5],10),ct[6]&&(parseInt(ct[6],10)||0),ct[7]&&parseFloat(ct[7])*Ne||0),ct[9]&&ct[10]&&(ot=parseInt(ct[9],10)*be+parseInt(ct[10],10),Xe+=(ct[8]==="+"?-1:1)*ot*ve*Ne),new Date(Xe).getTime()}function O(Me){var ve=Date.parse(Me);return isNaN(ve)&&(ve=D(Me)),ve}function U(Me){return Date.parse(Me)}function fe(Me){return Date.parse(Me)}function ye(Me,ve,be){be()}function _e(Me,ve,be){var Ne=O(Me);if(!isNaN(Ne)){ve(Ne);return}be()}function ee(Me,ve,be,Ne,Ue){var Xe,ot,ct=!1,xt=new XMLHttpRequest,Bt=Ue?o.HTTPRequest.HEAD:o.HTTPRequest.GET,Lt=ve.match(/\S+/g);if(ve=Lt.shift(),Xe=function(){ct||(ct=!0,Lt.length?ee(Me,Lt.join(" "),be,Ne,Ue):Ne())},ot=function(){var Oe,ze;xt.status===200&&(Oe=Ue?xt.getResponseHeader("Date"):xt.response,ze=Me(Oe),isNaN(ze)||(be(ze),ct=!0))},P.isRelative(ve)){var Pt=q.resolve();Pt&&(ve=P.resolve(ve,Pt.url))}xt.open(Bt,ve),xt.timeout=E,xt.onload=ot,xt.onloadend=Xe,xt.send()}function j(Me,ve,be){ee(fe,Me,ve,be,!0)}function X(){var Me=H.getLatestMPDRequestHeaderValueByID("Date"),ve=Me!==null?new Date(Me).getTime():Number.NaN;if(isNaN(ve))z(!0);else{var be=ve-Date.now();z(!1,be)}}function z(Me,ve){if(!isNaN(le)&&!isNaN(ve)&&!Me&&oe(ve),!Me&&!isNaN(ve)){ae=Date.now(),F=!1;var be=isNaN(le);le=ve,be&&ie(),I.debug("Completed UTC sync. Setting client - server offset to ".concat(ve))}Me&&(me=null,F=!1,te.error(new i.default(c.default.TIME_SYNC_FAILED_ERROR_CODE,c.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),b.trigger(u.default.UPDATE_TIME_SYNC_OFFSET,{offset:ve}),b.trigger(u.default.TIME_SYNCHRONIZATION_COMPLETED)}function oe(Me){try{var ve=ce(Me),be=isNaN(de)?_:de,Ne=isNaN(V.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?M:V.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,Ue=isNaN(V.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?R:V.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,Xe=isNaN(V.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?S:V.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts,ot;ve?(ot=Math.min(be*Ne,Ue),I.debug("Increasing timeBetweenSyncAttempts to ".concat(ot))):(ot=Math.max(be/Ne,Xe),I.debug("Decreasing timeBetweenSyncAttempts to ".concat(ot))),de=ot}catch{}}function se(){if(!(!J||J.length===0)){var Me=J.reduce(function(ve,be){return ve+be},0)/J.length;ce(Me)?I.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(I.debug("Completed background UTC sync. Setting client - server offset to ".concat(Me)),le=Me,b.trigger(u.default.UPDATE_TIME_SYNC_OFFSET,{offset:le})),G=!1,re=Date.now()}}function ce(Me){try{if(isNaN(le))return!0;var ve=V.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(V.get().streaming.utcSynchronization.maximumAllowedDrift)?V.get().streaming.utcSynchronization.maximumAllowedDrift:v,be=le-ve,Ne=le+ve;return Me>=be&&Me<=Ne}catch{return!0}}function Se(){he(),b.off(u.default.ATTEMPT_BACKGROUND_SYNC,ie,A)}return A={initialize:Q,attemptSync:Y,setConfig:pe,reset:Se},Z(),A}x.__dashjs_factory_name="TimeSyncController";var w=f.default.getSingletonFactory(x);w.HTTP_TIMEOUT_MS=E,f.default.updateSingletonFactory(x.__dashjs_factory_name,w),r.default=w},"./src/streaming/controllers/XlinkController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/XlinkLoader.js"),o=n("./src/core/EventBus.js"),l=n("./src/core/events/Events.js"),u=n("./src/core/FactoryMaker.js"),c=n("./externals/xml2json.js"),f=n("./src/streaming/utils/URLUtils.js"),h=n("./src/dash/constants/DashConstants.js"),p="onLoad",E="onActuate",v="urn:mpeg:dash:resolve-to-zero:2013";function M(y){y=y||{};var _=this.context,g=Object(o.default)(_).getInstance(),R=Object(f.default)(_).getInstance(),S,x,w,C,b,P;function A(){g.on(l.default.XLINK_ELEMENT_LOADED,H,S),P=Object(i.default)(_).create({errHandler:y.errHandler,dashMetrics:y.dashMetrics,mediaPlayerModel:y.mediaPlayerModel,requestModifier:y.requestModifier,settings:y.settings})}function I(de){de&&(x=de)}function F(de){de&&(w=de)}function G(de){var te;b=new c.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:x}),C=de,C.Period_asArray?(te=K(C.Period_asArray,C,h.default.PERIOD,p),k(te,h.default.PERIOD,p)):g.trigger(l.default.XLINK_READY,{manifest:C})}function V(){g.off(l.default.XLINK_ELEMENT_LOADED,H,S),P&&(P.reset(),P=null)}function k(de,te,q){var Z={},pe,he;Z.elements=de,Z.type=te,Z.resolveType=q,Z.elements.length===0&&J(Z);for(var Q=0;Q<Z.elements.length;Q++)pe=Z.elements[Q],R.isHTTPURL(pe.url)?he=pe.url:he=pe.originalContent.BaseURL+pe.url,P.load(he,pe,Z)}function H(de){var te,q,Z="<response>",pe="</response>",he="";if(te=de.element,q=de.resolveObject,te.resolvedContent){var Q=0;te.resolvedContent.indexOf("<?xml")===0&&(Q=te.resolvedContent.indexOf("?>")+2),he=te.resolvedContent.substr(0,Q)+Z+te.resolvedContent.substr(Q)+pe,te.resolvedContent=b.xml_str2json(he)}le(q)&&J(q)}function J(de){var te=[],q,Z;if(ae(de),de.resolveType===E&&g.trigger(l.default.XLINK_READY,{manifest:C}),de.resolveType===p)switch(de.type){case h.default.PERIOD:for(q=0;q<C[h.default.PERIOD+"_asArray"].length;q++)Z=C[h.default.PERIOD+"_asArray"][q],Z.hasOwnProperty(h.default.ADAPTATION_SET+"_asArray")&&(te=te.concat(K(Z[h.default.ADAPTATION_SET+"_asArray"],Z,h.default.ADAPTATION_SET,p))),Z.hasOwnProperty(h.default.EVENT_STREAM+"_asArray")&&(te=te.concat(K(Z[h.default.EVENT_STREAM+"_asArray"],Z,h.default.EVENT_STREAM,p)));k(te,h.default.ADAPTATION_SET,p);break;case h.default.ADAPTATION_SET:g.trigger(l.default.XLINK_READY,{manifest:C});break}}function K(de,te,q,Z){var pe=[],he,Q,Y;for(Q=de.length-1;Q>=0;Q--)he=de[Q],he.hasOwnProperty("xlink:href")&&he["xlink:href"]===v&&de.splice(Q,1);for(Q=0;Q<de.length;Q++)he=de[Q],he.hasOwnProperty("xlink:href")&&he.hasOwnProperty("xlink:actuate")&&he["xlink:actuate"]===Z&&(Y=re(he["xlink:href"],te,q,Q,Z,he),pe.push(Y));return pe}function ae(de){var te=[],q,Z,pe,he,Q,Y;for(he=de.elements.length-1;he>=0;he--){if(q=de.elements[he],Z=q.type+"_asArray",!q.resolvedContent||me())delete q.originalContent["xlink:actuate"],delete q.originalContent["xlink:href"],te.push(q.originalContent);else if(q.resolvedContent)for(Q=0;Q<q.resolvedContent[Z].length;Q++)pe=q.resolvedContent[Z][Q],te.push(pe);for(q.parentElement[Z].splice(q.index,1),Y=0;Y<te.length;Y++)q.parentElement[Z].splice(q.index+Y,0,te[Y]);te=[]}de.elements.length>0&&w.run(C)}function re(de,te,q,Z,pe,he){return{url:de,parentElement:te,type:q,index:Z,resolveType:pe,originalContent:he,resolvedContent:null,resolved:!1}}function le(de){var te,q;for(te=0;te<de.elements.length;te++)if(q=de.elements[te],q.resolved===!1)return!1;return!0}function me(){return!1}return S={resolveManifestOnLoad:G,setMatchers:I,setIron:F,reset:V},A(),S}M.__dashjs_factory_name="XlinkController",r.default=u.default.getClassFactory(M)},"./src/streaming/metrics/MetricsReporting.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),o=n("./src/streaming/metrics/MetricsReportingEvents.js"),l=n("./src/streaming/metrics/controllers/MetricsCollectionController.js"),u=n("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),c=n("./src/streaming/metrics/reporting/ReportingFactory.js");function f(){var p=this.context,E,v;function M(g){return v=Object(i.default)(p).getInstance({eventBus:g.eventBus,dashMetrics:g.dashMetrics,metricsConstants:g.metricsConstants,events:g.events}),v.initialise(),Object(l.default)(p).create(g)}function y(){return Object(c.default)(p).getInstance()}function _(){return Object(u.default)(p).getInstance()}return E={createMetricsReporting:M,getReportingFactory:y,getMetricsHandlerFactory:_},E}f.__dashjs_factory_name="MetricsReporting";var h=dashjs.FactoryMaker.getClassFactory(f);h.events=o.default,dashjs.FactoryMaker.updateClassFactory(f.__dashjs_factory_name,h),r.default=h},"./src/streaming/metrics/MetricsReportingEvents.js":function(t,r,n){n.r(r);var i=n("./src/core/events/EventsBase.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){var S;return l(this,R),S=g.call(this),S.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",S.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",S.CMCD_DATA_GENERATED="cmcdDataGenerated",S}return R}(i.default),y=new M;r.default=y},"./src/streaming/metrics/controllers/MetricsCollectionController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/controllers/MetricsController.js"),o=n("./src/streaming/metrics/utils/ManifestParsing.js"),l=n("./src/streaming/metrics/MetricsReportingEvents.js");function u(c){c=c||{};var f,h={},p=this.context,E=c.eventBus,v=c.events;function M(R){if(!R.error){var S=Object.keys(h),x=Object(o.default)(p).getInstance({adapter:c.adapter,constants:c.constants}).getMetrics(R.manifest);x.forEach(function(w){var C=JSON.stringify(w);if(h.hasOwnProperty(C))S.splice(C,1);else try{var b=Object(i.default)(p).create(c);b.initialize(w),h[C]=b}catch{}}),S.forEach(function(w){h[w].reset(),delete h[w]}),E.trigger(l.default.METRICS_INITIALISATION_COMPLETE)}}function y(){Object.keys(h).forEach(function(R){h[R].reset()}),h={}}function _(){E.on(v.MANIFEST_UPDATED,M,f),E.on(v.STREAM_TEARDOWN_COMPLETE,y,f)}function g(){E.off(v.MANIFEST_UPDATED,M,f),E.off(v.STREAM_TEARDOWN_COMPLETE,y,f)}return f={reset:g},_(),f}u.__dashjs_factory_name="MetricsCollectionController",r.default=dashjs.FactoryMaker.getClassFactory(u)},"./src/streaming/metrics/controllers/MetricsController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/controllers/RangeController.js"),o=n("./src/streaming/metrics/controllers/ReportingController.js"),l=n("./src/streaming/metrics/controllers/MetricsHandlersController.js");function u(c){c=c||{};var f,h,p,E,v=this.context;function M(_){try{p=Object(i.default)(v).create({mediaElement:c.mediaElement}),p.initialize(_.Range),h=Object(o.default)(v).create({debug:c.debug,metricsConstants:c.metricsConstants}),h.initialize(_.Reporting,p),f=Object(l.default)(v).create({debug:c.debug,eventBus:c.eventBus,metricsConstants:c.metricsConstants,events:c.events}),f.initialize(_.metrics,h)}catch(g){throw y(),g}}function y(){f&&f.reset(),h&&h.reset(),p&&p.reset()}return E={initialize:M,reset:y},E}u.__dashjs_factory_name="MetricsController",r.default=dashjs.FactoryMaker.getClassFactory(u)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function o(l){l=l||{};var u=[],c,f=this.context,h=l.eventBus,p=l.events,E=Object(i.default)(f).getInstance({debug:l.debug,eventBus:l.eventBus,metricsConstants:l.metricsConstants});function v(_){u.forEach(function(g){g.handleNewMetric(_.metric,_.value,_.mediaType)})}function M(_,g){_.split(",").forEach(function(R,S,x){var w;if(R.indexOf("(")!==-1&&R.indexOf(")")===-1){var C=x[S+1];C&&C.indexOf("(")===-1&&C.indexOf(")")!==-1&&(R+=","+C,delete x[S+1])}w=E.create(R,g),w&&u.push(w)}),h.on(p.METRIC_ADDED,v,c),h.on(p.METRIC_UPDATED,v,c)}function y(){h.off(p.METRIC_ADDED,v,c),h.off(p.METRIC_UPDATED,v,c),u.forEach(function(_){return _.reset()}),u=[]}return c={initialize:M,reset:y},c}o.__dashjs_factory_name="MetricsHandlersController",r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/controllers/RangeController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/utils/CustomTimeRanges.js");function o(l){l=l||{};var u=!1,c=this.context,f,h,p=l.mediaElement;function E(_){_&&_.length&&(_.forEach(function(g){var R=g.starttime,S=R+g.duration;h.add(R,S)}),u=!!_[0]._useWallClockTime)}function v(){h.clear()}function M(){h=Object(i.default)(c).create()}function y(){var _=h.length,g;if(!_)return!0;g=u?new Date().getTime()/1e3:p.currentTime;for(var R=0;R<_;R+=1){var S=h.start(R),x=h.end(R);if(S<=g&&g<x)return!0}return!1}return f={initialize:E,reset:v,isEnabled:y},M(),f}o.__dashjs_factory_name="RangeController",r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/controllers/ReportingController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/reporting/ReportingFactory.js");function o(l){var u=[],c,f=Object(i.default)(this.context).getInstance(l);function h(v,M){v.some(function(y){var _=f.create(y,M);if(_)return u.push(_),!0})}function p(){u.forEach(function(v){return v.reset()}),u=[]}function E(v,M){u.forEach(function(y){return y.report(v,M)})}return c={initialize:h,reset:p,report:E},c}o.__dashjs_factory_name="ReportingController",r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),o=n("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),l=n("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),u=n("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function c(f){f=f||{};var h,p=f.debug?f.debug.getLogger(h):{},E=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,v=this.context,M={BufferLevel:i.default,DVBErrors:o.default,HttpList:l.default,PlayList:u.default,RepSwitchList:u.default,TcpList:u.default};function y(R,S){var x=R.match(E),w;if(!!x){try{w=M[x[1]](v).create({eventBus:f.eventBus,metricsConstants:f.metricsConstants}),w.initialize(x[1],S,x[3],x[5])}catch(C){w=null,p.error("MetricsHandlerFactory: Could not create handler for type ".concat(x[1]," with args ").concat(x[3],", ").concat(x[5]," (").concat(C.message,")"))}return w}}function _(R,S){M[R]=S}function g(R){delete M[R]}return h={create:y,register:_,unregister:g},h}c.__dashjs_factory_name="MetricsHandlerFactory",r.default=dashjs.FactoryMaker.getSingletonFactory(c)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/utils/HandlerHelpers.js");function o(l){l=l||{};var u,c,f,h,p,E,v=this.context,M=Object(i.default)(v).getInstance(),y=[],_=l.metricsConstants;function g(){try{return Object.keys(y).map(function(C){return y[C]}).reduce(function(C,b){return C.level<b.level?C:b})}catch{return}}function R(){var C=g();C&&E!==C.t&&(E=C.t,c.report(h,C))}function S(C,b,P){b&&(f=M.validateN(P),c=b,h=M.reconstructFullMetricName(C,P),p=setInterval(R,f))}function x(){clearInterval(p),p=null,f=0,c=null,E=null}function w(C,b,P){C===_.BUFFER_LEVEL&&(y[P]=b)}return u={initialize:S,reset:x,handleNewMetric:w},u}o.__dashjs_factory_name="BufferLevelHandler",r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/MetricsReportingEvents.js");function o(l){l=l||{};var u,c,f=l.eventBus,h=l.metricsConstants;function p(){f.off(i.default.METRICS_INITIALISATION_COMPLETE,p,this),f.trigger(i.default.BECAME_REPORTING_PLAYER)}function E(y,_){_&&(c=_,f.on(i.default.METRICS_INITIALISATION_COMPLETE,p,this))}function v(){c=null}function M(y,_){y===h.DVB_ERRORS&&c&&c.report(y,_)}return u={initialize:E,reset:v,handleNewMetric:M},u}r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":function(t,r,n){n.r(r);function i(){var o,l,u;function c(p,E){l=p,u=E}function f(){u=null,l=void 0}function h(p,E){p===l&&u&&u.report(l,E)}return o={initialize:c,reset:f,handleNewMetric:h},o}i.__dashjs_factory_name="GenericMetricHandler",r.default=dashjs.FactoryMaker.getClassFactory(i)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/utils/HandlerHelpers.js");function o(l){l=l||{};var u,c,f,h,p,E,v=[],M=Object(i.default)(this.context).getInstance(),y=l.metricsConstants;function _(){var x=v;x.length&&c&&c.report(p,x),v=[]}function g(x,w,C,b){w&&(f=M.validateN(C),c=w,b&&b.length&&(h=b),p=M.reconstructFullMetricName(x,C,b),E=setInterval(_,f))}function R(){clearInterval(E),E=null,f=null,h=null,v=[],c=null}function S(x,w){x===y.HTTP_REQUEST&&(!h||h===w.type)&&v.push(w)}return u={initialize:g,reset:R,handleNewMetric:S},u}o.__dashjs_factory_name="HttpListHandler",r.default=dashjs.FactoryMaker.getClassFactory(o)},"./src/streaming/metrics/reporting/ReportingFactory.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function o(l){l=l||{};var u={"urn:dvb:dash:reporting:2014":i.default},c=this.context,f,h=l.debug?l.debug.getLogger(f):{},p=l.metricsConstants;function E(y,_){var g;try{g=u[y.schemeIdUri](c).create({metricsConstants:p}),g.initialize(y,_)}catch(R){g=null,h.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(y.schemeIdUri," (").concat(R.message,")"))}return g}function v(y,_){u[y]=_}function M(y){delete u[y]}return f={create:E,register:v,unregister:M},f}o.__dashjs_factory_name="ReportingFactory",r.default=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/utils/MetricSerialiser.js"),o=n("./src/streaming/metrics/utils/RNG.js");function l(u){u=u||{};var c,f=this.context,h,p,E,v,M,y,_=[],g=u.metricsConstants;function R(){h=Object(i.default)(f).getInstance(),p=Object(o.default)(f).getInstance(),C()}function S(P,A,I){var F=new XMLHttpRequest,G=function(){var k=_.indexOf(F);k!==-1&&(_.splice(k,1),F.status>=200&&F.status<300?A&&A():I&&I())};_.push(F);try{F.open("GET",P),F.onloadend=G,F.onerror=G,F.send()}catch{F.onerror()}}function x(P,A){Array.isArray(A)||(A=[A]),v&&y.isEnabled()&&A.forEach(function(I){var F=h.serialise(I);P!==g.DVB_ERRORS&&(F="metricname=".concat(P,"&").concat(F)),F="".concat(M,"?").concat(F),S(F,null,function(){v=!1})})}function w(P,A){var I;if(y=A,M=P.dvb_reportingUrl,!M)throw new Error("required parameter missing (dvb:reportingUrl)");E||(I=P.dvb_probability,I&&(I===1e3||I/1e3>=p.random())&&(v=!0),E=!0)}function C(){E=!1,v=!1,M=null,y=null}function b(){C()}return c={report:x,initialize:w,reset:b},R(),c}l.__dashjs_factory_name="DVBReporting",r.default=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/vo/DVBErrors.js"),o=n("./src/streaming/metrics/MetricsReportingEvents.js");function l(u){u=u||{};var c,f,h=u.eventBus,p=u.dashMetrics,E=u.metricsConstants,v=u.events;function M(b){var P=new i.default;if(!!f){for(var A in b)b.hasOwnProperty(A)&&(P[A]=b[A]);P.mpdurl||(P.mpdurl=f.originalUrl||f.url),P.terror||(P.terror=new Date),p.addDVBErrors(P)}}function y(b){b.error||(f=b.manifest)}function _(b){M({errorcode:i.default.BASE_URL_CHANGED,servicelocation:b.entry})}function g(){M({errorcode:i.default.BECAME_REPORTER})}function R(b){(b.responsecode===0||b.responsecode==null||b.responsecode>=400||b.responsecode<100||b.responsecode>=600)&&M({errorcode:b.responsecode||i.default.CONNECTION_ERROR,url:b.url,terror:b.tresponse,servicelocation:b._serviceLocation})}function S(b){switch(b.metric){case E.HTTP_REQUEST:R(b.value);break}}function x(b){var P=b.error?b.error.code:0,A;switch(P){case MediaError.MEDIA_ERR_NETWORK:A=i.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:A=i.default.CORRUPT_MEDIA_OTHER;break;default:return}M({errorcode:A})}function w(){h.on(v.MANIFEST_UPDATED,y,c),h.on(v.SERVICE_LOCATION_BLACKLIST_CHANGED,_,c),h.on(v.METRIC_ADDED,S,c),h.on(v.METRIC_UPDATED,S,c),h.on(v.PLAYBACK_ERROR,x,c),h.on(o.default.BECAME_REPORTING_PLAYER,g,c)}function C(){h.off(v.MANIFEST_UPDATED,y,c),h.off(v.SERVICE_LOCATION_BLACKLIST_CHANGED,_,c),h.off(v.METRIC_ADDED,S,c),h.off(v.METRIC_UPDATED,S,c),h.off(v.PLAYBACK_ERROR,x,c),h.off(o.default.BECAME_REPORTING_PLAYER,g,c)}return c={initialise:w,reset:C},c}l.__dashjs_factory_name="DVBErrorsTranslator",r.default=dashjs.FactoryMaker.getSingletonFactory(l)},"./src/streaming/metrics/utils/HandlerHelpers.js":function(t,r,n){n.r(r);function i(){return{reconstructFullMetricName:function(l,u,c){var f=l;return u&&(f+="("+u,c&&c.length&&(f+=","+c),f+=")"),f},validateN:function(l){if(!l)throw new Error("missing n");if(isNaN(l))throw new Error("n is NaN");if(l<0)throw new Error("n must be positive");return l}}}i.__dashjs_factory_name="HandlerHelpers",r.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/utils/ManifestParsing.js":function(t,r,n){n.r(r);var i=n("./src/streaming/metrics/vo/Metrics.js"),o=n("./src/streaming/metrics/vo/Range.js"),l=n("./src/streaming/metrics/vo/Reporting.js");function u(c){c=c||{};var f,h=c.adapter,p=c.constants;function E(M,y,_){var g,R,S=0;return y?S=h.getAvailabilityStartTime(M)/1e3:(g=h.getRegularPeriods(M),g.length&&(S=g[0].start)),R=S,_&&_.hasOwnProperty(p.START_TIME)&&(R+=_.starttime),R}function v(M){var y=[];return M&&M.Metrics_asArray&&M.Metrics_asArray.forEach(function(_){var g=new i.default,R=h.getIsDynamic(M);if(_.hasOwnProperty("metrics"))g.metrics=_.metrics;else return;if(_.Range_asArray&&_.Range_asArray.forEach(function(S){var x=new o.default;x.starttime=E(M,R,S),S.hasOwnProperty("duration")?x.duration=S.duration:x.duration=h.getDuration(M),x._useWallClockTime=R,g.Range.push(x)}),_.Reporting_asArray)_.Reporting_asArray.forEach(function(S){var x=new l.default;if(S.hasOwnProperty(p.SCHEME_ID_URI))x.schemeIdUri=S.schemeIdUri;else return;S.hasOwnProperty("value")&&(x.value=S.value),S.hasOwnProperty(p.DVB_REPORTING_URL)&&(x.dvb_reportingUrl=S[p.DVB_REPORTING_URL]),S.hasOwnProperty(p.DVB_PROBABILITY)&&(x.dvb_probability=S[p.DVB_PROBABILITY]),g.Reporting.push(x)});else return;y.push(g)}),y}return f={getMetrics:v},f}u.__dashjs_factory_name="ManifestParsing",r.default=dashjs.FactoryMaker.getSingletonFactory(u)},"./src/streaming/metrics/utils/MetricSerialiser.js":function(t,r,n){n.r(r);function i(){function o(l){var u=[],c=[],f,h;for(f in l)if(l.hasOwnProperty(f)&&f.indexOf("_")!==0){if(h=l[f],h==null&&(h=""),Array.isArray(h)){if(!h.length)continue;c=[],h.forEach(function(p){var E=Object.prototype.toString.call(p).slice(8,-1)!=="Object";c.push(E?p:o(p))}),h=c.map(encodeURIComponent).join(",")}else typeof h=="string"?h=encodeURIComponent(h):h instanceof Date?h=h.toISOString():typeof h=="number"&&(h=Math.round(h));u.push(f+"="+h)}return u.join("&")}return{serialise:o}}i.__dashjs_factory_name="MetricSerialiser",r.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/utils/RNG.js":function(t,r,n){n.r(r);function i(){var o=window.crypto||window.msCrypto,l=Uint32Array,u=Math.pow(2,l.BYTES_PER_ELEMENT*8)-1,c=10,f,h,p;function E(){o&&(f||(f=new l(c)),o.getRandomValues(f),h=0)}function v(M,y){var _;return M||(M=0),y||(y=1),o?(h===f.length&&E(),_=f[h]/u,h+=1):_=Math.random(),_*(y-M)+M}return p={random:v},E(),p}i.__dashjs_factory_name="RNG",r.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/vo/DVBErrors.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};o.SSL_CONNECTION_FAILED_PREFIX="SSL",o.DNS_RESOLUTION_FAILED="C00",o.HOST_UNREACHABLE="C01",o.CONNECTION_REFUSED="C02",o.CONNECTION_ERROR="C03",o.CORRUPT_MEDIA_ISOBMFF="M00",o.CORRUPT_MEDIA_OTHER="M01",o.BASE_URL_CHANGED="F00",o.BECAME_REPORTER="S00",r.default=o},"./src/streaming/metrics/vo/Metrics.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.metrics="",this.Range=[],this.Reporting=[]};r.default=o},"./src/streaming/metrics/vo/Range.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};r.default=o},"./src/streaming/metrics/vo/Reporting.js":function(t,r,n){n.r(r);function i(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var o=1e3,l=function u(){i(this,u),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=o};r.default=l},"./src/streaming/models/BaseURLTreeModel.js":function(t,r,n){n.r(r);var i=n("./src/streaming/utils/ObjectUtils.js"),o=n("./src/core/FactoryMaker.js");function l(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")}var u=NaN,c=function h(p,E){l(this,h),this.data={baseUrls:p||null,selectedIdx:E||u},this.children=[]};function f(){var h,p,E,v=this.context,M=Object(i.default)(v).getInstance();function y(){b()}function _(A){A.adapter&&(E=A.adapter)}function g(){if(!E||!E.hasOwnProperty("getBaseURLsFromElement")||!E.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}function R(A,I,F){var G=E.getBaseURLsFromElement(F);A[I]?M.areEqual(G,A[I].data.baseUrls)||(A[I].data.baseUrls=G,A[I].data.selectedIdx=u):A[I]=new c(G)}function S(A){g();var I=E.getBaseURLsFromElement(A);M.areEqual(I,p.data.baseUrls)||(p.data.baseUrls=I,p.data.selectedIdx=u),A&&A.Period_asArray&&A.Period_asArray.forEach(function(F,G){R(p.children,G,F),F.AdaptationSet_asArray&&F.AdaptationSet_asArray.forEach(function(V,k){R(p.children[G].children,k,V),V.Representation_asArray&&V.Representation_asArray.sort(E.getRepresentationSortFunction()).forEach(function(H,J){R(p.children[G].children[k].children,J,H)})})})}function x(A,I){var F=I||p;A(F.data),F.children&&F.children.forEach(function(G){return x(A,G)})}function w(A){x(function(I){isNaN(I.selectedIdx)||A===I.baseUrls[I.selectedIdx].serviceLocation&&(I.selectedIdx=u)})}function C(A){S(A)}function b(){p=new c}function P(A){var I=p,F=[I.data];return A&&A.forEach(function(G){I=I.children[G],I&&F.push(I.data)}),F.filter(function(G){return G.baseUrls.length})}return h={reset:b,update:C,getForPath:P,invalidateSelectedIndexes:w,setConfig:_},y(),h}f.__dashjs_factory_name="BaseURLTreeModel",r.default=o.default.getClassFactory(f)},"./src/streaming/models/CmcdModel.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/streaming/MediaPlayerEvents.js"),l=n("./src/streaming/metrics/MetricsReportingEvents.js"),u=n("./src/core/FactoryMaker.js"),c=n("./src/core/Settings.js"),f=n("./src/streaming/constants/Constants.js"),h=n("./src/streaming/vo/metrics/HTTPRequest.js"),p=n("./src/dash/models/DashManifestModel.js"),E=n("./src/core/Utils.js");function v(b,P){var A;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(A=M(b))||P&&b&&typeof b.length=="number"){A&&(b=A);var I=0,F=function(){};return{s:F,n:function(){return I>=b.length?{done:!0}:{done:!1,value:b[I++]}},e:function(J){throw J},f:F}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=!0,V=!1,k;return{s:function(){A=b[Symbol.iterator]()},n:function(){var J=A.next();return G=J.done,J},e:function(J){V=!0,k=J},f:function(){try{!G&&A.return!=null&&A.return()}finally{if(V)throw k}}}}function M(b,P){if(!!b){if(typeof b=="string")return y(b,P);var A=Object.prototype.toString.call(b).slice(8,-1);if(A==="Object"&&b.constructor&&(A=b.constructor.name),A==="Map"||A==="Set")return Array.from(b);if(A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A))return y(b,P)}}function y(b,P){(P==null||P>b.length)&&(P=b.length);for(var A=0,I=new Array(P);A<P;A++)I[A]=b[A];return I}var _="CMCD",g=1,R={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o"},S={DASH:"d",MSS:"s"},x={VOD:"v",LIVE:"l"},w=5;function C(){var b,P,A,I,F,G,V,k,H,J,K=this.context,ae=Object(i.default)(K).getInstance(),re=Object(c.default)(K).getInstance();function le(){b=Object(p.default)(K).getInstance(),te()}function me(){ae.on(o.default.PLAYBACK_RATE_CHANGED,j,P),ae.on(o.default.MANIFEST_LOADED,X,P),ae.on(o.default.BUFFER_LEVEL_STATE_CHANGED,z,P),ae.on(o.default.PLAYBACK_SEEKED,oe,P),ae.on(o.default.PERIOD_SWITCH_COMPLETED,q,P)}function de(ve){!ve||(ve.abrController&&(I=ve.abrController),ve.dashMetrics&&(F=ve.dashMetrics),ve.playbackController&&(G=ve.playbackController))}function te(){A={pr:1,nor:null,st:null,sf:null,sid:"".concat(E.default.generateUuid()),cid:null},H={},k={},J={},Z()}function q(){Z()}function Z(){if(!!G){var ve=G.getStreamController();if(!!ve&&typeof ve.getActiveStream=="function"){var be=ve.getActiveStream();!be||(V=be.getProcessors())}}}function pe(ve){try{if(re.get().streaming.cmcd&&re.get().streaming.cmcd.enabled){var be=Y(ve),Ne=se(be);return ae.trigger(l.default.CMCD_DATA_GENERATED,{url:ve.url,mediaType:ve.mediaType,cmcdData:be,cmcdString:Ne}),{key:_,value:Ne}}return null}catch{return null}}function he(ve,be){var Ne={},Ue=v(be),Xe;try{for(Ue.s();!(Xe=Ue.n()).done;){var ot=Xe.value;ve[ot]&&(Ne[ot]=ve[ot])}}catch(ct){Ue.e(ct)}finally{Ue.f()}return Ne}function Q(ve){try{if(re.get().streaming.cmcd&&re.get().streaming.cmcd.enabled){var be=Y(ve),Ne=he(be,["br","d","ot","tb"]),Ue=he(be,["bl","dl","mtp","nor","nrr","su"]),Xe=he(be,["bs","rtp"]),ot=he(be,["cid","pr","sf","sid","st","v"]),ct={"CMCD-Object":se(Ne),"CMCD-Request":se(Ue),"CMCD-Status":se(Xe),"CMCD-Session":se(ot)};return ae.trigger(l.default.CMCD_DATA_GENERATED,{url:ve.url,mediaType:ve.mediaType,cmcdData:be,headers:ct}),ct}return null}catch{return null}}function Y(ve){try{var be=null;return ve.type===h.HTTPRequest.MPD_TYPE?ue(ve):ve.type===h.HTTPRequest.MEDIA_SEGMENT_TYPE?(W(ve.mediaType),$(ve)):ve.type===h.HTTPRequest.INIT_SEGMENT_TYPE?B(ve):ve.type===h.HTTPRequest.OTHER_TYPE||ve.type===h.HTTPRequest.XLINK_EXPANSION_TYPE?L(ve):ve.type===h.HTTPRequest.LICENSE?ie(ve):be}catch{return null}}function ie(ve){var be=D();return be.ot=R.ENCRYPTION_KEY,be}function ue(){var ve=D();return ve.ot=R.MANIFEST,ve}function $(ve){var be=D(),Ne=O(ve),Ue=fe(ve),Xe=ye(ve.mediaType),ot=_e(ve.mediaType),ct=ee(ve.mediaType),xt=U(ve.mediaType),Bt=A.pr,Lt=ce(ve.mediaType),Pt;ve.mediaType===f.default.VIDEO&&(Pt=R.VIDEO),ve.mediaType===f.default.AUDIO&&(Pt=R.AUDIO),ve.mediaType===f.default.TEXT&&(ve.mediaInfo.mimeType==="application/mp4"?Pt=R.ISOBMFF_TEXT_TRACK:Pt=R.CAPTION);var Ht=re.get().streaming.cmcd.rtp;return Ht||(Ht=Se(ve)),be.rtp=Ht,Lt&&(ve.url!==Lt.url?be.nor=encodeURIComponent(E.default.getRelativeUrl(ve.url,Lt.url)):Lt.range&&(be.nrr=Lt.range)),Ne&&(be.br=Ne),Pt&&(be.ot=Pt),isNaN(Ue)||(be.d=Ue),isNaN(Xe)||(be.mtp=Xe),isNaN(ot)||(be.dl=ot),isNaN(ct)||(be.bl=ct),isNaN(xt)||(be.tb=xt),!isNaN(Bt)&&Bt!==1&&(be.pr=Bt),H[ve.mediaType]&&(be.bs=!0,H[ve.mediaType]=!1),(k[ve.mediaType]||!J[ve.mediaType])&&(be.su=!0,k[ve.mediaType]=!1,J[ve.mediaType]=!0),be}function W(ve){J.hasOwnProperty(ve)||(J[ve]=!1),k.hasOwnProperty(ve)||(k[ve]=!1),H.hasOwnProperty(ve)||(H[ve]=!1)}function B(){var ve=D();return ve.ot=R.INIT,ve.su=!0,ve}function L(){var ve=D();return ve.ot=R.OTHER,ve}function D(){var ve={},be=re.get().streaming.cmcd.cid?re.get().streaming.cmcd.cid:A.cid;return ve.v=g,ve.sid=re.get().streaming.cmcd.sid?re.get().streaming.cmcd.sid:A.sid,ve.sid="".concat(ve.sid),be&&(ve.cid="".concat(be)),!isNaN(A.pr)&&A.pr!==1&&A.pr!==null&&(ve.pr=A.pr),A.st&&(ve.st=A.st),A.sf&&(ve.sf=A.sf),ve}function O(ve){try{var be=ve.quality,Ne=ve.mediaInfo.bitrateList;return parseInt(Ne[be].bandwidth/1e3)}catch{return null}}function U(ve){try{var be=I.getTopBitrateInfoFor(ve);return Math.round(be.bitrate/1e3)}catch{return null}}function fe(ve){try{return isNaN(ve.duration)?null:Math.round(ve.duration*1e3)}catch{return null}}function ye(ve){try{return parseInt(I.getThroughputHistory().getSafeAverageThroughput(ve)/100)*100}catch{return null}}function _e(ve){try{var be=A.pr,Ne=F.getCurrentBufferLevel(ve);return!isNaN(be)&&!isNaN(Ne)?parseInt(Ne/be*10)*100:null}catch{return null}}function ee(ve){try{var be=F.getCurrentBufferLevel(ve);return isNaN(be)?null:parseInt(be*10)*100}catch{return null}}function j(ve){try{A.pr=ve.playbackRate}catch{}}function X(ve){try{var be=b.getIsDynamic(ve.data),Ne=be?x.LIVE:x.VOD,Ue=ve.protocol&&ve.protocol==="MSS"?S.MSS:S.DASH;A.st="".concat(Ne),A.sf="".concat(Ue)}catch{}}function z(ve){try{ve.state&&ve.mediaType&&ve.state===o.default.BUFFER_EMPTY&&(H[ve.mediaType]||(H[ve.mediaType]=!0),k[ve.mediaType]||(k[ve.mediaType]=!0))}catch{}}function oe(){for(var ve in H)H.hasOwnProperty(ve)&&(H[ve]=!0);for(var be in k)k.hasOwnProperty(be)&&(k[be]=!0)}function se(ve){try{if(!ve)return null;var be=Object.keys(ve).sort(function(Xe,ot){return Xe.localeCompare(ot)}),Ne=be.length,Ue=be.reduce(function(Xe,ot,ct){if(ot==="v"&&ve[ot]===1)return Xe;if(typeof ve[ot]=="string"&&ot!=="ot"&&ot!=="sf"&&ot!=="st"){var xt=ve[ot].replace(/"/g,'"');Xe+="".concat(ot,'="').concat(xt,'"')}else Xe+="".concat(ot,"=").concat(ve[ot]);return ct<Ne-1&&(Xe+=","),Xe},"");return Ue=Ue.replace(/=true/g,""),Ue=Ue.replace(/,\s*$/,""),Ue}catch{return null}}function ce(ve){if(!(!V||V.length===0)){var be=v(V),Ne;try{for(be.s();!(Ne=be.n()).done;){var Ue=Ne.value;if(Ue.getType()===ve)return Ue.probeNextRequest()}}catch(Xe){be.e(Xe)}finally{be.f()}}}function Se(ve){var be=G.getPlaybackRate();be||(be=1);var Ne=ve.quality,Ue=ve.mediaType,Xe=ve.mediaInfo,ot=ve.duration,ct=ee(Ue);ct===0&&(ct=500);var xt=Xe.bitrateList[Ne].bandwidth,Bt=xt*ot/1e3,Lt=ct/be/1e3,Pt=Bt/Lt,Ht=re.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(re.get().streaming.cmcd.rtpSafetyFactor)?re.get().streaming.cmcd.rtpSafetyFactor:w,Oe=Pt*Ht,ze=(parseInt(Oe/100)+1)*100;return ze}function Me(){ae.off(o.default.PLAYBACK_RATE_CHANGED,j,this),ae.off(o.default.MANIFEST_LOADED,X,this),ae.off(o.default.BUFFER_LEVEL_STATE_CHANGED,z,P),ae.off(o.default.PLAYBACK_SEEKED,oe,P),te()}return P={getQueryParameter:pe,getHeaderParameters:Q,setConfig:de,reset:Me,initialize:me},le(),P}C.__dashjs_factory_name="CmcdModel",r.default=u.default.getSingletonFactory(C)},"./src/streaming/models/FragmentModel.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/vo/FragmentRequest.js"),l="loading",u="executed",c="canceled",f="failed";function h(E){E=E||{};var v=E.eventBus,M=E.events,y=E.dashMetrics,_=E.fragmentLoader,g=E.debug,R=E.streamInfo,S=E.type,x,w,C,b;function P(){w=g.getLogger(x),Y(),v.on(M.LOADING_COMPLETED,pe,x),v.on(M.LOADING_DATA_PROGRESS,he,x),v.on(M.LOADING_ABANDONED,Q,x)}function A(){return R.id}function I(){return S}function F($){var W=function(U,fe){return U.action===o.default.ACTION_COMPLETE&&U.action===fe.action},B=function(U,fe){return!isNaN(U.index)&&U.startTime===fe.startTime&&U.adaptationIndex===fe.adaptationIndex&&U.type===fe.type},L=function(U,fe){return isNaN(U.index)&&isNaN(fe.index)&&U.quality===fe.quality},D=function(U){var fe=!1;return U.some(function(ye){if(B($,ye)||L($,ye)||W($,ye))return fe=!0,fe}),fe};return $?D(C):!1}function G($){var W=!1,B=0,L;if(W=F($),!W)for(B=0;B<b.length;B++)L=b[B],$.url===L.url&&$.startTime===L.startTime&&(W=!0);return W}function V($){var W=$?$.state instanceof Array?$.state:[$.state]:[],B=[];return W.forEach(function(L){var D=q(L);B=B.concat(te(D,$))}),B}function k($){return isNaN($.duration)?.25:Math.min($.duration/8,.5)}function H($){C=C.filter(function(W){var B=k(W);return isNaN(W.startTime)||($!==void 0?W.startTime>=$-B:!1)})}function J($){C=C.filter(function(W){return isNaN(W.startTime)||($!==void 0?W.startTime<$:!1)})}function K($,W){W<=$+.5||(C=C.filter(function(B){var L=k(B);return isNaN(B.startTime)||B.startTime>=W-L||isNaN(B.duration)||B.startTime+B.duration<=$+L}))}function ae($,W){if(!$||$.length===0){H();return}for(var B=0,L=0,D=$.length;L<D;L++)K(B,$.start(L)),B=$.end(L);W>0&&K(B,W)}function re(){w.debug("abort requests"),_.abort(),b=[]}function le($){switch($.action){case o.default.ACTION_DOWNLOAD:Z($,l),b.push($),me($);break;default:w.warn("Unknown request action.")}}function me($){v.trigger(M.FRAGMENT_LOADING_STARTED,{request:$},{streamId:R.id,mediaType:S}),_.load($)}function de($,W,B){for(var L=$.length-1,D=L;D>=0;D--){var O=$[D],U=O.startTime,fe=U+O.duration;if(B=isNaN(B)?k(O):B,!isNaN(U)&&!isNaN(fe)&&W+B>=U&&W-B<fe||isNaN(U)&&isNaN(W))return O}return null}function te($,W){return W.hasOwnProperty("time")?[de($,W.time,W.threshold)]:$.filter(function(B){for(var L in W)if(L!=="state"&&W.hasOwnProperty(L)&&B[L]!=W[L])return!1;return!0})}function q($){var W;switch($){case l:W=b;break;case u:W=C;break;default:W=[]}return W}function Z($,W){y.addSchedulingInfo($,W),y.addRequestsQueue($.mediaType,b,C)}function pe($){$.sender===_&&(b.splice(b.indexOf($.request),1),$.response&&!$.error&&C.push($.request),Z($.request,$.error?f:u),v.trigger(M.FRAGMENT_LOADING_COMPLETED,{request:$.request,response:$.response,error:$.error,sender:this},{streamId:R.id,mediaType:S}))}function he($){$.sender===_&&v.trigger(M.FRAGMENT_LOADING_PROGRESS,{request:$.request,response:$.response,error:$.error,sender:this},{streamId:R.id,mediaType:S})}function Q($){$.sender===_&&v.trigger(M.FRAGMENT_LOADING_ABANDONED,{request:$.request},{streamId:R.id,mediaType:S})}function Y(){C=[],b=[]}function ie(){v.off(M.LOADING_COMPLETED,pe,this),v.off(M.LOADING_DATA_PROGRESS,he,this),v.off(M.LOADING_ABANDONED,Q,this),_&&_.reset(),Y()}function ue($){C.push($)}return x={getStreamId:A,getType:I,getRequests:V,isFragmentLoaded:F,isFragmentLoadedOrPending:G,removeExecutedRequestsBeforeTime:H,removeExecutedRequestsAfterTime:J,syncExecutedRequestsWithBufferedRange:ae,abortRequests:re,executeRequest:le,reset:ie,resetInitialSettings:Y,addExecutedRequest:ue},P(),x}h.__dashjs_factory_name="FragmentModel";var p=i.default.getClassFactory(h);p.FRAGMENT_MODEL_LOADING=l,p.FRAGMENT_MODEL_EXECUTED=u,p.FRAGMENT_MODEL_CANCELED=c,p.FRAGMENT_MODEL_FAILED=f,i.default.updateClassFactory(h.__dashjs_factory_name,p),r.default=p},"./src/streaming/models/LowLatencyThroughputModel.js":function(t,r,n){n.r(r);var i=n("./src/core/Debug.js"),o=n("./src/core/FactoryMaker.js");function l(){var u=10,c=.8,f=.6,h=1.05,p=250,E=this.context,v,M,y={};function _(){M=Object(i.default)(E).getInstance().getLogger(v)}function g(C){for(var b={},P=0,A=0,I=0,F=0,G=C.length,V=0;V<G;++V)P+=C[V].chunkDownloadTimeRelativeMS,A+=C[V].bufferLevel,I+=C[V].chunkDownloadTimeRelativeMS*C[V].bufferLevel,F+=C[V].chunkDownloadTimeRelativeMS*C[V].chunkDownloadTimeRelativeMS;return b.m=(I-P*A/G)/(F-P*P/G),b.b=A/G-b.m*P/G,function(k){return b.m*k+b.b}}function R(C){var b=!0,P,A=C.reduce(function(I,F){return I+F.bufferLevelAtSegmentEnd},0)/C.length;return C.forEach(function(I){Math.abs(I.bufferLevelAtSegmentEnd/I.bufferLevelAtSegmentStart)<.95&&(b=!1),I.bufferLevelAtSegmentEnd/A<.8&&(b=!1),P?P>I.bitrate&&(b=!1):P=I.bitrate}),b}function S(C){var b=y[C.mediaType].slice(-1).pop(),P=y[C.mediaType].slice(-3),A=b.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;b.bufferLevelAtSegmentStart=b.getEstimatedBufferLevel(A/2),b.bufferLevelAtSegmentEnd=b.getEstimatedBufferLevel(A);var I=R(P),F=I?f:c;if(b.isBufferStable&&b.segDurationMS*h<b.fetchDownloadDurationMS)return b.fetchDownloadDurationMS;if(!I||b.segDurationMS<b.fetchDownloadDurationMS||b.adjustedAvailabilityStartTimeMS<=b.requestTimeMS+b.throughputCapacityDelayMS-b.segDurationMS)return b.fetchDownloadDurationMS*c;for(var G=b.requestTimeMS+b.throughputCapacityDelayMS-b.adjustedAvailabilityStartTimeMS,V=0,k=0,H=0,J=0;J<b.chunkMeasurements.length;J++){var K=b.chunkMeasurements[J];if(G<k+K.chunkDownloadDurationMS)break;k+=K.chunkDownloadDurationMS,V+=K.chunkBytes,H++}if(G<0&&M.warn("request time was before adjusted availibitly start time"),V&&k&&H>b.chunkMeasurements.length*.2){var ae=V/k,re=b.segmentBytes/ae;return b.fetchDownloadDurationMS<re?b.fetchDownloadDurationMS*F:re*F}var le=b.bitrate;return b.bitrateList.some(function(me){if(me.bandwidth>b.bitrate)return le=me.bandwidth,!0}),le===b.bitrate?b.fetchDownloadDurationMS*F:F*b.segmentBytes*8*1e3/le}function x(C,b){var P=y[C.mediaType]&&y[C.mediaType].slice(-3);return!P||P.length<3||!R(P)?0:b/4>p?p:b/4}function w(C,b,P,A,I){C&&C.mediaType&&!y[C.mediaType]&&(y[C.mediaType]=[]);var F=C.mediaInfo.bitrateList.find(function(G){return G.id===C.representationId});y[C.mediaType].push({index:C.index,repId:C.representationId,mediaType:C.mediaType,requestTimeMS:A,adjustedAvailabilityStartTimeMS:C.availabilityStartTime.getTime(),segDurationMS:C.duration*1e3,chunksDurationMS:P.reduce(function(G,V){return G+V.chunkDownloadDurationMS},0),segmentBytes:P.reduce(function(G,V){return G+V.chunkBytes},0),bitrate:F&&F.bandwidth,bitrateList:C.mediaInfo.bitrateList,chunkMeasurements:P,fetchDownloadDurationMS:b,throughputCapacityDelayMS:I,getEstimatedBufferLevel:g(P.slice(1))}),y[C.mediaType].length>u&&y[C.mediaType].shift()}return v={setup:_,addMeasurement:w,getThroughputCapacityDelayMS:x,getEstimatedDownloadDurationMS:S},_(),v}l.__dashjs_factory_name="LowLatencyThroughputModel",r.default=o.default.getSingletonFactory(l)},"./src/streaming/models/ManifestModel.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js");function u(){var c=this.context,f=Object(i.default)(c).getInstance(),h,p;function E(){return p}function v(M){p=M,M&&f.trigger(o.default.MANIFEST_LOADED,{data:M})}return h={getValue:E,setValue:v},h}u.__dashjs_factory_name="ManifestModel",r.default=l.default.getSingletonFactory(u)},"./src/streaming/models/MediaPlayerModel.js":function(t,r,n){n.r(r);var i=n("./src/dash/vo/UTCTiming.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/constants/Constants.js"),u=n("./src/streaming/rules/abr/ABRRulesCollection.js"),c=n("./src/core/Settings.js"),f=n("./src/streaming/utils/SupervisorTools.js"),h=12,p=20,E=3,v=10,M=5,y=4,_=5,g=!1;function R(){var S,x,w,C,b=this.context,P=Object(c.default)(b).getInstance();function A(){x=[],w={default:g},C=[]}function I(Y){var ie;for(ie=0;ie<C.length;ie++)if(C[ie].rulename===Y)return ie;return-1}function F(){return C}function G(Y,ie,ue){if(typeof Y!="string"||Y!==u.default.ABANDON_FRAGMENT_RULES&&Y!==u.default.QUALITY_SWITCH_RULES||typeof ie!="string")throw l.default.BAD_ARGUMENT_ERROR;var $=I(ie);$===-1?C.push({type:Y,rulename:ie,rule:ue}):(C[$].type=Y,C[$].rule=ue)}function V(Y){if(Y){var ie=I(Y);ie!==-1&&C.splice(ie,1)}else C=[]}function k(){var Y=P.get().streaming.buffer.initialBufferLevel;return isNaN(Y)||Y<0?0:Math.min(H(),Y)}function H(){if(P.get().streaming.lowLatencyEnabled)return ae();var Y=P.get().streaming.buffer.stableBufferTime;return Y>0?Y:P.get().streaming.buffer.fastSwitchEnabled?p:h}function J(Y){var ie=isNaN(P.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?M:P.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return P.get().streaming.lowLatencyEnabled?P.get().streaming.retryAttempts[Y]*ie:P.get().streaming.retryAttempts[Y]}function K(Y){var ie=isNaN(P.get().streaming.retryIntervals.lowLatencyReductionFactor)?v:P.get().streaming.retryIntervals.lowLatencyReductionFactor;return P.get().streaming.lowLatencyEnabled?P.get().streaming.retryIntervals[Y]/ie:P.get().streaming.retryIntervals[Y]}function ae(){return P.get().streaming.lowLatencyEnabled?P.get().streaming.delay.liveDelay||E:P.get().streaming.delay.liveDelay}function re(){try{var Y=P.get().streaming.liveCatchup.latencyThreshold,ie=ae();if(Y!==null&&!isNaN(Y))return Math.max(Y,ie);var ue=P.get().streaming.liveCatchup.minDrift,$=!isNaN(ie)&&ie?isNaN(ue)?ae():P.get().streaming.liveCatchup.minDrift+ae():NaN;return $&&!isNaN($)?Math.max($*y,_):NaN}catch{return NaN}}function le(Y,ie){de(Y,ie);var ue=new i.default;ue.schemeIdUri=Y,ue.value=ie,x.push(ue)}function me(){return x}function de(Y,ie){Object(f.checkParameterType)(Y,"string"),Object(f.checkParameterType)(ie,"string"),x.forEach(function(ue,$){ue.schemeIdUri===Y&&ue.value===ie&&x.splice($,1)})}function te(){x=[]}function q(){var Y=P.get().streaming.utcSynchronization.defaultTimingSource;le(Y.scheme,Y.value)}function Z(Y,ie){Y?w[Y]=!!ie:Object.keys(w).forEach(function(ue){Z(ue,ie)})}function pe(Y){var ie=w[Y];return ie===void 0?w.default:ie}function he(){return P.get().streaming.utcSynchronization.defaultTimingSource}function Q(){}return S={getABRCustomRules:F,addABRCustomRule:G,removeABRCustomRule:V,getStableBufferTime:H,getInitialBufferLevel:k,getRetryAttemptsForType:J,getRetryIntervalsForType:K,getLiveDelay:ae,getLiveCatchupLatencyThreshold:re,addUTCTimingSource:le,removeUTCTimingSource:de,getUTCTimingSources:me,clearDefaultUTCTimingSources:te,restoreDefaultUTCTimingSources:q,setXHRWithCredentialsForType:Z,getXHRWithCredentialsForType:pe,getDefaultUtcTimingSource:he,reset:Q},A(),S}R.__dashjs_factory_name="MediaPlayerModel",r.default=o.default.getSingletonFactory(R)},"./src/streaming/models/MetricsModel.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/constants/MetricsConstants.js"),l=n("./src/streaming/vo/MetricsList.js"),u=n("./src/streaming/vo/metrics/HTTPRequest.js"),c=n("./src/streaming/vo/metrics/RepresentationSwitch.js"),f=n("./src/streaming/vo/metrics/BufferLevel.js"),h=n("./src/streaming/vo/metrics/BufferState.js"),p=n("./src/streaming/vo/metrics/DVRInfo.js"),E=n("./src/streaming/vo/metrics/DroppedFrames.js"),v=n("./src/streaming/vo/metrics/ManifestUpdate.js"),M=n("./src/streaming/vo/metrics/SchedulingInfo.js"),y=n("./src/core/EventBus.js"),_=n("./src/streaming/vo/metrics/RequestsQueue.js"),g=n("./src/core/events/Events.js"),R=n("./src/core/FactoryMaker.js");function S(x){x=x||{};var w=x.settings,C=this.context,b=Object(y.default)(C).getInstance(),P,A;function I(){A={}}function F(){b.trigger(g.default.METRICS_CHANGED)}function G(L){b.trigger(g.default.METRIC_CHANGED,{mediaType:L}),F()}function V(L,D,O){b.trigger(g.default.METRIC_UPDATED,{mediaType:L,metric:D,value:O}),G(L)}function k(L,D,O){b.trigger(g.default.METRIC_ADDED,{mediaType:L,metric:D,value:O}),G(L)}function H(L){delete A[L],G(L)}function J(){A={},F()}function K(L,D){var O=null;return L&&(A.hasOwnProperty(L)?O=A[L]:D||(O=new l.default,A[L]=O)),O}function ae(L,D,O){var U=K(L);U!==null&&(U[D].push(O),U[D].length>w.get().streaming.metrics.maxListDepth&&U[D].shift())}function re(L,D,O,U,fe){var ye=new u.HTTPRequestTrace;return ye.s=D,ye.d=O,ye.b=U,ye.t=fe,L.trace.push(ye),L.interval||(L.interval=0),L.interval+=O,ye}function le(L,D,O,U,fe,ye,_e,ee,j,X,z,oe,se,ce,Se){var Me=new u.HTTPRequest;ye&&ye!==U&&(le(L,null,O,U,fe,null,null,ee,j,null,null,null,se,null,null),Me.actualurl=ye),Me.tcpid=D,Me.type=O,Me.url=U,Me.range=ee,Me.trequest=j,Me.tresponse=X,Me.responsecode=oe,Me._tfinish=z,Me._stream=L,Me._mediaduration=se,Me._quality=fe,Me._responseHeaders=ce,Me._serviceLocation=_e,Se?Se.forEach(function(ve){re(Me,ve.s,ve.d,ve.b,ve.t)}):(delete Me.interval,delete Me.trace),de(L,o.default.HTTP_REQUEST,Me)}function me(L,D,O,U,fe){var ye=new c.default;ye.t=D,ye.mt=O,ye.to=U,fe?ye.lto=fe:delete ye.lto,de(L,o.default.TRACK_SWITCH,ye)}function de(L,D,O){ae(L,D,O),k(L,D,O)}function te(L,D,O){var U=new f.default;U.t=D,U.level=O,de(L,o.default.BUFFER_LEVEL,U)}function q(L,D,O){var U=new h.default;U.target=O,U.state=D,de(L,o.default.BUFFER_STATE,U)}function Z(L,D,O,U){var fe=new p.default;fe.time=D,fe.range=U,fe.manifestInfo=O,de(L,o.default.DVR_INFO,fe)}function pe(L,D){var O=new E.default,U=K(L).DroppedFrames;!D||(O.time=D.creationTime,O.droppedFrames=D.droppedVideoFrames,!(U.length>0&&U[U.length-1]==O)&&de(L,o.default.DROPPED_FRAMES,O))}function he(L,D,O,U,fe,ye,_e,ee,j){var X=new M.default;X.mediaType=L,X.t=D,X.type=O,X.startTime=U,X.availabilityStartTime=fe,X.duration=ye,X.quality=_e,X.range=ee,X.state=j,de(L,o.default.SCHEDULING_INFO,X)}function Q(L,D,O){var U=new _.default;U.loadingRequests=D,U.executedRequests=O,K(L).RequestsQueue=U,k(L,o.default.REQUESTS_QUEUE,U)}function Y(L,D,O,U,fe,ye,_e,ee,j,X){var z=new v.ManifestUpdate;z.mediaType=L,z.type=D,z.requestTime=O,z.fetchTime=U,z.availabilityStartTime=fe,z.presentationStartTime=ye,z.clientTimeOffset=_e,z.currentTime=ee,z.buffered=j,z.latency=X,ae(i.default.STREAM,o.default.MANIFEST_UPDATE,z),k(L,o.default.MANIFEST_UPDATE,z)}function ie(L,D){if(L){for(var O in D)L[O]=D[O];V(L.mediaType,o.default.MANIFEST_UPDATE,L)}}function ue(L,D,O,U,fe){if(L){var ye=new v.ManifestUpdateStreamInfo;ye.id=D,ye.index=O,ye.start=U,ye.duration=fe,L.streamInfo.push(ye),V(L.mediaType,o.default.MANIFEST_UPDATE_STREAM_INFO,L)}}function $(L,D,O,U,fe,ye,_e,ee){if(L&&L.representationInfo){var j=new v.ManifestUpdateRepresentationInfo;j.id=D,j.index=O,j.streamIndex=U,j.mediaType=fe,j.startNumber=_e,j.fragmentInfoType=ee,j.presentationTimeOffset=ye,L.representationInfo.push(j),V(L.mediaType,o.default.MANIFEST_UPDATE_TRACK_INFO,L)}}function W(L){L.trace&&Array.isArray(L.trace)?L.trace.forEach(function(D){D.hasOwnProperty("subreplevel")&&!D.subreplevel&&delete D.subreplevel}):delete L.trace,de(i.default.STREAM,o.default.PLAY_LIST,L)}function B(L){de(i.default.STREAM,o.default.DVB_ERRORS,L)}return P={clearCurrentMetricsForType:H,clearAllCurrentMetrics:J,getMetricsFor:K,addHttpRequest:le,addRepresentationSwitch:me,addBufferLevel:te,addBufferState:q,addDVRInfo:Z,addDroppedFrames:pe,addSchedulingInfo:he,addRequestsQueue:Q,addManifestUpdate:Y,updateManifestUpdateInfo:ie,addManifestUpdateStreamInfo:ue,addManifestUpdateRepresentationInfo:$,addPlayList:W,addDVBErrors:B},I(),P}S.__dashjs_factory_name="MetricsModel",r.default=R.default.getSingletonFactory(S)},"./src/streaming/models/URIFragmentModel.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/URIFragmentData.js"),o=n("./src/core/FactoryMaker.js");function l(){var u,c;function f(p){if(c=new i.default,!p)return null;var E=p.indexOf("#");if(E!==-1)for(var v=p.substr(E+1).split("&"),M=0,y=v.length;M<y;++M){var _=v[M],g=_.indexOf("=");if(g!==-1){var R=_.substring(0,g);c.hasOwnProperty(R)&&(c[R]=_.substr(g+1))}}}function h(){return c}return u={initialize:f,getURIFragmentData:h},u}l.__dashjs_factory_name="URIFragmentModel",r.default=o.default.getSingletonFactory(l)},"./src/streaming/models/VideoModel.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/EventBus.js"),l=n("./src/core/events/Events.js"),u=n("./src/core/Debug.js"),c=n("./src/streaming/constants/Constants.js"),f=new Map([[c.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[c.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[c.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[c.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function h(){var p,E,v,M,y="element is not video or audio DOM type!",_=this.context,g=Object(o.default)(_).getInstance(),R=[];function S(){E=Object(u.default)(_).getInstance().getLogger(p)}function x(){g.on(l.default.PLAYBACK_PLAYING,me,this)}function w(){g.off(l.default.PLAYBACK_PLAYING,me,this)}function C(){v&&(v.playbackRate=1,v.removeEventListener("canplay",C))}function b(ce){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!v||(!Se&&v.readyState<=2&&ce>0?v.addEventListener("canplay",C):v.playbackRate=ce)}function P(ce,Se){oe(c.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(v){if(v.currentTime===ce)return;try{ce=Se?A(ce):ce,v.currentTime=ce}catch(Me){v.readyState===0&&Me.code===Me.INVALID_STATE_ERR&&setTimeout(function(){v.currentTime=ce},400)}}})}function A(ce){var Se=B(),Me=ce,ve=9999999999;if(Se)for(var be=0;be<Se.length;be++){var Ne=Se.start(be),Ue=Se.end(be),Xe=Math.abs(Ne-ce),ot=Math.abs(Ue-ce);if(ce>=Ne&&ce<=Ue)return ce;Xe<ve&&(ve=Xe,Me=Ne),ot<ve&&(ve=ot,Me=Ue)}return Me}function I(){return v}function F(ce){if(ce==null||ce&&/^(VIDEO|AUDIO)$/i.test(ce.nodeName))v=ce,v&&(v.preload="auto");else throw y}function G(ce){v&&(ce?v.src=ce:(v.removeAttribute("src"),v.load()))}function V(){return v?v.src:null}function k(){return M}function H(ce){M=ce,M.style.position="absolute",M.style.display="flex",M.style.overflow="hidden",M.style.pointerEvents="none",M.style.top=0,M.style.left=0}function J(ce,Se){le(ce,Se)}function K(){return R.length>0}function ae(ce){ce===null||!v||v.seeking||R.indexOf(ce)!==-1||R.push(ce)}function re(ce){var Se=R.indexOf(ce);ce!==null&&Se!==-1&&R.splice(Se,1)}function le(ce,Se){Se?ae(ce):re(ce)}function me(){if(v&&K()&&v.playbackRate===0){var ce=document.createEvent("Event");ce.initEvent("waiting",!0,!1),v.dispatchEvent(ce)}}function de(){if(!v)return null;var ce="webkitDroppedFrameCount"in v&&"webkitDecodedFrameCount"in v,Se="getVideoPlaybackQuality"in v,Me=null;return Se?Me=v.getVideoPlaybackQuality():ce&&(Me={droppedVideoFrames:v.webkitDroppedFrameCount,totalVideoFrames:v.webkitDroppedFrameCount+v.webkitDecodedFrameCount,creationTime:new Date}),Me}function te(){if(v){v.autoplay=!0;var ce=v.play();ce&&ce.catch&&typeof Promise!="undefined"&&ce.catch(function(Se){Se.name==="NotAllowedError"&&g.trigger(l.default.PLAYBACK_NOT_ALLOWED),E.warn("Caught pending play exception - continuing (".concat(Se,")"))})}}function q(){return v?v.paused:null}function Z(){v&&(v.pause(),v.autoplay=!1)}function pe(){return v?v.seeking:null}function he(){return v?v.currentTime:null}function Q(){return v?v.playbackRate:null}function Y(){return v?v.played:null}function ie(){return v?v.ended:null}function ue(ce,Se){v&&v.addEventListener(ce,Se)}function $(ce,Se){v&&v.removeEventListener(ce,Se)}function W(){return v?v.readyState:NaN}function B(){return v?v.buffered:null}function L(){return v?v.clientWidth:NaN}function D(){return v?v.clientHeight:NaN}function O(){return v?v.videoWidth:NaN}function U(){return v?v.videoHeight:NaN}function fe(){var ce=v.parentNode.host||v.parentNode;return ce?v.getBoundingClientRect().top-ce.getBoundingClientRect().top:NaN}function ye(){var ce=v.parentNode.host||v.parentNode;return ce?v.getBoundingClientRect().left-ce.getBoundingClientRect().left:NaN}function _e(){return v?v.textTracks:[]}function ee(ce,Se,Me,ve,be){if(v){for(var Ne=0;Ne<v.textTracks.length;Ne++)if(v.textTracks[Ne].kind===ce&&(Se?v.textTracks[Ne].label==Se:!0)&&v.textTracks[Ne].language===Me&&v.textTracks[Ne].isTTML===ve&&v.textTracks[Ne].isEmbedded===be)return v.textTracks[Ne]}return null}function j(ce,Se,Me,ve,be){if(!v)return null;var Ne=ee(ce,Se,Me,ve,be);return Ne||(Ne=v.addTextTrack(ce,Se,Me),Ne.isEmbedded=be,Ne.isTTML=ve),Ne}function X(ce){v&&(v.appendChild(ce),ce.isTTML!==void 0&&(v.textTracks[v.textTracks.length-1].isTTML=ce.isTTML,v.textTracks[v.textTracks.length-1].isEmbedded=ce.isEmbedded))}function z(ce){v&&v.removeChild(ce)}function oe(ce,Se){if(ce===c.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||W()>=ce)Se();else{var Me=f.get(ce);se(Me,Se)}}function se(ce,Se){var Me=function ve(){$(ce,ve),Se(ce)};ue(ce,Me)}return p={initialize:x,setCurrentTime:P,play:te,isPaused:q,pause:Z,isStalled:K,isSeeking:pe,getTime:he,getPlaybackRate:Q,setPlaybackRate:b,getPlayedRanges:Y,getEnded:ie,setStallState:J,getElement:I,setElement:F,setSource:G,getSource:V,getTTMLRenderingDiv:k,setTTMLRenderingDiv:H,getPlaybackQuality:de,addEventListener:ue,removeEventListener:$,getReadyState:W,getBufferRange:B,getClientWidth:L,getClientHeight:D,getTextTracks:_e,getTextTrack:ee,addTextTrack:j,appendChild:X,removeChild:z,getVideoWidth:O,getVideoHeight:U,getVideoRelativeOffsetTop:fe,getVideoRelativeOffsetLeft:ye,waitForReadyState:oe,reset:w},S(),p}h.__dashjs_factory_name="VideoModel",r.default=i.default.getSingletonFactory(h)},"./src/streaming/net/FetchLoader.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Settings.js"),l=n("./src/streaming/constants/Constants.js");function u(_,g){return h(_)||f(_,g)||E(_,g)||c()}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f(_,g){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(_)))){var R=[],S=!0,x=!1,w=void 0;try{for(var C=_[Symbol.iterator](),b;!(S=(b=C.next()).done)&&(R.push(b.value),!(g&&R.length===g));S=!0);}catch(P){x=!0,w=P}finally{try{!S&&C.return!=null&&C.return()}finally{if(x)throw w}}return R}}function h(_){if(Array.isArray(_))return _}function p(_,g){var R;if(typeof Symbol=="undefined"||_[Symbol.iterator]==null){if(Array.isArray(_)||(R=E(_))||g&&_&&typeof _.length=="number"){R&&(_=R);var S=0,x=function(){};return{s:x,n:function(){return S>=_.length?{done:!0}:{done:!1,value:_[S++]}},e:function(A){throw A},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w=!0,C=!1,b;return{s:function(){R=_[Symbol.iterator]()},n:function(){var A=R.next();return w=A.done,A},e:function(A){C=!0,b=A},f:function(){try{!w&&R.return!=null&&R.return()}finally{if(C)throw b}}}}function E(_,g){if(!!_){if(typeof _=="string")return v(_,g);var R=Object.prototype.toString.call(_).slice(8,-1);if(R==="Object"&&_.constructor&&(R=_.constructor.name),R==="Map"||R==="Set")return Array.from(_);if(R==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(R))return v(_,g)}}function v(_,g){(g==null||g>_.length)&&(g=_.length);for(var R=0,S=new Array(g);R<g;R++)S[R]=_[R];return S}function M(_){_=_||{};var g=this.context,R=_.requestModifier,S=_.lowLatencyThroughputModel,x=_.boxParser,w=Object(o.default)(g).getInstance(),C,b;function P(H){b=H.dashMetrics}function A(H){var J=new Date,K=H.request,ae=new Headers;if(K.range&&ae.append("Range","bytes="+K.range),H.headers)for(var re in H.headers){var le=H.headers[re];le&&ae.append(re,le)}K.requestStartDate||(K.requestStartDate=J),R&&R.modifyRequestHeader({setRequestHeader:function(he,Q){ae.append(he,Q)}});var me;typeof window.AbortController=="function"&&(me=new AbortController,H.abortController=me,me.signal.onabort=H.onabort);var de={method:H.method,headers:ae,credentials:H.withCredentials?"include":void 0,signal:me?me.signal:void 0},te=w.get().streaming.abr.fetchThroughputCalculationMode,q=Date.now(),Z=0;new Promise(function(pe){if(te===l.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&S&&(Z=S.getThroughputCapacityDelayMS(K,b.getCurrentBufferLevel(K.mediaType)*1e3),Z))return setTimeout(pe,Z);pe()}).then(function(){var pe=Date.now();fetch(H.url,de).then(function(he){H.response||(H.response={}),H.response.status=he.status,H.response.statusText=he.statusText,H.response.responseURL=he.url,he.ok||H.onerror();var Q="",Y=p(he.headers.keys()),ie;try{for(Y.s();!(ie=Y.n()).done;){var ue=ie.value;Q+=ue+": "+he.headers.get(ue)+`\r
`}}catch(Se){Y.e(Se)}finally{Y.f()}if(H.response.responseHeaders=Q,!he.body)return he.arrayBuffer().then(function(Se){H.response.response=Se;var Me={loaded:Se.byteLength,total:Se.byteLength,stream:!1};H.progress(Me),H.onload(),H.onend()});var $=parseInt(he.headers.get("Content-Length"),10),W=0,B=!1,L=new Uint8Array,D=0;if(te===l.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&S){var O=function(Me){var ve=Me.getReader(),be=[];ve.read().then(function Ne(Ue){var Xe=Ue.value,ot=Ue.done;if(fe=Date.now(),Xe&&Xe.length){var ct=fe-U,xt=Xe.length;be.push({chunkDownloadTimeRelativeMS:fe-pe,chunkDownloadDurationMS:ct,chunkBytes:xt,kbps:Math.round(8*xt/(ct/1e3)),bufferLevel:b.getCurrentBufferLevel(K.mediaType)})}if(ot){var Bt=fe-pe,Lt=be.reduce(function(Pt,Ht){return Pt+Ht.chunkBytes},0);S.addMeasurement(K,Bt,be,q,Z,Q),H.progress({loaded:Lt,total:Lt,lengthComputable:!0,time:S.getEstimatedDownloadDurationMS(K),stream:!0});return}return U=Date.now(),ve.read().then(Ne)})},U=pe,fe=0,ye=he.body.tee(),_e=u(ye,2),ee=_e[0],j=_e[1];O(ee),H.reader=j.getReader()}else H.reader=he.body.getReader();var X=[],z=[],oe=[],se=!0,ce=function Se(Me){var ve=Me.value,be=Me.done;if(be){if(L){if(te!==l.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var Ne=null;te===l.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&(Ne=k(z,oe)),H.progress({loaded:W,total:isNaN($)?W:$,lengthComputable:!0,time:V(X,W),throughput:Ne,stream:!0})}H.response.response=L.buffer}H.onload(),H.onend();return}if(ve&&ve.length>0){if(L=F(L,ve),W+=ve.length,X.push({ts:Date.now(),bytes:ve.length}),te===l.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&se){var Ue=x.findLastTopIsoBoxCompleted(["moof"],L,D);Ue.found&&(se=!1,z.push({ts:performance.now(),bytes:ve.length}))}var Xe=x.findLastTopIsoBoxCompleted(["moov","mdat"],L,D);if(Xe.found){var ot=Xe.lastCompletedOffset+Xe.size;te===l.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&!se&&(se=!0,oe.push({ts:performance.now(),bytes:L.length}));var ct;ot===L.length?(ct=L,L=new Uint8Array):(ct=new Uint8Array(L.subarray(0,ot)),L=L.subarray(ot)),H.progress({data:ct.buffer,lengthComputable:!1,noTrace:!0}),D=0}else D=Xe.lastCompletedOffset,B||(H.progress({lengthComputable:!1,noTrace:!0}),B=!0)}I(H,Se)};I(H,ce)}).catch(function(he){H.onerror&&H.onerror(he)})})}function I(H,J){H.reader.read().then(J).catch(function(K){H.onerror&&H.response.status===200&&H.onerror(K)})}function F(H,J){if(H.length===0)return J;var K=new Uint8Array(H.length+J.length);return K.set(H),K.set(J,H.length),K}function G(H){if(H.abortController)H.abortController.abort();else if(H.reader)try{H.reader.cancel(),H.onabort()}catch{}}function V(H,J){try{if(H=H.filter(function(re){return re.bytes>J/4/H.length}),H.length>1){var K=0,ae=(H[H.length-1].ts-H[0].ts)/H.length;return H.forEach(function(re,le){var me=H[le+1];if(me){var de=me.ts-re.ts;K+=de<ae?de:0}}),K}return null}catch{return null}}function k(H,J){try{var K,ae;K=H.filter(function(pe,he){return he<H.length-1}),ae=J.filter(function(pe,he){return he<J.length-1});var re=[];if(K.length>1){for(var le=0,me=0,de=0;de<K.length;de++)if(K[de]&&ae[de]){var te=ae[de].ts-K[de].ts;if(te>1)re.push(8*ae[de].bytes/te);else{me===0&&(me=K[de].ts);var q=ae[de].ts-me;q>1?(re.push(8*le/q),le=0,me=0):le+=ae[de].bytes}}if(re.length>0){var Z=re.reduce(function(pe,he){return pe+he},0);return Z/re.length}}return null}catch{return null}}return C={load:A,abort:G,calculateDownloadedTime:V,setup:P},C}M.__dashjs_factory_name="FetchLoader";var y=i.default.getClassFactory(M);r.default=y},"./src/streaming/net/HTTPLoader.js":function(t,r,n){n.r(r);var i=n("./src/streaming/net/XHRLoader.js"),o=n("./src/streaming/net/FetchLoader.js"),l=n("./src/streaming/vo/metrics/HTTPRequest.js"),u=n("./src/core/FactoryMaker.js"),c=n("./src/streaming/vo/DashJSError.js"),f=n("./src/streaming/models/CmcdModel.js"),h=n("./src/core/Utils.js"),p=n("./src/core/Debug.js"),E=n("./src/core/EventBus.js"),v=n("./src/core/events/Events.js"),M=n("./src/core/Settings.js"),y=n("./src/streaming/constants/Constants.js"),_=n("./src/streaming/models/LowLatencyThroughputModel.js");function g(x,w,C){return w in x?Object.defineProperty(x,w,{value:C,enumerable:!0,configurable:!0,writable:!0}):x[w]=C,x}function R(x){x=x||{};var w=this.context,C=x.errHandler,b=x.dashMetrics,P=x.mediaPlayerModel,A=x.requestModifier,I=x.boxParser,F=x.errors,G=x.requestTimeout||0,V=Object(E.default)(w).getInstance(),k=Object(M.default)(w).getInstance(),H,J,K,ae,re,le,me,de;function te(){var Q;de=Object(p.default)(w).getInstance().getLogger(H),J=[],K=[],ae=[],le=Object(f.default)(w).getInstance(),me=Object(_.default)(w).getInstance(),re=(Q={},g(Q,l.HTTPRequest.MPD_TYPE,F.DOWNLOAD_ERROR_ID_MANIFEST_CODE),g(Q,l.HTTPRequest.XLINK_EXPANSION_TYPE,F.DOWNLOAD_ERROR_ID_XLINK_CODE),g(Q,l.HTTPRequest.INIT_SEGMENT_TYPE,F.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),g(Q,l.HTTPRequest.MEDIA_SEGMENT_TYPE,F.DOWNLOAD_ERROR_ID_CONTENT_CODE),g(Q,l.HTTPRequest.INDEX_SEGMENT_TYPE,F.DOWNLOAD_ERROR_ID_CONTENT_CODE),g(Q,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,F.DOWNLOAD_ERROR_ID_CONTENT_CODE),g(Q,l.HTTPRequest.OTHER_TYPE,F.DOWNLOAD_ERROR_ID_CONTENT_CODE),Q)}function q(Q,Y){var ie=Q.request,ue=[],$=!0,W=!0,B=new Date,L=B,D=0,O;if(!A||!b||!C)throw new Error("config object is not correct or missing");var U=function(Ue){if(W=!1,ie.requestStartDate=B,ie.requestEndDate=new Date,ie.firstByteDate=ie.firstByteDate||B,!ie.checkExistenceOnly){var Xe=O.response?O.response.responseURL:null,ot=O.response?O.response.status:null,ct=O.response&&O.response.getAllResponseHeaders?O.response.getAllResponseHeaders():O.response?O.response.responseHeaders:[];b.addHttpRequest(ie,Xe,ot,ct,Ue?ue:null),ie.type===l.HTTPRequest.MPD_TYPE&&b.addManifestUpdate(ie)}},fe=function(){if(J.indexOf(O)!==-1&&(J.splice(J.indexOf(O),1),W))if(U(!1),Y>0){try{if(k.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&ie.type===l.HTTPRequest.MEDIA_SEGMENT_TYPE){var Ue=P.getRetryAttemptsForType(l.HTTPRequest.MEDIA_SEGMENT_TYPE);Ue===Y&&V.trigger(v.default.ATTEMPT_BACKGROUND_SYNC)}}catch{}Y--;var Xe={config:Q};ae.push(Xe),Xe.timeout=setTimeout(function(){ae.indexOf(Xe)!==-1&&(ae.splice(ae.indexOf(Xe),1),q(Q,Y))},P.getRetryIntervalsForType(ie.type))}else{if(ie.type===l.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;C.error(new c.default(re[ie.type],ie.url+" is not available",{request:ie,response:O.response})),Q.error&&Q.error(ie,"error",O.response.statusText),Q.complete&&Q.complete(ie,O.response.statusText)}},ye=function(Ue){var Xe=new Date;$&&($=!1,(!Ue.lengthComputable||Ue.lengthComputable&&Ue.total!==Ue.loaded)&&(ie.firstByteDate=Xe)),Ue.lengthComputable&&(ie.bytesLoaded=Ue.loaded,ie.bytesTotal=Ue.total),Ue.noTrace||(ue.push({s:L,d:Ue.time?Ue.time:Xe.getTime()-L.getTime(),b:[Ue.loaded?Ue.loaded-D:0],t:Ue.throughput}),L=Xe,D=Ue.loaded),Q.progress&&Ue&&Q.progress(Ue)},_e=function(){O.response.status>=200&&O.response.status<=299&&(U(!0),Q.success&&Q.success(O.response.response,O.response.statusText,O.response.responseURL),Q.complete&&Q.complete(ie,O.response.statusText))},ee=function(){Q.abort&&Q.abort(ie)},j=function(Ue){var Xe;if(Ue.lengthComputable){var ot=Ue.loaded/Ue.total*100;Xe="Request timeout: loaded: "+Ue.loaded+", out of: "+Ue.total+" : "+ot.toFixed(3)+"% Completed"}else Xe="Request timeout: non-computable download size";de.warn(Xe)},X;k.get().streaming.lowLatencyEnabled&&window.fetch&&ie.responseType==="arraybuffer"&&ie.type===l.HTTPRequest.MEDIA_SEGMENT_TYPE?(X=Object(o.default)(w).create({requestModifier:A,lowLatencyThroughputModel:me,boxParser:I}),X.setup({dashMetrics:b})):X=Object(i.default)(w).create({requestModifier:A});var z=null,oe=A.modifyRequestURL(ie.url);if(k.get().streaming.cmcd&&k.get().streaming.cmcd.enabled){var se=k.get().streaming.cmcd.mode;if(se===y.default.CMCD_MODE_QUERY){var ce=Z(ie);oe=h.default.addAditionalQueryParameterToUrl(oe,ce)}else se===y.default.CMCD_MODE_HEADER&&(z=le.getHeaderParameters(ie))}ie.url=oe;var Se=ie.checkExistenceOnly?l.HTTPRequest.HEAD:l.HTTPRequest.GET,Me=P.getXHRWithCredentialsForType(ie.type);O={url:oe,method:Se,withCredentials:Me,request:ie,onload:_e,onend:fe,onerror:fe,progress:ye,onabort:ee,ontimeout:j,loader:X,timeout:G,headers:z};var ve=new Date().getTime();if(isNaN(ie.delayLoadingTime)||ve>=ie.delayLoadingTime)J.push(O),X.load(O);else{var be={httpRequest:O};K.push(be),be.delayTimeout=setTimeout(function(){if(K.indexOf(be)!==-1){K.splice(K.indexOf(be),1);try{B=new Date,L=B,J.push(be.httpRequest),X.load(be.httpRequest)}catch{be.httpRequest.onerror()}}},ie.delayLoadingTime-ve)}}function Z(Q){try{var Y=[],ie=le.getQueryParameter(Q);return ie&&Y.push(ie),Y}catch{return[]}}function pe(Q){Q.request?q(Q,P.getRetryAttemptsForType(Q.request.type)):Q.error&&Q.error(Q.request,"error")}function he(){ae.forEach(function(Q){clearTimeout(Q.timeout),Q.config.request&&Q.config.abort&&Q.config.abort(Q.config.request)}),ae=[],K.forEach(function(Q){return clearTimeout(Q.delayTimeout)}),K=[],J.forEach(function(Q){Q.request.type!==l.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(Q.onloadend=Q.onerror=Q.onprogress=void 0,Q.loader.abort(Q))}),J=[]}return H={load:pe,abort:he},te(),H}R.__dashjs_factory_name="HTTPLoader";var S=u.default.getClassFactory(R);r.default=S},"./src/streaming/net/SchemeLoaderFactory.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/net/HTTPLoader.js");function l(){var c,f;function h(_,g){f[_]=g}function p(_){f[_]&&delete f[_]}function E(){f={}}function v(_){for(var g in f)if(f.hasOwnProperty(g)&&_.startsWith(g))return f[g];return o.default}function M(){E()}function y(){M()}return y(),c={getLoader:v,registerLoader:h,unregisterLoader:p,unregisterAllLoader:E,reset:M},c}l.__dashjs_factory_name="SchemeLoaderFactory";var u=i.default.getSingletonFactory(l);r.default=u},"./src/streaming/net/URLLoader.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/net/SchemeLoaderFactory.js");function l(c){c=c||{};var f=this.context,h,p,E;p=Object(o.default)(f).getInstance();function v(y){if(!E){var _=p.getLoader(y&&y.request?y.request.url:null);E=_(f).create({errHandler:c.errHandler,mediaPlayerModel:c.mediaPlayerModel,requestModifier:c.requestModifier,dashMetrics:c.dashMetrics,boxParser:c.boxParser?c.boxParser:null,constants:c.constants?c.constants:null,dashConstants:c.dashConstants?c.dashConstants:null,urlUtils:c.urlUtils?c.urlUtils:null,requestTimeout:isNaN(c.requestTimeout)?0:c.requestTimeout,errors:c.errors})}E.load(y)}function M(){E&&E.abort()}return h={load:v,abort:M},h}l.__dashjs_factory_name="URLLoader";var u=i.default.getClassFactory(l);r.default=u},"./src/streaming/net/XHRLoader.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(u){u=u||{};var c=u.requestModifier,f;function h(E){var v=new Date,M=E.request,y=new XMLHttpRequest;if(y.open(E.method,E.url,!0),M.responseType&&(y.responseType=M.responseType),M.range&&y.setRequestHeader("Range","bytes="+M.range),M.requestStartDate||(M.requestStartDate=v),c&&(y=c.modifyRequestHeader(y)),E.headers)for(var _ in E.headers){var g=E.headers[_];g&&y.setRequestHeader(_,g)}y.withCredentials=E.withCredentials,y.onload=E.onload,y.onloadend=E.onend,y.onerror=E.onerror,y.onprogress=E.progress,y.onabort=E.onabort,y.ontimeout=E.ontimeout,y.timeout=E.timeout,y.send(),E.response=y}function p(E){var v=E.response;v.onloadend=v.onerror=v.onprogress=void 0,v.abort()}return f={load:h,abort:p},f}o.__dashjs_factory_name="XHRLoader";var l=i.default.getClassFactory(o);r.default=l},"./src/streaming/protection/CommonEncryption.js":function(t,r,n){n.r(r);function i(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function o(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function l(f,h,p){return h&&o(f.prototype,h),p&&o(f,p),f}var u={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},c=function(){function f(){i(this,f)}return l(f,null,[{key:"findCencContentProtection",value:function(p){for(var E=null,v=0;v<p.length;++v){var M=p[v];M.schemeIdUri.toLowerCase()==="urn:mpeg:dash:mp4protection:2011"&&(M.value.toLowerCase()==="cenc"||M.value.toLowerCase()==="cbcs")&&(E=M)}return E}},{key:"getPSSHData",value:function(p){var E=8,v=new DataView(p),M=v.getUint8(E);return E+=20,M>0&&(E+=4+16*v.getUint32(E)),E+=4,p.slice(E)}},{key:"getPSSHForKeySystem",value:function(p,E){var v=f.parsePSSHList(E);return p&&v.hasOwnProperty(p.uuid.toLowerCase())?v[p.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(p,E){return"pssh"in p?(p.pssh.__text=p.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),E.decodeArray(p.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(p){if(p==null)return[];for(var E=new DataView(p.buffer||p),v=!1,M={},y=0;!v;){var _=void 0,g=void 0,R=void 0,S=void 0,x=y;if(y>=E.buffer.byteLength)break;if(_=E.getUint32(y),g=y+_,y+=4,E.getUint32(y)!==1886614376){y=g;continue}if(y+=4,R=E.getUint8(y),R!==0&&R!==1){y=g;continue}y++,y+=3,S="";var w=void 0,C=void 0;for(w=0;w<4;w++)C=E.getUint8(y+w).toString(16),S+=C.length===1?"0"+C:C;for(y+=4,S+="-",w=0;w<2;w++)C=E.getUint8(y+w).toString(16),S+=C.length===1?"0"+C:C;for(y+=2,S+="-",w=0;w<2;w++)C=E.getUint8(y+w).toString(16),S+=C.length===1?"0"+C:C;for(y+=2,S+="-",w=0;w<2;w++)C=E.getUint8(y+w).toString(16),S+=C.length===1?"0"+C:C;for(y+=2,S+="-",w=0;w<6;w++)C=E.getUint8(y+w).toString(16),S+=C.length===1?"0"+C:C;y+=6,S=S.toLowerCase(),y+=4,M[S]=E.buffer.slice(x,g),y=g}return M}},{key:"getLicenseServerUrlFromMediaInfo",value:function(p,E){try{if(!p||p.length===0)return null;for(var v=0,M=null;v<p.length&&!M;){var y=p[v];if(y&&y.contentProtection&&y.contentProtection.length>0){var _=y.contentProtection.filter(function(b){return b.schemeIdUri&&b.schemeIdUri===E});if(_&&_.length>0)for(var g=0;g<_.length&&!M;){for(var R=_[g],S=0;S<u.attributes.length&&!M;){for(var x=0,w=u.attributes[S];x<u.prefixes.length&&!M;){var C=u.prefixes[x];R[w]&&R[w].__prefix&&R[w].__prefix===C&&R[w].__text&&(M=R[w].__text),x+=1}S+=1}g+=1}}v+=1}return M}catch{return null}}}]),f}();r.default=c},"./src/streaming/protection/Protection.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/controllers/ProtectionController.js"),o=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),l=n("./src/streaming/protection/ProtectionEvents.js"),u=n("./src/streaming/protection/errors/ProtectionErrors.js"),c=n("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),f=n("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),h=n("./src/streaming/protection/models/ProtectionModel_01b.js"),p=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],E=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function v(){var y,_=this.context;function g(x){var w=null,C=Object(o.default)(_).getInstance();C.setConfig({debug:x.debug,BASE64:x.BASE64}),C.initialize();var b=R(x);return!w&&b&&(w=Object(i.default)(_).create({protectionModel:b,protectionKeyController:C,eventBus:x.eventBus,debug:x.debug,events:x.events,BASE64:x.BASE64,constants:x.constants,cmcdModel:x.cmcdModel,settings:x.settings}),x.capabilities.setEncryptedMediaSupported(!0)),w}function R(x){var w=x.debug,C=w.getLogger(y),b=x.eventBus,P=x.errHandler,A=x.videoModel?x.videoModel.getElement():null;return(!A||A.onencrypted!==void 0)&&(!A||A.mediaKeys!==void 0)?(C.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),Object(c.default)(_).create({debug:w,eventBus:b,events:x.events})):S(A,E)?(C.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),Object(f.default)(_).create({debug:w,eventBus:b,events:x.events,api:S(A,E)})):S(A,p)?(C.info("EME detected on this user agent! (ProtectionModel_01b)"),Object(h.default)(_).create({debug:w,eventBus:b,errHandler:P,events:x.events,api:S(A,p)})):(C.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function S(x,w){for(var C=0;C<w.length;C++){var b=w[C];if(typeof x[b[Object.keys(b)[0]]]=="function")return b}return null}return y={createProtectionSystem:g},y}v.__dashjs_factory_name="Protection";var M=dashjs.FactoryMaker.getClassFactory(v);M.events=l.default,M.errors=u.default,dashjs.FactoryMaker.updateClassFactory(v.__dashjs_factory_name,M),r.default=M},"./src/streaming/protection/ProtectionEvents.js":function(t,r,n){n.r(r);var i=n("./src/core/events/EventsBase.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){var S;return l(this,R),S=g.call(this),S.INTERNAL_KEY_MESSAGE="internalKeyMessage",S.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",S.KEY_ADDED="public_keyAdded",S.KEY_ERROR="public_keyError",S.KEY_MESSAGE="public_keyMessage",S.KEY_SESSION_CLOSED="public_keySessionClosed",S.KEY_SESSION_CREATED="public_keySessionCreated",S.KEY_SESSION_REMOVED="public_keySessionRemoved",S.KEY_STATUSES_CHANGED="public_keyStatusesChanged",S.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",S.KEY_SYSTEM_SELECTED="public_keySystemSelected",S.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",S.LICENSE_REQUEST_SENDING="public_licenseRequestSending",S.NEED_KEY="needkey",S.PROTECTION_CREATED="public_protectioncreated",S.PROTECTION_DESTROYED="public_protectiondestroyed",S.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",S.TEARDOWN_COMPLETE="protectionTeardownComplete",S.VIDEO_ELEMENT_SELECTED="videoElementSelected",S.KEY_SESSION_UPDATED="public_keySessionUpdated",S}return R}(i.default),y=new M;r.default=y},"./src/streaming/protection/controllers/ProtectionController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/CommonEncryption.js"),o=n("./src/streaming/protection/vo/MediaCapability.js"),l=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),u=n("./src/streaming/protection/errors/ProtectionErrors.js"),c=n("./src/streaming/vo/DashJSError.js"),f=n("./src/streaming/protection/vo/LicenseRequest.js"),h=n("./src/streaming/protection/vo/LicenseResponse.js"),p=n("./src/streaming/vo/metrics/HTTPRequest.js"),E=n("./src/core/Utils.js"),v=n("./src/streaming/constants/Constants.js"),M=n("./src/core/FactoryMaker.js");function y(C){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?y=function(P){return typeof P}:y=function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},y(C)}var _=5,g=500,R=3,S=1e3,x=8e3;function w(C){C=C||{};var b=C.protectionKeyController,P=C.protectionModel,A=C.eventBus,I=C.events,F=C.debug,G=C.BASE64,V=C.constants,k=[],H=C.cmcdModel,J=C.settings,K,ae,re,le,me,de,te,q,Z,pe,he;function Q(){ae=F.getLogger(K),re=[],le=[],de="temporary",te="",pe=[],he=[],A.on(I.INTERNAL_KEY_MESSAGE,Ne,K),A.on(I.INTERNAL_KEY_STATUS_CHANGED,be,K)}function Y(){if(!A||!A.hasOwnProperty("on")||!b||!b.hasOwnProperty("getSupportedKeySystemsFromContentProtection"))throw new Error("Missing config parameter(s)")}function ie(Ce){if(!Ce)throw new Error("mediaInfo can not be null or undefined");Y(),le.push(Ce);var we=b.getSupportedKeySystemsFromContentProtection(Ce.contentProtection,me,de);we=we.sort(function(Qe,it){var st=me&&me[Qe.ks.systemString]&&me[Qe.ks.systemString].priority>=0?me[Qe.ks.systemString].priority:we.length,at=me&&me[it.ks.systemString]&&me[it.ks.systemString].priority>=0?me[it.ks.systemString].priority:we.length;return st-at}),we&&we.length>0&&ue(we,!0)}function ue(Ce,we){Z?re.push(Ce):q?q&&W(Ce):$(Ce,we)}function $(Ce,we){Z=!0;var Qe=[];re.push(Ce);for(var it=0;it<Ce.length;it++){var st=ve(Ce[it]);Qe.push({ks:Ce[it].ks,configs:[st]})}var at;P.requestKeySystemAccess(Qe).then(function(Ae){return at=Ae.data,ae.info("DRM: KeySystem Access Granted ("+at.keySystem.systemString+")!  Selecting key system..."),P.selectKeySystem(at)}).then(function(Ae){if(q=Ae,Z=!1,!!P){A.trigger(I.KEY_SYSTEM_SELECTED,{data:at});var Be=O(q);Be&&Be.serverCertificate&&Be.serverCertificate.length>0&&P.setServerCertificate(G.decodeArray(Be.serverCertificate).buffer);for(var We,Te=0;Te<re.length;Te++)for(We=0;We<re[Te].length;We++)if(q===re[Te][We].ks){var De=re[Te][We];B(De);break}}}).catch(function(Ae){q=null,Z=!1,we||A.trigger(I.KEY_SYSTEM_SELECTED,{data:null,error:new c.default(u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,u.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+Ae.error)})})}function W(Ce){var we=Ce.findIndex(function(it){return it.ks===q}),Qe=Ce[we];we===-1||!Qe.initData||B(Qe)}function B(Ce){if(b.isClearKey(q)&&Ce.protData&&Ce.protData.hasOwnProperty("clearkeys")){var we={kids:Object.keys(Ce.protData.clearkeys)};Ce.initData=new TextEncoder().encode(JSON.stringify(we))}Ce.sessionId?L(Ce):Ce.initData!==null&&D(Ce)}function L(Ce){Y(),P.loadKeySession(Ce)}function D(Ce){var we=i.default.getPSSHForKeySystem(q,Ce?Ce.initData:null);if(we){if(ye(Ce.keyId)||_e(we))return;try{Ce.initData=we,P.createKeySession(Ce)}catch(Qe){A.trigger(I.KEY_SESSION_CREATED,{data:null,error:new c.default(u.default.KEY_SESSION_CREATED_ERROR_CODE,u.default.KEY_SESSION_CREATED_ERROR_MESSAGE+Qe.message)})}}else Ce&&Ce.initData?P.createKeySession(Ce):A.trigger(I.KEY_SESSION_CREATED,{data:null,error:new c.default(u.default.KEY_SESSION_CREATED_ERROR_CODE,u.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(q?q.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function O(Ce){if(Ce){var we=Ce.systemString;if(me)return we in me?me[we]:null}return null}function U(){le=[]}function fe(Ce){return Y(),b.getSupportedKeySystemsFromContentProtection(Ce,me,de)}function ye(Ce){if(!Ce)return!1;try{for(var we=P.getSessions(),Qe=0;Qe<we.length;Qe++)if(we[Qe].getKeyId()===Ce)return!0;return!1}catch{return!1}}function _e(Ce){if(!Ce)return!1;try{for(var we=P.getAllInitData(),Qe=0;Qe<we.length;Qe++)if(b.initDataEquals(Ce,we[Qe]))return ae.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch{return!1}}function ee(Ce){Y(),P.removeKeySession(Ce)}function j(Ce){Y(),P.closeKeySession(Ce)}function X(Ce){Y(),P.setServerCertificate(Ce)}function z(Ce){Y(),Ce?(P.setMediaElement(Ce),A.on(I.NEED_KEY,Pt,K)):Ce===null&&(P.setMediaElement(Ce),A.off(I.NEED_KEY,Pt,K))}function oe(Ce){de=Ce}function se(Ce){te=Ce}function ce(Ce){me=Ce,b.setProtectionData(Ce)}function Se(){P&&P.stop()}function Me(){A.off(I.INTERNAL_KEY_MESSAGE,Ne,K),A.off(I.INTERNAL_KEY_STATUS_CHANGED,be,K),Y(),pe=[],he=[],z(null),q=null,Z=!1,P&&(P.reset(),P=null),k.forEach(function(Ce){return clearTimeout(Ce)}),k=[],le=[],re=[]}function ve(Ce){var we=Ce.protData,Qe=[],it=[],st=we&&we.audioRobustness&&we.audioRobustness.length>0?we.audioRobustness:te,at=we&&we.videoRobustness&&we.videoRobustness.length>0?we.videoRobustness:te,Ae=Ce.sessionType,Be=we&&we.distinctiveIdentifier?we.distinctiveIdentifier:"optional",We=we&&we.persistentState?we.persistentState:Ae==="temporary"?"optional":"required";return le.forEach(function(Te){Te.type===V.AUDIO?Qe.push(new o.default(Te.codec,st)):Te.type===V.VIDEO&&it.push(new o.default(Te.codec,at))}),new l.default(Qe,it,Be,We,[Ae])}function be(Ce){Ce.error?A.trigger(I.KEY_STATUSES_CHANGED,{data:null,error:Ce.error}):ae.debug("DRM: key status = "+Ce.status)}function Ne(Ce){ae.debug("DRM: onKeyMessage");var we=Ce.data;A.trigger(I.KEY_MESSAGE,{data:we});var Qe=we.messageType?we.messageType:"license-request",it=we.message,st=we.sessionToken,at=O(q),Ae=b.getLicenseServerModelInstance(q,at,Qe),Be={sessionToken:st,messageType:Qe};if(!it||it.byteLength===0){Ue(Be,new c.default(u.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));return}if(!Ae){ae.debug("DRM: License server request not required for this message (type = "+Ce.data.messageType+").  Session ID = "+st.getSessionId()),Ue(Be);return}if(b.isClearKey(q)){var We=b.processClearKeyLicenseRequest(q,at,it);if(We){ae.debug("DRM: ClearKey license request handled by application!"),Ue(Be),P.updateKeySession(st,We);return}}Xe(we,Ae,at)}function Ue(Ce,we){A.trigger(I.LICENSE_REQUEST_COMPLETE,{data:Ce,error:we})}function Xe(Ce,we,Qe){var it=Ce.sessionToken,st=Ce.messageType?Ce.messageType:"license-request",at={sessionToken:it,messageType:st},Ae=q?q.systemString:null,Be=ct(Qe,st,it,Ce,we);if(!Be){Ue(at,new c.default(u.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));return}var We={},Te=!1;Qe&&xt(We,Qe.httpRequestHeaders);var De=Ce.message,Ze=q.getRequestHeadersFromMessage(De);xt(We,Ze),Object.keys(We).forEach(function(gt){gt.toLowerCase()==="authorization"&&(Te=!0)}),Qe&&typeof Qe.withCredentials=="boolean"&&(Te=Qe.withCredentials);var nt=function(Yt){if(!!P)if(Yt.status>=200&&Yt.status<=299){var An=E.default.parseHttpHeaders(Yt.getAllResponseHeaders?Yt.getAllResponseHeaders():null),bn=new h.default(Yt.responseURL,An,Yt.response);Lt(he,bn).then(function(){var tt=we.getLicenseMessage(bn.data,Ae,st);tt!==null?(Ue(at),P.updateKeySession(it,tt)):Bt(Yt,at,Ae,st,we)})}else Bt(Yt,at,Ae,st,we)},ge=function(Yt){Ue(at,new c.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Ae+' update, XHR aborted. status is "'+Yt.statusText+'" ('+Yt.status+"), readyState is "+Yt.readyState))},Pe=function(Yt){Ue(at,new c.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Ae+' update, XHR error. status is "'+Yt.statusText+'" ('+Yt.status+"), readyState is "+Yt.readyState))},qe=q.getLicenseRequestFromMessage(De),Ye=we.getHTTPMethod(st),$e=we.getResponseType(Ae,st),ht=Qe&&!isNaN(Qe.httpTimeout)?Qe.httpTimeout:x,bt=it.getSessionId()||null,It=new f.default(Be,Ye,$e,We,Te,st,bt,qe),Dt=isNaN(J.get().streaming.retryAttempts[p.HTTPRequest.LICENSE])?R:J.get().streaming.retryAttempts[p.HTTPRequest.LICENSE];Lt(pe,It).then(function(){ot(It,Dt,ht,nt,ge,Pe)})}function ot(Ce,we,Qe,it,st,at){var Ae=new XMLHttpRequest;if(J.get().streaming.cmcd&&J.get().streaming.cmcd.enabled){var Be=J.get().streaming.cmcd.mode;if(Be===v.default.CMCD_MODE_QUERY){var We=H.getQueryParameter({url:Ce.url,type:p.HTTPRequest.LICENSE});We&&(Ce.url=E.default.addAditionalQueryParameterToUrl(Ce.url,[We]))}}Ae.open(Ce.method,Ce.url,!0),Ae.responseType=Ce.responseType,Ae.withCredentials=Ce.withCredentials,Qe>0&&(Ae.timeout=Qe);for(var Te in Ce.headers)Ae.setRequestHeader(Te,Ce.headers[Te]);if(J.get().streaming.cmcd&&J.get().streaming.cmcd.enabled){var De=J.get().streaming.cmcd.mode;if(De===v.default.CMCD_MODE_HEADER){var Ze=H.getHeaderParameters({url:Ce.url,type:p.HTTPRequest.LICENSE});if(Ze)for(var nt in Ze){var ge=Ze[nt];ge&&Ae.setRequestHeader(nt,ge)}}}var Pe=function(){we--;var Ye=isNaN(J.get().streaming.retryIntervals[p.HTTPRequest.LICENSE])?S:J.get().streaming.retryIntervals[p.HTTPRequest.LICENSE];setTimeout(function(){ot(Ce,we,Qe,it,st,at)},Ye)};Ae.onload=function(){this.status>=200&&this.status<=299||we<=0?it(this):(ae.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+we),Pe())},Ae.ontimeout=Ae.onerror=function(){we<=0?at(this):(ae.warn("License request network request failed . Retrying it... Pending retries: "+we),Pe())},Ae.onabort=function(){st(this)},A.trigger(I.LICENSE_REQUEST_SENDING,{url:Ce.url,headers:Ce.headers,payload:Ce.data,sessionId:Ce.sessionId}),Ae.send(Ce.data)}function ct(Ce,we,Qe,it,st){var at=null,Ae=it.message;if(Ce&&Ce.serverURL){var Be=Ce.serverURL;typeof Be=="string"&&Be!==""?at=Be:y(Be)==="object"&&Be.hasOwnProperty(we)&&(at=Be[we])}else if(Ce&&Ce.laURL&&Ce.laURL!=="")at=Ce.laURL;else if(at=i.default.getLicenseServerUrlFromMediaInfo(le,q.schemeIdURI),!at&&!b.isClearKey(q)){var We=i.default.getPSSHData(Qe.initData);at=q.getLicenseServerURLFromInitData(We),at||(at=it.laURL)}return at=st.getServerURLFromMessage(at,Ae,we),at}function xt(Ce,we){if(we)for(var Qe in we)Ce[Qe]=we[Qe]}function Bt(Ce,we,Qe,it,st){var at=Ce.response?st.getErrorResponse(Ce.response,Qe,it):"NONE";Ue(we,new c.default(u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Qe+' update, XHR complete. status is "'+Ce.statusText+'" ('+Ce.status+"), readyState is "+Ce.readyState+".  Response is "+at))}function Lt(Ce,we){return Ce?Ce.reduce(function(Qe,it){return Qe.then(function(){return it(we)})},Promise.resolve()):Promise.resolve()}function Pt(Ce,we){if(!J.get().streaming.protection.ignoreEmeEncryptedEvent){if(ae.debug("DRM: onNeedKey"),Ce.key.initDataType!=="cenc"){ae.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+Ce.key.initDataType);return}if(le.length===0&&(ae.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),we=typeof we=="undefined"?1:we+1,we<_)){k.push(setTimeout(function(){Pt(Ce,we)},g));return}var Qe=Ce.key.initData;if(ArrayBuffer.isView(Qe)&&(Qe=Qe.buffer),q){var it=i.default.getPSSHForKeySystem(q,Qe);if(it&&_e(it))return}ae.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(Qe)));var st=b.getSupportedKeySystemsFromSegmentPssh(Qe,me,de);if(st.length===0){ae.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");return}ue(st,!1)}}function Ht(){return b?b.getKeySystems():[]}function Oe(Ce){b&&b.setKeySystems(Ce)}function ze(Ce){pe=Ce}function Fe(Ce){he=Ce}return K={initializeForMedia:ie,clearMediaInfoArray:U,createKeySession:D,loadKeySession:L,removeKeySession:ee,closeKeySession:j,setServerCertificate:X,setMediaElement:z,setSessionType:oe,setRobustnessLevel:se,setProtectionData:ce,getSupportedKeySystemsFromContentProtection:fe,getKeySystems:Ht,setKeySystems:Oe,setLicenseRequestFilters:ze,setLicenseResponseFilters:Fe,stop:Se,reset:Me},Q(),K}w.__dashjs_factory_name="ProtectionController",r.default=M.default.getClassFactory(w)},"./src/streaming/protection/controllers/ProtectionKeyController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/CommonEncryption.js"),o=n("./src/streaming/protection/drm/KeySystemClearKey.js"),l=n("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),u=n("./src/streaming/protection/drm/KeySystemWidevine.js"),c=n("./src/streaming/protection/drm/KeySystemPlayReady.js"),f=n("./src/streaming/protection/servers/DRMToday.js"),h=n("./src/streaming/protection/servers/PlayReady.js"),p=n("./src/streaming/protection/servers/Widevine.js"),E=n("./src/streaming/protection/servers/ClearKey.js"),v=n("./src/streaming/constants/ProtectionConstants.js");function M(){var y=this.context,_,g,R,S,x,w,C;function b(de){!de||(de.debug&&(g=de.debug,R=g.getLogger(_)),de.BASE64&&(x=de.BASE64))}function P(){S=[];var de;de=Object(c.default)(y).getInstance({BASE64:x}),S.push(de),de=Object(u.default)(y).getInstance({BASE64:x}),S.push(de),de=Object(o.default)(y).getInstance({BASE64:x}),S.push(de),w=de,de=Object(l.default)(y).getInstance({BASE64:x,debug:g}),S.push(de),C=de}function A(){return S}function I(de){S=de}function F(de){for(var te=0;te<S.length;te++)if(S[te].systemString===de)return S[te];return null}function G(de){return de===w||de===C}function V(de,te){if(de.byteLength===te.byteLength){for(var q=new Uint8Array(de),Z=new Uint8Array(te),pe=0;pe<q.length;pe++)if(q[pe]!==Z[pe])return!1;return!0}return!1}function k(de,te,q){var Z,pe,he,Q,Y=[];if(de){var ie=i.default.findCencContentProtection(de);for(he=0;he<S.length;++he){pe=S[he];var ue=re(pe.systemString,te);for(Q=0;Q<de.length;++Q)if(Z=de[Q],Z.schemeIdUri.toLowerCase()===pe.schemeIdURI){var $=pe.getInitData(Z,ie);Y.push({ks:S[he],keyId:Z.keyId,initData:$,protData:ue,cdmData:pe.getCDMData(ue?ue.cdmData:null),sessionId:le(ue,Z),sessionType:me(ue,q)})}}}return Y}function H(de,te,q){for(var Z=[],pe=i.default.parsePSSHList(de),he,Q,Y=0;Y<S.length;++Y){he=S[Y],Q=he.systemString;var ie=re(Q,te);he.uuid in pe&&Z.push({ks:he,initData:pe[he.uuid],protData:ie,cdmData:he.getCDMData(ie?ie.cdmData:null),sessionId:le(ie),sessionType:me(ie,q)})}return Z}function J(de,te,q){if(q==="license-release"||q==="individualization-request")return null;var Z=null;return te&&te.hasOwnProperty("drmtoday")?Z=Object(f.default)(y).getInstance({BASE64:x}):de.systemString===v.default.WIDEVINE_KEYSTEM_STRING?Z=Object(p.default)(y).getInstance():de.systemString===v.default.PLAYREADY_KEYSTEM_STRING?Z=Object(h.default)(y).getInstance():de.systemString===v.default.CLEARKEY_KEYSTEM_STRING&&(Z=Object(E.default)(y).getInstance()),Z}function K(de,te,q){try{return de.getClearKeysFromProtectionData(te,q)}catch{return R.error("Failed to retrieve clearkeys from ProtectionData"),null}}function ae(de){for(var te=function(he){var Q=null;return de&&(Q=he in de?de[he]:null),Q},q=0;q<S.length;q++){var Z=S[q];Z.hasOwnProperty("init")&&Z.init(te(Z.systemString))}}function re(de,te){return te&&de in te?te[de]:null}function le(de,te){return de&&de.sessionId?de.sessionId:te&&te.sessionId?te.sessionId:null}function me(de,te){return de&&de.sessionType?de.sessionType:te}return _={initialize:P,setProtectionData:ae,isClearKey:G,initDataEquals:V,getKeySystems:A,setKeySystems:I,getKeySystemBySystemString:F,getSupportedKeySystemsFromContentProtection:k,getSupportedKeySystemsFromSegmentPssh:H,getLicenseServerModelInstance:J,processClearKeyLicenseRequest:K,setConfig:b},_}M.__dashjs_factory_name="ProtectionKeyController",r.default=dashjs.FactoryMaker.getSingletonFactory(M)},"./src/streaming/protection/drm/KeySystemClearKey.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/vo/KeyPair.js"),o=n("./src/streaming/protection/vo/ClearKeyKeySet.js"),l=n("./src/streaming/protection/CommonEncryption.js"),u=n("./src/streaming/constants/ProtectionConstants.js"),c="e2719d58-a985-b3c9-781a-b030af78d30e",f=u.default.CLEARKEY_KEYSTEM_STRING,h="urn:uuid:"+c;function p(E){E=E||{};var v,M=E.BASE64;function y(C,b){var P=null;if(C){for(var A=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b))),I=[],F=0;F<A.kids.length;F++){var G=A.kids[F],V=C.clearkeys&&C.clearkeys.hasOwnProperty(G)?C.clearkeys[G]:null;if(!V)throw new Error("DRM: ClearKey keyID ("+G+") is not known!");I.push(new i.default(G,V))}P=new o.default(I)}return P}function _(C,b){try{var P=l.default.parseInitDataFromContentProtection(C,M);if(!P&&b){var A=g(b["cenc:default_KID"]),I={kids:[A]};P=new TextEncoder().encode(JSON.stringify(I))}return P}catch{return null}}function g(C){try{var b=C.replace(/-/g,"");return b=btoa(b.match(/\w{2}/g).map(function(P){return String.fromCharCode(parseInt(P,16))}).join("")),b.replace(/=/g,"")}catch{return null}}function R(){return{"Content-Type":"application/json"}}function S(C){return JSON.parse(String.fromCharCode.apply(null,new Uint8Array(C)))}function x(){return null}function w(){return null}return v={uuid:c,schemeIdURI:h,systemString:f,getInitData:_,getRequestHeadersFromMessage:R,getLicenseRequestFromMessage:S,getLicenseServerURLFromInitData:x,getCDMData:w,getClearKeysFromProtectionData:y},v}p.__dashjs_factory_name="KeySystemClearKey",r.default=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/protection/drm/KeySystemPlayReady.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/CommonEncryption.js"),o=n("./src/streaming/constants/ProtectionConstants.js"),l="9a04f079-9840-4286-ab92-e65be0885f95",u=o.default.PLAYREADY_KEYSTEM_STRING,c="urn:uuid:"+l,f='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>';function h(p){p=p||{};var E,v="utf-16",M=p.BASE64;function y(){if(!M||!M.hasOwnProperty("decodeArray")||!M.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function _(C){var b,P,A={},I=new DOMParser,F=v==="utf-16"?new Uint16Array(C):new Uint8Array(C);b=String.fromCharCode.apply(null,F),P=I.parseFromString(b,"application/xml");for(var G=P.getElementsByTagName("name"),V=P.getElementsByTagName("value"),k=0;k<G.length;k++)A[G[k].childNodes[0].nodeValue]=V[k].childNodes[0].nodeValue;return A.hasOwnProperty("Content")&&(A["Content-Type"]=A.Content,delete A.Content),A.hasOwnProperty("Content-Type")||(A["Content-Type"]="text/xml; charset=utf-8"),A}function g(C){var b=null,P=new DOMParser,A=v==="utf-16"?new Uint16Array(C):new Uint8Array(C);y();var I=String.fromCharCode.apply(null,A),F=P.parseFromString(I,"application/xml");if(F.getElementsByTagName("PlayReadyKeyMessage")[0]){var G=F.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;G&&(b=M.decode(G))}else return C;return b}function R(C){if(C)for(var b=new DataView(C),P=b.getUint16(4,!0),A=6,I=new DOMParser,F=0;F<P;F++){var G=b.getUint16(A,!0);A+=2;var V=b.getUint16(A,!0);if(A+=2,G!==1){A+=V;continue}var k=C.slice(A,A+V),H=String.fromCharCode.apply(null,new Uint16Array(k)),J=I.parseFromString(H,"application/xml");if(J.getElementsByTagName("LA_URL")[0]){var K=J.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(K)return K}if(J.getElementsByTagName("LUI_URL")[0]){var ae=J.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(ae)return ae}}return null}function S(C){var b=new Uint8Array([112,115,115,104,0,0,0,0]),P=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),A=0,I=null,F,G,V,k,H;if(y(),!C)return null;if("pssh"in C)return i.default.parseInitDataFromContentProtection(C,M);if("pro"in C)I=M.decodeArray(C.pro.__text);else if("prheader"in C)I=M.decodeArray(C.prheader.__text);else return null;return F=I.length,G=4+b.length+P.length+4+F,V=new ArrayBuffer(G),k=new Uint8Array(V),H=new DataView(V),H.setUint32(A,G),A+=4,k.set(b,A),A+=b.length,k.set(P,A),A+=P.length,H.setUint32(A,F),A+=4,k.set(I,A),A+=F,k.buffer}function x(C){if(C!=="utf-8"&&C!=="utf-16")throw new Error('Specified message format is not one of "utf-8" or "utf-16"');v=C}function w(C){var b,P,A,I;if(y(),!C)return null;for(b=[],I=0;I<C.length;++I)b.push(C.charCodeAt(I)),b.push(0);for(b=String.fromCharCode.apply(null,b),b=M.encode(b),P=f.replace("%CUSTOMDATA%",b),A=[],I=0;I<P.length;++I)A.push(P.charCodeAt(I)),A.push(0);return new Uint8Array(A).buffer}return E={uuid:l,schemeIdURI:c,systemString:u,getInitData:S,getRequestHeadersFromMessage:_,getLicenseRequestFromMessage:g,getLicenseServerURLFromInitData:R,getCDMData:w,setPlayReadyMessageFormat:x},E}h.__dashjs_factory_name="KeySystemPlayReady",r.default=dashjs.FactoryMaker.getSingletonFactory(h)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/vo/KeyPair.js"),o=n("./src/streaming/protection/vo/ClearKeyKeySet.js"),l=n("./src/streaming/protection/CommonEncryption.js"),u=n("./src/streaming/constants/ProtectionConstants.js"),c="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",f=u.default.CLEARKEY_KEYSTEM_STRING,h="urn:uuid:"+c;function p(E){var v,M=E.BASE64,y=E.debug.getLogger(v);function _(C,b){var P=null;if(C){for(var A=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b))),I=[],F=0;F<A.kids.length;F++){var G=A.kids[F],V=C.clearkeys&&C.clearkeys.hasOwnProperty(G)?C.clearkeys[G]:null;if(!V)throw new Error("DRM: ClearKey keyID ("+G+") is not known!");I.push(new i.default(G,V))}P=new o.default(I),y.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return P}function g(C){return l.default.parseInitDataFromContentProtection(C,M)}function R(){return null}function S(C){return new Uint8Array(C)}function x(){return null}function w(){return null}return v={uuid:c,schemeIdURI:h,systemString:f,getInitData:g,getRequestHeadersFromMessage:R,getLicenseRequestFromMessage:S,getLicenseServerURLFromInitData:x,getCDMData:w,getClearKeysFromProtectionData:_},v}p.__dashjs_factory_name="KeySystemW3CClearKey",r.default=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/protection/drm/KeySystemWidevine.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/CommonEncryption.js"),o=n("./src/streaming/constants/ProtectionConstants.js"),l="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",u=o.default.WIDEVINE_KEYSTEM_STRING,c="urn:uuid:"+l;function f(h){h=h||{};var p,E=h.BASE64;function v(R){return i.default.parseInitDataFromContentProtection(R,E)}function M(){return null}function y(R){return new Uint8Array(R)}function _(){return null}function g(){return null}return p={uuid:l,schemeIdURI:c,systemString:u,getInitData:v,getRequestHeadersFromMessage:M,getLicenseRequestFromMessage:y,getLicenseServerURLFromInitData:_,getCDMData:g},p}f.__dashjs_factory_name="KeySystemWidevine",r.default=dashjs.FactoryMaker.getSingletonFactory(f)},"./src/streaming/protection/errors/ProtectionErrors.js":function(t,r,n){n.r(r);var i=n("./src/core/errors/ErrorsBase.js");function o(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(R){return typeof R}:o=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},o(_)}function l(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function u(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&c(_,g)}function c(_,g){return c=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},c(_,g)}function f(_){var g=E();return function(){var S=v(_),x;if(g){var w=v(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return h(this,x)}}function h(_,g){return g&&(o(g)==="object"||typeof g=="function")?g:p(_)}function p(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},v(_)}var M=function(_){u(R,_);var g=f(R);function R(){var S;return l(this,R),S=g.call(this),S.MEDIA_KEYERR_CODE=100,S.MEDIA_KEYERR_UNKNOWN_CODE=101,S.MEDIA_KEYERR_CLIENT_CODE=102,S.MEDIA_KEYERR_SERVICE_CODE=103,S.MEDIA_KEYERR_OUTPUT_CODE=104,S.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,S.MEDIA_KEYERR_DOMAIN_CODE=106,S.MEDIA_KEY_MESSAGE_ERROR_CODE=107,S.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,S.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,S.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,S.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,S.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,S.KEY_SESSION_CREATED_ERROR_CODE=113,S.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,S.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",S.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",S.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",S.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",S.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",S.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",S.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",S.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",S.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",S.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",S.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",S.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",S.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",S.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",S}return R}(i.default),y=new M;r.default=y},"./src/streaming/protection/models/ProtectionModel_01b.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),o=n("./src/streaming/protection/vo/NeedKey.js"),l=n("./src/streaming/vo/DashJSError.js"),u=n("./src/streaming/protection/vo/KeyMessage.js"),c=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),f=n("./src/streaming/protection/vo/KeySystemAccess.js"),h=n("./src/streaming/protection/errors/ProtectionErrors.js");function p(E){E=E||{};var v=this.context,M=E.eventBus,y=E.events,_=E.debug,g=E.api,R=E.errHandler,S,x,w,C,b,P,A,I,F;function G(){x=_.getLogger(S),w=null,C=null,P=[],A=[],b=Object(i.default)(v).getInstance(),F=Z()}function V(){w&&he();for(var Q=0;Q<A.length;Q++)me(A[Q]);M.trigger(y.TEARDOWN_COMPLETE)}function k(){for(var Q=[],Y=0;Y<P.length;Y++)Q.push(P[Y].initData);for(var ie=0;ie<A.length;ie++)Q.push(A[ie].initData);return Q}function H(){return A.concat(P)}function J(Q){return new Promise(function(Y,ie){var ue=w;ue||(ue=document.createElement("video"));for(var $=!1,W=0;W<Q.length;W++)for(var B=Q[W].ks.systemString,L=Q[W].configs,D=null,O=null,U=0;U<L.length;U++){var fe=L[U].videoCapabilities;if(fe&&fe.length!==0){O=[];for(var ye=0;ye<fe.length;ye++)ue.canPlayType(fe[ye].contentType,B)!==""&&O.push(fe[ye])}if(!(!D&&!O||D&&D.length===0||O&&O.length===0)){$=!0;var _e=new c.default(D,O),ee=b.getKeySystemBySystemString(B),j=new f.default(ee,_e);M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{data:j}),Y({data:j});break}}if(!$){var X="Key system access denied! -- No valid audio/video content configurations detected!";M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{error:X}),ie({error:X})}})}function K(Q){return C=Q.keySystem,Promise.resolve(C)}function ae(Q){if(w!==Q){if(w){he();for(var Y=0;Y<A.length;Y++)me(A[Y]);A=[]}w=Q,w&&(w.addEventListener(g.keyerror,F),w.addEventListener(g.needkey,F),w.addEventListener(g.keymessage,F),w.addEventListener(g.keyadded,F),M.trigger(y.VIDEO_ELEMENT_SELECTED))}}function re(Q){if(!C)throw new Error("Can not create sessions until you have selected a key system");if(I||A.length===0){var Y={sessionId:null,keyId:Q.keyId,initData:Q.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return P.push(Y),w[g.generateKeyRequest](C.systemString,new Uint8Array(Q.initData)),Y}else throw new Error("Multiple sessions not allowed!")}function le(Q,Y){var ie=Q.sessionId;if(!b.isClearKey(C))w[g.addKey](C.systemString,new Uint8Array(Y),new Uint8Array(Q.initData),ie);else for(var ue=0;ue<Y.keyPairs.length;ue++)w[g.addKey](C.systemString,Y.keyPairs[ue].key,Y.keyPairs[ue].keyID,ie);M.trigger(y.KEY_SESSION_UPDATED)}function me(Q){try{w[g.cancelKeyRequest](C.systemString,Q.sessionId)}catch(Y){M.trigger(y.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Q.sessionId+") "+Y.message})}}function de(){}function te(){}function q(){}function Z(){return{handleEvent:function(Y){var ie=null;switch(Y.type){case g.needkey:var ue=ArrayBuffer.isView(Y.initData)?Y.initData.buffer:Y.initData;M.trigger(y.NEED_KEY,{key:new o.default(ue,"cenc")});break;case g.keyerror:if(ie=pe(A,Y.sessionId),ie||(ie=pe(P,Y.sessionId)),ie){var $=h.default.MEDIA_KEYERR_CODE,W="";switch(Y.errorCode.code){case 1:$=h.default.MEDIA_KEYERR_UNKNOWN_CODE,W+="MEDIA_KEYERR_UNKNOWN - "+h.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:$=h.default.MEDIA_KEYERR_CLIENT_CODE,W+="MEDIA_KEYERR_CLIENT - "+h.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:$=h.default.MEDIA_KEYERR_SERVICE_CODE,W+="MEDIA_KEYERR_SERVICE - "+h.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:$=h.default.MEDIA_KEYERR_OUTPUT_CODE,W+="MEDIA_KEYERR_OUTPUT - "+h.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:$=h.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,W+="MEDIA_KEYERR_HARDWARECHANGE - "+h.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:$=h.default.MEDIA_KEYERR_DOMAIN_CODE,W+="MEDIA_KEYERR_DOMAIN - "+h.default.MEDIA_KEYERR_DOMAIN_MESSAGE;break}W+="  System Code = "+Y.systemCode,M.trigger(y.KEY_ERROR,{error:new l.default($,W,ie)})}else x.error("No session token found for key error");break;case g.keyadded:ie=pe(A,Y.sessionId),ie||(ie=pe(P,Y.sessionId)),ie?(x.debug("DRM: Key added."),M.trigger(y.KEY_ADDED,{data:ie})):x.debug("No session token found for key added");break;case g.keymessage:if(I=Y.sessionId!==null&&Y.sessionId!==void 0,I?(ie=pe(A,Y.sessionId),!ie&&P.length>0&&(ie=P.shift(),A.push(ie),ie.sessionId=Y.sessionId,M.trigger(y.KEY_SESSION_CREATED,{data:ie}))):P.length>0&&(ie=P.shift(),A.push(ie),P.length!==0&&R.error(new l.default(h.default.MEDIA_KEY_MESSAGE_ERROR_CODE,h.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),ie){var B=ArrayBuffer.isView(Y.message)?Y.message.buffer:Y.message;ie.keyMessage=B,M.trigger(y.INTERNAL_KEY_MESSAGE,{data:new u.default(ie,B,Y.defaultURL)})}else x.warn("No session token found for key message");break}}}}function pe(Q,Y){if(!Y||!Q)return null;for(var ie=Q.length,ue=0;ue<ie;ue++)if(Q[ue].sessionId==Y)return Q[ue];return null}function he(){w.removeEventListener(g.keyerror,F),w.removeEventListener(g.needkey,F),w.removeEventListener(g.keymessage,F),w.removeEventListener(g.keyadded,F)}return S={getAllInitData:k,getSessions:H,requestKeySystemAccess:J,selectKeySystem:K,setMediaElement:ae,createKeySession:re,updateKeySession:le,closeKeySession:me,setServerCertificate:de,loadKeySession:te,removeKeySession:q,stop:V,reset:V},G(),S}p.__dashjs_factory_name="ProtectionModel_01b",r.default=dashjs.FactoryMaker.getClassFactory(p)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),o=n("./src/streaming/protection/vo/NeedKey.js"),l=n("./src/streaming/protection/errors/ProtectionErrors.js"),u=n("./src/streaming/vo/DashJSError.js"),c=n("./src/streaming/protection/vo/KeyMessage.js"),f=n("./src/streaming/protection/vo/KeySystemAccess.js"),h=n("./src/streaming/constants/ProtectionConstants.js");function p(E){E=E||{};var v=this.context,M=E.eventBus,y=E.events,_=E.debug,g,R,S,x,w,C,b,P;function A(){R=_.getLogger(g),S=null,x=null,w=null,C=[],P=Object(i.default)(v).getInstance(),b=Z()}function I(){var Y=C.length,ie;Y!==0?function(){for(var ue=function(B){pe(B),C.length===0&&(x?(x.removeEventListener("encrypted",b),x.setMediaKeys(null).then(function(){M.trigger(y.TEARDOWN_COMPLETE)})):M.trigger(y.TEARDOWN_COMPLETE))},$=0;$<Y;$++)ie=C[$],function(W){ie.session.closed.then(function(){ue(W)}),q(ie).catch(function(){ue(W)})}(ie)}():M.trigger(y.TEARDOWN_COMPLETE)}function F(){for(var Y,ie=0;ie<C.length;ie++)Y=C[ie],Y.getUsable()||q(Y).catch(function(){pe(Y)})}function G(){for(var Y=[],ie=0;ie<C.length;ie++)C[ie].initData&&Y.push(C[ie].initData);return Y}function V(){return C}function k(Y){return new Promise(function(ie,ue){H(Y,0,ie,ue)})}function H(Y,ie,ue,$){if(navigator.requestMediaKeySystemAccess===void 0||typeof navigator.requestMediaKeySystemAccess!="function"){var W="Insecure origins are not allowed";M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{error:W}),$({error:W});return}var B=Y[ie].ks,L=Y[ie].configs,D=B.systemString;D===h.default.PLAYREADY_KEYSTEM_STRING&&L[0].persistentState==="required"&&(D+=".recommendation"),navigator.requestMediaKeySystemAccess(D,L).then(function(O){var U=typeof O.getConfiguration=="function"?O.getConfiguration():null,fe=new f.default(B,U);fe.mksa=O,M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{data:fe}),ue({data:fe})}).catch(function(O){if(ie+1<Y.length)H(Y,ie+1,ue,$);else{var U="Key system access denied! ";M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{error:U+O.message}),$({error:U+O.message})}})}function J(Y){return new Promise(function(ie,ue){Y.mksa.createMediaKeys().then(function($){return S=Y.keySystem,w=$,x?x.setMediaKeys(w):Promise.resolve()}).then(function(){ie(S)}).catch(function(){ue({error:"Error selecting keys system ("+Y.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})}function K(Y){x!==Y&&(x&&(x.removeEventListener("encrypted",b),x.setMediaKeys&&x.setMediaKeys(null)),x=Y,x&&(x.addEventListener("encrypted",b),x.setMediaKeys&&w&&x.setMediaKeys(w)))}function ae(Y){if(!S||!w)throw new Error("Can not set server certificate until you have selected a key system");w.setServerCertificate(Y).then(function(){R.info("DRM: License server certificate successfully updated."),M.trigger(y.SERVER_CERTIFICATE_UPDATED)}).catch(function(ie){M.trigger(y.SERVER_CERTIFICATE_UPDATED,{error:new u.default(l.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,l.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+ie.name)})})}function re(Y){if(!S||!w)throw new Error("Can not create sessions until you have selected a key system");var ie=w.createSession(Y.sessionType),ue=Q(ie,Y),$=S.systemString===h.default.CLEARKEY_KEYSTEM_STRING&&(Y.initData||Y.protData&&Y.protData.clearkeys)?h.default.INITIALIZATION_DATA_TYPE_KEYIDS:h.default.INITIALIZATION_DATA_TYPE_CENC;ie.generateRequest($,Y.initData).then(function(){R.debug("DRM: Session created.  SessionID = "+ue.getSessionId()),M.trigger(y.KEY_SESSION_CREATED,{data:ue})}).catch(function(W){pe(ue),M.trigger(y.KEY_SESSION_CREATED,{data:null,error:new u.default(l.default.KEY_SESSION_CREATED_ERROR_CODE,l.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+W.name)})})}function le(Y,ie){var ue=Y.session;P.isClearKey(S)&&(ie=ie.toJWK()),ue.update(ie).then(function(){M.trigger(y.KEY_SESSION_UPDATED)}).catch(function($){M.trigger(y.KEY_ERROR,{error:new u.default(l.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+$.name,Y)})})}function me(Y){if(!S||!w)throw new Error("Can not load sessions until you have selected a key system");for(var ie=Y.sessionId,ue=0;ue<C.length;ue++)if(ie===C[ue].sessionId){R.warn("DRM: Ignoring session ID because we have already seen it!");return}var $=w.createSession(Y.sessionType),W=Q($,Y);$.load(ie).then(function(B){B?(R.debug("DRM: Session loaded.  SessionID = "+W.getSessionId()),M.trigger(y.KEY_SESSION_CREATED,{data:W})):(pe(W),M.trigger(y.KEY_SESSION_CREATED,{data:null,error:new u.default(l.default.KEY_SESSION_CREATED_ERROR_CODE,l.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+ie+")")}))}).catch(function(B){pe(W),M.trigger(y.KEY_SESSION_CREATED,{data:null,error:new u.default(l.default.KEY_SESSION_CREATED_ERROR_CODE,l.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+ie+")! "+B.name)})})}function de(Y){var ie=Y.session;ie.remove().then(function(){R.debug("DRM: Session removed.  SessionID = "+Y.getSessionId()),M.trigger(y.KEY_SESSION_REMOVED,{data:Y.getSessionId()})},function(ue){M.trigger(y.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+Y.getSessionId()+"). "+ue.name})})}function te(Y){q(Y).catch(function(ie){pe(Y),M.trigger(y.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Y.getSessionId()+") "+ie.name})})}function q(Y){var ie=Y.session;return ie.removeEventListener("keystatuseschange",Y),ie.removeEventListener("message",Y),ie.close()}function Z(){return{handleEvent:function(ie){switch(ie.type){case"encrypted":if(ie.initData){var ue=ArrayBuffer.isView(ie.initData)?ie.initData.buffer:ie.initData;M.trigger(y.NEED_KEY,{key:new o.default(ue,ie.initDataType)})}break}}}}function pe(Y){for(var ie=0;ie<C.length;ie++)if(C[ie]===Y){C.splice(ie,1);break}}function he(Y){var ie,ue;return Y&&Y.length>0&&(Y[0]&&(typeof Y[0]=="string"?ie=Y[0]:ue=Y[0]),Y[1]&&(typeof Y[1]=="string"?ie=Y[1]:ue=Y[1])),{status:ie,keyId:ue}}function Q(Y,ie){var ue={session:Y,keyId:ie.keyId,initData:ie.initData,sessionId:ie.sessionId,sessionType:ie.sessionType,handleEvent:function(W){switch(W.type){case"keystatuseschange":M.trigger(y.KEY_STATUSES_CHANGED,{data:this}),W.target.keyStatuses.forEach(function(){var L=he(arguments);switch(L.status){case"expired":M.trigger(y.INTERNAL_KEY_STATUS_CHANGED,{error:new u.default(l.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,l.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:M.trigger(y.INTERNAL_KEY_STATUS_CHANGED,L);break}});break;case"message":var B=ArrayBuffer.isView(W.message)?W.message.buffer:W.message;M.trigger(y.INTERNAL_KEY_MESSAGE,{data:new c.default(this,B,void 0,W.messageType)});break}},getKeyId:function(){return this.keyId},getSessionId:function(){return Y.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return Y.expiration},getKeyStatuses:function(){return Y.keyStatuses},getUsable:function(){var W=!1;return Y.keyStatuses.forEach(function(){var B=he(arguments);B.status==="usable"&&(W=!0)}),W}};return Y.addEventListener("keystatuseschange",ue),Y.addEventListener("message",ue),Y.closed.then(function(){pe(ue),R.debug("DRM: Session closed.  SessionID = "+ue.getSessionId()),M.trigger(y.KEY_SESSION_CLOSED,{data:ue.getSessionId()})}),C.push(ue),ue}return g={getAllInitData:G,getSessions:V,requestKeySystemAccess:k,selectKeySystem:J,setMediaElement:K,setServerCertificate:ae,createKeySession:re,updateKeySession:le,loadKeySession:me,removeKeySession:de,closeKeySession:te,stop:F,reset:I},A(),g}p.__dashjs_factory_name="ProtectionModel_21Jan2015",r.default=dashjs.FactoryMaker.getClassFactory(p)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),o=n("./src/streaming/protection/vo/NeedKey.js"),l=n("./src/streaming/vo/DashJSError.js"),u=n("./src/streaming/protection/errors/ProtectionErrors.js"),c=n("./src/streaming/protection/vo/KeyMessage.js"),f=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),h=n("./src/streaming/protection/vo/KeySystemAccess.js");function p(E){E=E||{};var v=this.context,M=E.eventBus,y=E.events,_=E.debug,g=E.api,R,S,x,w,C,b,P,A,I;function F(){S=_.getLogger(R),x=null,w=null,C=null,b=null,P=[],I=Object(i.default)(v).getInstance(),A=q()}function G(){try{for(var he=0;he<P.length;he++)le(P[he]);x&&x.removeEventListener(g.needkey,A),M.trigger(y.TEARDOWN_COMPLETE)}catch(Q){M.trigger(y.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+Q.message})}}function V(){for(var he=[],Q=0;Q<P.length;Q++)he.push(P[Q].initData);return he}function k(){return P}function H(he){return new Promise(function(Q,Y){for(var ie=!1,ue=0;ue<he.length;ue++)for(var $=he[ue].ks.systemString,W=he[ue].configs,B=null,L=null,D=0;D<W.length;D++){var O=W[D].audioCapabilities,U=W[D].videoCapabilities;if(O&&O.length!==0){B=[];for(var fe=0;fe<O.length;fe++)window[g.MediaKeys].isTypeSupported($,O[fe].contentType)&&B.push(O[fe])}if(U&&U.length!==0){L=[];for(var ye=0;ye<U.length;ye++)window[g.MediaKeys].isTypeSupported($,U[ye].contentType)&&L.push(U[ye])}if(!(!B&&!L||B&&B.length===0||L&&L.length===0)){ie=!0;var _e=new f.default(B,L),ee=I.getKeySystemBySystemString($),j=new h.default(ee,_e);M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{data:j}),Q({data:j});break}}if(!ie){var X="Key system access denied! -- No valid audio/video content configurations detected!";M.trigger(y.KEY_SYSTEM_ACCESS_COMPLETE,{error:X}),Y({error:X})}})}function J(he){return new Promise(function(Q,Y){try{C=he.mediaKeys=new window[g.MediaKeys](he.keySystem.systemString),w=he.keySystem,b=he,x&&Z(),Q(w)}catch{Y({error:"Error selecting keys system ("+w.systemString+")! Could not create MediaKeys -- TODO"})}})}function K(he){x!==he&&(x&&x.removeEventListener(g.needkey,A),x=he,x&&(x.addEventListener(g.needkey,A),C&&Z()))}function ae(he){if(!w||!C||!b)throw new Error("Can not create sessions until you have selected a key system");var Q=null;if(b.ksConfiguration.videoCapabilities&&b.ksConfiguration.videoCapabilities.length>0&&(Q=b.ksConfiguration.videoCapabilities[0]),Q===null&&b.ksConfiguration.audioCapabilities&&b.ksConfiguration.audioCapabilities.length>0&&(Q=b.ksConfiguration.audioCapabilities[0]),Q===null)throw new Error("Can not create sessions for unknown content types.");var Y=Q.contentType,ie=C.createSession(Y,new Uint8Array(he.initData),he.cdmData?new Uint8Array(he.cdmData):null),ue=pe(ie,he);ie.addEventListener(g.error,ue),ie.addEventListener(g.message,ue),ie.addEventListener(g.ready,ue),ie.addEventListener(g.close,ue),P.push(ue),S.debug("DRM: Session created.  SessionID = "+ue.getSessionId()),M.trigger(y.KEY_SESSION_CREATED,{data:ue})}function re(he,Q){var Y=he.session;I.isClearKey(w)?Y.update(new Uint8Array(Q.toJWK())):Y.update(new Uint8Array(Q)),M.trigger(y.KEY_SESSION_UPDATED)}function le(he){var Q=he.session;Q.removeEventListener(g.error,he),Q.removeEventListener(g.message,he),Q.removeEventListener(g.ready,he),Q.removeEventListener(g.close,he);for(var Y=0;Y<P.length;Y++)if(P[Y]===he){P.splice(Y,1);break}Q[g.release]()}function me(){}function de(){}function te(){}function q(){return{handleEvent:function(Q){switch(Q.type){case g.needkey:if(Q.initData){var Y=ArrayBuffer.isView(Q.initData)?Q.initData.buffer:Q.initData;M.trigger(y.NEED_KEY,{key:new o.default(Y,"cenc")})}break}}}}function Z(){var he=null,Q=function(){x.removeEventListener("loadedmetadata",he),x[g.setMediaKeys](C),M.trigger(y.VIDEO_ELEMENT_SELECTED)};x.readyState>=1?Q():(he=Q.bind(this),x.addEventListener("loadedmetadata",he))}function pe(he,Q){return{session:he,keyId:Q.keyId,initData:Q.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(ie){switch(ie.type){case g.error:var ue="KeyError";M.trigger(y.KEY_ERROR,{error:new l.default(u.default.MEDIA_KEYERR_CODE,ue,this)});break;case g.message:var $=ArrayBuffer.isView(ie.message)?ie.message.buffer:ie.message;M.trigger(y.INTERNAL_KEY_MESSAGE,{data:new c.default(this,$,ie.destinationURL)});break;case g.ready:S.debug("DRM: Key added."),M.trigger(y.KEY_ADDED);break;case g.close:S.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),M.trigger(y.KEY_SESSION_CLOSED,{data:this.getSessionId()});break}}}}return R={getAllInitData:V,getSessions:k,requestKeySystemAccess:H,selectKeySystem:J,setMediaElement:K,createKeySession:ae,updateKeySession:re,closeKeySession:le,setServerCertificate:me,loadKeySession:de,removeKeySession:te,stop:G,reset:G},F(),R}p.__dashjs_factory_name="ProtectionModel_3Feb2014",r.default=dashjs.FactoryMaker.getClassFactory(p)},"./src/streaming/protection/servers/ClearKey.js":function(t,r,n){n.r(r);var i=n("./src/streaming/protection/vo/KeyPair.js"),o=n("./src/streaming/protection/vo/ClearKeyKeySet.js");function l(){var u;function c(v){return v}function f(){return"POST"}function h(){return"json"}function p(v){if(!v.hasOwnProperty("keys"))return null;for(var M=[],y=0;y<v.keys.length;y++){var _=v.keys[y],g=_.kid.replace(/=/g,""),R=_.k.replace(/=/g,"");M.push(new i.default(g,R))}return new o.default(M)}function E(v){return String.fromCharCode.apply(null,new Uint8Array(v))}return u={getServerURLFromMessage:c,getHTTPMethod:f,getResponseType:h,getLicenseMessage:p,getErrorResponse:E},u}l.__dashjs_factory_name="ClearKey",r.default=dashjs.FactoryMaker.getSingletonFactory(l)},"./src/streaming/protection/servers/DRMToday.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/ProtectionConstants.js");function o(l){l=l||{};var u=l.BASE64,c={};c[i.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(g){return u.decodeArray(g.license)},getErrorResponse:function(g){return g}},c[i.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(g){return g},getErrorResponse:function(g){return String.fromCharCode.apply(null,new Uint8Array(g))}};var f;function h(){if(!u||!u.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function p(_){return _}function E(){return"POST"}function v(_){return c[_].responseType}function M(_,g){return h(),c[g].getLicenseMessage(_)}function y(_,g){return c[g].getErrorResponse(_)}return f={getServerURLFromMessage:p,getHTTPMethod:E,getResponseType:v,getLicenseMessage:M,getErrorResponse:y},f}o.__dashjs_factory_name="DRMToday",r.default=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/protection/servers/PlayReady.js":function(t,r,n){n.r(r);function i(){var o,l="http://schemas.xmlsoap.org/soap/envelope/";function u(y){var _=String.fromCharCode.apply(null,new Uint8Array(y)),g=decodeURIComponent(escape(_));return g}function c(y){if(window.DOMParser){var _=u(y),g=new window.DOMParser,R=g.parseFromString(_,"text/xml"),S=R?R.getElementsByTagNameNS(l,"Envelope")[0]:null,x=S?S.getElementsByTagNameNS(l,"Body")[0]:null,w=x?x.getElementsByTagNameNS(l,"Fault")[0]:null;if(w)return null}return y}function f(y){var _="",g="",R="",S=-1,x=-1;if(window.DOMParser){var w=u(y),C=new window.DOMParser,b=C.parseFromString(w,"text/xml"),P=b?b.getElementsByTagNameNS(l,"Envelope")[0]:null,A=P?P.getElementsByTagNameNS(l,"Body")[0]:null,I=A?A.getElementsByTagNameNS(l,"Fault")[0]:null,F=I?I.getElementsByTagName("detail")[0]:null,G=F?F.getElementsByTagName("Exception")[0]:null,V=null;if(I===null)return w;V=I.getElementsByTagName("faultstring")[0].firstChild,_=V?V.nodeValue:null,G!==null&&(V=G.getElementsByTagName("StatusCode")[0],g=V?V.firstChild.nodeValue:null,V=G.getElementsByTagName("Message")[0],R=V?V.firstChild.nodeValue:null,S=R?R.lastIndexOf("[")+1:-1,x=R?R.indexOf("]"):-1,R=R?R.substring(S,x):"")}var k="code: ".concat(g,", name: ").concat(_);return R&&(k+=", message: ".concat(R)),k}function h(y){return y}function p(){return"POST"}function E(){return"arraybuffer"}function v(y){return c.call(this,y)}function M(y){return f.call(this,y)}return o={getServerURLFromMessage:h,getHTTPMethod:p,getResponseType:E,getLicenseMessage:v,getErrorResponse:M},o}i.__dashjs_factory_name="PlayReady",r.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/protection/servers/Widevine.js":function(t,r,n){n.r(r);function i(){var o;function l(p){return p}function u(){return"POST"}function c(){return"arraybuffer"}function f(p){return p}function h(p){return String.fromCharCode.apply(null,new Uint8Array(p))}return o={getServerURLFromMessage:l,getHTTPMethod:u,getResponseType:c,getLicenseMessage:f,getErrorResponse:h},o}i.__dashjs_factory_name="Widevine",r.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/protection/vo/ClearKeyKeySet.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f,h){if(i(this,c),h&&h!=="persistent"&&h!=="temporary")throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=f,this.type=h}return l(c,[{key:"toJWK",value:function(){var h,p=this.keyPairs.length,E={keys:[]};for(h=0;h<p;h++){var v={kty:"oct",alg:"A128KW",kid:this.keyPairs[h].keyID,k:this.keyPairs[h].key};E.keys.push(v)}this.type&&(E.type=this.type);var M=JSON.stringify(E),y=M.length,_=new ArrayBuffer(y),g=new Uint8Array(_);for(h=0;h<y;h++)g[h]=M.charCodeAt(h);return _}}]),c}();r.default=u},"./src/streaming/protection/vo/KeyMessage.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f,h){i(this,l),this.sessionToken=u,this.message=c,this.defaultURL=f,this.messageType=h||"license-request"};r.default=o},"./src/streaming/protection/vo/KeyPair.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c){i(this,l),this.keyID=u,this.key=c};r.default=o},"./src/streaming/protection/vo/KeySystemAccess.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c){i(this,l),this.keySystem=u,this.ksConfiguration=c};r.default=o},"./src/streaming/protection/vo/KeySystemConfiguration.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f,h,p){i(this,l),this.initDataTypes=["cenc"],u&&u.length&&(this.audioCapabilities=u),c&&c.length&&(this.videoCapabilities=c),this.distinctiveIdentifier=f,this.persistentState=h,this.sessionTypes=p};r.default=o},"./src/streaming/protection/vo/LicenseRequest.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f,h,p,E,v,M){i(this,l),this.url=u,this.method=c,this.responseType=f,this.headers=h,this.withCredentials=p,this.messageType=E,this.sessionId=v,this.data=M};r.default=o},"./src/streaming/protection/vo/LicenseResponse.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f){i(this,l),this.url=u,this.headers=c,this.data=f};r.default=o},"./src/streaming/protection/vo/MediaCapability.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c){i(this,l),this.contentType=u,this.robustness=c};r.default=o},"./src/streaming/protection/vo/NeedKey.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c){i(this,l),this.initData=u,this.initDataType=c};r.default=o},"./src/streaming/rules/DroppedFramesHistory.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(){var u={},c={},f={};function h(M,y,_){if(!!y){u[M]||(u[M]=[],c[M]=0,f[M]=0);var g=_&&_.droppedVideoFrames?_.droppedVideoFrames:0,R=_&&_.totalVideoFrames?_.totalVideoFrames:0,S=g-c;c[M]=g;var x=R-f;f[M]=R;var w=u[M];isNaN(y)||(w[y]?(w[y].droppedVideoFrames+=S,w[y].totalVideoFrames+=x):w[y]={droppedVideoFrames:S,totalVideoFrames:x})}}function p(M){return u[M]}function E(M){try{delete u[M],delete c[M],delete f[M]}catch{}}function v(){u={},c={},f={}}return{push:h,getFrameHistory:p,clearForStream:E,reset:v}}o.__dashjs_factory_name="DroppedFramesHistory";var l=i.default.getClassFactory(o);r.default=l},"./src/streaming/rules/RulesContext.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(l){l=l||{};var u,c=l.abrController,f=l.switchHistory,h=l.droppedFramesHistory,p=l.currentRequest,E=l.useBufferOccupancyABR,v=l.useL2AABR,M=l.useLoLPABR,y=l.streamProcessor?l.streamProcessor.getScheduleController():null,_=l.streamProcessor?l.streamProcessor.getRepresentationInfo():null,g=l.videoModel?l.videoModel:null;function R(){var H=x();return H?H.type:null}function S(){var H=x();return H?H.streamInfo:null}function x(){return _?_.mediaInfo:null}function w(){return _}function C(){return y}function b(){return c}function P(){return f}function A(){return g}function I(){return h}function F(){return p}function G(){return E}function V(){return v}function k(){return M}return u={getMediaType:R,getMediaInfo:x,getDroppedFramesHistory:I,getCurrentRequest:F,getSwitchHistory:P,getStreamInfo:S,getScheduleController:C,getAbrController:b,getRepresentationInfo:w,useBufferOccupancyABR:G,useL2AABR:V,useLoLPABR:k,getVideoModel:A},u}o.__dashjs_factory_name="RulesContext",r.default=i.default.getClassFactory(o)},"./src/streaming/rules/SwitchRequest.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=-1,l={DEFAULT:.5,STRONG:1,WEAK:0};function u(f,h,p){var E,v,M,y;function _(g){var R=l.DEFAULT;return(g===l.DEFAULT||g===l.STRONG||g===l.WEAK)&&(R=g),R}return v=f===void 0?o:f,M=_(p),y=h===void 0?null:h,E={quality:v,reason:y,priority:M},E}u.__dashjs_factory_name="SwitchRequest";var c=i.default.getClassFactory(u);c.NO_CHANGE=o,c.PRIORITY=l,i.default.updateClassFactory(u.__dashjs_factory_name,c),r.default=c},"./src/streaming/rules/SwitchRequestHistory.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/rules/SwitchRequest.js"),l=8;function u(){var f=[],h=[];function p(M){M.newValue===o.default.NO_CHANGE&&(M.newValue=M.oldValue),f[M.oldValue]||(f[M.oldValue]={noDrops:0,drops:0,dropSize:0});var y=M.newValue-M.oldValue,_=y<0?1:0,g=_?-y:0,R=_?0:1;if(f[M.oldValue].drops+=_,f[M.oldValue].dropSize+=g,f[M.oldValue].noDrops+=R,h.push({idx:M.oldValue,noDrop:R,drop:_,dropSize:g}),h.length>l){var S=h.shift();f[S.idx].drops-=S.drop,f[S.idx].dropSize-=S.dropSize,f[S.idx].noDrops-=S.noDrop}}function E(){return f}function v(){f=[],h=[]}return{push:p,getSwitchRequests:E,reset:v}}u.__dashjs_factory_name="SwitchRequestHistory";var c=i.default.getClassFactory(u);r.default=c},"./src/streaming/rules/ThroughputHistory.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/core/FactoryMaker.js");function l(u){u=u||{};var c=20,f=3,h=4,p=4,E=1.3,v=1.3,M=8,y=3,_=2,g=1,R=u.settings,S,x,w,C,b;function P(){b={throughputHalfLife:{fast:y,slow:M},latencyHalfLife:{fast:g,slow:_}},me()}function A(te,q,Z){if(te===i.default.VIDEO)return Z<R.get().streaming.cacheLoadThresholds[i.default.VIDEO];if(te===i.default.AUDIO)return Z<R.get().streaming.cacheLoadThresholds[i.default.AUDIO]}function I(te,q,Z){if(!(!q.trace||!q.trace.length)){var pe=q.tresponse.getTime()-q.trequest.getTime()||1,he=q._tfinish.getTime()-q.tresponse.getTime()||1,Q=q.trace.reduce(function(W,B){return W+B.b[0]},0),Y=0,ie=0;if(R.get().streaming.lowLatencyEnabled){var ue=R.get().streaming.abr.fetchThroughputCalculationMode;if(ue===i.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING){var $=q.trace.reduce(function(W,B){return W+B.t},0);ie=Math.round($/q.trace.length)}ie===0&&(Y=q.trace.reduce(function(W,B){return W+B.d},0))}else Y=Z?he:pe+he;if(Y!==0&&(ie=Math.round(8*Q/Y)),re(te),A(te,pe,he)){if(S[te].length>0&&!S[te].hasCachedEntries)return;S[te].hasCachedEntries=!0}else S[te]&&S[te].hasCachedEntries&&le(te);S[te].push(ie),S[te].length>c&&S[te].shift(),x[te].push(pe),x[te].length>c&&x[te].shift(),F(w[te],ie,.001*he,b.throughputHalfLife),F(C[te],pe,1,b.latencyHalfLife)}}function F(te,q,Z,pe){var he=Math.pow(.5,Z/pe.fast);te.fastEstimate=(1-he)*q+he*te.fastEstimate;var Q=Math.pow(.5,Z/pe.slow);te.slowEstimate=(1-Q)*q+Q*te.slowEstimate,te.totalWeight+=Z}function G(te,q,Z){var pe,he;if(te?(pe=S[q],he=Z?f:h):(pe=x[q],he=p),!pe)he=0;else if(he>=pe.length)he=pe.length;else if(te)for(var Q=1;Q<he;++Q){var Y=pe[pe.length-Q]/pe[pe.length-Q-1];if((Y>=v||Y<=1/E)&&(he+=1,he===pe.length))break}return he}function V(te,q,Z){return R.get().streaming.abr.movingAverageMethod!==i.default.MOVING_AVERAGE_SLIDING_WINDOW?H(te,q):k(te,q,Z)}function k(te,q,Z){var pe=G(te,q,Z),he=te?S:x,Q=he[q];return pe===0||!Q||Q.length===0?NaN:(Q=Q.slice(-pe),Q.reduce(function(Y,ie){return Y+ie})/Q.length)}function H(te,q){var Z=te?b.throughputHalfLife:b.latencyHalfLife,pe=te?w[q]:C[q];if(!pe||pe.totalWeight<=0)return NaN;var he=pe.fastEstimate/(1-Math.pow(.5,pe.totalWeight/Z.fast)),Q=pe.slowEstimate/(1-Math.pow(.5,pe.totalWeight/Z.slow));return te?Math.min(he,Q):Math.max(he,Q)}function J(te,q){return V(!0,te,q)}function K(te,q){var Z=J(te,q);return isNaN(Z)||(Z*=R.get().streaming.abr.bandwidthSafetyFactor),Z}function ae(te){return V(!1,te)}function re(te){S[te]=S[te]||[],x[te]=x[te]||[],w[te]=w[te]||{fastEstimate:0,slowEstimate:0,totalWeight:0},C[te]=C[te]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function le(te){delete S[te],delete x[te],delete w[te],delete C[te],re(te)}function me(){S={},x={},w={},C={}}var de={push:I,getAverageThroughput:J,getSafeAverageThroughput:K,getAverageLatency:ae,reset:me};return P(),de}l.__dashjs_factory_name="ThroughputHistory",r.default=o.default.getClassFactory(l)},"./src/streaming/rules/abr/ABRRulesCollection.js":function(t,r,n){n.r(r);var i=n("./src/streaming/rules/abr/ThroughputRule.js"),o=n("./src/streaming/rules/abr/InsufficientBufferRule.js"),l=n("./src/streaming/rules/abr/AbandonRequestsRule.js"),u=n("./src/streaming/rules/abr/DroppedFramesRule.js"),c=n("./src/streaming/rules/abr/SwitchHistoryRule.js"),f=n("./src/streaming/rules/abr/BolaRule.js"),h=n("./src/streaming/rules/abr/L2ARule.js"),p=n("./src/streaming/rules/abr/lolp/LoLpRule.js"),E=n("./src/core/FactoryMaker.js"),v=n("./src/streaming/rules/SwitchRequest.js"),M=n("./src/streaming/constants/Constants.js"),y="qualitySwitchRules",_="abandonFragmentRules";function g(S){S=S||{};var x=this.context,w=S.mediaPlayerModel,C=S.dashMetrics,b=S.settings,P,A,I;function F(){A=[],I=[],b.get().streaming.abr.useDefaultABRRules&&(b.get().streaming.abr.ABRStrategy===M.default.ABR_STRATEGY_L2A?A.push(Object(h.default)(x).create({dashMetrics:C,mediaPlayerModel:w,settings:b})):b.get().streaming.abr.ABRStrategy===M.default.ABR_STRATEGY_LoLP?A.push(Object(p.default)(x).create({dashMetrics:C})):(A.push(Object(f.default)(x).create({dashMetrics:C,mediaPlayerModel:w,settings:b})),A.push(Object(i.default)(x).create({dashMetrics:C})),b.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&A.push(Object(o.default)(x).create({dashMetrics:C,settings:b})),b.get().streaming.abr.additionalAbrRules.switchHistoryRule&&A.push(Object(c.default)(x).create()),b.get().streaming.abr.additionalAbrRules.droppedFramesRule&&A.push(Object(u.default)(x).create()),b.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&I.push(Object(l.default)(x).create({dashMetrics:C,mediaPlayerModel:w,settings:b}))));var ae=w.getABRCustomRules();ae.forEach(function(re){re.type===y&&A.push(re.rule(x).create()),re.type===_&&I.push(re.rule(x).create())})}function G(ae){return ae.filter(function(re){return re.quality>v.default.NO_CHANGE})}function V(ae){var re={},le=null,me,de,te,q,Z;if(ae.length!==0){for(re[v.default.PRIORITY.STRONG]={quality:v.default.NO_CHANGE,reason:null},re[v.default.PRIORITY.WEAK]={quality:v.default.NO_CHANGE,reason:null},re[v.default.PRIORITY.DEFAULT]={quality:v.default.NO_CHANGE,reason:null},me=0,de=ae.length;me<de;me+=1)te=ae[me],te.quality!==v.default.NO_CHANGE&&(re[te.priority].quality===v.default.NO_CHANGE||re[te.priority].quality>te.quality)&&(re[te.priority].quality=te.quality,re[te.priority].reason=te.reason||null);return re[v.default.PRIORITY.WEAK].quality!==v.default.NO_CHANGE&&(le=re[v.default.PRIORITY.WEAK]),re[v.default.PRIORITY.DEFAULT].quality!==v.default.NO_CHANGE&&(le=re[v.default.PRIORITY.DEFAULT]),re[v.default.PRIORITY.STRONG].quality!==v.default.NO_CHANGE&&(le=re[v.default.PRIORITY.STRONG]),le&&(q=le.quality,Z=le.reason),Object(v.default)(x).create(q,Z)}}function k(ae){var re=A.map(function(de){return de.getMaxIndex(ae)}),le=G(re),me=V(le);return me||Object(v.default)(x).create()}function H(ae,re){var le=I.map(function(te){return te.shouldAbandon(ae,re)}),me=G(le),de=V(me);return de||Object(v.default)(x).create()}function J(){[A,I].forEach(function(ae){ae&&ae.length&&ae.forEach(function(re){return re.reset&&re.reset()})}),A=[],I=[]}function K(){return A}return P={initialize:F,reset:J,getMaxQuality:k,getMinSwitchRequest:V,shouldAbandonFragment:H,getQualitySwitchRules:K},P}g.__dashjs_factory_name="ABRRulesCollection";var R=E.default.getClassFactory(g);R.QUALITY_SWITCH_RULES=y,R.ABANDON_FRAGMENT_RULES=_,E.default.updateSingletonFactory(g.__dashjs_factory_name,R),r.default=R},"./src/streaming/rules/abr/AbandonRequestsRule.js":function(t,r,n){n.r(r);var i=n("./src/streaming/rules/SwitchRequest.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/core/Debug.js");function u(c){c=c||{};var f=1.8,h=500,p=5,E=this.context,v=c.mediaPlayerModel,M=c.dashMetrics,y=c.settings,_,g,R,S,x;function w(){g=Object(l.default)(E).getInstance().getLogger(_),A()}function C(I,F){R[I]=R[I]||{},R[I][F]=R[I][F]||{}}function b(I,F){x[I]=x[I]||[],x[I].push(F)}function P(I){var F=Object(i.default)(E).create(i.default.NO_CHANGE,{name:u.__dashjs_factory_name});if(!I||!I.hasOwnProperty("getMediaInfo")||!I.hasOwnProperty("getMediaType")||!I.hasOwnProperty("getCurrentRequest")||!I.hasOwnProperty("getRepresentationInfo")||!I.hasOwnProperty("getAbrController"))return F;var G=I.getMediaInfo(),V=I.getMediaType(),k=I.getStreamInfo(),H=k?k.id:null,J=I.getCurrentRequest();if(!isNaN(J.index)){C(V,J.index);var K=v.getStableBufferTime(),ae=M.getCurrentBufferLevel(V);if(ae>K)return F;var re=R[V][J.index];if(re===null||J.firstByteDate===null||S.hasOwnProperty(re.id))return F;if(re.firstByteTime===void 0&&(x[V]=[],re.firstByteTime=J.firstByteDate.getTime(),re.segmentDuration=J.duration,re.bytesTotal=J.bytesTotal,re.id=J.index),re.bytesLoaded=J.bytesLoaded,re.elapsedTime=new Date().getTime()-re.firstByteTime,re.bytesLoaded>0&&re.elapsedTime>0&&b(V,Math.round(re.bytesLoaded*8/re.elapsedTime)),x[V].length>=p&&re.elapsedTime>h&&re.bytesLoaded<re.bytesTotal){var le=x[V].reduce(function(Q,Y){return Q+Y},0);if(re.measuredBandwidthInKbps=Math.round(le/x[V].length),re.estimatedTimeOfDownload=+(re.bytesTotal*8/re.measuredBandwidthInKbps/1e3).toFixed(2),re.estimatedTimeOfDownload<re.segmentDuration*f||I.getRepresentationInfo().quality===0)return F;if(!S.hasOwnProperty(re.id)){var me=I.getAbrController(),de=re.bytesTotal-re.bytesLoaded,te=me.getBitrateList(G),q=me.getQualityForBitrate(G,re.measuredBandwidthInKbps*y.get().streaming.abr.bandwidthSafetyFactor,H),Z=me.getMinAllowedIndexFor(V,H),pe=Z!==void 0?Math.max(Z,q):q,he=re.bytesTotal*te[pe].bitrate/te[me.getQualityFor(V,H)].bitrate;de>he&&(F.quality=pe,F.reason.throughput=re.measuredBandwidthInKbps,F.reason.fragmentID=re.id,S[re.id]=re,g.debug("["+V+"] frag id",re.id," is asking to abandon and switch to quality to ",pe," measured bandwidth was",re.measuredBandwidthInKbps),delete R[V][re.id])}}else re.bytesLoaded===re.bytesTotal&&delete R[V][re.id]}return F}function A(){R={},S={},x=[]}return _={shouldAbandon:P,reset:A},w(),_}u.__dashjs_factory_name="AbandonRequestsRule",r.default=o.default.getClassFactory(u)},"./src/streaming/rules/abr/BolaRule.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/MetricsConstants.js"),o=n("./src/streaming/rules/SwitchRequest.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/vo/metrics/HTTPRequest.js"),c=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),h=n("./src/core/Debug.js"),p=n("./src/streaming/MediaPlayerEvents.js"),E=0,v=1,M=2,y=10,_=2,g=.99;function R(S){S=S||{};var x=this.context,w=S.dashMetrics,C=S.mediaPlayerModel,b=Object(c.default)(x).getInstance(),P,A,I;function F(){A=Object(h.default)(x).getInstance().getLogger(P),ie(),b.on(p.default.BUFFER_EMPTY,de,P),b.on(p.default.PLAYBACK_SEEKING,te,P),b.on(p.default.METRIC_ADDED,Z,P),b.on(p.default.QUALITY_CHANGE_REQUESTED,he,P),b.on(p.default.FRAGMENT_LOADING_ABANDONED,Q,P),b.on(f.default.MEDIA_FRAGMENT_LOADED,q,P)}function G($){return $.map(function(W){return Math.log(W)})}function V($,W,B){var L=B.reduce(function(fe,ye,_e){return ye>B[fe]?_e:fe},0);if(L===0)return null;var D=Math.max($,y+_*W.length),O=(B[L]-1)/(D/y-1),U=y/O;return{gp:O,Vp:U}}function k($){var W={},B=$.getMediaInfo(),L=B.bitrateList.map(function(fe){return fe.bandwidth}),D=G(L);D=D.map(function(fe){return fe-D[0]+1});var O=C.getStableBufferTime(),U=V(O,L,D);return U?(W.state=v,W.bitrates=L,W.utilities=D,W.stableBufferTime=O,W.Vp=U.Vp,W.gp=U.gp,W.lastQuality=0,H(W)):W.state=E,W}function H($){$.placeholderBuffer=0,$.mostAdvancedSegmentStart=NaN,$.lastSegmentWasReplacement=!1,$.lastSegmentStart=NaN,$.lastSegmentDurationS=NaN,$.lastSegmentRequestTimeMs=NaN,$.lastSegmentFinishTimeMs=NaN}function J($,W){var B=C.getStableBufferTime();if($.stableBufferTime!==B){var L=V(B,$.bitrates,$.utilities);if(L.Vp!==$.Vp||L.gp!==$.gp){var D=w.getCurrentBufferLevel(W),O=D+$.placeholderBuffer;O-=y,O*=L.Vp/$.Vp,O+=y,$.stableBufferTime=B,$.Vp=L.Vp,$.gp=L.gp,$.placeholderBuffer=Math.max(0,O-D)}}}function K($){var W=$.getMediaType(),B=I[W];return B?B.state!==E&&J(B,W):(B=k($),I[W]=B),B}function ae($,W){for(var B=$.bitrates.length,L=NaN,D=NaN,O=0;O<B;++O){var U=($.Vp*($.utilities[O]+$.gp)-W)/$.bitrates[O];(isNaN(D)||U>=D)&&(D=U,L=O)}return L}function re($,W){return $.Vp*($.utilities[W]+$.gp)}function le($,W){for(var B=$.bitrates[W],L=$.utilities[W],D=0,O=W-1;O>=0;--O)if($.utilities[O]<$.utilities[W]){var U=$.bitrates[O],fe=$.utilities[O],ye=$.Vp*($.gp+(B*fe-U*L)/(B-U));D=Math.max(D,ye)}return D}function me($,W){var B=Date.now();if(isNaN($.lastSegmentFinishTimeMs)){if(!isNaN($.lastCallTimeMs)){var D=.001*(B-$.lastCallTimeMs);$.placeholderBuffer+=Math.max(0,D)}}else{var L=.001*(B-$.lastSegmentFinishTimeMs);$.placeholderBuffer+=Math.max(0,L)}$.lastCallTimeMs=B,$.lastSegmentStart=NaN,$.lastSegmentRequestTimeMs=NaN,$.lastSegmentFinishTimeMs=NaN,J($,W)}function de(){for(var $ in I)I.hasOwnProperty($)&&I[$].state===M&&(I[$].placeholderBuffer=0)}function te(){for(var $ in I)if(I.hasOwnProperty($)){var W=I[$];W.state!==E&&(W.state=v,H(W))}}function q($){if($&&$.chunk&&$.chunk.mediaInfo){var W=I[$.chunk.mediaInfo.type];if(W&&W.state!==E){var B=$.chunk.start;isNaN(W.mostAdvancedSegmentStart)||B>W.mostAdvancedSegmentStart?(W.mostAdvancedSegmentStart=B,W.lastSegmentWasReplacement=!1):W.lastSegmentWasReplacement=!0,W.lastSegmentStart=B,W.lastSegmentDurationS=$.chunk.duration,W.lastQuality=$.chunk.quality,pe(W,$.chunk.mediaInfo.type)}}}function Z($){if($&&$.metric===i.default.HTTP_REQUEST&&$.value&&$.value.type===u.HTTPRequest.MEDIA_SEGMENT_TYPE&&$.value.trace&&$.value.trace.length){var W=I[$.mediaType];W&&W.state!==E&&(W.lastSegmentRequestTimeMs=$.value.trequest.getTime(),W.lastSegmentFinishTimeMs=$.value._tfinish.getTime(),pe(W,$.mediaType))}}function pe($,W){if(!isNaN($.lastSegmentStart)&&!isNaN($.lastSegmentRequestTimeMs)&&!isNaN($.placeholderBuffer)){if($.placeholderBuffer*=g,!isNaN($.lastSegmentFinishTimeMs)){var B=w.getCurrentBufferLevel(W),L=B+.001*($.lastSegmentFinishTimeMs-$.lastSegmentRequestTimeMs),D=re($,$.lastQuality),O=Math.max(0,D-L);$.placeholderBuffer=Math.min(O,$.placeholderBuffer)}$.lastSegmentWasReplacement&&!isNaN($.lastSegmentDurationS)&&($.placeholderBuffer+=$.lastSegmentDurationS),$.lastSegmentStart=NaN,$.lastSegmentRequestTimeMs=NaN}}function he($){if($){var W=I[$.mediaType];W&&W.state!==E&&(W.abrQuality=$.newQuality)}}function Q($){if($){var W=I[$.mediaType];if(W&&W.state!==E){var B=w.getCurrentBufferLevel($.mediaType),L;W.abrQuality>0?L=le(W,W.abrQuality):L=y;var D=Math.max(0,L-B);W.placeholderBuffer=Math.min(W.placeholderBuffer,D)}}}function Y($){var W=Object(o.default)(x).create();if(!$||!$.hasOwnProperty("getMediaInfo")||!$.hasOwnProperty("getMediaType")||!$.hasOwnProperty("getScheduleController")||!$.hasOwnProperty("getStreamInfo")||!$.hasOwnProperty("getAbrController")||!$.hasOwnProperty("useBufferOccupancyABR"))return W;var B=$.getMediaInfo(),L=$.getMediaType(),D=$.getScheduleController(),O=$.getStreamInfo(),U=$.getAbrController(),fe=U.getThroughputHistory(),ye=O?O.id:null,_e=O&&O.manifestInfo&&O.manifestInfo.isDynamic,ee=$.useBufferOccupancyABR();if(W.reason=W.reason||{},!ee)return W;D.setTimeToLoadDelay(0);var j=K($);if(j.state===E)return W;var X=w.getCurrentBufferLevel(L),z=fe.getAverageThroughput(L,_e),oe=fe.getSafeAverageThroughput(L,_e),se=fe.getAverageLatency(L),ce;if(W.reason.state=j.state,W.reason.throughput=z,W.reason.latency=se,isNaN(z))return W;switch(j.state){case v:ce=U.getQualityForBitrate(B,oe,ye,se),W.quality=ce,W.reason.throughput=oe,j.placeholderBuffer=Math.max(0,le(j,ce)-X),j.lastQuality=ce,!isNaN(j.lastSegmentDurationS)&&X>=j.lastSegmentDurationS&&(j.state=M);break;case M:me(j,L),ce=ae(j,X+j.placeholderBuffer);var Se=U.getQualityForBitrate(B,oe,ye,se);ce>j.lastQuality&&ce>Se&&(ce=Math.max(Se,j.lastQuality));var Me=Math.max(0,X+j.placeholderBuffer-re(j,ce));Me<=j.placeholderBuffer?(j.placeholderBuffer-=Me,Me=0):(Me-=j.placeholderBuffer,j.placeholderBuffer=0,ce<U.getMaxAllowedIndexFor(L,ye)?D.setTimeToLoadDelay(1e3*Me):Me=0),W.quality=ce,W.reason.throughput=z,W.reason.latency=se,W.reason.bufferLevel=X,W.reason.placeholderBuffer=j.placeholderBuffer,W.reason.delay=Me,j.lastQuality=ce;break;default:A.debug("BOLA ABR rule invoked in bad state."),W.quality=U.getQualityForBitrate(B,oe,ye,se),W.reason.state=j.state,W.reason.throughput=oe,W.reason.latency=se,j.state=v,H(j)}return W}function ie(){I={}}function ue(){ie(),b.off(p.default.BUFFER_EMPTY,de,P),b.off(p.default.PLAYBACK_SEEKING,te,P),b.off(p.default.METRIC_ADDED,Z,P),b.off(p.default.QUALITY_CHANGE_REQUESTED,he,P),b.off(p.default.FRAGMENT_LOADING_ABANDONED,Q,P),b.off(f.default.MEDIA_FRAGMENT_LOADED,q,P)}return P={getMaxIndex:Y,reset:ue},F(),P}R.__dashjs_factory_name="BolaRule",r.default=l.default.getClassFactory(R)},"./src/streaming/rules/abr/DroppedFramesRule.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/rules/SwitchRequest.js"),l=n("./src/core/Debug.js");function u(){var c=this.context,f,h,p=.15,E=375;function v(){h=Object(l.default)(c).getInstance().getLogger(f)}function M(y){var _=Object(o.default)(c).create();if(!y||!y.hasOwnProperty("getDroppedFramesHistory"))return _;var g=y.getDroppedFramesHistory(),R=y.getStreamInfo().id;if(g){var S=g.getFrameHistory(R);if(!S||S.length===0)return _;for(var x=0,w=0,C=o.default.NO_CHANGE,b=1;b<S.length;b++)if(S[b]&&(x=S[b].droppedVideoFrames,w=S[b].totalVideoFrames,w>E&&x/w>p)){C=b-1,h.debug("index: "+C+" Dropped Frames: "+x+" Total Frames: "+w);break}return Object(o.default)(c).create(C,{droppedFrames:x})}return _}return f={getMaxIndex:M},v(),f}u.__dashjs_factory_name="DroppedFramesRule",r.default=i.default.getClassFactory(u)},"./src/streaming/rules/abr/InsufficientBufferRule.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/core/Debug.js"),c=n("./src/streaming/rules/SwitchRequest.js"),f=n("./src/streaming/constants/Constants.js"),h=n("./src/streaming/constants/MetricsConstants.js"),p=n("./src/streaming/MediaPlayerEvents.js");function E(v){v=v||{};var M=.5,y=2,_=this.context,g=Object(i.default)(_).getInstance(),R=v.dashMetrics,S=v.settings,x,w,C;function b(){w=Object(u.default)(_).getInstance().getLogger(x),F(),g.on(p.default.PLAYBACK_SEEKING,G,x),g.on(o.default.BYTES_APPENDED_END_FRAGMENT,V,x)}function P(){if(!R||!R.hasOwnProperty("getCurrentBufferLevel")||!R.hasOwnProperty("getCurrentBufferState"))throw new Error(f.default.MISSING_CONFIG_ERROR)}function A(H){var J=Object(c.default)(_).create();if(!H||!H.hasOwnProperty("getMediaType"))return J;P();var K=H.getMediaType(),ae=R.getCurrentBufferState(K),re=H.getRepresentationInfo(),le=re.fragmentDuration,me=H.getStreamInfo(),de=me?me.id:null,te=me&&me.manifestInfo&&me.manifestInfo.isDynamic;if(I(K)||!le)return J;if(ae&&ae.state===h.default.BUFFER_EMPTY)w.debug("["+K+"] Switch to index 0; buffer is empty."),J.quality=0,J.reason="InsufficientBufferRule: Buffer is empty";else{var q=H.getMediaInfo(),Z=H.getAbrController(),pe=Z.getThroughputHistory(),he=R.getCurrentBufferLevel(K),Q=pe.getAverageThroughput(K,te),Y=pe.getAverageLatency(K),ie=Q*(he/le)*M;J.quality=Z.getQualityForBitrate(q,ie,de,Y),J.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return J}function I(H){return!S.get().streaming.lowLatencyEnabled&&C[H].ignoreCount>0}function F(){C={},C[f.default.VIDEO]={ignoreCount:y},C[f.default.AUDIO]={ignoreCount:y}}function G(){F()}function V(H){!isNaN(H.startTime)&&(H.mediaType===f.default.AUDIO||H.mediaType===f.default.VIDEO)&&C[H.mediaType].ignoreCount>0&&C[H.mediaType].ignoreCount--}function k(){F(),g.off(p.default.PLAYBACK_SEEKING,G,x),g.off(o.default.BYTES_APPENDED_END_FRAGMENT,V,x)}return x={getMaxIndex:A,reset:k},b(),x}E.__dashjs_factory_name="InsufficientBufferRule",r.default=l.default.getClassFactory(E)},"./src/streaming/rules/abr/L2ARule.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/MetricsConstants.js"),o=n("./src/streaming/rules/SwitchRequest.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/vo/metrics/HTTPRequest.js"),c=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),h=n("./src/core/Debug.js"),p=n("./src/streaming/constants/Constants.js"),E=0,v=1,M=2;function y(_){_=_||{};var g=this.context,R=_.dashMetrics,S=Object(c.default)(g).getInstance(),x,w,C,b;function P(){b=Object(h.default)(g).getInstance().getLogger(x),me(),S.on(f.default.PLAYBACK_SEEKING,V,x),S.on(f.default.MEDIA_FRAGMENT_LOADED,k,x),S.on(f.default.METRIC_ADDED,H,x),S.on(f.default.QUALITY_CHANGE_REQUESTED,K,x)}function A(te){var q={},Z=te.getMediaInfo(),pe=Z.bitrateList.map(function(he){return he.bandwidth/1e3});return q.state=v,q.bitrates=pe,q.lastQuality=0,I(Z),F(q),q}function I(te){!te||!te.type||(C[te.type]={},C[te.type].w=[],C[te.type].prev_w=[],C[te.type].Q=0,C[te.type].segment_request_start_s=0,C[te.type].segment_download_finish_s=0,C[te.type].B_target=1.5)}function F(te){te.placeholderBuffer=0,te.mostAdvancedSegmentStart=NaN,te.lastSegmentWasReplacement=!1,te.lastSegmentStart=NaN,te.lastSegmentDurationS=NaN,te.lastSegmentRequestTimeMs=NaN,te.lastSegmentFinishTimeMs=NaN}function G(te){var q=te.getMediaType(),Z=w[q];return Z||(Z=A(te),w[q]=Z),Z}function V(){for(var te in w)if(w.hasOwnProperty(te)){var q=w[te];q.state!==E&&(q.state=v,F(q))}}function k(te){if(te&&te.chunk&&te.chunk.mediaInfo){var q=w[te.chunk.mediaInfo.type],Z=C[te.chunk.mediaInfo.type];if(q&&q.state!==E){var pe=te.chunk.start;isNaN(q.mostAdvancedSegmentStart)||pe>q.mostAdvancedSegmentStart?(q.mostAdvancedSegmentStart=pe,q.lastSegmentWasReplacement=!1):q.lastSegmentWasReplacement=!0,q.lastSegmentStart=pe,q.lastSegmentDurationS=te.chunk.duration,q.lastQuality=te.chunk.quality,J(q,Z)}}}function H(te){if(te&&te.metric===i.default.HTTP_REQUEST&&te.value&&te.value.type===u.HTTPRequest.MEDIA_SEGMENT_TYPE&&te.value.trace&&te.value.trace.length){var q=w[te.mediaType],Z=C[te.mediaType];q&&q.state!==E&&(q.lastSegmentRequestTimeMs=te.value.trequest.getTime(),q.lastSegmentFinishTimeMs=te.value._tfinish.getTime(),J(q,Z))}}function J(te,q){!isNaN(te.lastSegmentStart)&&!isNaN(te.lastSegmentRequestTimeMs)&&(q.segment_request_start_s=.001*te.lastSegmentRequestTimeMs,q.segment_download_finish_s=.001*te.lastSegmentFinishTimeMs,te.lastSegmentStart=NaN,te.lastSegmentRequestTimeMs=NaN)}function K(te){if(te&&te.mediaType){var q=w[te.mediaType];q&&q.state!==E&&(q.abrQuality=te.newQuality)}}function ae(te,q){if(te.length!==q.length)return-1;for(var Z=0,pe=0;pe<te.length;pe++)Z=Z+te[pe]*q[pe];return Z}function re(te){for(var q=te.length,Z=!1,pe=[],he=0;he<q;++he)pe[he]=te[he];for(var Q=te.sort(function(B,L){return L-B}),Y=0,ie=0,ue=[],$=0;$<q-1;++$)if(Y=Y+Q[$],ie=(Y-1)/($+1),ie>=Q[$+1]){Z=!0;break}Z||(ie=(Y+Q[q-1]-1)/q);for(var W=0;W<q;++W)ue[W]=Math.max(pe[W]-ie,0);return ue}function le(te){var q=Object(o.default)(g).create(),Z=4,pe=Math.pow(Z,.99),he=Math.max(Math.pow(Z,1),pe*Math.sqrt(Z)),Q=te.getMediaInfo(),Y=te.getMediaType(),ie=Q.bitrateList.map(function(Bt){return Bt.bandwidth}),ue=ie.length,$=te.getScheduleController(),W=te.getStreamInfo(),B=te.getAbrController(),L=B.getThroughputHistory(),D=W&&W.manifestInfo&&W.manifestInfo.isDynamic,O=te.useL2AABR(),U=R.getCurrentBufferLevel(Y,!0),fe=L.getSafeAverageThroughput(Y,D),ye=L.getAverageThroughput(Y,D),_e=2,ee=L.getAverageLatency(Y),j=te.getVideoModel(),X,z=j.getPlaybackRate();if(!te||!te.hasOwnProperty("getMediaInfo")||!te.hasOwnProperty("getMediaType")||!te.hasOwnProperty("getScheduleController")||!te.hasOwnProperty("getStreamInfo")||!te.hasOwnProperty("getAbrController")||!te.hasOwnProperty("useL2AABR")||(q.reason=q.reason||{},!O||Y===p.default.AUDIO))return q;$.setTimeToLoadDelay(0);var oe=G(te);if(oe.state===E)return q;var se=C[Y];if(!se||(q.reason.state=oe.state,q.reason.throughput=ye,q.reason.latency=ee,isNaN(ye)))return q;switch(oe.state){case v:if(X=B.getQualityForBitrate(Q,fe,W.id,ee),q.quality=X,q.reason.throughput=fe,oe.lastQuality=X,!isNaN(oe.lastSegmentDurationS)&&U>=se.B_target){oe.state=M,se.Q=pe;for(var ce=0;ce<ue;++ce)ce===oe.lastQuality?se.prev_w[ce]=1:se.prev_w[ce]=0}break;case M:var Se=[],Me=R.getCurrentHttpRequest(Y).trace.reduce(function(Bt,Lt){return Bt+Lt.d},0),ve=R.getCurrentHttpRequest(Y).trace.reduce(function(Bt,Lt){return Bt+Lt.b[0]},0),be=Math.round(8*ve/Me);be<1&&(be=1);for(var Ne=oe.lastSegmentDurationS,Ue=1,Xe=0;Xe<ue;++Xe)ie[Xe]=ie[Xe]/1e3,z*ie[Xe]>be&&(Ue=-1),se.w[Xe]=se.prev_w[Xe]+Ue*(Ne/(2*he))*((se.Q+pe)*(z*ie[Xe]/be));se.w=re(se.w);for(var ot=0;ot<ue;++ot)Se[ot]=se.w[ot]-se.prev_w[ot],se.prev_w[ot]=se.w[ot];se.Q=Math.max(0,se.Q-Ne+Ne*z*((ae(ie,se.prev_w)+ae(ie,Se))/be));for(var ct=[],xt=0;xt<ue;++xt)ct[xt]=Math.abs(ie[xt]-ae(se.w,ie));X=ct.indexOf(Math.min.apply(Math,ct)),X>oe.lastQuality&&ie[oe.lastQuality+1]<=be&&(X=oe.lastQuality+1),ie[X]>=be&&(se.Q=_e*Math.max(pe,se.Q)),q.quality=X,q.reason.throughput=ye,q.reason.latency=ee,q.reason.bufferLevel=U,oe.lastQuality=q.quality;break;default:b.debug("L2A ABR rule invoked in bad state."),q.quality=B.getQualityForBitrate(Q,fe,W.id,ee),q.reason.state=oe.state,q.reason.throughput=fe,q.reason.latency=ee,oe.state=v,F(oe)}return q}function me(){w={},C={}}function de(){me(),S.off(f.default.PLAYBACK_SEEKING,V,x),S.off(f.default.MEDIA_FRAGMENT_LOADED,k,x),S.off(f.default.METRIC_ADDED,H,x),S.off(f.default.QUALITY_CHANGE_REQUESTED,K,x)}return x={getMaxIndex:le,reset:de},P(),x}y.__dashjs_factory_name="L2ARule",r.default=l.default.getClassFactory(y)},"./src/streaming/rules/abr/SwitchHistoryRule.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/streaming/rules/SwitchRequest.js");function u(){var c=this.context,f,h,p=.075,E=6;function v(){h=Object(o.default)(c).getInstance().getLogger(f)}function M(y){for(var _=y?y.getSwitchHistory():null,g=_?_.getSwitchRequests():[],R=0,S=0,x=0,w=Object(l.default)(c).create(),C=0;C<g.length;C++)if(g[C]!==void 0&&(R+=g[C].drops,S+=g[C].noDrops,x+=g[C].dropSize,R+S>=E&&R/S>p)){w.quality=C>0&&g[C].drops>0?C-1:C,w.reason={index:w.quality,drops:R,noDrops:S,dropSize:x},h.debug("Switch history rule index: "+w.quality+" samples: "+(R+S)+" drops: "+R);break}return w}return f={getMaxIndex:M},v(),f}u.__dashjs_factory_name="SwitchHistoryRule",r.default=i.default.getClassFactory(u)},"./src/streaming/rules/abr/ThroughputRule.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/rules/SwitchRequest.js"),l=n("./src/streaming/constants/Constants.js"),u=n("./src/streaming/constants/MetricsConstants.js");function c(f){f=f||{};var h=this.context,p=f.dashMetrics,E;function v(){if(!p||!p.hasOwnProperty("getCurrentBufferState"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function M(_){var g=Object(o.default)(h).create();if(!_||!_.hasOwnProperty("getMediaInfo")||!_.hasOwnProperty("getMediaType")||!_.hasOwnProperty("useBufferOccupancyABR")||!_.hasOwnProperty("getAbrController")||!_.hasOwnProperty("getScheduleController"))return g;v();var R=_.getMediaInfo(),S=_.getMediaType(),x=p.getCurrentBufferState(S),w=_.getScheduleController(),C=_.getAbrController(),b=_.getStreamInfo(),P=b?b.id:null,A=b&&b.manifestInfo?b.manifestInfo.isDynamic:null,I=C.getThroughputHistory(),F=I.getSafeAverageThroughput(S,A),G=I.getAverageLatency(S),V=_.useBufferOccupancyABR();return isNaN(F)||!x||V||C.getAbandonmentStateFor(P,S)!==u.default.ABANDON_LOAD&&(x.state===u.default.BUFFER_LOADED||A)&&(g.quality=C.getQualityForBitrate(R,F,P,G),w.setTimeToLoadDelay(0),g.reason={throughput:F,latency:G}),g}function y(){}return E={getMaxIndex:M,reset:y},E}c.__dashjs_factory_name="ThroughputRule",r.default=i.default.getClassFactory(c)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l={MANUAL:"manual_weight_selection",RANDOM:"random_weight_selection",DYNAMIC:"dynamic_weight_selection"};function u(){var c=this.context,f,h,p,E,v,M,y,_,g;function R(){h=Object(o.default)(c).getInstance().getLogger(f),x()}function S(){x()}function x(){p=null,E=1,v=100,M=0,y=null,_=null,g=l.DYNAMIC}function w(){var le=0;if(p)for(var me=0;me<p.length;me++){var de=p[me];de.state.throughput>le&&(le=de.state.throughput)}return le}function C(le){var me=le.map(function(de){return Math.pow(de,2)}).reduce(function(de,te){return de+te});return Math.sqrt(me)}function b(le,me,de){var te=le.map(function(Z,pe){return de[pe]*Math.pow(Z-me[pe],2)}).reduce(function(Z,pe){return Z+pe}),q=te<0?-1:1;return q*Math.sqrt(Math.abs(te))}function P(le,me){var de=[le.state.throughput,le.state.latency,le.state.rebuffer,le.state.switch],te=[me.state.throughput,me.state.latency,me.state.rebuffer,me.state.switch];return b(de,te,[1,1,1,1])}function A(le,me,de){for(var te=0;te<me.length;te++){var q=me[te],Z=.1,pe=P(q,le),he=Math.exp(-1*Math.pow(pe,2)/(2*Math.pow(Z,2)));I(q,de,he)}}function I(le,me,de){var te=le.state,q=[.01,.01,.01,.01];te.throughput=te.throughput+(me[0]-te.throughput)*q[0]*de,te.latency=te.latency+(me[1]-te.latency)*q[1]*de,te.rebuffer=te.rebuffer+(me[2]-te.rebuffer)*q[2]*de,te.switch=te.switch+(me[3]-te.switch)*q[3]*de}function F(le,me){var de=0,te=le;if(p)for(var q=0;q<p.length;q++){var Z=p[q];Z.bitrate<le.bitrate&&Z.bitrate>de&&me>Z.bitrate&&(de=Z.bitrate,te=Z)}return te}function G(le,me,de,te,q,Z,pe){var he=de,Q=te,Y=me,ie=K(le),ue=me/E;ue>1&&(ue=w()),de=de/v;var $=0,W=0,B=0,L=1e4;h.debug("getNextQuality called throughput:".concat(ue," latency:").concat(de," bufferSize:").concat(te," currentQualityIndex:").concat(Z," playbackRate:").concat(q));var D=ie[Z],O=D.bitrate*pe.getSegmentDuration()/Y,U=Math.max(0,O-Q);if(Q-O<pe.getMinBuffer())return h.debug("Buffer is low for bitrate= ".concat(D.bitrate," downloadTime=").concat(O," currentBuffer=").concat(Q," rebuffer=").concat(U)),F(D,Y).qualityIndex;switch(g){case l.MANUAL:V();break;case l.RANDOM:k(ie);break;case l.DYNAMIC:H(pe,ie,he,Q,U,Y,q);break;default:H(pe,ie,he,Q,U,Y,q)}for(var fe=null,ye=null,_e=null,ee=0;ee<ie.length;ee++){var j=ie[ee],X=j.state,z=[X.throughput,X.latency,X.rebuffer,X.switch],oe=y.slice(),se=pe.getNextBufferWithBitrate(j.bitrate,Q,Y),ce=se<pe.getMinBuffer();ce&&h.debug("Buffer is low for bitrate=".concat(j.bitrate," downloadTime=").concat(O," currentBuffer=").concat(Q," nextBuffer=").concat(se)),(j.bitrate>me-L||ce)&&j.bitrate!==M&&(oe[0]=100);var Se=b(z,[ue,$,W,B],oe);(fe===null||Se<fe)&&(fe=Se,ye=j.qualityIndex,_e=j)}var Me=Math.abs(D.bitrate-_e.bitrate)/E;return A(D,ie,[ue,de,U,Me]),A(_e,ie,[ue,$,W,Me]),ye}function V(){var le=.4,me=.4,de=.4,te=.4;y=[le,me,de,te]}function k(le){y=J(le.length,4)}function H(le,me,de,te,q,Z,pe){y||(y=_[_.length-1]);var he=le.findWeightVector(me,de,te,q,Z,pe);he!==null&&he!==-1&&(y=he)}function J(le,me){for(var de=[],te=Math.sqrt(2/le),q=0;q<me;q++)de.push(Math.random()*te);return y=de,y}function K(le){if(!p){p=[];var me=le.bitrateList,de=[];M=me[0].bandwidth,me.forEach(function(Z){de.push(Z.bandwidth),Z.bandwidth<M&&(M=Z.bandwidth)}),E=C(de);for(var te=0;te<me.length;te++){var q={qualityIndex:te,bitrate:me[te].bandwidth,state:{throughput:me[te].bandwidth/E,latency:0,rebuffer:0,switch:0}};p.push(q)}_=re(p)}return p}function ae(le){for(var me=[],de=0;de<le;de++){var te=[Math.random()*w(),Math.random(),Math.random(),Math.random()];me.push(te)}return me}function re(le){var me=[],de=ae(Math.pow(le.length,2));me.push(de[0]);for(var te=[1,1,1,1],q=1;q<le.length;q++){for(var Z=null,pe=null,he=0;he<de.length;he++){for(var Q=de[he],Y=null,ie=0;ie<me.length;ie++){var ue=b(Q,me[ie],te);(Y===null||ue<Y)&&(Y=ue)}(pe===null||Y>pe)&&(Z=Q,pe=Y)}me.push(Z)}for(var $=null,W=null,B=0;B<me.length;B++){for(var L=0,D=0;D<me.length;D++)B!==D&&(L+=b(me[B],me[D],te));($===null||L>$)&&($=L,W=B)}var O=[];for(O.push(me[W]),me.splice(W,1);me.length>0;){for(var U=null,fe=null,ye=0;ye<me.length;ye++){var _e=b(O[0],me[ye],te);(U===null||_e<U)&&(U=_e,fe=ye)}O.push(me[fe]),me.splice(fe,1)}return O}return f={getNextQuality:G,reset:S},R(),f}u.__dashjs_factory_name="LearningAbrController",r.default=i.default.getClassFactory(u)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/rules/abr/lolp/QoeInfo.js");function l(){var u,c,f,h,p;function E(){v()}function v(){c=null,f=null,h=null,p=null}function M(w,C,b){c=y("segment",w,C,b),f=w,h=C,p=b}function y(w,C,b,P){var A=new o.default;return A.type=w,C?A.weights.bitrateReward=C:A.weights.bitrateReward=1,A.weights.bitrateSwitchPenalty=1,b?A.weights.rebufferPenalty=b:A.weights.rebufferPenalty=1e3,A.weights.latencyPenalty=[],A.weights.latencyPenalty.push({threshold:1.1,penalty:P*.05}),A.weights.latencyPenalty.push({threshold:1e8,penalty:b*.1}),P?A.weights.playbackSpeedPenalty=P:A.weights.playbackSpeedPenalty=200,A}function _(w,C,b,P){c&&g(w,C,b,P,c)}function g(w,C,b,P,A){A.bitrateWSum+=A.weights.bitrateReward*w,A.lastBitrate&&(A.bitrateSwitchWSum+=A.weights.bitrateSwitchPenalty*Math.abs(w-A.lastBitrate)),A.lastBitrate=w,A.rebufferWSum+=A.weights.rebufferPenalty*C;for(var I=0;I<A.weights.latencyPenalty.length;I++){var F=A.weights.latencyPenalty[I];if(b<=F.threshold){A.latencyWSum+=F.penalty*b;break}}A.playbackSpeedWSum+=A.weights.playbackSpeedPenalty*Math.abs(1-P),A.totalQoe=A.bitrateWSum-A.bitrateSwitchWSum-A.rebufferWSum-A.latencyWSum-A.playbackSpeedWSum}function R(){return c}function S(w,C,b,P){var A=null;return f&&h&&p&&(A=y("segment",f,h,p)),A?(g(w,C,b,P,A),A.totalQoe):0}function x(){v()}return u={setupPerSegmentQoe:M,logSegmentMetrics:_,getPerSegmentQoe:R,calculateSingleUseQoe:S,reset:x},E(),u}l.__dashjs_factory_name="LoLpQoeEvaluator",r.default=i.default.getClassFactory(l)},"./src/streaming/rules/abr/lolp/LoLpRule.js":function(t,r,n){n.r(r);var i=n("./src/core/Debug.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/rules/abr/lolp/LearningAbrController.js"),u=n("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),c=n("./src/streaming/rules/SwitchRequest.js"),f=n("./src/streaming/constants/MetricsConstants.js"),h=n("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),p=n("./src/streaming/constants/Constants.js"),E=1.5,v=.3;function M(y){y=y||{};var _=y.dashMetrics,g=this.context,R,S,x,w;function C(){R=Object(i.default)(g).getInstance().getLogger(S),x=Object(l.default)(g).create(),w=Object(u.default)(g).create()}function b(I){try{var F=Object(c.default)(g).create(),G=I.getMediaInfo().type,V=I.getAbrController(),k=I.getStreamInfo(),H=V.getQualityFor(G,k.id),J=I.getMediaInfo(),K=_.getCurrentBufferState(G),ae=I.getScheduleController(),re=_.getCurrentBufferLevel(G,!0),le=k&&k.manifestInfo?k.manifestInfo.isDynamic:null,me=ae.getPlaybackController(),de=me.getCurrentLiveLatency();if(!I.useLoLPABR()||G===p.default.AUDIO)return F;de||(de=0);var te=me.getPlaybackRate(),q=V.getThroughputHistory(),Z=q.getSafeAverageThroughput(G,le);if(R.debug("Throughput ".concat(Math.round(Z)," kbps")),isNaN(Z)||!K||V.getAbandonmentStateFor(k.id,G)===f.default.ABANDON_LOAD)return F;for(var pe=J.bitrateList,he=I.getRepresentationInfo().fragmentDuration,Q=pe[0].bandwidth/1e3,Y=pe[pe.length-1].bandwidth/1e3,ie=0;ie<pe.length;ie++){var ue=pe[ie].bandwidth/1e3;ue>Y?Y=ue:ue<Q&&(Q=ue)}var $=pe[H].bandwidth,W=$/1e3,B=_.getCurrentHttpRequest(G,!0),L=(B.tresponse.getTime()-B.trequest.getTime())/1e3,D=L>he?L-he:0;w.setupPerSegmentQoe(he,Y,Q),w.logSegmentMetrics(W,D,de,te);var O=Object(h.default)(g).create({targetLatency:E,bufferMin:v,segmentDuration:he,qoeEvaluator:w});return F.quality=x.getNextQuality(J,Z*1e3,de,re,te,H,O),F.reason={throughput:Z,latency:de},F.priority=c.default.PRIORITY.STRONG,ae.setTimeToLoadDelay(0),F.quality!==H&&console.log("[TgcLearningRule]["+G+"] requesting switch to index: ",F.quality,"Average throughput",Math.round(Z),"kbps"),F}catch(U){throw U}}function P(){x.reset(),w.reset()}function A(){P()}return S={getMaxIndex:b,reset:A},C(),S}M.__dashjs_factory_name="LoLPRule",r.default=o.default.getClassFactory(M)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(l){var u=l.targetLatency,c=l.bufferMin,f=l.segmentDuration,h=l.qoeEvaluator,p,E,v,M,y;function _(){g()}function g(){E=[.2,.4,.6,.8,1],v=4,M=x(E,v),y=0}function R(A,I,F,G,V,k){var H=null,J=null,K=null,ae=Math.abs(I-y);return A.forEach(function(re){M.forEach(function(le){var me={throughput:le[0],latency:le[1],buffer:le[2],switch:le[3]},de=re.bitrate*f/V,te=P(F,de),q=Math.max(1e-5,de-te),Z;me.buffer===0?Z=10:Z=1/me.buffer;var pe=Z*q;me.latency===0?Z=10:Z=1/me.latency;var he=Z*re.state.latency,Q=h.calculateSingleUseQoe(re.bitrate,pe,he,k);(H===null||Q>H)&&S(I,te,ae)&&(H=Q,J=le,K=re.bitrate)})}),J===null&&K===null&&(J=-1),y=I,J}function S(A,I,F){return A>u+F?!1:I>=c}function x(A,I){var F=A.map(function(V){return[V]}),G=function V(k,H,J){if(J===H)return k;for(var K=k.length,ae=0;ae<K;ae++)for(var re=k.shift(),le=0;le<A.length;le++)k.push(re.concat(A[le]));return V(k,H,J+1)};return G(F,I,1)}function w(){return c}function C(){return f}function b(A,I,F){var G=A*f/F;return P(I,G)}function P(A,I){var F=C(),G;return I>F?G=A-F:G=A+F-I,G}return p={getMinBuffer:w,getSegmentDuration:C,getNextBufferWithBitrate:b,getNextBuffer:P,findWeightVector:R},_(),p}o.__dashjs_factory_name="LoLpWeightSelector",r.default=i.default.getClassFactory(o)},"./src/streaming/rules/abr/lolp/QoeInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0};r.default=o},"./src/streaming/text/EmbeddedTextHtmlRender.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(){var l=0,u;function c(y){for(var _="",g=0;g<y.length;++g){var R=y[g];_+=R.uchar}var S=_.length,x=_.replace(/^\s+/,"").length;return S-x}function f(y){return"left: "+y.x*3.125+"%; top: "+y.y1*6.66+"%; width: "+(100-y.x*3.125)+"%; height: "+Math.max(y.y2-1-y.y1,1)*6.66+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function h(y){return y==="red"?"rgb(255, 0, 0)":y==="green"?"rgb(0, 255, 0)":y==="blue"?"rgb(0, 0, 255)":y==="cyan"?"rgb(0, 255, 255)":y==="magenta"?"rgb(255, 0, 255)":y==="yellow"?"rgb(255, 255, 0)":y==="white"?"rgb(255, 255, 255)":y==="black"?"rgb(0, 0, 0)":y}function p(y,_){var g=y.videoHeight/15;return _?"font-size: "+g+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(_.foreground?h(_.foreground):"rgb(255, 255, 255)")+"; font-style: "+(_.italics?"italic":"normal")+"; text-decoration: "+(_.underline?"underline":"none")+"; white-space: pre; background-color: "+(_.background?h(_.background):"transparent")+";":"font-size: "+g+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function E(y){return y.replace(/^\s+/g,"")}function v(y){return y.replace(/\s+$/g,"")}function M(y,_,g,R){var S=null,x=null,w=!1,C=-1,b={start:_,end:g,spans:[]},P="style_cea608_white_black",A={},I={},F=[],G,V;for(G=0;G<15;++G){var k=R.rows[G],H="",J=null;if(k.isEmpty()===!1){var K=c(k.chars);S===null&&(S={x:K,y1:G,y2:G+1,p:[]}),K!==C&&w&&(S.p.push(b),b={start:_,end:g,spans:[]},S.y2=G,S.name="region_"+S.x+"_"+S.y1+"_"+S.y2,A.hasOwnProperty(S.name)===!1?(F.push(S),A[S.name]=S):(x=A[S.name],x.p.contat(S.p)),S={x:K,y1:G,y2:G+1,p:[]});for(var ae=0;ae<k.chars.length;++ae){var re=k.chars[ae],le=re.penState;if(J===null||!le.equals(J)){H.trim().length>0&&(b.spans.push({name:P,line:H,row:G}),H="");var me="style_cea608_"+le.foreground+"_"+le.background;le.underline&&(me+="_underline"),le.italics&&(me+="_italics"),I.hasOwnProperty(me)||(I[me]=JSON.parse(JSON.stringify(le))),J=le,P=me}H+=re.uchar}H.trim().length>0&&b.spans.push({name:P,line:H,row:G}),w=!0,C=K}else w=!1,C=-1,S&&(S.p.push(b),b={start:_,end:g,spans:[]},S.y2=G,S.name="region_"+S.x+"_"+S.y1+"_"+S.y2,A.hasOwnProperty(S.name)===!1?(F.push(S),A[S.name]=S):(x=A[S.name],x.p.contat(S.p)),S=null)}S&&(S.p.push(b),S.y2=G+1,S.name="region_"+S.x+"_"+S.y1+"_"+S.y2,A.hasOwnProperty(S.name)===!1?(F.push(S),A[S.name]=S):(x=A[S.name],x.p.contat(S.p)),S=null);var de=[];for(G=0;G<F.length;++G){var te=F[G],q="sub_cea608_"+l++,Z=document.createElement("div");Z.id=q;var pe=f(te);Z.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+pe;var he=document.createElement("div");he.className="paragraph bodyStyle",he.style.cssText=p(y);var Q=document.createElement("div");Q.className="cueUniWrapper",Q.style.cssText="unicode-bidi: normal; direction: ltr;";for(var Y=0;Y<te.p.length;++Y){var ie=te.p[Y],ue=0;for(V=0;V<ie.spans.length;++V){var $=ie.spans[V];if($.line.length>0){if(V!==0&&ue!=$.row){var W=document.createElement("br");W.className="lineBreak",Q.appendChild(W)}var B=!1;ue===$.row&&(B=!0),ue=$.row;var L=I[$.name],D=document.createElement("span");D.className="spanPadding "+$.name+" customSpanColor",D.style.cssText=p(y,L),V!==0&&B?V===ie.spans.length-1?D.textContent=v($.line):D.textContent=$.line:ie.spans.length>1&&V<ie.spans.length-1&&$.row===ie.spans[V+1].row?D.textContent=E($.line):D.textContent=$.line.trim(),Q.appendChild(D)}}}he.appendChild(Q),Z.appendChild(he);var O={bodyStyle:["%",90]};for(var U in I)I.hasOwnProperty(U)&&(O[U]=["%",90]);de.push({type:"html",start:_,end:g,cueHTMLElement:Z,cueID:q,cellResolution:[32,15],isFromCEA608:!0,fontSize:O,lineHeight:{},linePadding:{}})}return de}return u={createHTMLCaptionsFromScreen:M},u}o.__dashjs_factory_name="EmbeddedTextHtmlRender",r.default=i.default.getSingletonFactory(o)},"./src/streaming/text/NotFragmentedTextBufferController.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/utils/InitCache.js"),c=n("./src/streaming/SourceBufferSink.js"),f=n("./src/streaming/vo/DashJSError.js"),h=n("./src/core/errors/Errors.js"),p="NotFragmentedTextBufferController";function E(v){v=v||{};var M=this.context,y=Object(i.default)(M).getInstance(),_=v.textController,g=v.errHandler,R=v.streamInfo,S=v.type,x,w,C,b,P,A;function I(){C=!1,b=null,w=!1,A=Object(u.default)(M).getInstance(),y.on(o.default.INIT_FRAGMENT_LOADED,Z,x)}function F(){return p}function G(U){K(U)}function V(U){return new Promise(function(fe,ye){try{P=Object(c.default)(M).create({mediaSource:b,textController:_,eventBus:y}),P.initializeForFirstUse(R,U),C||(P.getBuffer()&&typeof P.getBuffer().initialize=="function"&&P.getBuffer().initialize(),C=!0),fe(P)}catch(_e){g.error(new f.default(h.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,h.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+S)),ye(_e)}})}function k(){return R.id}function H(){return S}function J(){return P}function K(U){b=U}function ae(){return b}function re(){return!1}function le(){return 0}function me(){return w}function de(U){w!==U&&(w=U,w&&O(o.default.BUFFERING_COMPLETED))}function te(U){y.off(o.default.INIT_FRAGMENT_LOADED,Z,x),!U&&P&&(P.abort(),P.reset(),P=null)}function q(U){return A.extract(R.id,U)!==null}function Z(U){!U.chunk.bytes||w||(A.save(U.chunk),P.append(U.chunk),de(!0))}function pe(){return null}function he(){return[]}function Q(){return Number.POSITIVE_INFINITY}function Y(){return Promise.resolve()}function ie(){return Promise.resolve()}function ue(){return Promise.resolve()}function $(){return w=!1,Promise.resolve()}function W(){return Promise.resolve()}function B(){}function L(){}function D(){return Promise.resolve()}function O(U,fe){var ye=fe||{};y.trigger(U,ye,{streamId:R.id,mediaType:S})}return x={initialize:G,getStreamId:k,getType:H,getBufferControllerType:F,createBufferSink:V,getBuffer:J,getBufferLevel:le,getRangeAt:pe,getAllRangesWithSafetyFactor:he,getContinuousBufferTimeForTargetTime:Q,setMediaSource:K,getMediaSource:ae,appendInitSegmentFromCache:q,getIsBufferingCompleted:me,setIsBufferingCompleted:de,getIsPruningInProgress:re,reset:te,clearBuffers:Y,prepareForPlaybackSeek:ue,prepareForReplacementTrackSwitch:$,setSeekTarget:B,updateAppendWindow:W,pruneAllSafely:D,updateBufferTimestampOffset:ie,segmentRequestingCompleted:L},I(),x}E.__dashjs_factory_name=p,r.default=l.default.getClassFactory(E)},"./src/streaming/text/TextController.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/text/TextSourceBuffer.js"),u=n("./src/streaming/text/TextTracks.js"),c=n("./src/streaming/utils/VTTParser.js"),f=n("./src/streaming/utils/TTMLParser.js"),h=n("./src/core/EventBus.js"),p=n("./src/core/events/Events.js"),E=n("./src/streaming/MediaPlayerEvents.js"),v=n("./src/streaming/utils/SupervisorTools.js");function M(y){var _=this.context,g=y.adapter,R=y.errHandler,S=y.manifestModel,x=y.mediaController,w=y.videoModel,C=y.settings,b,P,A,I,F,G,V,k,H,J,K,ae,re;function le(){k=null,K=!1,ae=!1,H=!1,re=!1,F=Object(c.default)(_).getInstance(),G=Object(f.default)(_).getInstance(),V=Object(h.default)(_).getInstance(),fe()}function me(){V.on(p.default.CURRENT_TRACK_CHANGED,ie,b),V.on(p.default.TEXT_TRACKS_QUEUE_INITIALIZED,Y,b)}function de(_e){var ee=_e.id,j=Object(u.default)(_).create({videoModel:w,streamInfo:_e});j.initialize(),I[ee]=j;var X=Object(l.default)(_).create({errHandler:R,adapter:g,manifestModel:S,mediaController:x,videoModel:w,textTracks:j,vttParser:F,ttmlParser:G,streamInfo:_e});X.initialize(),A[ee]=X,P[ee]={},P[ee].lastEnabledIndex=-1}function te(_e){var ee=_e.id;!I[ee]||I[ee].createTracks()}function q(_e,ee,j){var X=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,z=_e.id;!A[z]||A[z].addMediaInfos(ee,j,X)}function Z(_e){var ee=_e.id;if(A&&A[ee])return A[ee]}function pe(){return J}function he(_e,ee){var j=_e.id;!A[j]||A[j].addEmbeddedTrack(ee)}function Q(_e){k=_e,H=!0}function Y(_e){var ee=_e.tracks,j=_e.index,X=_e.streamId,z=C.get().streaming.text.defaultEnabled;z===!1&&!$()||re?B(X,-1):(k&&ee.some(function(oe,se){if(x.matchSettings(k,oe))return B(X,se),j=se,!0}),J=!1),P[X].lastEnabledIndex=j,V.trigger(E.default.TEXT_TRACKS_ADDED,{enabled:$(),index:j,tracks:ee,streamId:X}),ae=!0}function ie(_e){if(!H&&_e&&_e.newMediaInfo){var ee=_e.newMediaInfo;ee.type===i.default.TEXT&&(k={lang:ee.lang,role:ee.roles[0],index:ee.index,codec:ee.codec,accessibility:ee.accessibility[0]})}}function ue(_e,ee){Object(v.checkParameterType)(ee,"boolean"),$()!==ee&&(ee&&B(_e,P[_e].lastEnabledIndex),ee||(P[_e].lastEnabledIndex=O(_e),ae?B(_e,-1):re=!0))}function $(){var _e=!0;return J&&!K&&(_e=!1),_e}function W(_e){Object(v.checkParameterType)(_e,"boolean"),K=_e}function B(_e,ee){J=ee===-1,J&&x&&x.saveTextSettingsDisabled();var j=O(_e);if(!(j===ee||!I[_e])){I[_e].setModeForTrackIdx(j,i.default.TEXT_HIDDEN),I[_e].setCurrentTrackIdx(ee),I[_e].setModeForTrackIdx(ee,i.default.TEXT_SHOWING);var X=I[_e].getCurrentTrackInfo();X&&X.isFragmented&&!X.isEmbedded?L(_e,X,j):X&&!X.isFragmented&&D(_e,X),x.setTrack(X)}}function L(_e,ee,j){if(!!A[_e])for(var X=A[_e].getConfig(),z=X.fragmentedTracks,oe=0;oe<z.length;oe++){var se=z[oe];if(ee.lang===se.lang&&(se.id?ee.id===se.id:ee.index===se.index)){var ce=x.getCurrentTrackFor(i.default.TEXT,_e);(se.id?ce.id!==se.id:ce.index!==se.index)?(I[_e].deleteCuesFromTrackIdx(j),A[_e].setCurrentFragmentedTrackIdx(oe)):j===-1&&V.trigger(p.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:_e,mediaType:i.default.TEXT})}}}function D(_e,ee){V.trigger(p.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:ee},{streamId:_e,mediaType:i.default.TEXT})}function O(_e){return I[_e].getCurrentTrackIdx()}function U(_e){if(!!_e){var ee=_e.id;A[ee]&&A[ee].resetMediaInfos(),I[ee]&&I[ee].deleteAllTextTracks()}}function fe(){A={},I={},P={},J=!0,ae=!1,re=!1}function ye(){fe(),V.off(p.default.CURRENT_TRACK_CHANGED,ie,b),V.off(p.default.TEXT_TRACKS_QUEUE_INITIALIZED,Y,b),Object.keys(A).forEach(function(_e){A[_e].resetEmbedded(),A[_e].reset()})}return b={deactivateStream:U,initialize:me,initializeForStream:de,createTracks:te,getTextSourceBuffer:Z,getAllTracksAreDisabled:pe,addEmbeddedTrack:he,setInitialSettings:Q,enableText:ue,isTextEnabled:$,setTextTrack:B,getCurrentTrackIdx:O,enableForcedTextStreaming:W,addMediaInfosToBuffer:q,reset:ye},le(),b}M.__dashjs_factory_name="TextController",r.default=o.default.getClassFactory(M)},"./src/streaming/text/TextSourceBuffer.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/vo/metrics/HTTPRequest.js"),l=n("./src/streaming/vo/TextTrackInfo.js"),u=n("./src/streaming/utils/BoxParser.js"),c=n("./src/streaming/utils/CustomTimeRanges.js"),f=n("./src/core/FactoryMaker.js"),h=n("./src/core/Debug.js"),p=n("./src/streaming/text/EmbeddedTextHtmlRender.js"),E=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),v=n.n(E),M=n("./externals/cea608-parser.js"),y=n.n(M),_=n("./src/core/EventBus.js"),g=n("./src/core/events/Events.js"),R=n("./src/streaming/vo/DashJSError.js"),S=n("./src/core/errors/Errors.js");function x(w){var C=w.errHandler,b=w.manifestModel,P=w.mediaController,A=w.videoModel,I=w.textTracks,F=w.vttParser,G=w.ttmlParser,V=w.streamInfo,k=this.context,H=Object(_.default)(k).getInstance(),J=!1,K,ae,re,le,me,de,te,q,Z,pe,he,Q,Y,ie,ue,$;function W(){ae=Object(h.default)(k).getInstance().getLogger(K),re=Object(u.default)(k).getInstance(),D()}function B(){return V.id}function L(){de=null,q=NaN,Z=[],pe=null,te=!1}function D(){L(),me=[],le=null}function O(){J||j()}function U(Fe,Ce,we){if(me=me.concat(Ce),Fe===i.default.TEXT&&Ce[0].isFragmented&&!Ce[0].isEmbedded){de=we,K.buffered=Object(c.default)(k).create(),Z=P.getTracksFor(i.default.TEXT,V.id).filter(function(at){return at.isFragmented});for(var Qe=P.getCurrentTrackFor(i.default.TEXT,V.id),it=0;it<Z.length;it++)if(Z[it]===Qe){se(it);break}}for(var st=0;st<Ce.length;st++)fe(Ce[st])}function fe(Fe){var Ce=new l.default,we={subtitle:"subtitles",caption:"captions"};for(var Qe in Fe)Ce[Qe]=Fe[Qe];Ce.labels=Fe.labels,Ce.defaultTrack=Lt(Fe),Ce.isFragmented=Fe.isFragmented,Ce.isEmbedded=!!Fe.isEmbedded,Ce.isTTML=ce(Fe),Ce.kind=Se(Fe,we),I.addTextTrack(Ce)}function ye(){}function _e(){D(),me=[],re=null}function ee(Fe){var Ce=Fe.chunk;Ce.mediaInfo.embeddedCaptions&&Me(Ce.bytes,Ce)}function j(){Q=[],he=null,Y=0,ue=[],ie=null,J=!0,$=Object(p.default)(k).getInstance(),H.on(g.default.VIDEO_CHUNK_RECEIVED,ee,K),H.on(g.default.BUFFER_CLEARED,Oe,K)}function X(){H.off(g.default.VIDEO_CHUNK_RECEIVED,ee,K),H.off(g.default.BUFFER_CLEARED,Oe,K),I&&I.deleteAllTextTracks(),J=!1,Q=[],ue=[null,null],ie=null}function z(Fe){if(!!J&&Fe)if(Fe.id===i.default.CC1||Fe.id===i.default.CC3){for(var Ce=0;Ce<Q.length;Ce++)if(Q[Ce].id===Fe.id)return;Q.push(Fe)}else ae.warn("Embedded track "+Fe.id+" not supported!")}function oe(){var Fe={fragmentModel:de,fragmentedTracks:Z,videoModel:A};return Fe}function se(Fe){he=Fe}function ce(Fe){return Fe.codec&&Fe.codec.search(i.default.STPP)>=0||Fe.mimeType&&Fe.mimeType.search(i.default.TTML)>=0}function Se(Fe,Ce){var we=Fe.roles&&Fe.roles.length>0?Ce[Fe.roles[0]]:Ce.caption;return we=we===Ce.caption||we===Ce.subtitle?we:Ce.caption,we}function Me(Fe,Ce){var we=Ce.mediaInfo,Qe=we.type,it=we.mimeType,st=we.codec||it;if(!st){ae.error("No text type defined");return}we.codec.indexOf("application/mp4")!==-1?ve(Fe,Ce,st):Qe===i.default.VIDEO?Xe(Fe,Ce):Ue(Fe,Ce,st)}function ve(Fe,Ce,we){var Qe,it;if(Ce.segmentType==="InitializationSegment")te=!0,q=re.getMediaTimescaleFromMoov(Fe);else{if(!te)return;it=re.getSamplesInfo(Fe),Qe=it.sampleList,Qe.length>0&&(pe=Qe[0].cts-Ce.start*q),we.search(i.default.STPP)>=0?be(Fe,Qe,we):Ne(Fe,Qe)}}function be(Fe,Ce,we){var Qe,it;for(le=le!==null?le:Pt(we),Qe=0;Qe<Ce.length;Qe++){var st=Ce[Qe],at=st.cts,Ae=Bt(),Be=Ae+at/q,We=Be+st.duration/q;K.buffered.add(Be,We);var Te=new DataView(Fe,st.offset,st.subSizes[0]),De=v.a.Utils.dataViewToString(Te,i.default.UTF8),Ze=[],nt=st.offset+st.subSizes[0];for(it=1;it<st.subSizes.length;it++){var ge=new Uint8Array(Fe,nt,st.subSizes[it]),Pe=String.fromCharCode.apply(null,ge);Ze.push(Pe),nt+=st.subSizes[it]}try{var qe=b.getValue(),Ye=qe.ttmlTimeIsRelative?at/q:0,$e=le.parse(De,Ye,at/q,(at+st.duration)/q,Ze);I.addCaptions(he,Ae,$e)}catch(ht){de.removeExecutedRequestsBeforeTime(),this.remove(),ae.error("TTML parser error: "+ht.message)}}}function Ne(Fe,Ce){var we,Qe,it,st=[];for(we=0;we<Ce.length;we++){var at=Ce[we];at.cts-=pe;var Ae=Bt(),Be=Ae+at.cts/q,We=Be+at.duration/q;K.buffered.add(Be,We);var Te=Fe.slice(at.offset,at.offset+at.size),De=v.a.parseBuffer(Te);for(Qe=0;Qe<De.boxes.length;Qe++){var Ze=De.boxes[Qe];if(ae.debug("VTT box1: "+Ze.type),Ze.type!=="vtte"&&Ze.type==="vttc")for(ae.debug("VTT vttc boxes.length = "+Ze.boxes.length),it=0;it<Ze.boxes.length;it++){var nt=Ze.boxes[it];if(ae.debug("VTT box2: "+nt.type),nt.type==="payl"){var ge=nt.cue_text;ae.debug("VTT cue_text = "+ge);var Pe=at.cts/q,qe=(at.cts+at.duration)/q;st.push({start:Pe,end:qe,data:ge,styles:{}}),ae.debug("VTT "+Pe+"-"+qe+" : "+ge)}}}}st.length>0&&I.addCaptions(he,0,st)}function Ue(Fe,Ce,we){var Qe,it,st=new DataView(Fe,0,Fe.byteLength);it=v.a.Utils.dataViewToString(st,i.default.UTF8);try{Qe=Pt(we).parse(it,0),I.addCaptions(I.getCurrentTrackIdx(),0,Qe),K.buffered&&K.buffered.add(Ce.start,Ce.end)}catch(at){C.error(new R.default(S.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,S.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+at.message,it))}}function Xe(Fe,Ce){var we,Qe;if(Ce.segmentType===o.HTTPRequest.INIT_SEGMENT_TYPE)Y===0&&(Y=re.getMediaTimescaleFromMoov(Fe));else if(Ce.segmentType===o.HTTPRequest.MEDIA_SEGMENT_TYPE){if(Y===0){ae.warn("CEA-608: No timescale for embeddedTextTrack yet");return}Qe=re.getSamplesInfo(Fe);var it=Qe.lastSequenceNumber;if(!ue[0]&&!ue[1]&&ot(),Y){if(ie!==null&&it!==ie+Qe.numSequences)for(we=0;we<ue.length;we++)ue[we]&&ue[we].reset();for(var st=xt(Fe,Qe.sampleList),at=0;at<ue.length;at++){var Ae=st.fields[at],Be=ue[at];if(Be)for(we=0;we<Ae.length;we++)Be.addData(Ae[we][0]/Y,Ae[we][1])}ie=it}}}function ot(){for(var Fe,Ce=0;Ce<Q.length;Ce++){if(Fe=I.getTrackIdxForId(Q[Ce].id),Fe===-1){ae.warn("CEA-608: data before track is ready.");return}var we=ct(Fe);ue[Ce]=new y.a.Cea608Parser(Ce+1,{newCue:we},null)}}function ct(Fe){function Ce(we,Qe,it){var st;if(A.getTTMLRenderingDiv())st=$.createHTMLCaptionsFromScreen(A.getElement(),we,Qe,it);else{var at=it.getDisplayText();st=[{start:we,end:Qe,data:at,styles:{}}]}st&&I.addCaptions(Fe,0,st)}return Ce}function xt(Fe,Ce){if(Ce.length===0)return null;for(var we={splits:[],fields:[[],[]]},Qe=new DataView(Fe),it=0;it<Ce.length;it++)for(var st=Ce[it],at=y.a.findCea608Nalus(Qe,st.offset,st.size),Ae=null,Be=0,We=0;We<at.length;We++)for(var Te=y.a.extractCea608DataFromRange(Qe,at[We]),De=0;De<2;De++)if(Te[De].length>0){st.cts!==Ae?Be=0:Be+=1;var Ze=Bt();we.fields[De].push([st.cts+Ze*Y,Te[De],Be]),Ae=st.cts}return we.fields.forEach(function(ge){ge.sort(function(Pe,qe){return Pe[0]===qe[0]?Pe[2]-qe[2]:Pe[0]-qe[0]})}),we}function Bt(){return isNaN(K.timestampOffset)?0:K.timestampOffset}function Lt(Fe){var Ce=!1;return Q.length>1&&Fe.isEmbedded?Ce=Fe.id&&Fe.id===i.default.CC1:Q.length===1?Fe.id&&typeof Fe.id=="string"&&Fe.id.substring(0,2)==="CC"&&(Ce=!0):Q.length===0&&(Ce=Fe.index===me[0].index),Ce}function Pt(Fe){var Ce;return Fe.search(i.default.VTT)>=0?Ce=F:(Fe.search(i.default.TTML)>=0||Fe.search(i.default.STPP)>=0)&&(Ce=G),Ce}function Ht(Fe,Ce){Fe===void 0&&Fe===Ce&&(Fe=K.buffered.start(0),Ce=K.buffered.end(K.buffered.length-1)),K.buffered.remove(Fe,Ce),I.deleteCuesFromTrackIdx(he,Fe,Ce)}function Oe(Fe){Q.forEach(function(Ce){var we=I.getTrackIdxForId(Ce.id);we>=0&&I.deleteCuesFromTrackIdx(we,Fe.from,Fe.to)})}function ze(){me=[]}return K={initialize:O,addMediaInfos:U,resetMediaInfos:ze,getStreamId:B,append:Me,abort:ye,addEmbeddedTrack:z,resetEmbedded:X,getConfig:oe,setCurrentFragmentedTrackIdx:se,remove:Ht,reset:_e},W(),K}x.__dashjs_factory_name="TextSourceBuffer",r.default=f.default.getClassFactory(x)},"./src/streaming/text/TextTracks.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/core/EventBus.js"),l=n("./src/core/events/Events.js"),u=n("./src/streaming/MediaPlayerEvents.js"),c=n("./src/core/FactoryMaker.js"),f=n("./src/core/Debug.js"),h=n("./node_modules/imsc/src/main/js/main.js");function p(E){var v=this.context,M=Object(o.default)(v).getInstance(),y=E.videoModel,_=E.streamInfo,g,R,S,x,w,C,b,P,A,I,F,G,V,k,H,J,K;function ae(){R=Object(f.default)(v).getInstance().getLogger(g)}function re(){typeof window=="undefined"||typeof navigator=="undefined"||(S=window.VTTCue||window.TextTrackCue,x=[],w=[],C=-1,b=0,P=0,A=0,I=0,F=null,G=null,k=!1,J=2147483647,H=null,document.fullscreenElement!==void 0?V="fullscreenElement":document.webkitIsFullScreen!==void 0?V="webkitIsFullScreen":document.msFullscreenElement?V="msFullscreenElement":document.mozFullScreen&&(V="mozFullScreen"))}function le(){return _.id}function me(z){var oe=z.kind,se=z.id!==void 0?z.id:z.lang,ce=z.lang,Se=z.isTTML,Me=z.isEmbedded,ve=y.addTextTrack(oe,se,ce,Se,Me);return ve}function de(z){x.push(z)}function te(){x.sort(function(be,Ne){return be.index-Ne.index}),F=y.getTTMLRenderingDiv();for(var z=-1,oe=0;oe<x.length;oe++){var se=me(x[oe]);w.push(se),x[oe].defaultTrack&&(se.default=!0,z=oe);var ce=Y(oe);ce&&(ce.mode=i.default.TEXT_SHOWING,F&&(x[oe].isTTML||x[oe].isEmbedded)?ce.renderingType="html":ce.renderingType="default"),Q(oe,0,x[oe].captionData),M.trigger(u.default.TEXT_TRACK_ADDED)}if($.call(this,z),z>=0){var Se=function be(){var Ne=Y(z);Ne&&Ne.renderingType==="html"&&Z.call(this,Ne,!0),M.off(u.default.PLAYBACK_METADATA_LOADED,be,this)};M.on(u.default.PLAYBACK_METADATA_LOADED,Se,this);for(var Me=0;Me<x.length;Me++){var ve=Y(Me);ve&&(ve.mode=Me===z?i.default.TEXT_SHOWING:i.default.TEXT_HIDDEN)}}M.trigger(l.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:C,tracks:x,streamId:_.id})}function q(z,oe,se,ce,Se,Me){var ve=z/oe,be=se/ce,Ne=0,Ue=0;ve>be?(Ue=oe,Ne=Ue/ce*se):(Ne=z,Ue=Ne/se*ce);var Xe=0,ot=0,ct=0,xt=0,Bt=Ne/Ue;return Bt>Se?(xt=Ue,ct=Ue*Se):(ct=Ne,xt=Ne/Se),Xe=(z-ct)/2,ot=(oe-xt)/2,Me?{x:Xe+ct*.1,y:ot+xt*.1,w:ct*.8,h:xt*.8}:{x:Xe,y:ot,w:ct,h:xt}}function Z(z,oe){var se=y.getClientWidth(),ce=y.getClientHeight(),Se=y.getVideoWidth(),Me=y.getVideoHeight(),ve=y.getVideoRelativeOffsetTop(),be=y.getVideoRelativeOffsetLeft();if(Se!==0&&Me!==0){var Ne=Se/Me,Ue=!1;z.isFromCEA608&&(Ne=3.5/3,Ue=!0);var Xe=q.call(this,se,ce,Se,Me,Ne,Ue),ot=Xe.w,ct=Xe.h,xt=Xe.x,Bt=Xe.y;if(ot!=A||ct!=I||xt!=b||Bt!=P||oe){if(b=xt+be,P=Bt+ve,A=ot,I=ct,F){var Lt=F.style;Lt&&(Lt.left=b+"px",Lt.top=P+"px",Lt.width=A+"px",Lt.height=I+"px",Lt.zIndex=V&&document[V]||k?J:null,M.trigger(u.default.CAPTION_CONTAINER_RESIZE))}var Pt=z.activeCues;if(Pt)for(var Ht=Pt.length,Oe=0;Oe<Ht;++Oe){var ze=Pt[Oe];ze.scaleCue(ze)}}}}function pe(z){var oe=A,se=I,ce,Se,Me,ve,be;if(z.cellResolution){var Ne=[oe/z.cellResolution[0],se/z.cellResolution[1]];if(z.linePadding){for(ce in z.linePadding)if(z.linePadding.hasOwnProperty(ce)){var Ue=z.linePadding[ce];Se=(Ue*Ne[0]).toString();for(var Xe=document.getElementsByClassName("spanPadding"),ot=0;ot<Xe.length;ot++)Xe[ot].style.cssText=Xe[ot].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Se),Xe[ot].style.cssText=Xe[ot].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Se)}}if(z.fontSize){for(ce in z.fontSize)if(z.fontSize.hasOwnProperty(ce)){z.fontSize[ce][0]==="%"?Me=z.fontSize[ce][1]/100:z.fontSize[ce][0]==="c"&&(Me=z.fontSize[ce][1]),Se=(Me*Ne[1]).toString(),ce!=="defaultFontSize"?be=document.getElementsByClassName(ce):be=document.getElementsByClassName("paragraph");for(var ct=0;ct<be.length;ct++)be[ct].style.cssText=be[ct].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Se)}if(z.lineHeight){for(ce in z.lineHeight)if(z.lineHeight.hasOwnProperty(ce)){z.lineHeight[ce][0]==="%"?ve=z.lineHeight[ce][1]/100:z.fontSize[ce][0]==="c"&&(ve=z.lineHeight[ce][1]),Se=(ve*Ne[1]).toString(),be=document.getElementsByClassName(ce);for(var xt=0;xt<be.length;xt++)be[xt].style.cssText=be[xt].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Se)}}}}if(z.isd){var Bt=document.getElementById(z.cueID);Bt&&F.removeChild(Bt),he(z)}}function he(z){if(F){var oe=document.createElement("div");F.appendChild(oe),H=Object(h.renderHTML)(z.isd,oe,function(se){var ce=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,Se=/^#(.*)$/;if(ce.test(se)){var Me=ce.exec(se),ve=parseInt(Me[4],10)-1,be=btoa(z.images[ve]),Ne="data:image/png;base64,"+be;return Ne}else if(Se.test(se)){var Ue=Se.exec(se),Xe=Ue[1],ot="data:image/png;base64,"+z.embeddedImages[Xe];return ot}else return null},F.clientHeight,F.clientWidth,!1,function(se){R.info("renderCaption :",se)},H,!0),oe.id=z.cueID,M.trigger(u.default.CAPTION_RENDERED,{captionDiv:oe,currentTrackIdx:C})}}function Q(z,oe,se){var ce=Y(z),Se=this;if(!!ce&&!(!Array.isArray(se)||se.length===0))for(var Me=0;Me<se.length;Me++){var ve=void 0,be=se[Me];ce.cellResolution=be.cellResolution,ce.isFromCEA608=be.isFromCEA608,be.type==="html"&&F&&!isNaN(be.start)&&!isNaN(be.end)?(ve=new S(be.start+oe,be.end+oe,""),ve.cueHTMLElement=be.cueHTMLElement,ve.isd=be.isd,ve.images=be.images,ve.embeddedImages=be.embeddedImages,ve.cueID=be.cueID,ve.scaleCue=pe.bind(Se),ve.cellResolution=be.cellResolution,ve.lineHeight=be.lineHeight,ve.linePadding=be.linePadding,ve.fontSize=be.fontSize,F.style.left=b+"px",F.style.top=P+"px",F.style.width=A+"px",F.style.height=I+"px",ve.onenter=function(){ce.mode===i.default.TEXT_SHOWING&&(this.isd?(he(this),R.debug("Cue enter id:"+this.cueID)):(F.appendChild(this.cueHTMLElement),pe.call(Se,this),M.trigger(u.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:C})))},ve.onexit=function(){if(F)for(var Ne=F.childNodes,Ue=0;Ue<Ne.length;++Ue)Ne[Ue].id===this.cueID&&(R.debug("Cue exit id:"+Ne[Ue].id),F.removeChild(Ne[Ue]),--Ue)}):be.data&&!isNaN(be.start)&&!isNaN(be.end)&&(ve=new S(be.start-oe,be.end-oe,be.data),be.styles&&(be.styles.align!==void 0&&"align"in ve&&(ve.align=be.styles.align),be.styles.line!==void 0&&"line"in ve&&(ve.line=be.styles.line),be.styles.position!==void 0&&"position"in ve&&(ve.position=be.styles.position),be.styles.size!==void 0&&"size"in ve&&(ve.size=be.styles.size)),ve.onenter=function(){ce.mode===i.default.TEXT_SHOWING&&M.trigger(u.default.CAPTION_RENDERED,{currentTrackIdx:C})});try{ve?B(ce,ve)||ce.addCue(ve):R.error("impossible to display subtitles.")}catch(Ne){throw D(ce),ce.addCue(ve),Ne}}}function Y(z){return z>=0&&x[z]?y.getTextTrack(x[z].kind,x[z].id,x[z].lang,x[z].isTTML,x[z].isEmbedded):null}function ie(){return C}function ue(z){for(var oe=-1,se=0;se<x.length;se++)if(x[se].id===z){oe=se;break}return oe}function $(z){var oe=this;if(z!==C){C=z;var se=Y(C);W.call(this,se),G&&(clearInterval(G),G=null),se&&se.renderingType==="html"&&(Z.call(this,se,!0),window.ResizeObserver?(K=new window.ResizeObserver(function(){Z.call(oe,se,!0)}),K.observe(y.getElement())):G=setInterval(Z.bind(this,se),500))}}function W(z){ee.call(this),z?z.renderingType==="html"?ye.call(this):_e.call(this):_e.call(this)}function B(z,oe){if(!z.cues)return!1;for(var se=0;se<z.cues.length;se++)if(z.cues[se].startTime===oe.startTime&&z.cues[se].endTime===oe.endTime)return!0;return!1}function L(z,oe,se){return(isNaN(oe)||z.startTime>=oe)&&(isNaN(se)||z.endTime<=se)}function D(z,oe,se){if(z.cues)for(var ce=z.cues,Se=ce.length-1,Me=Se;Me>=0;Me--)L(ce[Me],oe,se)&&(ce[Me].onexit&&ce[Me].onexit(),z.removeCue(ce[Me]))}function O(z,oe,se){var ce=Y(z);ce&&D(ce,oe,se)}function U(){for(var z=w?w.length:0,oe=0;oe<z;oe++){var se=Y(oe);se&&D.call(this,se,_.start,_.start+_.duration)}w=[],x=[],G&&(clearInterval(G),G=null),K&&y&&(K.unobserve(y.getElement()),K=null),C=-1,ee.call(this)}function fe(z){y.removeChild(w[z]),w.splice(z,1)}function ye(){var z=document.getElementById("native-cue-style");if(!z){z=document.createElement("style"),z.id="native-cue-style",document.head.appendChild(z);var oe=z.sheet,se=y.getElement();try{se&&(se.id?oe.insertRule("#"+se.id+"::cue {background: transparent}",0):se.classList.length!==0?oe.insertRule("."+se.className+"::cue {background: transparent}",0):oe.insertRule("video::cue {background: transparent}",0))}catch(ce){R.info(""+ce.message)}}}function _e(){var z=document.getElementById("native-cue-style");z&&document.head.removeChild(z)}function ee(){if(F)for(;F.firstChild;)F.removeChild(F.firstChild)}function j(z,oe){var se=Y(z);se&&se.mode!==oe&&(se.mode=oe)}function X(){return x[C]}return g={initialize:re,getStreamId:le,addTextTrack:de,addCaptions:Q,createTracks:te,getCurrentTrackIdx:ie,setCurrentTrackIdx:$,getTrackIdxForId:ue,getCurrentTrackInfo:X,setModeForTrackIdx:j,deleteCuesFromTrackIdx:O,deleteAllTextTracks:U,deleteTextTrack:fe},ae(),g}p.__dashjs_factory_name="TextTracks",r.default=c.default.getClassFactory(p)},"./src/streaming/thumbnail/ThumbnailController.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js"),l=n("./src/streaming/vo/Thumbnail.js"),u=n("./src/streaming/thumbnail/ThumbnailTracks.js"),c=n("./src/streaming/vo/BitrateInfo.js"),f=n("./src/dash/utils/SegmentsUtils.js");function h(p){var E=this.context,v=p.streamInfo,M,y;function _(){P(),y=Object(u.default)(E).create({streamInfo:v,adapter:p.adapter,baseURLController:p.baseURLController,timelineConverter:p.timelineConverter,debug:p.debug,eventBus:p.eventBus,events:p.events,dashConstants:p.dashConstants,dashMetrics:p.dashMetrics,segmentBaseController:p.segmentBaseController})}function g(){y.addTracks();var A=y.getTracks();A&&A.length>0&&w(0)}function R(){return v.id}function S(A,I){if(typeof I=="function"){var F=y.getCurrentTrack(),G,V;if(!F||F.segmentDuration<=0||A===void 0||A===null){I(null);return}V=y.getThumbnailRequestForTime(A),V&&(F.segmentDuration=V.duration),G=A%F.segmentDuration;var k=Math.floor(G*F.tilesHor*F.tilesVert/F.segmentDuration),H=new l.default;if(H.width=Math.floor(F.widthPerTile),H.height=Math.floor(F.heightPerTile),H.x=Math.floor(k%F.tilesHor)*F.widthPerTile,H.y=Math.floor(k/F.tilesHor)*F.heightPerTile,"readThumbnail"in F)return F.readThumbnail(A,function(K){H.url=K,I(H)});if(V)H.url=V.url,F.segmentDuration=NaN;else{var J=Math.floor(A/F.segmentDuration);H.url=x(F,J)}I(H)}}function x(A,I){var F=I+A.startNumber,G=Object(f.replaceTokenForTemplate)(A.templateUrl,"Number",F);return G=Object(f.replaceTokenForTemplate)(G,"Time",(F-1)*A.segmentDuration*A.timescale),G=Object(f.replaceTokenForTemplate)(G,"Bandwidth",A.bandwidth),Object(f.unescapeDollarsInTemplate)(G)}function w(A){y.setTrackByIndex(A)}function C(){return y.getCurrentTrackIndex()}function b(){var A=y.getTracks(),I=0;return A.map(function(F){var G=new c.default;return G.mediaType=o.default.IMAGE,G.qualityIndex=I++,G.bitrate=F.bitrate,G.width=F.width,G.height=F.height,G})}function P(){y&&y.reset()}return M={getStreamId:R,initialize:g,provide:S,setTrackByIndex:w,getCurrentTrackIndex:C,getBitrateList:b,reset:P},_(),M}h.__dashjs_factory_name="ThumbnailController",r.default=i.default.getClassFactory(h)},"./src/streaming/thumbnail/ThumbnailTracks.js":function(t,r,n){n.r(r),n.d(r,"THUMBNAILS_SCHEME_ID_URIS",function(){return M});var i=n("./src/streaming/constants/Constants.js"),o=n("./src/dash/constants/DashConstants.js"),l=n("./src/core/FactoryMaker.js"),u=n("./src/streaming/vo/ThumbnailTrackInfo.js"),c=n("./src/streaming/utils/URLUtils.js"),f=n("./src/dash/utils/SegmentsUtils.js"),h=n("./src/streaming/utils/BoxParser.js"),p=n("./src/streaming/net/XHRLoader.js"),E=n("./src/dash/DashHandler.js"),v=n("./src/dash/controllers/SegmentsController.js"),M=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function y(_){var g=this.context,R=_.adapter,S=_.baseURLController,x=_.streamInfo,w=_.timelineConverter,C=_.debug,b=_.eventBus,P=_.events,A=_.dashConstants,I=Object(c.default)(g).getInstance(),F,G,V,k,H,J,K,ae;function re(){ie(),K=Object(p.default)(g).create({}),ae=Object(h.default)(g).getInstance(),J=Object(v.default)(g).create({events:P,eventBus:b,streamInfo:x,timelineConverter:w,dashConstants:A,dashMetrics:_.dashMetrics,segmentBaseController:_.segmentBaseController,type:i.default.IMAGE}),V=Object(E.default)(g).create({streamInfo:x,type:i.default.IMAGE,timelineConverter:w,segmentsController:J,baseURLController:S,debug:C,eventBus:b,events:P,dashConstants:A,urlUtils:I}),V.initialize(R?R.getIsDynamic():!1)}function le(){if(!(!x||!R)&&(H=R.getMediaInfoForType(x,i.default.IMAGE),!!H)){var ue=R.getVoRepresentations(H);ue&&ue.length>0&&ue.forEach(function($){($.segmentInfoType===o.default.SEGMENT_TEMPLATE&&$.segmentDuration>0&&$.media||$.segmentInfoType===o.default.SEGMENT_TIMELINE)&&me($),$.segmentInfoType===o.default.SEGMENT_BASE&&me($,!0)}),G.length>0&&G.sort(function($,W){return $.bitrate-W.bitrate})}}function me(ue,$){var W=new u.default;W.id=ue.id,W.bitrate=ue.bandwidth,W.width=ue.width,W.height=ue.height,W.tilesHor=1,W.tilesVert=1,ue.essentialProperties&&ue.essentialProperties.forEach(function(B){if(M.indexOf(B.schemeIdUri)>=0&&B.value){var L=B.value.split("x");L.length===2&&!isNaN(L[0])&&!isNaN(L[1])&&(W.tilesHor=parseInt(L[0],10),W.tilesVert=parseInt(L[1],10))}}),$?J.updateSegmentData(ue).then(function(B){de(W,ue,B)}):(W.startNumber=ue.startNumber,W.segmentDuration=ue.segmentDuration,W.timescale=ue.timescale,W.templateUrl=q(ue)),W.tilesHor>0&&W.tilesVert>0&&(W.widthPerTile=W.width/W.tilesHor,W.heightPerTile=W.height/W.tilesVert,G.push(W))}function de(ue,$,W){var B=[],L=te(W,$);$.segments=L,ue.segmentDuration=$.segments[0].duration,ue.readThumbnail=function(D,O){var U=null;B.some(function(fe){if(fe.start<=D&&fe.end>D)return U=fe.url,!0}),U?O(U):$.segments.some(function(fe){if(fe.mediaStartTime<=D&&fe.mediaStartTime+fe.duration>D){var ye=S.resolve($.path);return K.load({method:"get",url:ye.url,request:{range:fe.mediaRange,responseType:"arraybuffer"},onload:function(ee){var j=ae.getSamplesInfo(ee.target.response),X=new Blob([ee.target.response.slice(j.sampleList[0].offset,j.sampleList[0].offset+j.sampleList[0].size)],{type:"image/jpeg"}),z=window.URL.createObjectURL(X);B.push({start:fe.mediaStartTime,end:fe.mediaStartTime+fe.duration,url:z}),O&&O(z)}}),!0}})}}function te(ue,$){var W=[],B=0,L,D,O,U;for(L=0,D=ue.segments.length;L<D;L++)O=ue.segments[L],U=Object(f.getTimeBasedSegment)(w,R.getIsDynamic(),$,O.startTime,O.duration,O.timescale,O.media,O.mediaRange,B),U&&(W.push(U),U=null,B++);return W}function q(ue){var $=I.isRelative(ue.media)?I.resolve(ue.media,S.resolve(ue.path).url):ue.media;return $?Object(f.replaceIDForTemplate)($,ue.id):""}function Z(){return G}function pe(){return k}function he(){return k<0?null:G[k]}function Q(ue){!G||G.length===0||(ue>=G.length&&(ue=G.length-1),k=ue)}function Y(ue){for(var $,W=R.getVoRepresentations(H),B=0;B<W.length;B++)if(G[k].id===W[B].id){$=W[B];break}return V.getSegmentRequestForTime(H,$,ue)}function ie(){G=[],k=-1,H=null}return F={getTracks:Z,addTracks:le,reset:ie,setTrackByIndex:Q,getCurrentTrack:he,getCurrentTrackIndex:pe,getThumbnailRequestForTime:Y},re(),F}y.__dashjs_factory_name="ThumbnailTracks",r.default=l.default.getClassFactory(y)},"./src/streaming/utils/BaseURLSelector.js":function(t,r,n){n.r(r);var i=n("./src/core/errors/Errors.js"),o=n("./src/core/EventBus.js"),l=n("./src/core/events/Events.js"),u=n("./src/streaming/controllers/BlacklistController.js"),c=n("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),f=n("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),h=n("./src/core/FactoryMaker.js"),p=n("./src/streaming/vo/DashJSError.js"),E=n("./src/streaming/utils/SupervisorTools.js");function v(){var M=this.context,y=Object(o.default)(M).getInstance(),_,g,R,S,x;function w(){g=Object(u.default)(M).create({updateEventName:l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:l.default.SERVICE_LOCATION_BLACKLIST_ADD}),R=Object(f.default)(M).create({blacklistController:g}),S=Object(c.default)(M).create({blacklistController:g}),x=R}function C(I){I.selector&&(x=I.selector)}function b(I){Object(E.checkParameterType)(I,"boolean"),x=I?S:R}function P(I){if(!!I){var F=I.baseUrls,G=I.selectedIdx;if(!isNaN(G))return F[G];var V=x.select(F);if(!V){y.trigger(l.default.URL_RESOLUTION_FAILED,{error:new p.default(i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),x===R&&A();return}return I.selectedIdx=F.indexOf(V),V}}function A(){g.reset()}return _={chooseSelector:b,select:P,reset:A,setConfig:C},w(),_}v.__dashjs_factory_name="BaseURLSelector",r.default=h.default.getClassFactory(v)},"./src/streaming/utils/BoxParser.js":function(t,r,n){n.r(r);var i=n("./src/core/Debug.js"),o=n("./src/streaming/utils/IsoFile.js"),l=n("./src/core/FactoryMaker.js"),u=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),c=n.n(u),f=n("./src/streaming/vo/IsoBoxSearchInfo.js");function h(){var p,E,v=this.context;function M(){p=Object(i.default)(v).getInstance().getLogger(E)}function y(b){if(!b)return null;b.fileStart===void 0&&(b.fileStart=0);var P=c.a.parseBuffer(b),A=Object(o.default)(v).create();return A.setData(P),A}function _(b,P,A){if(A===void 0&&(A=0),!P||A+8>=P.byteLength)return new f.default(0,!1);for(var I=P instanceof ArrayBuffer?new Uint8Array(P):P,F,G=0;A<I.byteLength;){var V=S(I,A),k=x(I,A+4);if(V===0)break;A+V<=I.byteLength&&(b.indexOf(k)>=0?F=new f.default(A,!0,V):G=A+V),A+=V}return F||new f.default(G,!1)}function g(b){if(!b||b.byteLength===0)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var P=y(b),A=P.getBoxes("moof"),I=P.getBoxes("mfhd"),F,G,V,k,H,J,K,ae,re,le,me,de,te,q,Z,pe,he;pe=P.getBoxes("moof").length,Z=I[I.length-1].sequence_number,V=0,J=[];var Q=-1,Y=-1;for(me=0;me<A.length;me++){var ie=A[me],ue=ie.getChildBoxes("traf");for(re=0;re<ue.length;re++){var $=ue[re],W=$.getChildBox("tfhd"),B=$.getChildBox("tfdt");H=B.baseMediaDecodeTime;var L=$.getChildBoxes("trun"),D=$.getChildBoxes("subs");for(le=0;le<L.length;le++){var O=L[le];for(V=O.sample_count,q=(W.base_data_offset||0)+(O.data_offset||0),ae=0;ae<V;ae++){K=O.samples[ae],F=K.sample_duration!==void 0?K.sample_duration:W.default_sample_duration,k=K.sample_size!==void 0?K.sample_size:W.default_sample_size,G=K.sample_composition_time_offset!==void 0?K.sample_composition_time_offset:0;var U={dts:H,cts:H+G,duration:F,offset:ie.offset+q,size:k,subSizes:[k]};if(D)for(de=0;de<D.length;de++){var fe=D[de];if(Q<fe.entry_count-1&&ae>Y&&(Q++,Y+=fe.entries[Q].sample_delta),ae==Y){U.subSizes=[];var ye=fe.entries[Q];for(te=0;te<ye.subsample_count;te++)U.subSizes.push(ye.subsamples[te].subsample_size)}}J.push(U),q+=k,H+=F}}he=H-B.baseMediaDecodeTime}}return{sampleList:J,lastSequenceNumber:Z,totalDuration:he,numSequences:pe}}function R(b){var P=y(b),A=P?P.getBox("mdhd"):void 0;return A?A.timescale:NaN}function S(b,P){return b[P+3]>>>0|b[P+2]<<8>>>0|b[P+1]<<16>>>0|b[P]<<24>>>0}function x(b,P){return String.fromCharCode(b[P++])+String.fromCharCode(b[P++])+String.fromCharCode(b[P++])+String.fromCharCode(b[P])}function w(b){var P=null,A,I,F=y(b);if(!F)return P;var G=F.getBox("ftyp"),V=F.getBox("moov");return p.debug("Searching for initialization."),V&&V.isComplete&&(A=G?G.offset:V.offset,I=V.offset+V.size-1,P=A+"-"+I,p.debug("Found the initialization.  Range: "+P)),P}function C(b,P,A){if(A===void 0&&(A=0),!P||A+8>=P.byteLength)return new f.default(0,!1);for(var I=P instanceof ArrayBuffer?new Uint8Array(P):P,F,G=0;A<I.byteLength;){var V=S(I,A),k=x(I,A+4);if(V===0)break;A+V<=I.byteLength&&(b.indexOf(k)>=0?F=new f.default(A,!0,V,k):G=A+V),A+=V}return F||new f.default(G,!1)}return E={parse:y,findLastTopIsoBoxCompleted:_,getMediaTimescaleFromMoov:R,getSamplesInfo:g,findInitRange:w,parsePayload:C},M(),E}h.__dashjs_factory_name="BoxParser",r.default=l.default.getSingletonFactory(h)},"./src/streaming/utils/Capabilities.js":function(t,r,n){n.r(r),n.d(r,"supportsMediaSource",function(){return c});var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/thumbnail/ThumbnailTracks.js"),l=n("./src/streaming/constants/Constants.js"),u=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function c(){var h="WebKitMediaSource"in window,p="MediaSource"in window;return h||p}function f(){var h,p,E;function v(){E=!1}function M(b){!b||b.settings&&(p=b.settings)}function y(){return E}function _(b){E=b}function g(b,P){return P!==l.default.AUDIO&&P!==l.default.VIDEO?Promise.resolve(!0):R(b,P)?x(b,P):S(b)}function R(b,P){return p.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(b.codec&&P===l.default.AUDIO||P===l.default.VIDEO&&b.codec&&b.width&&b.height&&b.bitrate&&b.framerate)}function S(b){return new Promise(function(P){if(!b||!b.codec){P(!1);return}var A=b.codec;if(b.width&&b.height&&(A+=';width="'+b.width+'";height="'+b.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(A)){P(!0);return}else if("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(A)){P(!0);return}P(!1)})}function x(b,P){return new Promise(function(A){if(!b||!b.codec){A(!1);return}var I={type:"media-source"};I[P]={},I[P].contentType=b.codec,I[P].width=b.width,I[P].height=b.height,I[P].bitrate=parseInt(b.bitrate),I[P].framerate=parseFloat(b.framerate),navigator.mediaCapabilities.decodingInfo(I).then(function(F){A(F.supported)}).catch(function(){A(!1)})})}function w(b){try{return o.THUMBNAILS_SCHEME_ID_URIS.indexOf(b.schemeIdUri)!==-1}catch{return!0}}function C(b,P){for(var A=b.split(".")[0],I=P.indexOf(A)===0,F,G=0;G<u.length;G++)if(u[G].codec===A){F=u[G];break}return F?I||F.compatibleCodecs.some(function(V){return P.indexOf(V)===0}):I}return h={setConfig:M,supportsMediaSource:c,supportsEncryptedMedia:y,supportsCodec:g,setEncryptedMediaSupported:_,supportsEssentialProperty:w,codecRootCompatibleWithCodec:C},v(),h}f.__dashjs_factory_name="Capabilities",r.default=i.default.getSingletonFactory(f)},"./src/streaming/utils/CapabilitiesFilter.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/streaming/constants/Constants.js");function u(){var c=this.context,f,h,p,E,v,M;function y(){v=Object(o.default)(c).getInstance().getLogger(f)}function _(F){!F||(F.adapter&&(h=F.adapter),F.capabilities&&(p=F.capabilities),F.settings&&(E=F.settings))}function g(F){return new Promise(function(G){var V=[];V.push(R(l.default.VIDEO,F)),V.push(R(l.default.AUDIO,F)),Promise.all(V).then(function(){E.get().streaming.capabilities.filterUnsupportedEssentialProperties&&P(F),A(F),G()}).catch(function(){G()})})}function R(F,G){if(!G||!G.Period_asArray||G.Period_asArray.length===0)return Promise.resolve();var V=[];return G.Period_asArray.forEach(function(k){V.push(S(k,F))}),Promise.all(V)}function S(F,G){return new Promise(function(V){if(!F||!F.AdaptationSet_asArray||F.AdaptationSet_asArray.length===0){V();return}var k=[];F.AdaptationSet_asArray.forEach(function(H){h.getIsTypeOf(H,G)&&k.push(x(H,G))}),Promise.all(k).then(function(){F.AdaptationSet_asArray=F.AdaptationSet_asArray.filter(function(H){var J=H.Representation_asArray&&H.Representation_asArray.length>0;return J||v.warn("AdaptationSet has been removed because of no supported Representation"),J}),V()}).catch(function(){V()})})}function x(F,G){return new Promise(function(V){if(!F.Representation_asArray||F.Representation_asArray.length===0){V();return}var k=[],H=[];F.Representation_asArray.forEach(function(J,K){var ae=h.getCodec(F,K,!1),re=w(G,J,ae);H.push(re),k.push(p.supportsCodec(re,G))}),Promise.all(k).then(function(J){F.Representation_asArray=F.Representation_asArray.filter(function(K,ae){return J[ae]||v.debug("[Stream] Codec ".concat(H[ae].codec," not supported ")),J[ae]}),V()}).catch(function(){V()})})}function w(F,G,V){switch(F){case l.default.VIDEO:return C(G,V);case l.default.AUDIO:return b(G,V);default:return null}}function C(F,G){var V=F.width||null,k=F.height||null,H=F.frameRate||null,J=F.bandwidth||null;return{codec:G,width:V,height:k,framerate:H,bitrate:J}}function b(F,G){var V=F.audioSamplingRate||null,k=F.bandwidth||null;return{codec:G,bitrate:k,samplerate:V}}function P(F){!F||!F.Period_asArray||F.Period_asArray.length===0||F.Period_asArray.forEach(function(G){G.AdaptationSet_asArray=G.AdaptationSet_asArray.filter(function(V){return!V.Representation_asArray||V.Representation_asArray.length===0?!0:(V.Representation_asArray=V.Representation_asArray.filter(function(k){var H=h.getEssentialPropertiesForRepresentation(k);if(H&&H.length>0)for(var J=0;J<H.length;){if(!p.supportsEssentialProperty(H[J]))return v.debug("[Stream] EssentialProperty not supported: "+H[J].schemeIdUri),!1;J+=1}return!0}),V.Representation_asArray&&V.Representation_asArray.length>0)})})}function A(F){!M||M.length===0||!F||!F.Period_asArray||F.Period_asArray.length===0||F.Period_asArray.forEach(function(G){G.AdaptationSet_asArray=G.AdaptationSet_asArray.filter(function(V){return!V.Representation_asArray||V.Representation_asArray.length===0?!0:(V.Representation_asArray=V.Representation_asArray.filter(function(k){return!M.some(function(H){return!H(k)})}),V.Representation_asArray&&V.Representation_asArray.length>0)})})}function I(F){M=F}return f={setConfig:_,filterUnsupportedFeatures:g,setCustomCapabilitiesFilters:I},y(),f}u.__dashjs_factory_name="CapabilitiesFilter",r.default=i.default.getSingletonFactory(u)},"./src/streaming/utils/CustomTimeRanges.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/utils/SupervisorTools.js");function l(){var u=[],c=0;function f(y,_){var g=0;for(g=0;g<this.customTimeRangeArray.length&&y>this.customTimeRangeArray[g].start;g++);for(this.customTimeRangeArray.splice(g,0,{start:y,end:_}),g=0;g<this.customTimeRangeArray.length-1;g++)this.mergeRanges(g,g+1)&&g--;this.length=this.customTimeRangeArray.length}function h(){this.customTimeRangeArray=[],this.length=0}function p(y,_){for(var g=0;g<this.customTimeRangeArray.length;g++)if(y<=this.customTimeRangeArray[g].start&&_>=this.customTimeRangeArray[g].end)this.customTimeRangeArray.splice(g,1),g--;else if(y>this.customTimeRangeArray[g].start&&_<this.customTimeRangeArray[g].end){this.customTimeRangeArray.splice(g+1,0,{start:_,end:this.customTimeRangeArray[g].end}),this.customTimeRangeArray[g].end=y;break}else y>this.customTimeRangeArray[g].start&&y<this.customTimeRangeArray[g].end?this.customTimeRangeArray[g].end=y:_>this.customTimeRangeArray[g].start&&_<this.customTimeRangeArray[g].end&&(this.customTimeRangeArray[g].start=_);this.length=this.customTimeRangeArray.length}function E(y,_){var g=this.customTimeRangeArray[y],R=this.customTimeRangeArray[_];return g.start<=R.start&&R.start<=g.end&&g.end<=R.end?(g.end=R.end,this.customTimeRangeArray.splice(_,1),!0):R.start<=g.start&&g.start<=R.end&&R.end<=g.end?(g.start=R.start,this.customTimeRangeArray.splice(_,1),!0):R.start<=g.start&&g.start<=R.end&&g.end<=R.end?(this.customTimeRangeArray.splice(y,1),!0):g.start<=R.start&&R.start<=g.end&&R.end<=g.end?(this.customTimeRangeArray.splice(_,1),!0):!1}function v(y){return Object(o.checkInteger)(y),y>=this.customTimeRangeArray.length||y<0?NaN:this.customTimeRangeArray[y].start}function M(y){return Object(o.checkInteger)(y),y>=this.customTimeRangeArray.length||y<0?NaN:this.customTimeRangeArray[y].end}return{customTimeRangeArray:u,length:c,add:f,clear:h,remove:p,mergeRanges:E,start:v,end:M}}l.__dashjs_factory_name="CustomTimeRanges",r.default=i.default.getClassFactory(l)},"./src/streaming/utils/DOMStorage.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/streaming/constants/Constants.js"),u=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],c="dashjs_?_bitrate",f="dashjs_?_settings",h="localStorage",p="sessionStorage",E="lastBitrate",v="lastMediaSettings";function M(_){_=_||{};var g=this.context,R=_.settings,S,x,w;function C(){x=Object(o.default)(g).getInstance().getLogger(S),P()}function b(J){if(w!==void 0)return w;w=!1;var K="1",ae="1",re;try{typeof window!="undefined"&&(re=window[J])}catch(le){return x.warn("DOMStorage access denied: "+le.message),w}if(!re||J!==h&&J!==p)return w;try{re.setItem(K,ae),re.removeItem(K),w=!0}catch(le){x.warn("DOMStorage is supported, but cannot be used: "+le.message)}return w}function P(){b(h)&&u.forEach(function(J){var K=localStorage.getItem(J.oldKey);if(K){localStorage.removeItem(J.oldKey);try{localStorage.setItem(J.newKey,K)}catch(ae){x.error(ae.message)}}})}function A(){var J=60*1e3*10;return Math.round(new Date().getTime()/J)*J}function I(J,K){return b(J)&&R.get().streaming[K+"CachingInfo"].enabled}function F(){if(!R)throw new Error(l.default.MISSING_CONFIG_ERROR)}function G(J){var K=null;if(F(),I(h,v)){var ae=f.replace(/\?/,J);try{var re=JSON.parse(localStorage.getItem(ae))||{},le=new Date().getTime()-parseInt(re.timestamp,10)>=R.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;K=re.settings,le&&(localStorage.removeItem(ae),K=null)}catch{return null}}return K}function V(J){var K=NaN;if(F(),I(h,E)){var ae=c.replace(/\?/,J);try{var re=JSON.parse(localStorage.getItem(ae))||{},le=new Date().getTime()-parseInt(re.timestamp,10)>=R.get().streaming.lastBitrateCachingInfo.ttl||!1,me=parseFloat(re.bitrate);!isNaN(me)&&!le?(K=me,x.debug("Last saved bitrate for "+J+" was "+me)):le&&localStorage.removeItem(ae)}catch{return null}}return K}function k(J,K){if(I(h,v)){var ae=f.replace(/\?/,J);try{localStorage.setItem(ae,JSON.stringify({settings:K,timestamp:A()}))}catch(re){x.error(re.message)}}}function H(J,K){if(I(h,E)&&K){var ae=c.replace(/\?/,J);try{localStorage.setItem(ae,JSON.stringify({bitrate:K.toFixed(3),timestamp:A()}))}catch(re){x.error(re.message)}}}return S={getSavedBitrateSettings:V,setSavedBitrateSettings:H,getSavedMediaSettings:G,setSavedMediaSettings:k},C(),S}M.__dashjs_factory_name="DOMStorage";var y=i.default.getSingletonFactory(M);r.default=y},"./src/streaming/utils/DefaultURLUtils.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(){var l,u=/^[a-z][a-z0-9+\-_.]*:/i,c=/^https?:\/\//i,f=/^https:\/\//i,h=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,p=function(I,F){try{return new window.URL(I,F).toString()}catch{return I}},E=function(I,F){var G=M;if(!F||!R(I))return I;S(I)&&(G=y),x(I)&&(G=g);var V=G(F),k=V.charAt(V.length-1)!=="/"&&I.charAt(0)!=="/"?"/":"";return[V,I].join(k)};function v(){try{var A=new window.URL("x","http://y");l=p}catch{}finally{l=l||E}}function M(A){var I=A.indexOf("/"),F=A.lastIndexOf("/");return I!==-1?F===I+1?A:(A.indexOf("?")!==-1&&(A=A.substring(0,A.indexOf("?"))),A.substring(0,F+1)):""}function y(A){var I=A.match(h);return I?I[1]:""}function _(A){var I=/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(A);return I[2].substring(1)}function g(A){var I=A.match(u);return I?I[0]:""}function R(A){return!u.test(A)}function S(A){return R(A)&&A.charAt(0)==="/"}function x(A){return A.indexOf("//")===0}function w(A){return c.test(A)}function C(A){return f.test(A)}function b(A,I){return l(A,I)}v();var P={parseBaseUrl:M,parseOrigin:y,parseScheme:g,isRelative:R,isPathAbsolute:S,isSchemeRelative:x,isHTTPURL:w,isHTTPS:C,removeHostname:_,resolve:b};return P}o.__dashjs_factory_name="DefaultURLUtils",r.default=i.default.getSingletonFactory(o)},"./src/streaming/utils/EBMLParser.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(l){l=l||{};var u,c=new DataView(l.data),f=0;function h(){return f}function p(x){f=x}function E(x,w){var C=!0,b=0,P,A;if(w===void 0&&(w=!1),x.tag>16777215?(c.getUint32(f)!==x.tag&&(C=!1),b=4):x.tag>65535?(P=c.getUint16(f),A=c.getUint8(f+2),P*256+A!==x.tag&&(C=!1),b=3):x.tag>255?(c.getUint16(f)!==x.tag&&(C=!1),b=2):(c.getUint8(f)!==x.tag&&(C=!1),b=1),!C&&x.required&&!w)throw new Error("required tag not found");return C&&(f+=b),C}function v(x,w){var C=E(x,w);return C&&_(),C}function M(x){var w;return E(x),w=_(),u[x.parse](w)}function y(x,w){var C=E(x,w),b;return C&&(b=_(),f+=b),C}function _(x){var w=1,C=128,b=8,P=-1,A=0,I=c.getUint8(f),F=0;for(F=0;F<b;F+=1){if((I&C)===C){A=x===void 0?I&~C:I,P=F;break}C>>=1}for(F=0;F<P;F+=1,w+=1)A=A<<8|255&c.getUint8(f+w);return f+=w,A}function g(x){var w;switch(x){case 4:w=c.getFloat32(f),f+=4;break;case 8:w=c.getFloat64(f),f+=8;break}return w}function R(x){for(var w=0,C=0;C<x;C+=1)w<<=8,w|=c.getUint8(f+C)&255;return f+=x,w}function S(){return f<c.byteLength}return u={getPos:h,setPos:p,consumeTag:E,consumeTagAndSize:v,parseTag:M,skipOverElement:y,getMatroskaCodedNum:_,getMatroskaFloat:g,getMatroskaUint:R,moreData:S},u}o.__dashjs_factory_name="EBMLParser",r.default=i.default.getClassFactory(o)},"./src/streaming/utils/ErrorHandler.js":function(t,r,n){n.r(r);var i=n("./src/core/EventBus.js"),o=n("./src/core/events/Events.js"),l=n("./src/core/FactoryMaker.js");function u(){var c,f=this.context,h=Object(i.default)(f).getInstance();function p(E){h.trigger(o.default.ERROR,{error:E})}return c={error:p},c}u.__dashjs_factory_name="ErrorHandler",r.default=l.default.getSingletonFactory(u)},"./src/streaming/utils/InitCache.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(){var l={};function u(p){var E=p.streamId,v=p.representationId;l[E]=l[E]||{},l[E][v]=p}function c(p,E){return l&&l[p]&&l[p][E]?l[p][E]:null}function f(){l={}}var h={save:u,extract:c,reset:f};return h}o.__dashjs_factory_name="InitCache",r.default=i.default.getSingletonFactory(o)},"./src/streaming/utils/IsoFile.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/IsoBox.js"),o=n("./src/core/FactoryMaker.js");function l(){var u,c;function f(M){return!M||!c||!c.boxes||c.boxes.length===0||typeof c.fetch!="function"?null:v(c.fetch(M))}function h(M){var y=[];if(!M||!c||typeof c.fetchAll!="function")return y;for(var _=c.fetchAll(M),g,R=0,S=_.length;R<S;R++)g=v(_[R]),g&&y.push(g);return y}function p(M){c=M}function E(){if(!c||!c.boxes||!c.boxes.length)return null;var M=c.boxes[c.boxes.length-1].type,y=h(M);return y.length>0?y[y.length-1]:null}function v(M){if(!M)return null;var y=new i.default(M);return M.hasOwnProperty("_incomplete")&&(y.isComplete=!M._incomplete),y}return u={getBox:f,getBoxes:h,setData:p,getLastBox:E},u}l.__dashjs_factory_name="IsoFile",r.default=o.default.getClassFactory(l)},"./src/streaming/utils/ObjectUtils.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./node_modules/fast-deep-equal/index.js"),l=n.n(o);function u(){var c;function f(h,p){return l()(h,p)}return c={areEqual:f},c}u.__dashjs_factory_name="ObjectUtils",r.default=i.default.getSingletonFactory(u)},"./src/streaming/utils/RequestModifier.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(){var l;function u(f){return f}function c(f){return f}return l={modifyRequestURL:u,modifyRequestHeader:c},l}o.__dashjs_factory_name="RequestModifier",r.default=i.default.getSingletonFactory(o)},"./src/streaming/utils/SupervisorTools.js":function(t,r,n){n.r(r),n.d(r,"checkParameterType",function(){return l}),n.d(r,"checkInteger",function(){return u}),n.d(r,"checkRange",function(){return c}),n.d(r,"checkIsVideoOrAudioType",function(){return f});var i=n("./src/streaming/constants/Constants.js");function o(h){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(E){return typeof E}:o=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},o(h)}function l(h,p){if(o(h)!==p)throw i.default.BAD_ARGUMENT_ERROR}function u(h){var p=h!==null&&!isNaN(h)&&h%1==0;if(!p)throw i.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function c(h,p,E){if(h<p||h>E)throw i.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function f(h){if(typeof h!="string"||h!==i.default.AUDIO&&h!==i.default.VIDEO)throw i.default.BAD_ARGUMENT_ERROR}},"./src/streaming/utils/TTMLParser.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l=n("./src/core/EventBus.js"),u=n("./src/core/events/Events.js"),c=n("./node_modules/imsc/src/main/js/main.js"),f=n("./src/streaming/MediaPlayerEvents.js"),h=n("./src/streaming/constants/ConformanceViolationConstants.js");function p(){var E=this.context,v=Object(l.default)(E).getInstance(),M,y,_=0;function g(){y=Object(o.default)(E).getInstance().getLogger(M)}function R(){var x="cue_TTML_"+_;return _++,x}function S(x,w,C,b,P){var A="",I=[],F,G,V,k={},H={},J="",K="",ae={onOpenTag:function(te,q,Z){if(Z[" imagetype"]&&!Z[" imageType"]&&(v.trigger(f.default.CONFORMANCE_VIOLATION,{level:h.default.LEVELS.ERROR,event:h.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),Z[" imageType"]=Z[" imagetype"]),q==="image"&&(te==="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"||te==="http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt")){if(!Z[" imageType"]||Z[" imageType"].value!=="PNG"){y.warn("smpte-tt imageType != PNG. Discarded");return}J=Z["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){J&&(H[J]=K.trim()),K="",J=""},onText:function(te){J&&(K=K+te)}};if(!x)throw A="no ttml data to parse",new Error(A);k.data=x,v.trigger(u.default.TTML_TO_PARSE,k);var re=Object(c.fromXML)(k.data,function(de){A=de},ae);v.trigger(u.default.TTML_PARSED,{ttmlString:k.data,ttmlDoc:re});var le=re.getMediaTimeEvents();for(V=0;V<le.length;V++){var me=Object(c.generateISD)(re,le[V],function(de){A=de});me.contents.some(function(de){return de.contents.length})&&(F=le[V]+w<C?C:le[V]+w,G=le[V+1]+w>b?b:le[V+1]+w,F<G&&I.push({start:F,end:G,type:"html",cueID:R(),isd:me,images:P,embeddedImages:H}))}if(A!=="")throw y.error(A),new Error(A);return I}return M={parse:S},g(),M}p.__dashjs_factory_name="TTMLParser",r.default=i.default.getSingletonFactory(p)},"./src/streaming/utils/URLUtils.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/utils/DefaultURLUtils.js");function l(){var c,f,h=[],p=this.context;function E(I){var F;for(F=0;F<h.length;F++){var G=h[F].regex;if(G.test(I))return h[F].utils}return f}function v(){f=Object(o.default)(p).getInstance()}function M(I,F){h.push({regex:I,utils:F})}function y(I,F,G){var V=E(G||F);return V&&typeof V[I]=="function"?V[I](F,G):f[I](F,G)}function _(I){return y("parseBaseUrl",I)}function g(I){return y("parseOrigin",I)}function R(I){return y("removeHostname",I)}function S(I){return y("parseScheme",I)}function x(I){return y("isRelative",I)}function w(I){return y("isPathAbsolute",I)}function C(I){return y("isSchemeRelative",I)}function b(I){return y("isHTTPURL",I)}function P(I){return y("isHTTPS",I)}function A(I,F){return y("resolve",I,F)}return v(),c={registerUrlRegex:M,parseBaseUrl:_,parseOrigin:g,parseScheme:S,isRelative:x,isPathAbsolute:w,isSchemeRelative:C,isHTTPURL:b,isHTTPS:P,removeHostname:R,resolve:A},c}l.__dashjs_factory_name="URLUtils";var u=i.default.getSingletonFactory(l);r.default=u},"./src/streaming/utils/VTTParser.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),l="WEBVTT";function u(){var c=this.context,f,h,p,E,v,M;function y(){h=Object(o.default)(c).getInstance().getLogger(f),p=/(?:\r\n|\r|\n)/gm,E=/-->/,v=/(^[\s]+|[\s]+$)/g,M=/\s\b/g}function _(w){var C=[],b,P;if(!w)return C;w=w.split(p),b=w.length,P=-1;for(var A=0;A<b;A++){var I=w[A];if(I.length>0&&I!==l&&I.match(E)){var F=R(I),G=F.cuePoints,V=F.styles,k=x(w,A+1),H=g(G[0].replace(v,"")),J=g(G[1].replace(v,""));!isNaN(H)&&!isNaN(J)&&H>=P&&J>H?k!==""?(P=H,C.push({start:H,end:J,data:k,styles:V})):h.error("Skipping cue due to empty/malformed cue text"):h.error("Skipping cue due to incorrect cue timing")}}return C}function g(w){var C=w.split(":"),b=C.length-1;return w=parseInt(C[b-1],10)*60+parseFloat(C[b]),b===2&&(w+=parseInt(C[0],10)*3600),w}function R(w){var C=w.split(E),b=C[1].split(M);return b.shift(),C[1]=b[0],b.shift(),{cuePoints:C,styles:S(b)}}function S(w){var C={};return w.forEach(function(b){if(b.split(/:/).length>1){var P=b.split(/:/)[1];P&&P.search(/%/)!=-1&&(P=parseInt(P.replace(/%/,""),10)),(b.match(/align/)||b.match(/A/))&&(C.align=P),(b.match(/line/)||b.match(/L/))&&(C.line=P),(b.match(/position/)||b.match(/P/))&&(C.position=P),(b.match(/size/)||b.match(/S/))&&(C.size=P)}}),C}function x(w,C){for(var b=C,P="",A="",I;w[b]!==""&&b<w.length;)b++;if(I=b-C,I>1)for(var F=0;F<I;F++)if(A=w[C+F],!A.match(E))P+=A,F!==I-1&&(P+=`
`);else{P="";break}else A=w[C],A.match(E)||(P=A);return P}return f={parse:_},y(),f}u.__dashjs_factory_name="VTTParser",r.default=i.default.getSingletonFactory(u)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(l){l=l||{};var u,c=l.blacklistController;function f(h){var p=0,E;return h&&h.some(function(v,M){return p=M,!c.contains(v.serviceLocation)})&&(E=h[p]),E}return u={select:f},u}o.__dashjs_factory_name="BasicSelector",r.default=i.default.getClassFactory(o)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":function(t,r,n){n.r(r);var i=n("./src/core/FactoryMaker.js");function o(l){l=l||{};var u,c=l.blacklistController;function f(E){var v=[],M=function(g){return!(v.length&&g.dvb_priority&&v.indexOf(g.dvb_priority)!==-1)},y=function(g){return c.contains(g.serviceLocation)?(g.dvb_priority&&v.push(g.dvb_priority),!1):!0};return E.filter(y).filter(M)}function h(E){var v=function(w,C){var b=w.dvb_priority-C.dvb_priority;return isNaN(b)?0:b},M=function(w,C,b){return!C||b[0].dvb_priority&&w.dvb_priority&&b[0].dvb_priority===w.dvb_priority},y=0,_=[],g=0,R,S;if(S=E.sort(v).filter(M),S.length)return S.length>1&&(S.forEach(function(x){y+=x.dvb_weight,_.push(y)}),R=Math.floor(Math.random()*(y-1)),_.every(function(x,w){return g=w,!(R<x)})),S[g]}function p(E){return E&&h(f(E))}return u={select:p},u}o.__dashjs_factory_name="DVBSelector",r.default=i.default.getClassFactory(o)},"./src/streaming/vo/BitrateInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};r.default=o},"./src/streaming/vo/DashJSError.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f){i(this,l),this.code=u||null,this.message=c||null,this.data=f||null};r.default=o},"./src/streaming/vo/DataChunk.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};r.default=o},"./src/streaming/vo/FragmentRequest.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/metrics/HTTPRequest.js");function o(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}function l(f,h){for(var p=0;p<h.length;p++){var E=h[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function u(f,h,p){return h&&l(f.prototype,h),p&&l(f,p),f}var c=function(){function f(h){o(this,f),this.action=f.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=h||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return u(f,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===i.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(p){this.type=p&&p.init?i.HTTPRequest.INIT_SEGMENT_TYPE:i.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=p&&p.url?p.url:null,this.range=p&&p.range?p.range.start+"-"+p.range.end:null,this.mediaType=p&&p.mediaType?p.mediaType:null}}]),f}();c.ACTION_DOWNLOAD="download",c.ACTION_COMPLETE="complete",r.default=c},"./src/streaming/vo/HeadRequest.js":function(t,r,n){n.r(r);var i=n("./src/streaming/vo/FragmentRequest.js");function o(y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(g){return typeof g}:o=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},o(y)}function l(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}function u(y,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(_&&_.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),_&&c(y,_)}function c(y,_){return c=Object.setPrototypeOf||function(R,S){return R.__proto__=S,R},c(y,_)}function f(y){var _=E();return function(){var R=v(y),S;if(_){var x=v(this).constructor;S=Reflect.construct(R,arguments,x)}else S=R.apply(this,arguments);return h(this,S)}}function h(y,_){return _&&(o(_)==="object"||typeof _=="function")?_:p(y)}function p(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(y){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},v(y)}var M=function(y){u(g,y);var _=f(g);function g(R){var S;return l(this,g),S=_.call(this,R),S.checkForExistenceOnly=!0,S}return g}(i.default);r.default=M},"./src/streaming/vo/IsoBox.js":function(t,r,n){n.r(r);function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function o(c,f){for(var h=0;h<f.length;h++){var p=f[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function l(c,f,h){return f&&o(c.prototype,f),h&&o(c,h),c}var u=function(){function c(f){if(i(this,c),this.offset=f._offset,this.type=f.type,this.size=f.size,this.boxes=[],f.boxes)for(var h=0;h<f.boxes.length;h++)this.boxes.push(new c(f.boxes[h]));switch(this.isComplete=!0,f.type){case"sidx":if(this.timescale=f.timescale,this.earliest_presentation_time=f.earliest_presentation_time,this.first_offset=f.first_offset,this.references=f.references,f.references){this.references=[];for(var p=0;p<f.references.length;p++){var E={reference_type:f.references[p].reference_type,referenced_size:f.references[p].referenced_size,subsegment_duration:f.references[p].subsegment_duration};this.references.push(E)}}break;case"emsg":this.id=f.id,this.version=f.version===1?1:0,this.value=f.value,this.timescale=f.timescale,this.scheme_id_uri=f.scheme_id_uri,this.presentation_time_delta=f.version===1?f.presentation_time:f.presentation_time_delta,this.event_duration=f.event_duration,this.message_data=f.message_data;break;case"mdhd":this.timescale=f.timescale;break;case"mfhd":this.sequence_number=f.sequence_number;break;case"subs":this.entry_count=f.entry_count,this.entries=f.entries;break;case"tfhd":this.base_data_offset=f.base_data_offset,this.sample_description_index=f.sample_description_index,this.default_sample_duration=f.default_sample_duration,this.default_sample_size=f.default_sample_size,this.default_sample_flags=f.default_sample_flags,this.flags=f.flags;break;case"tfdt":this.version=f.version,this.baseMediaDecodeTime=f.baseMediaDecodeTime,this.flags=f.flags;break;case"trun":if(this.sample_count=f.sample_count,this.first_sample_flags=f.first_sample_flags,this.data_offset=f.data_offset,this.flags=f.flags,this.samples=f.samples,f.samples){this.samples=[];for(var v=0,M=f.samples.length;v<M;v++){var y={sample_size:f.samples[v].sample_size,sample_duration:f.samples[v].sample_duration,sample_composition_time_offset:f.samples[v].sample_composition_time_offset};this.samples.push(y)}}break}}return l(c,[{key:"getChildBox",value:function(h){for(var p=0;p<this.boxes.length;p++)if(this.boxes[p].type===h)return this.boxes[p]}},{key:"getChildBoxes",value:function(h){for(var p=[],E=0;E<this.boxes.length;E++)this.boxes[E].type===h&&p.push(this.boxes[E]);return p}}]),c}();r.default=u},"./src/streaming/vo/IsoBoxSearchInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u,c,f){i(this,l),this.lastCompletedOffset=u,this.found=c,this.size=f};r.default=o},"./src/streaming/vo/MetricsList.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]};r.default=o},"./src/streaming/vo/TextRequest.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/vo/FragmentRequest.js");function l(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(R){return typeof R}:l=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},l(_)}function u(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function c(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),g&&f(_,g)}function f(_,g){return f=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},f(_,g)}function h(_){var g=v();return function(){var S=M(_),x;if(g){var w=M(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return p(this,x)}}function p(_,g){return g&&(l(g)==="object"||typeof g=="function")?g:E(_)}function E(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M(_){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},M(_)}var y=function(_){c(R,_);var g=h(R);function R(S,x){var w;return u(this,R),w=g.call(this),w.url=S||null,w.type=x||null,w.mediaType=i.default.STREAM,w.responseType="",w}return R}(o.default);r.default=y},"./src/streaming/vo/TextTrackInfo.js":function(t,r,n){n.r(r);var i=n("./src/dash/vo/MediaInfo.js");function o(y){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(g){return typeof g}:o=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},o(y)}function l(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}function u(y,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(_&&_.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),_&&c(y,_)}function c(y,_){return c=Object.setPrototypeOf||function(R,S){return R.__proto__=S,R},c(y,_)}function f(y){var _=E();return function(){var R=v(y),S;if(_){var x=v(this).constructor;S=Reflect.construct(R,arguments,x)}else S=R.apply(this,arguments);return h(this,S)}}function h(y,_){return _&&(o(_)==="object"||typeof _=="function")?_:p(y)}function p(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function E(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(y){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)},v(y)}var M=function(y){u(g,y);var _=f(g);function g(){var R;return l(this,g),R=_.call(this),R.captionData=null,R.label=null,R.defaultTrack=!1,R.kind=null,R.isFragmented=!1,R.isEmbedded=!1,R.isTTML=null,R}return g}(i.default);r.default=M},"./src/streaming/vo/Thumbnail.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null};r.default=o},"./src/streaming/vo/ThumbnailTrackInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""};r.default=o},"./src/streaming/vo/URIFragmentData.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};r.default=o},"./src/streaming/vo/metrics/BufferLevel.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.t=null,this.level=null};r.default=o},"./src/streaming/vo/metrics/BufferState.js":function(t,r,n){n.r(r);var i=n("./src/streaming/constants/MetricsConstants.js");function o(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var l=function u(){o(this,u),this.target=null,this.state=i.default.BUFFER_EMPTY};r.default=l},"./src/streaming/vo/metrics/DVRInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.time=null,this.range=null,this.manifestInfo=null};r.default=o},"./src/streaming/vo/metrics/DroppedFrames.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.time=null,this.droppedFrames=null};r.default=o},"./src/streaming/vo/metrics/HTTPRequest.js":function(t,r,n){n.r(r),n.d(r,"HTTPRequest",function(){return o}),n.d(r,"HTTPRequestTrace",function(){return l});function i(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function u(){i(this,u),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null},l=function u(){i(this,u),this.s=null,this.d=null,this.b=[],this.t=null};o.GET="GET",o.HEAD="HEAD",o.MPD_TYPE="MPD",o.XLINK_EXPANSION_TYPE="XLinkExpansion",o.INIT_SEGMENT_TYPE="InitializationSegment",o.INDEX_SEGMENT_TYPE="IndexSegment",o.MEDIA_SEGMENT_TYPE="MediaSegment",o.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",o.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",o.LICENSE="license",o.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":function(t,r,n){n.r(r),n.d(r,"ManifestUpdate",function(){return o}),n.d(r,"ManifestUpdateStreamInfo",function(){return l}),n.d(r,"ManifestUpdateRepresentationInfo",function(){return u});function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}var o=function c(){i(this,c),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},l=function c(){i(this,c),this.id=null,this.index=null,this.start=null,this.duration=null},u=function c(){i(this,c),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":function(t,r,n){n.r(r),n.d(r,"PlayList",function(){return o}),n.d(r,"PlayListTrace",function(){return l});function i(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function u(){i(this,u),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};o.INITIAL_PLAYOUT_START_REASON="initial_playout",o.SEEK_START_REASON="seek",o.RESUME_FROM_PAUSE_START_REASON="resume",o.METRICS_COLLECTION_START_REASON="metrics_collection_start";var l=function u(){i(this,u),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};l.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",l.REBUFFERING_REASON="rebuffering",l.USER_REQUEST_STOP_REASON="user_request",l.END_OF_PERIOD_STOP_REASON="end_of_period",l.END_OF_CONTENT_STOP_REASON="end_of_content",l.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",l.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.t=null,this.mt=null,this.to=null,this.lto=null};r.default=o},"./src/streaming/vo/metrics/RequestsQueue.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.loadingRequests=[],this.executedRequests=[]};r.default=o},"./src/streaming/vo/metrics/SchedulingInfo.js":function(t,r,n){n.r(r);function i(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(){i(this,l),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};r.default=o},0:function(t,r){},1:function(t,r){}}).default})})(lT);var S1=kR(lT.exports),LL=NL,uT={class:"className",for:"htmlFor","http-equiv":"httpEquiv"};function NL(m){return function(e,t,r){for(var n in t)n in uT&&(t[uT[n]]=t[n],delete t[n]);return m(e,t,r)}}var FL=LL,Ho=0,bi=1,Or=2,_f=3,pi=4,Bn=5,jp=6,bs=7,ir=8,Go=9,jo=10,ru=11,Is=12,Vo=13,BL=function(m,e){e||(e={});var t=e.concat||function(n,i){return String(n)+String(i)};return e.attrToProp!==!1&&(m=FL(m)),function(n){for(var i=bi,o="",l=arguments.length,u=[],c=0;c<n.length;c++)if(c<l-1){var f=arguments[c+1],h=w(n[c]),p=i;p===jo&&(p=ir),p===Go&&(p=ir),p===bs&&(p=ir),p===pi&&(p=Bn),p===Or?o==="/"?(h.push([Or,"/",f]),o=""):h.push([Or,f]):p===Vo&&e.comments?o+=String(f):p!==Vo&&h.push([Ho,p,f]),u.push.apply(u,h)}else u.push.apply(u,w(n[c]));for(var E=[null,{},[]],v=[[E,-1]],c=0;c<u.length;c++){var M=v[v.length-1][0],h=u[c],y=h[0];if(y===Or&&/^\//.test(h[1])){var _=v[v.length-1][1];v.length>1&&(v.pop(),v[v.length-1][0][2][_]=m(M[0],M[1],M[2].length?M[2]:void 0))}else if(y===Or){var g=[h[1],{},[]];M[2].push(g),v.push([g,M[2].length-1])}else if(y===Bn||y===Ho&&h[1]===Bn){for(var R="",S;c<u.length;c++)if(u[c][0]===Bn)R=t(R,u[c][1]);else if(u[c][0]===Ho&&u[c][1]===Bn)if(typeof u[c][2]=="object"&&!R)for(S in u[c][2])u[c][2].hasOwnProperty(S)&&!M[1][S]&&(M[1][S]=u[c][2][S]);else R=t(R,u[c][2]);else break;u[c][0]===ru&&c++;for(var x=c;c<u.length;c++)if(u[c][0]===ir||u[c][0]===Bn)M[1][R]?u[c][1]===""||(M[1][R]=t(M[1][R],u[c][1])):M[1][R]=r(u[c][1]);else if(u[c][0]===Ho&&(u[c][1]===ir||u[c][1]===Bn))M[1][R]?u[c][2]===""||(M[1][R]=t(M[1][R],u[c][2])):M[1][R]=r(u[c][2]);else{R.length&&!M[1][R]&&c===x&&(u[c][0]===_f||u[c][0]===Is)&&(M[1][R]=R.toLowerCase()),u[c][0]===_f&&c--;break}}else if(y===Bn)M[1][h[1]]=!0;else if(y===Ho&&h[1]===Bn)M[1][h[2]]=!0;else if(y===_f){if(HL(M[0])&&v.length){var _=v[v.length-1][1];v.pop(),v[v.length-1][0][2][_]=m(M[0],M[1],M[2].length?M[2]:void 0)}}else if(y===Ho&&h[1]===bi)h[2]===void 0||h[2]===null?h[2]="":h[2]||(h[2]=t("",h[2])),Array.isArray(h[2][0])?M[2].push.apply(M[2],h[2]):M[2].push(h[2]);else if(y===bi)M[2].push(h[1]);else if(!(y===ru||y===Is))throw new Error("unhandled: "+y)}if(E[2].length>1&&/^\s*$/.test(E[2][0])&&E[2].shift(),E[2].length>2||E[2].length===2&&/\S/.test(E[2][1])){if(e.createFragment)return e.createFragment(E[2]);throw new Error("multiple root elements must be wrapped in an enclosing tag")}return Array.isArray(E[2][0])&&typeof E[2][0][0]=="string"&&Array.isArray(E[2][0][2])&&(E[2][0]=m(E[2][0][0],E[2][0][1],E[2][0][2])),E[2][0];function w(C){var b=[];i===bs&&(i=pi);for(var P=0;P<C.length;P++){var A=C.charAt(P);i===bi&&A==="<"?(o.length&&b.push([bi,o]),o="",i=Or):A===">"&&!UL(i)&&i!==Vo?(i===Or&&o.length?b.push([Or,o]):i===Bn?b.push([Bn,o]):i===ir&&o.length&&b.push([ir,o]),b.push([_f]),o="",i=bi):i===Vo&&/-$/.test(o)&&A==="-"?(e.comments&&b.push([ir,o.substr(0,o.length-1)]),o="",i=bi):i===Or&&/^!--$/.test(o)?(e.comments&&b.push([Or,o],[Bn,"comment"],[ru]),o=A,i=Vo):i===bi||i===Vo?o+=A:i===Or&&A==="/"&&o.length||(i===Or&&/\s/.test(A)?(o.length&&b.push([Or,o]),o="",i=pi):i===Or?o+=A:i===pi&&/[^\s"'=/]/.test(A)?(i=Bn,o=A):i===pi&&/\s/.test(A)?(o.length&&b.push([Bn,o]),b.push([Is])):i===Bn&&/\s/.test(A)?(b.push([Bn,o]),o="",i=jp):i===Bn&&A==="="?(b.push([Bn,o],[ru]),o="",i=bs):i===Bn?o+=A:(i===jp||i===pi)&&A==="="?(b.push([ru]),i=bs):(i===jp||i===pi)&&!/\s/.test(A)?(b.push([Is]),/[\w-]/.test(A)?(o+=A,i=Bn):i=pi):i===bs&&A==='"'?i=jo:i===bs&&A==="'"?i=Go:i===jo&&A==='"'?(b.push([ir,o],[Is]),o="",i=pi):i===Go&&A==="'"?(b.push([ir,o],[Is]),o="",i=pi):i===bs&&!/\s/.test(A)?(i=ir,P--):i===ir&&/\s/.test(A)?(b.push([ir,o],[Is]),o="",i=pi):(i===ir||i===Go||i===jo)&&(o+=A))}return i===bi&&o.length?(b.push([bi,o]),o=""):i===ir&&o.length?(b.push([ir,o]),o=""):i===jo&&o.length?(b.push([ir,o]),o=""):i===Go&&o.length?(b.push([ir,o]),o=""):i===Bn&&(b.push([Bn,o]),o=""),b}};function r(n){return typeof n=="function"||typeof n=="string"||n&&typeof n=="object"||n==null?n:t("",n)}};function UL(m){return m===Go||m===jo}var WL=RegExp("^("+["area","base","basefont","bgsound","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr","!--","animate","animateTransform","circle","cursor","desc","ellipse","feBlend","feColorMatrix","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","font-face-format","font-face-name","font-face-uri","glyph","glyphRef","hkern","image","line","missing-glyph","mpath","path","polygon","polyline","rect","set","stop","tref","use","view","vkern"].join("|")+")(?:[.#][a-zA-Z0-9\x7F-\uFFFF_:-]+)*$");function HL(m){return WL.test(m)}var vf=/\n[\s]+$/,Ef=/^\n[\s]+/,cT=/[\s]+$/,fT=/^[\s]+/,yf=/[\n\s]+/g,dT=["a","abbr","b","bdi","bdo","br","cite","data","dfn","em","i","kbd","mark","q","rp","rt","rtc","ruby","s","amp","small","span","strong","sub","sup","time","u","var","wbr"],Tf=["code","pre","textarea"],GL=function m(e,t){if(!!Array.isArray(t))for(var r=e.nodeName.toLowerCase(),n=!1,i,o,l=0,u=t.length;l<u;l++){var c=t[l];if(Array.isArray(c)){m(e,c);continue}(typeof c=="number"||typeof c=="boolean"||typeof c=="function"||c instanceof Date||c instanceof RegExp)&&(c=c.toString());var f=e.childNodes[e.childNodes.length-1];if(typeof c=="string")n=!0,f&&f.nodeName==="#text"?f.nodeValue+=c:(c=e.ownerDocument.createTextNode(c),e.appendChild(c),f=c),l===u-1&&(n=!1,dT.indexOf(r)===-1&&Tf.indexOf(r)===-1?(i=f.nodeValue.replace(Ef,"").replace(cT,"").replace(vf,"").replace(yf," "),i===""?e.removeChild(f):f.nodeValue=i):Tf.indexOf(r)===-1&&(o=l===0?"":" ",i=f.nodeValue.replace(Ef,o).replace(fT," ").replace(cT,"").replace(vf,"").replace(yf," "),f.nodeValue=i));else if(c&&c.nodeType){n&&(n=!1,dT.indexOf(r)===-1&&Tf.indexOf(r)===-1?(i=f.nodeValue.replace(Ef,"").replace(vf," ").replace(yf," "),i===""?e.removeChild(f):f.nodeValue=i):Tf.indexOf(r)===-1&&(i=f.nodeValue.replace(fT," ").replace(Ef,"").replace(vf," ").replace(yf," "),f.nodeValue=i));var h=c.nodeName;h&&(r=h.toLowerCase()),e.appendChild(c)}}},jL=["svg","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],VL=["async","autofocus","autoplay","checked","controls","default","defaultchecked","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","novalidate","open","playsinline","readonly","required","reversed","selected"],zL=["indeterminate"],kL=BL,KL=GL,YL=jL,XL=VL,QL=zL,JL="http://www.w3.org/2000/svg",ZL="http://www.w3.org/1999/xlink",qL="!--",$L=function(m){function e(n,i,o){var l;YL.indexOf(n)!==-1&&(i.namespace=JL);var u=!1;i.namespace&&(u=i.namespace,delete i.namespace);var c=!1;if(i.is&&(c=i.is,delete i.is),u)c?l=m.createElementNS(u,n,{is:c}):l=m.createElementNS(u,n);else{if(n===qL)return m.createComment(i.comment);c?l=m.createElement(n,{is:c}):l=m.createElement(n)}for(var f in i)if(i.hasOwnProperty(f)){var h=f.toLowerCase(),p=i[f];if(h==="classname"&&(h="class",f="class"),f==="htmlFor"&&(f="for"),XL.indexOf(h)!==-1){if(String(p)==="true")p=h;else if(String(p)==="false")continue}h.slice(0,2)==="on"||QL.indexOf(h)!==-1?l[f]=p:u?f==="xlink:href"?l.setAttributeNS(ZL,f,p):/^xmlns($|:)/i.test(f)||l.setAttributeNS(null,f,p):l.setAttribute(f,p)}return KL(l,o),l}function t(n){for(var i=m.createDocumentFragment(),o=0;o<n.length;o++)n[o]!=null&&(Array.isArray(n[o])?i.appendChild(t(n[o])):(typeof n[o]=="string"&&(n[o]=m.createTextNode(n[o])),i.appendChild(n[o])));return i}var r=kL(e,{comments:!0,createFragment:t});return r.default=r,r.createComment=e,r},A1=$L(document),hT={exports:{}};(function(m){function e(){this.registry={},this.render=(n,i=null)=>{if(r(n)){const o=this.registry[n];if(i instanceof HTMLElement)i.id=n,i.innerHTML=o,document.head.appendChild(i);else{const l=t(n,o);document.head.appendChild(l)}}},this.add=(n,i,o=!0)=>{this.registry[n]===void 0&&(this.registry[n]=i,o&&this.render(n))},this.remove=(n,i=!1)=>{delete this.registry[n],i&&document.getElementById(n).remove()};function t(n,i){const o=document.createElement("style");return o.type="text/css",o.id=n,o.innerHTML=i,o}function r(n){return document.getElementById(n)==null}}m.exports=e})(hT);var x1=hT.exports;ra.notEqual=n1;ra.notOk=r1;ra.equal=t1;ra.ok=ra;var e1=ra;function t1(m,e,t){ra(m==e,t)}function n1(m,e,t){ra(m!=e,t)}function r1(m,e){ra(!m,e)}function ra(m,e){if(!m)throw new Error(e||"AssertionError")}var i1=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"],pT=i1,a1=pT.length,s1=1,o1=3,l1=8,u1=c1;function c1(m,e){var t=m.nodeType,r=m.nodeName;t===s1&&f1(m,e),(t===o1||t===l1)&&e.nodeValue!==m.nodeValue&&(e.nodeValue=m.nodeValue),r==="INPUT"?p1(m,e):r==="OPTION"?h1(m,e):r==="TEXTAREA"&&m1(m,e),d1(m,e)}function f1(m,e){for(var t=e.attributes,r=m.attributes,n=null,i=null,o=null,l=null,u=null,c=r.length-1;c>=0;--c)u=r[c],l=u.name,n=u.namespaceURI,i=u.value,n?(l=u.localName||l,o=e.getAttributeNS(n,l),o!==i&&e.setAttributeNS(n,l,i)):e.hasAttribute(l)?(o=e.getAttribute(l),o!==i&&(i==="null"||i==="undefined"?e.removeAttribute(l):e.setAttribute(l,i))):e.setAttribute(l,i);for(var f=t.length-1;f>=0;--f)u=t[f],u.specified!==!1&&(l=u.name,n=u.namespaceURI,n?(l=u.localName||l,m.hasAttributeNS(n,l)||e.removeAttributeNS(n,l)):m.hasAttributeNS(null,l)||e.removeAttribute(l))}function d1(m,e){for(var t=0;t<a1;t++){var r=pT[t];m[r]?e[r]=m[r]:e[r]&&(e[r]=void 0)}}function h1(m,e){Vp(m,e,"selected")}function p1(m,e){var t=m.value,r=e.value;Vp(m,e,"checked"),Vp(m,e,"disabled"),m.indeterminate!==e.indeterminate&&(e.indeterminate=m.indeterminate),e.type!=="file"&&(t!==r&&(e.setAttribute("value",t),e.value=t),t==="null"&&(e.value="",e.removeAttribute("value")),m.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=t):e.removeAttribute("value"))}function m1(m,e){var t=m.value;if(t!==e.value&&(e.value=t),e.firstChild&&e.firstChild.nodeValue!==t){if(t===""&&e.firstChild.nodeValue===e.placeholder)return;e.firstChild.nodeValue=t}}function Vp(m,e,t){m[t]!==e[t]&&(e[t]=m[t],m[t]?e.setAttribute(t,""):e.removeAttribute(t))}var zp=e1,g1=u1,_1=3,R1=v1;function v1(m,e,t){return zp.equal(typeof m,"object","nanomorph: oldTree should be an object"),zp.equal(typeof e,"object","nanomorph: newTree should be an object"),t&&t.childrenOnly?(gT(e,m),m):(zp.notEqual(e.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),Mf(e,m))}function Mf(m,e){return e?m?m.isSameNode&&m.isSameNode(e)?e:m.tagName!==e.tagName||mT(m)!==mT(e)?m:(g1(m,e),gT(m,e),e):null:m}function mT(m){return m.dataset?m.dataset.nanomorphComponentId:void 0}function gT(m,e){for(var t,r,n,i,o=0,l=0;t=e.childNodes[l],r=m.childNodes[l-o],!(!t&&!r);l++)if(!r)e.removeChild(t),l--;else if(!t)e.appendChild(r),o++;else if(_T(r,t))n=Mf(r,t),n!==t&&(e.replaceChild(n,t),o++);else{i=null;for(var u=l;u<e.childNodes.length;u++)if(_T(e.childNodes[u],r)){i=e.childNodes[u];break}i?(n=Mf(r,i),n!==i&&o++,e.insertBefore(n,t)):!r.id&&!t.id?(n=Mf(r,t),n!==t&&(e.replaceChild(n,t),o++)):(e.insertBefore(r,t),o++)}}function _T(m,e){return m.id?m.id===e.id:m.isSameNode?m.isSameNode(e):m.tagName!==e.tagName?!1:m.type===_1?m.nodeValue===e.nodeValue:!1}export{aT as A,Ry as B,Ft as C,ga as E,eT as G,gp as M,M1 as O,nr as P,Fc as S,_y as T,Ie as V,Sn as W,Et as a,Wc as b,Kn as c,qE as d,Nc as e,ZE as f,S1 as g,A1 as h,y1 as i,x1 as j,oT as l,R1 as n,lC as p,T1 as r};
